<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>chai</title>
    <link rel="stylesheet" type="text/css" href="../../css/main.css">
</head>
<body>
<div class="nav">
<div class="logo">chai</div>
<ul><li><a href="../../index.html">Lua5.3</a></li><li><a href="../../html/chai.html">chai</a></li><li><a href="../../html/mocha.html">mocha</a></li><li><a href="#"><span></span>wcj</a><ul><li class="active"><a href="../../html/wcj/Lua5.32.html">Lua5.32</a></li><li><a href="../../html/wcj/chai1.html">chai1</a></li><li><a href="../../html/wcj/mocha3.html">mocha3</a></li></ul></li></ul></div>


<div class="warpper">

    <div class="page-toc">
        <ul><li><a href="#简介">简介</a></li><li><a href="#基本概念">基本概念</a><ul><li><a href="#值与类型">值与类型</a></li><li><a href="#环境与全局环境">环境与全局环境</a></li><li><a href="#错误处理">错误处理</a></li><li><a href="#元表及元方法">元表及元方法</a></li><li><a href="#垃圾收集">垃圾收集</a><ul><li><a href="#垃圾收集元方法">垃圾收集元方法</a></li><li><a href="#弱表">弱表</a></li></ul></li><li><a href="#协程">协程</a></li></ul></li><li><a href="#语言定义">语言定义</a><ul><li><a href="#词法约定">词法约定</a></li><li><a href="#变量">变量</a></li><li><a href="#语句">语句</a><ul><li><a href="#语句块">语句块</a></li><li><a href="#代码块">代码块</a></li><li><a href="#赋值">赋值</a></li><li><a href="#控制结构">控制结构</a></li><li><a href="#For 语句">For 语句</a></li><li><a href="#函数调用语句">函数调用语句</a></li><li><a href="#局部声明">局部声明</a></li></ul></li><li><a href="#表达式">表达式</a><ul><li><a href="#数学运算操作符">数学运算操作符</a></li><li><a href="#位操作符">位操作符</a></li><li><a href="#强制转换">强制转换</a></li><li><a href="#比较操作符">比较操作符</a></li></ul></li></ul></li><li><a href="#编程接口">编程接口</a></li><li><a href="#辅助库">辅助库</a></li><li><a href="#标准库">标准库</a><ul><li><a href="#基础函数">基础函数</a></li><li><a href="#模块">模块</a></li><li><a href="#字符串处理">字符串处理</a><ul><li><a href="#匹配模式">匹配模式</a></li><li><a href="#打包和解包用到的格式串">打包和解包用到的格式串</a></li></ul></li><li><a href="#UTF-8 支持">UTF-8 支持</a></li><li><a href="#表处理">表处理</a></li><li><a href="#数学函数">数学函数</a></li><li><a href="#输入输出库">输入输出库</a></li><li><a href="#操作系统库">操作系统库</a></li><li><a href="#调试库">调试库</a></li></ul></li><li><a href="#独立版 Lua">独立版 Lua</a></li><li><a href="#与之前版本不兼容的地方">与之前版本不兼容的地方</a><ul><li><a href="#语言的变更">语言的变更</a></li><li><a href="#库的变更">库的变更</a></li><li><a href="#API 的变更">API 的变更</a></li></ul></li><li><a href="#Lua 的完整语法">Lua 的完整语法</a></li></ul>
    </div>
    
    <div class="content markdown-body">
        <p><a href="http://cloudwu.github.io/lua53doc/manual.html#3.3.1">&#x8F6C;&#x8F7D;&#x6765;&#x6E90;&#x4E8E;</a></p>
<h1 id="&#x7B80;&#x4ECB;">&#x7B80;&#x4ECB; <a href="#&#x7B80;&#x4ECB;"> # </a></h1>
<p><code>Lua</code> &#x662F;&#x4E00;&#x95E8;&#x6269;&#x5C55;&#x5F0F;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x8BED;&#x8A00;&#xFF0C;&#x88AB;&#x8BBE;&#x8BA1;&#x6210;&#x652F;&#x6301;&#x901A;&#x7528;&#x8FC7;&#x7A0B;&#x5F0F;&#x7F16;&#x7A0B;&#xFF0C;&#x5E76;&#x6709;&#x76F8;&#x5173;&#x6570;&#x636E;&#x63CF;&#x8FF0;&#x8BBE;&#x65BD;&#x3002; &#x540C;&#x65F6;&#x5BF9;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7F16;&#x7A0B;&#x3001;&#x51FD;&#x6570;&#x5F0F;&#x7F16;&#x7A0B;&#x548C;&#x6570;&#x636E;&#x9A71;&#x52A8;&#x5F0F;&#x7F16;&#x7A0B;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x826F;&#x597D;&#x7684;&#x652F;&#x6301;&#x3002; &#x5B83;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5F3A;&#x5927;&#x3001;&#x8F7B;&#x91CF;&#x7684;&#x5D4C;&#x5165;&#x5F0F;&#x811A;&#x672C;&#x8BED;&#x8A00;&#xFF0C;&#x53EF;&#x4F9B;&#x4EFB;&#x4F55;&#x9700;&#x8981;&#x7684;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x3002; <code>Lua</code> &#x7531; clean C&#xFF08;&#x6807;&#x51C6; C &#x548C; C++ &#x95F4;&#x5171;&#x901A;&#x7684;&#x5B50;&#x96C6;&#xFF09; &#x5B9E;&#x73B0;&#x6210;&#x4E00;&#x4E2A;&#x5E93;&#x3002;</p>
<p>&#x4F5C;&#x4E3A;&#x4E00;&#x95E8;&#x6269;&#x5C55;&#x5F0F;&#x8BED;&#x8A00;&#xFF0C;<code>Lua</code> &#x6CA1;&#x6709; <code>main</code> &#x7A0B;&#x5E8F;&#x7684;&#x6982;&#x5FF5;&#xFF1A; &#x5B83;&#x53EA;&#x80FD; &#x5D4C;&#x5165; &#x4E00;&#x4E2A;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x5DE5;&#x4F5C;&#xFF0C; &#x8BE5;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x88AB;&#x79F0;&#x4E3A; &#x88AB;&#x5D4C;&#x5165;&#x7A0B;&#x5E8F; &#x6216;&#x8005;&#x7B80;&#x79F0; &#x5BBF;&#x4E3B; &#x3002; &#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x6267;&#x884C;&#x4E00;&#x5C0F;&#x6BB5; <code>Lua</code> &#x4EE3;&#x7801;&#xFF0C;&#x53EF;&#x4EE5;&#x8BFB;&#x5199; <code>Lua</code> &#x53D8;&#x91CF;&#xFF0C;&#x53EF;&#x4EE5;&#x6CE8;&#x518C; <code>C</code> &#x51FD;&#x6570;&#x8BA9; <code>Lua</code> &#x4EE3;&#x7801;&#x8C03;&#x7528;&#x3002; &#x4F9D;&#x9760; C &#x51FD;&#x6570;&#xFF0C;<code>Lua</code> &#x53EF;&#x4EE5;&#x5171;&#x4EAB;&#x76F8;&#x540C;&#x7684;&#x8BED;&#x6CD5;&#x6846;&#x67B6;&#x6765;&#x5B9A;&#x5236;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#xFF0C;&#x4ECE;&#x800C;&#x9002;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x9886;&#x57DF;&#x3002; <code>Lua</code> &#x7684;&#x5B98;&#x65B9;&#x53D1;&#x5E03;&#x7248;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x53EB;&#x505A; lua &#x7684;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x793A;&#x4F8B;&#xFF0C; &#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x5229;&#x7528; <code>Lua</code> &#x5E93;&#x5B9E;&#x73B0;&#x7684;&#x5B8C;&#x6574;&#x72EC;&#x7ACB;&#x7684; <code>Lua</code> &#x89E3;&#x91CA;&#x5668;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x4EA4;&#x4E92;&#x5F0F;&#x5E94;&#x7528;&#x6216;&#x6279;&#x5904;&#x7406;&#x3002;</p>
<p><code>Lua</code> &#x662F;&#x4E00;&#x4E2A;&#x81EA;&#x7531;&#x8F6F;&#x4EF6;&#xFF0C;&#x5176;&#x4F7F;&#x7528;&#x8BB8;&#x53EF;&#x8BC1;&#x51B3;&#x5B9A;&#x4E86;&#x5B83;&#x7684;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x65E0;&#x9700;&#x4EFB;&#x4F55;&#x62C5;&#x4FDD;&#x3002; &#x672C;&#x624B;&#x518C;&#x6240;&#x63CF;&#x8FF0;&#x7684;&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x5728; <code>Lua</code> &#x7684;&#x5B98;&#x65B9;&#x7F51;&#x7AD9; <a href="www.lua.org">www.lua.org</a> &#x627E;&#x5230;&#x3002;</p>
<p>&#x4E0E;&#x5176;&#x5B83;&#x7684;&#x8BB8;&#x591A;&#x53C2;&#x8003;&#x624B;&#x518C;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4EFD;&#x6587;&#x6863;&#x6709;&#x4E9B;&#x5730;&#x65B9;&#x6BD4;&#x8F83;&#x67AF;&#x71E5;&#x3002; &#x5173;&#x4E8E; <code>Lua</code> &#x80CC;&#x540E;&#x7684;&#x8BBE;&#x8BA1;&#x601D;&#x60F3;&#xFF0C; &#x53EF;&#x4EE5;&#x770B;&#x770B; <code>Lua</code> &#x7F51;&#x7AD9;&#x4E0A;&#x63D0;&#x4F9B;&#x7684;&#x6280;&#x672F;&#x8BBA;&#x6587;&#x3002; &#x81F3;&#x4E8E;&#x7528; <code>Lua</code> &#x7F16;&#x7A0B;&#x7684;&#x7EC6;&#x8282;&#x4ECB;&#x7ECD;&#xFF0C; &#x8BF7;&#x53C2;&#x9605; Roberto &#x7684;&#x4E66;&#xFF0C;Programming in <code>Lua</code>&#x3002;</p>
<h1 id="&#x57FA;&#x672C;&#x6982;&#x5FF5;">&#x57FA;&#x672C;&#x6982;&#x5FF5; <a href="#&#x57FA;&#x672C;&#x6982;&#x5FF5;"> # </a></h1>
<p>&#x672C;&#x7AE0;&#x63CF;&#x8FF0;&#x4E86;&#x8BED;&#x8A00;&#x7684;&#x57FA;&#x672C;&#x6982;&#x5FF5;&#x3002;</p>
<h2 id="&#x503C;&#x4E0E;&#x7C7B;&#x578B;">&#x503C;&#x4E0E;&#x7C7B;&#x578B; <a href="#&#x503C;&#x4E0E;&#x7C7B;&#x578B;"> # </a></h2>
<p><code>Lua</code> &#x662F;&#x4E00;&#x95E8;&#x52A8;&#x6001;&#x7C7B;&#x578B;&#x8BED;&#x8A00;&#x3002; &#x8FD9;&#x610F;&#x5473;&#x7740;&#x53D8;&#x91CF;&#x6CA1;&#x6709;&#x7C7B;&#x578B;&#xFF1B;&#x53EA;&#x6709;&#x503C;&#x624D;&#x6709;&#x7C7B;&#x578B;&#x3002; &#x8BED;&#x8A00;&#x4E2D;&#x4E0D;&#x8BBE;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;&#x3002; &#x6240;&#x6709;&#x7684;&#x503C;&#x643A;&#x5E26;&#x81EA;&#x5DF1;&#x7684;&#x7C7B;&#x578B;&#x3002;  </p>
<p><code>Lua</code> &#x4E2D;&#x6240;&#x6709;&#x7684;&#x503C;&#x90FD;&#x662F; &#x4E00;&#x7B49;&#x516C;&#x6C11;&#x3002; &#x8FD9;&#x610F;&#x5473;&#x7740;&#x6240;&#x6709;&#x7684;&#x503C;&#x5747;&#x53EF;&#x4FDD;&#x5B58;&#x5728;&#x53D8;&#x91CF;&#x4E2D;&#x3001; &#x5F53;&#x4F5C;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x5176;&#x5B83;&#x51FD;&#x6570;&#x3001;&#x4EE5;&#x53CA;&#x4F5C;&#x4E3A;&#x8FD4;&#x56DE;&#x503C;&#x3002;  </p>
<p><code>Lua</code> &#x4E2D;&#x6709;&#x516B;&#x79CD;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#xFF1A; <code>nil</code>&#x3001;<code>boolean</code>&#x3001;<code>number</code>&#x3001;<code>string</code>&#x3001;<code>function</code>&#x3001;<code>userdata</code>&#x3001; <code>thread</code> &#x548C; <code>table</code>&#x3002; <code>Nil</code> &#x662F;&#x503C; <code>nil</code> &#x7684;&#x7C7B;&#x578B;&#xFF0C; &#x5176;&#x4E3B;&#x8981;&#x7279;&#x5F81;&#x5C31;&#x662F;&#x548C;&#x5176;&#x5B83;&#x503C;&#x533A;&#x522B;&#x5F00;&#xFF1B;&#x901A;&#x5E38;&#x7528;&#x6765;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x6709;&#x610F;&#x4E49;&#x7684;&#x503C;&#x4E0D;&#x5B58;&#x5728;&#x65F6;&#x7684;&#x72B6;&#x6001;&#x3002; <code>Boolean</code> &#x662F; <code>false</code> &#x4E0E; <code>true</code> &#x4E24;&#x4E2A;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002; <code>nil</code> &#x548C; <code>false</code> &#x90FD;&#x4F1A;&#x5BFC;&#x81F4;&#x6761;&#x4EF6;&#x5224;&#x65AD;&#x4E3A;&#x5047;&#xFF1B; &#x800C;&#x5176;&#x5B83;&#x4EFB;&#x4F55;&#x503C;&#x90FD;&#x8868;&#x793A;&#x4E3A;&#x771F;&#x3002; <code>Number</code> &#x4EE3;&#x8868;&#x4E86;&#x6574;&#x6570;&#x548C;&#x5B9E;&#x6570;&#xFF08;&#x6D6E;&#x70B9;&#x6570;&#xFF09;&#x3002; <code>String</code> &#x8868;&#x793A;&#x4E00;&#x4E2A;&#x4E0D;&#x53EF;&#x53D8;&#x7684;&#x5B57;&#x8282;&#x5E8F;&#x5217;&#x3002;   </p>
<p><code>Lua</code> &#x5BF9; 8 &#x4F4D;&#x662F;&#x53CB;&#x597D;&#x7684;&#xFF1A; &#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x5BB9;&#x7EB3;&#x4EFB;&#x610F; 8 &#x4F4D;&#x503C;&#xFF0C; &#x5176;&#x4E2D;&#x5305;&#x542B;&#x96F6; <code>(&apos;\0&apos;)</code> &#x3002;   </p>
<p><code>Lua</code> &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E0E;&#x7F16;&#x7801;&#x65E0;&#x5173;&#xFF1B; &#x5B83;&#x4E0D;&#x5173;&#x5FC3;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x5177;&#x4F53;&#x5185;&#x5BB9;&#x3002;  </p>
<p><code>number</code> &#x7C7B;&#x578B;&#x6709;&#x4E24;&#x79CD;&#x5185;&#x90E8;&#x8868;&#x73B0;&#x65B9;&#x5F0F;&#xFF0C; &#x6574;&#x6570; &#x548C; &#x6D6E;&#x70B9;&#x6570;&#x3002; &#x5BF9;&#x4E8E;&#x4F55;&#x65F6;&#x4F7F;&#x7528;&#x54EA;&#x79CD;&#x5185;&#x90E8;&#x5F62;&#x5F0F;&#xFF0C;<code>Lua</code> &#x6709;&#x660E;&#x786E;&#x7684;&#x89C4;&#x5219;&#xFF0C; &#x4F46;&#x5B83;&#x4E5F;&#x6309;&#x9700;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.3&#xFF09;&#x4F5C;&#x81EA;&#x52A8;&#x8F6C;&#x6362;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x7A0B;&#x5E8F;&#x5458;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x5FFD;&#x7565;&#x6574;&#x6570;&#x4E0E;&#x6D6E;&#x70B9;&#x6570;&#x4E4B;&#x95F4;&#x7684;&#x5DEE;&#x5F02;&#x6216;&#x8005;&#x5047;&#x8BBE;&#x5B8C;&#x5168;&#x63A7;&#x5236;&#x6BCF;&#x4E2A;&#x6570;&#x5B57;&#x7684;&#x5185;&#x90E8;&#x8868;&#x73B0;&#x65B9;&#x5F0F;&#x3002; &#x6807;&#x51C6; <code>Lua</code> &#x4F7F;&#x7528; 64 &#x4F4D;&#x6574;&#x6570;&#x548C;&#x53CC;&#x7CBE;&#x5EA6;&#xFF08;64 &#x4F4D;&#xFF09;&#x6D6E;&#x70B9;&#x6570;&#xFF0C; &#x4F46;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x628A; <code>Lua</code> &#x7F16;&#x8BD1;&#x6210;&#x4F7F;&#x7528; 32 &#x4F4D;&#x6574;&#x6570;&#x548C;&#x5355;&#x7CBE;&#x5EA6;&#xFF08;32 &#x4F4D;&#xFF09;&#x6D6E;&#x70B9;&#x6570;&#x3002; &#x4EE5; 32 &#x4F4D;&#x8868;&#x793A;&#x6570;&#x5B57;&#x5BF9;&#x5C0F;&#x578B;&#x673A;&#x5668;&#x4EE5;&#x53CA;&#x5D4C;&#x5165;&#x5F0F;&#x7CFB;&#x7EDF;&#x7279;&#x522B;&#x5408;&#x9002;&#x3002; &#xFF08;&#x53C2;&#x89C1; <code>luaconf.h</code> &#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x5B8F; <code>LUA_32BITS</code> &#x3002;&#xFF09;  </p>
<p><code>Lua</code> &#x53EF;&#x4EE5;&#x8C03;&#x7528;&#xFF08;&#x4EE5;&#x53CA;&#x64CD;&#x4F5C;&#xFF09;&#x7528; <code>Lua</code> &#x6216; C &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.10&#xFF09;&#x7F16;&#x5199;&#x7684;&#x51FD;&#x6570;&#x3002; &#x8FD9;&#x4E24;&#x79CD;&#x51FD;&#x6570;&#x6709;&#x7EDF;&#x4E00;&#x7C7B;&#x578B; function&#x3002;  </p>
<p>userdata &#x7C7B;&#x578B;&#x5141;&#x8BB8;&#x5C06; C &#x4E2D;&#x7684;&#x6570;&#x636E;&#x4FDD;&#x5B58;&#x5728; <code>Lua</code> &#x53D8;&#x91CF;&#x4E2D;&#x3002; &#x7528;&#x6237;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x5185;&#x5B58;&#x5757;&#xFF0C; &#x6709;&#x4E24;&#x79CD;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF1A; &#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E; &#xFF0C;&#x6307;&#x4E00;&#x5757;&#x7531; <code>Lua</code> &#x7BA1;&#x7406;&#x7684;&#x5185;&#x5B58;&#x5BF9;&#x5E94;&#x7684;&#x5BF9;&#x8C61;&#xFF1B; &#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E; &#xFF0C;&#x5219;&#x6307;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684; C &#x6307;&#x9488;&#x3002; &#x7528;&#x6237;&#x6570;&#x636E;&#x5728; <code>Lua</code> &#x4E2D;&#x9664;&#x4E86;&#x8D4B;&#x503C;&#x4E0E;&#x76F8;&#x7B49;&#x6027;&#x5224;&#x65AD;&#x4E4B;&#x5916;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x9884;&#x5B9A;&#x4E49;&#x7684;&#x64CD;&#x4F5C;&#x3002; &#x901A;&#x8FC7;&#x4F7F;&#x7528; &#x5143;&#x8868; &#xFF0C;&#x7A0B;&#x5E8F;&#x5458;&#x53EF;&#x4EE5;&#x7ED9;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E;&#x5B9A;&#x4E49;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x64CD;&#x4F5C; &#xFF08;&#x53C2;&#x89C1; <a href="#&#x5143;&#x8868;&#x53CA;&#x5143;&#x65B9;&#x6CD5;">&#x5143;&#x8868;&#x53CA;&#x5143;&#x65B9;&#x6CD5;</a>&#xFF09;&#x3002; &#x4F60;&#x53EA;&#x80FD;&#x901A;&#x8FC7; C API &#x800C;&#x65E0;&#x6CD5;&#x5728; <code>Lua</code> &#x4EE3;&#x7801;&#x4E2D;&#x521B;&#x5EFA;&#x6216;&#x8005;&#x4FEE;&#x6539;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x503C;&#xFF0C; &#x8FD9;&#x4FDD;&#x8BC1;&#x4E86;&#x6570;&#x636E;&#x4EC5;&#x88AB;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x6240;&#x63A7;&#x5236;&#x3002;</p>
<p>thread &#x7C7B;&#x578B;&#x8868;&#x793A;&#x4E86;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x7684;&#x6267;&#x884C;&#x5E8F;&#x5217;&#xFF0C;&#x88AB;&#x7528;&#x4E8E;&#x5B9E;&#x73B0;&#x534F;&#x7A0B; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.6&#xFF09;&#x3002; <code>Lua</code> &#x7684;&#x7EBF;&#x7A0B;&#x4E0E;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x7EBF;&#x7A0B;&#x6BEB;&#x65E0;&#x5173;&#x7CFB;&#x3002; <code>Lua</code> &#x4E3A;&#x6240;&#x6709;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x5305;&#x62EC;&#x90A3;&#x4E9B;&#x4E0D;&#x652F;&#x6301;&#x539F;&#x751F;&#x7EBF;&#x7A0B;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x63D0;&#x4F9B;&#x4E86;&#x534F;&#x7A0B;&#x652F;&#x6301;&#x3002;</p>
<p>table &#x662F;&#x4E00;&#x4E2A;&#x5173;&#x8054;&#x6570;&#x7EC4;&#xFF0C; &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x8FD9;&#x4E2A;&#x6570;&#x7EC4;&#x4E0D;&#x4EC5;&#x4EC5;&#x4EE5;&#x6570;&#x5B57;&#x505A;&#x7D22;&#x5F15;&#xFF0C;&#x9664;&#x4E86; nil &#x548C; NaN &#x4E4B;&#x5916;&#x7684;&#x6240;&#x6709; <code>Lua</code> &#x503C; &#x90FD;&#x53EF;&#x4EE5;&#x505A;&#x7D22;&#x5F15;&#x3002; &#xFF08;Not a Number &#x662F;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x5B83;&#x7528;&#x4E8E;&#x8868;&#x793A;&#x672A;&#x5B9A;&#x4E49;&#x6216;&#x8868;&#x793A;&#x4E0D;&#x4E86;&#x7684;&#x8FD0;&#x7B97;&#x7ED3;&#x679C;&#xFF0C;&#x6BD4;&#x5982; 0/0&#x3002;&#xFF09; &#x8868;&#x53EF;&#x4EE5;&#x662F; &#x5F02;&#x6784; &#x7684;&#xFF1B; &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x8868;&#x5185;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x503C;&#xFF08; nil &#x9664;&#x5916;&#xFF09;&#x3002; &#x4EFB;&#x4F55;&#x952E;&#x7684;&#x503C;&#x82E5;&#x4E3A; nil &#x5C31;&#x4E0D;&#x4F1A;&#x88AB;&#x8BB0;&#x5165;&#x8868;&#x7ED3;&#x6784;&#x5185;&#x90E8;&#x3002; &#x6362;&#x8A00;&#x4E4B;&#xFF0C;&#x5BF9;&#x4E8E;&#x8868;&#x5185;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x952E;&#xFF0C;&#x90FD;&#x5BF9;&#x5E94;&#x7740;&#x503C; nil &#x3002;</p>
<p>&#x8868;&#x662F; <code>Lua</code> &#x4E2D;&#x552F;&#x4E00;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C; &#x5B83;&#x53EF;&#x88AB;&#x7528;&#x4E8E;&#x8868;&#x793A;&#x666E;&#x901A;&#x6570;&#x7EC4;&#x3001;&#x5E8F;&#x5217;&#x3001;&#x7B26;&#x53F7;&#x8868;&#x3001;&#x96C6;&#x5408;&#x3001;&#x8BB0;&#x5F55;&#x3001;&#x56FE;&#x3001;&#x6811;&#x7B49;&#x7B49;&#x3002; &#x5BF9;&#x4E8E;&#x8BB0;&#x5F55;&#xFF0C;<code>Lua</code> &#x4F7F;&#x7528;&#x57DF;&#x540D;&#x4F5C;&#x4E3A;&#x7D22;&#x5F15;&#x3002; &#x8BED;&#x8A00;&#x63D0;&#x4F9B;&#x4E86; a.name &#x8FD9;&#x6837;&#x7684;&#x8BED;&#x6CD5;&#x7CD6;&#x6765;&#x66FF;&#x4EE3; a[&quot;name&quot;] &#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x4EE5;&#x65B9;&#x4FBF;&#x8BB0;&#x5F55;&#x8FD9;&#x79CD;&#x7ED3;&#x6784;&#x7684;&#x4F7F;&#x7528;&#x3002; &#x5728; <code>Lua</code> &#x4E2D;&#x6709;&#x591A;&#x79CD;&#x4FBF;&#x5229;&#x7684;&#x65B9;&#x5F0F;&#x521B;&#x5EFA;&#x8868;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.9&#xFF09;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528; &#x5E8F;&#x5217; &#x8FD9;&#x4E2A;&#x672F;&#x8BED;&#x6765;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x7528; {1..n} &#x7684;&#x6B63;&#x6574;&#x6570;&#x96C6;&#x505A;&#x7D22;&#x5F15;&#x7684;&#x8868;&#x3002; &#x8FD9;&#x91CC;&#x7684;&#x975E;&#x8D1F;&#x6574;&#x6570; n &#x88AB;&#x79F0;&#x4E3A;&#x8BE5;&#x5E8F;&#x5217;&#x7684;&#x957F;&#x5EA6;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.7&#xFF09;&#x3002;</p>
<p>&#x548C;&#x7D22;&#x5F15;&#x4E00;&#x6837;&#xFF0C;&#x8868;&#x4E2D;&#x6BCF;&#x4E2A;&#x57DF;&#x7684;&#x503C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x3002; &#x9700;&#x8981;&#x7279;&#x522B;&#x6307;&#x51FA;&#x7684;&#x662F;&#xFF1A;&#x65E2;&#x7136;&#x51FD;&#x6570;&#x662F;&#x4E00;&#x7B49;&#x516C;&#x6C11;&#xFF0C;&#x90A3;&#x4E48;&#x8868;&#x7684;&#x57DF;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x51FD;&#x6570;&#x3002; &#x8FD9;&#x6837;&#xFF0C;&#x8868;&#x5C31;&#x53EF;&#x4EE5;&#x643A;&#x5E26; &#x65B9;&#x6CD5; &#x4E86;&#x3002; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.11&#xFF09;&#x3002;</p>
<p>&#x7D22;&#x5F15;&#x4E00;&#x5F20;&#x8868;&#x7684;&#x539F;&#x5219;&#x9075;&#x5FAA;&#x8BED;&#x8A00;&#x4E2D;&#x7684;&#x76F4;&#x63A5;&#x6BD4;&#x8F83;&#x89C4;&#x5219;&#x3002; &#x5F53;&#x4E14;&#x4EC5;&#x5F53; i &#x4E0E; j&#x76F4;&#x63A5;&#x6BD4;&#x8F83;&#x76F8;&#x7B49;&#x65F6; &#xFF08;&#x5373;&#x4E0D;&#x901A;&#x8FC7;&#x5143;&#x65B9;&#x6CD5;&#x7684;&#x6BD4;&#x8F83;&#xFF09;&#xFF0C; &#x8868;&#x8FBE;&#x5F0F; a[i] &#x4E0E; a[j] &#x8868;&#x793A;&#x4E86;&#x8868;&#x4E2D;&#x76F8;&#x540C;&#x7684;&#x5143;&#x7D20;&#x3002; &#x7279;&#x522B;&#x6307;&#x51FA;&#xFF1A;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x5B8C;&#x5168;&#x8868;&#x793A;&#x4E3A;&#x6574;&#x6570;&#x7684;&#x6D6E;&#x70B9;&#x6570;&#x548C;&#x5BF9;&#x5E94;&#x7684;&#x6574;&#x6570;&#x76F8;&#x7B49; &#xFF08;&#x4F8B;&#x5982;&#xFF1A;1.0 == 1&#xFF09;&#x3002; &#x4E3A;&#x4E86;&#x6D88;&#x9664;&#x6B67;&#x4E49;&#xFF0C;&#x5F53;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x5B8C;&#x5168;&#x8868;&#x793A;&#x4E3A;&#x6574;&#x6570;&#x7684;&#x6D6E;&#x70B9;&#x6570;&#x505A;&#x4E3A;&#x952E;&#x503C;&#x65F6;&#xFF0C; &#x90FD;&#x4F1A;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x5BF9;&#x5E94;&#x7684;&#x6574;&#x6570;&#x50A8;&#x5B58;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x4F60;&#x5199; a[2.0] = true &#x65F6;&#xFF0C; &#x5B9E;&#x9645;&#x88AB;&#x63D2;&#x5165;&#x8868;&#x4E2D;&#x7684;&#x952E;&#x662F;&#x6574;&#x6570; 2 &#x3002; &#xFF08;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;2 &#x4E0E; &quot;2&quot; &#x662F;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684; <code>Lua</code> &#x503C;&#xFF0C; &#x6545;&#x800C;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x662F;&#x540C;&#x4E00;&#x5F20;&#x8868;&#x4E2D;&#x7684;&#x4E0D;&#x540C;&#x9879;&#x3002;&#xFF09;</p>
<p>&#x8868;&#x3001;&#x51FD;&#x6570;&#x3001;&#x7EBF;&#x7A0B;&#x3001;&#x4EE5;&#x53CA;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E;&#x5728; <code>Lua</code> &#x4E2D;&#x88AB;&#x79F0;&#x4E3A; &#x5BF9;&#x8C61;&#xFF1A; &#x53D8;&#x91CF;&#x5E76;&#x4E0D;&#x771F;&#x7684; &#x6301;&#x6709; &#x5B83;&#x4EEC;&#x7684;&#x503C;&#xFF0C;&#x800C;&#x4EC5;&#x4FDD;&#x5B58;&#x4E86;&#x5BF9;&#x8FD9;&#x4E9B;&#x5BF9;&#x8C61;&#x7684; &#x5F15;&#x7528;&#x3002; &#x8D4B;&#x503C;&#x3001;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x3001;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#xFF0C;&#x90FD;&#x662F;&#x9488;&#x5BF9;&#x5F15;&#x7528;&#x800C;&#x4E0D;&#x662F;&#x9488;&#x5BF9;&#x503C;&#x7684;&#x64CD;&#x4F5C;&#xFF0C; &#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x5747;&#x4E0D;&#x4F1A;&#x505A;&#x4EFB;&#x4F55;&#x5F62;&#x5F0F;&#x7684;&#x9690;&#x5F0F;&#x62F7;&#x8D1D;&#x3002;</p>
<p>&#x5E93;&#x51FD;&#x6570; type &#x7528;&#x4E8E;&#x4EE5;&#x5B57;&#x7B26;&#x4E32;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002; &#xFF08;&#x53C2;&#x89C1; &#xA7;6.1&#xFF09;&#x3002;</p>
<h2 id="&#x73AF;&#x5883;&#x4E0E;&#x5168;&#x5C40;&#x73AF;&#x5883;">&#x73AF;&#x5883;&#x4E0E;&#x5168;&#x5C40;&#x73AF;&#x5883; <a href="#&#x73AF;&#x5883;&#x4E0E;&#x5168;&#x5C40;&#x73AF;&#x5883;"> # </a></h2>
<p>&#x540E;&#x9762;&#x5728; &#xA7;3.2 &#x4EE5;&#x53CA; &#xA7;3.3.3 &#x4F1A;&#x8BA8;&#x8BBA;&#xFF0C; &#x5F15;&#x7528;&#x4E00;&#x4E2A;&#x53EB; var &#x7684;&#x81EA;&#x7531;&#x540D;&#x5B57;&#xFF08;&#x6307;&#x5728;&#x4EFB;&#x4F55;&#x5C42;&#x7EA7;&#x90FD;&#x672A;&#x88AB;&#x58F0;&#x660E;&#x7684;&#x540D;&#x5B57;&#xFF09; &#x5728;&#x53E5;&#x6CD5;&#x4E0A;&#x90FD;&#x88AB;&#x7FFB;&#x8BD1;&#x4E3A; _ENV.var &#x3002; &#x6B64;&#x5916;&#xFF0C;&#x6BCF;&#x4E2A;&#x88AB;&#x7F16;&#x8BD1;&#x7684; <code>Lua</code> &#x4EE3;&#x7801;&#x5757;&#x90FD;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x5916;&#x90E8;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x53EB; _ENV &#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.2&#xFF09;&#xFF0C; &#x56E0;&#x6B64;&#xFF0C;_ENV &#x8FD9;&#x4E2A;&#x540D;&#x5B57;&#x6C38;&#x8FDC;&#x90FD;&#x4E0D;&#x4F1A;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x4E2D;&#x7684;&#x81EA;&#x7531;&#x540D;&#x5B57;&#x3002;</p>
<p>&#x5728;&#x8F6C;&#x8BD1;&#x90A3;&#x4E9B;&#x81EA;&#x7531;&#x540D;&#x5B57;&#x65F6;&#xFF0C;_ENV &#x662F;&#x5426;&#x662F;&#x90A3;&#x4E2A;&#x5916;&#x90E8;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x65E0;&#x6240;&#x8C13;&#x3002; _ENV &#x548C;&#x5176;&#x5B83;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7684;&#x53D8;&#x91CF;&#x540D;&#x6CA1;&#x6709;&#x533A;&#x522B;&#x3002; &#x8FD9;&#x91CC;&#x7279;&#x522B;&#x6307;&#x51FA;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x65B0;&#x53D8;&#x91CF;&#x6216;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x53EB;&#x8FD9;&#x4E2A;&#x540D;&#x5B57;&#x3002; &#x5F53;&#x7F16;&#x8BD1;&#x5668;&#x5728;&#x8F6C;&#x8BD1;&#x81EA;&#x7531;&#x540D;&#x5B57;&#x65F6;&#x6240;&#x7528;&#x5230;&#x7684; _ENV &#xFF0C; &#x6307;&#x7684;&#x662F;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x5728;&#x90A3;&#x4E2A;&#x70B9;&#x4E0A;&#x53EF;&#x89C1;&#x7684;&#x90A3;&#x4E2A;&#x540D;&#x4E3A; _ENV &#x7684;&#x53D8;&#x91CF;&#x3002; &#xFF08;<code>Lua</code> &#x7684;&#x53EF;&#x89C1;&#x6027;&#x89C4;&#x5219;&#x53C2;&#x89C1; &#xA7;3.5&#xFF09;</p>
<p>&#x88AB; _ENV &#x7528;&#x4E8E;&#x503C;&#x7684;&#x90A3;&#x5F20;&#x8868;&#x88AB;&#x79F0;&#x4E3A; &#x73AF;&#x5883;&#x3002;</p>
<p><code>Lua</code> &#x4FDD;&#x6709;&#x4E00;&#x4E2A;&#x88AB;&#x79F0;&#x4E3A; &#x5168;&#x5C40;&#x73AF;&#x5883; &#x7279;&#x522B;&#x73AF;&#x5883;&#x3002;&#x5B83;&#x88AB;&#x4FDD;&#x5B58;&#x5728; C &#x6CE8;&#x518C;&#x8868; &#xFF08;&#x53C2;&#x89C1; &#xA7;4.5&#xFF09;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x522B;&#x7D22;&#x5F15;&#x4E0B;&#x3002; &#x5728; <code>Lua</code> &#x4E2D;&#xFF0C;&#x5168;&#x5C40;&#x53D8;&#x91CF; _G &#x88AB;&#x521D;&#x59CB;&#x5316;&#x4E3A;&#x8FD9;&#x4E2A;&#x503C;&#x3002; &#xFF08;_G &#x4E0D;&#x88AB;&#x5185;&#x90E8;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x4F7F;&#x7528;&#x3002;&#xFF09;</p>
<p>&#x5F53; <code>Lua</code> &#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#xFF0C;_ENV &#x8FD9;&#x4E2A;&#x4E0A;&#x503C;&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x5168;&#x5C40;&#x73AF;&#x5883; &#xFF08;&#x53C2;&#x89C1; load&#xFF09;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;<code>Lua</code> &#x4EE3;&#x7801;&#x4E2D;&#x63D0;&#x53CA;&#x7684;&#x81EA;&#x7531;&#x540D;&#x5B57;&#x90FD;&#x6307;&#x7684;&#x5168;&#x5C40;&#x73AF;&#x5883;&#x4E2D;&#x7684;&#x76F8;&#x5173;&#x9879; &#xFF08;&#x56E0;&#x6B64;&#xFF0C;&#x5B83;&#x4EEC;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A; &#x5168;&#x5C40;&#x53D8;&#x91CF; &#xFF09;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x6807;&#x51C6;&#x5E93;&#x90FD;&#x88AB;&#x52A0;&#x8F7D;&#x5165;&#x5168;&#x5C40;&#x73AF;&#x5883;&#xFF0C;&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x4E5F;&#x9488;&#x5BF9;&#x8FD9;&#x4E2A;&#x73AF;&#x5883;&#x505A;&#x64CD;&#x4F5C;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x7528; load &#xFF08;&#x6216; loadfile&#xFF09;&#x52A0;&#x8F7D;&#x4EE3;&#x7801;&#x5757;&#xFF0C;&#x5E76;&#x8D4B;&#x4E88;&#x5B83;&#x4EEC;&#x4E0D;&#x540C;&#x7684;&#x73AF;&#x5883;&#x3002; &#xFF08;&#x5728; C &#x91CC;&#xFF0C;&#x5F53;&#x4F60;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6539;&#x53D8;&#x5B83;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x4E0A;&#x503C;&#x6765;&#x6539;&#x53D8;&#x5B83;&#x7684;&#x73AF;&#x5883;&#x3002;&#xFF09;</p>
<h2 id="&#x9519;&#x8BEF;&#x5904;&#x7406;">&#x9519;&#x8BEF;&#x5904;&#x7406; <a href="#&#x9519;&#x8BEF;&#x5904;&#x7406;"> # </a></h2>
<p>&#x7531;&#x4E8E; <code>Lua</code> &#x662F;&#x4E00;&#x95E8;&#x5D4C;&#x5165;&#x5F0F;&#x6269;&#x5C55;&#x8BED;&#x8A00;&#xFF0C;&#x5176;&#x6240;&#x6709;&#x884C;&#x4E3A;&#x5747;&#x6E90;&#x4E8E;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D; C &#x4EE3;&#x7801;&#x5BF9;&#x67D0;&#x4E2A; <code>Lua</code> &#x5E93;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x3002; &#xFF08;&#x5355;&#x72EC;&#x4F7F;&#x7528; <code>Lua</code> &#x65F6;&#xFF0C;lua &#x7A0B;&#x5E8F;&#x5C31;&#x662F;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x3002;&#xFF09; &#x6240;&#x4EE5;&#xFF0C;&#x5728;&#x7F16;&#x8BD1;&#x6216;&#x8FD0;&#x884C; <code>Lua</code> &#x4EE3;&#x7801;&#x5757;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x65E0;&#x8BBA;&#x4F55;&#x65F6;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF0C; &#x63A7;&#x5236;&#x6743;&#x90FD;&#x8FD4;&#x56DE;&#x7ED9;&#x5BBF;&#x4E3B;&#xFF0C;&#x7531;&#x5BBF;&#x4E3B;&#x8D1F;&#x8D23;&#x91C7;&#x53D6;&#x6070;&#x5F53;&#x7684;&#x63AA;&#x65BD;&#xFF08;&#x6BD4;&#x5982;&#x6253;&#x5370;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#xFF09;&#x3002;</p>
<p>&#x53EF;&#x4EE5;&#x5728; <code>Lua</code> &#x4EE3;&#x7801;&#x4E2D;&#x8C03;&#x7528; error &#x51FD;&#x6570;&#x6765;&#x663E;&#x5F0F;&#x5730;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002; &#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x5728; <code>Lua</code> &#x4E2D;&#x6355;&#x83B7;&#x8FD9;&#x4E9B;&#x9519;&#x8BEF;&#xFF0C; &#x53EF;&#x4EE5;&#x4F7F;&#x7528; pcall &#x6216; xpcall &#x5728; &#x4FDD;&#x62A4;&#x6A21;&#x5F0F; &#x4E0B;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x4F55;&#x65F6;&#x51FA;&#x73B0;&#x9519;&#x8BEF;&#xFF0C;&#x90FD;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x643A;&#x5E26;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x7684; &#x9519;&#x8BEF;&#x5BF9;&#x8C61; &#xFF08;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#xFF09;&#x3002; <code>Lua</code> &#x672C;&#x8EAB;&#x53EA;&#x4F1A;&#x4E3A;&#x9519;&#x8BEF;&#x751F;&#x6210;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x7684;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#xFF0C; &#x4F46;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x4E3A;&#x9519;&#x8BEF;&#x751F;&#x6210;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#xFF0C; &#x8FD9;&#x5C31;&#x770B;&#x4F60;&#x7684; <code>Lua</code> &#x7A0B;&#x5E8F;&#x6216;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x5982;&#x4F55;&#x5904;&#x7406;&#x8FD9;&#x4E9B;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x4F7F;&#x7528; xpcall &#x6216; lua_pcall &#x65F6;&#xFF0C; &#x4F60;&#x5E94;&#x8BE5;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A; &#x6D88;&#x606F;&#x5904;&#x7406;&#x51FD;&#x6570; &#x7528;&#x4E8E;&#x9519;&#x8BEF;&#x629B;&#x51FA;&#x65F6;&#x8C03;&#x7528;&#x3002; &#x8BE5;&#x51FD;&#x6570;&#x9700;&#x63A5;&#x6536;&#x539F;&#x59CB;&#x7684;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002; &#x5B83;&#x5728;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x540E;&#x6808;&#x5C1A;&#x672A;&#x5C55;&#x5F00;&#x65F6;&#x8C03;&#x7528;&#xFF0C; &#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x6808;&#x6765;&#x6536;&#x96C6;&#x66F4;&#x591A;&#x7684;&#x4FE1;&#x606F;&#xFF0C; &#x6BD4;&#x5982;&#x901A;&#x8FC7;&#x63A2;&#x77E5;&#x6808;&#x6765;&#x521B;&#x5EFA;&#x4E00;&#x7EC4;&#x6808;&#x56DE;&#x6EAF;&#x4FE1;&#x606F;&#x3002; &#x540C;&#x65F6;&#xFF0C;&#x8BE5;&#x5904;&#x7406;&#x51FD;&#x6570;&#x4E5F;&#x5904;&#x4E8E;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;&#x6240;&#x4EE5;&#x8BE5;&#x51FD;&#x6570;&#x5185;&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x4F1A;&#x518D;&#x6B21;&#x89E6;&#x53D1;&#x5B83;&#xFF08;&#x9012;&#x5F52;&#xFF09;&#x3002; &#x5982;&#x679C;&#x9012;&#x5F52;&#x592A;&#x6DF1;&#xFF0C;<code>Lua</code> &#x4F1A;&#x7EC8;&#x6B62;&#x8C03;&#x7528;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5408;&#x9002;&#x7684;&#x6D88;&#x606F;&#x3002;</p>
<h2 id="&#x5143;&#x8868;&#x53CA;&#x5143;&#x65B9;&#x6CD5;">&#x5143;&#x8868;&#x53CA;&#x5143;&#x65B9;&#x6CD5; <a href="#&#x5143;&#x8868;&#x53CA;&#x5143;&#x65B9;&#x6CD5;"> # </a></h2>
<p><code>Lua</code> &#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x503C;&#x90FD;&#x53EF;&#x4EE5;&#x6709;&#x4E00;&#x4E2A; &#x5143;&#x8868;&#x3002; &#x8FD9;&#x4E2A; &#x5143;&#x8868; &#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684; <code>Lua</code> &#x8868;&#xFF0C; &#x5B83;&#x7528;&#x4E8E;&#x5B9A;&#x4E49;&#x539F;&#x59CB;&#x503C;&#x5728;&#x7279;&#x5B9A;&#x64CD;&#x4F5C;&#x4E0B;&#x7684;&#x884C;&#x4E3A;&#x3002; &#x5982;&#x679C;&#x4F60;&#x60F3;&#x6539;&#x53D8;&#x4E00;&#x4E2A;&#x503C;&#x5728;&#x7279;&#x5B9A;&#x64CD;&#x4F5C;&#x4E0B;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x5B83;&#x7684;&#x5143;&#x8868;&#x4E2D;&#x8BBE;&#x7F6E;&#x5BF9;&#x5E94;&#x57DF;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x4F60;&#x5BF9;&#x975E;&#x6570;&#x5B57;&#x503C;&#x505A;&#x52A0;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C; <code>Lua</code> &#x4F1A;&#x68C0;&#x67E5;&#x8BE5;&#x503C;&#x7684;&#x5143;&#x8868;&#x4E2D;&#x7684; &quot;__add&quot; &#x57DF;&#x4E0B;&#x7684;&#x51FD;&#x6570;&#x3002; &#x5982;&#x679C;&#x80FD;&#x627E;&#x5230;&#xFF0C;<code>Lua</code> &#x5219;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x5B8C;&#x6210;&#x52A0;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x5143;&#x8868;&#x4E2D;&#x7684;&#x952E;&#x5BF9;&#x5E94;&#x7740;&#x4E0D;&#x540C;&#x7684; &#x4E8B;&#x4EF6; &#x540D;&#xFF1B; &#x952E;&#x5173;&#x8054;&#x7684;&#x90A3;&#x4E9B;&#x503C;&#x88AB;&#x79F0;&#x4E3A; &#x5143;&#x65B9;&#x6CD5;&#x3002; &#x5728;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x5F15;&#x7528;&#x7684;&#x4E8B;&#x4EF6;&#x4E3A; &quot;add&quot; &#xFF0C; &#x5B8C;&#x6210;&#x52A0;&#x64CD;&#x4F5C;&#x7684;&#x90A3;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x662F;&#x5143;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x7528; getmetatable &#x51FD;&#x6570; &#x6765;&#x83B7;&#x53D6;&#x4EFB;&#x4F55;&#x503C;&#x7684;&#x5143;&#x8868;&#x3002;</p>
<p>&#x4F7F;&#x7528; setmetatable &#x6765;&#x66FF;&#x6362;&#x4E00;&#x5F20;&#x8868;&#x7684;&#x5143;&#x8868;&#x3002;&#x5728; <code>Lua</code> &#x4E2D;&#xFF0C;&#x4F60;&#x4E0D;&#x53EF;&#x4EE5;&#x6539;&#x53D8;&#x8868;&#x4EE5;&#x5916;&#x5176;&#x5B83;&#x7C7B;&#x578B;&#x7684;&#x503C;&#x7684;&#x5143;&#x8868; &#xFF08;&#x9664;&#x975E;&#x4F60;&#x4F7F;&#x7528;&#x8C03;&#x8BD5;&#x5E93;&#xFF08;&#x53C2;&#x89C1;&#xA7;6.10&#xFF09;&#xFF09;&#xFF1B; &#x82E5;&#x60F3;&#x6539;&#x53D8;&#x8FD9;&#x4E9B;&#x975E;&#x8868;&#x7C7B;&#x578B;&#x7684;&#x503C;&#x7684;&#x5143;&#x8868;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528; C API&#x3002;</p>
<p>&#x8868;&#x548C;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E;&#x6709;&#x72EC;&#x7ACB;&#x7684;&#x5143;&#x8868; &#xFF08;&#x5F53;&#x7136;&#xFF0C;&#x591A;&#x4E2A;&#x8868;&#x548C;&#x7528;&#x6237;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;&#x5143;&#x8868;&#xFF09;&#x3002; &#x5176;&#x5B83;&#x7C7B;&#x578B;&#x7684;&#x503C;&#x6309;&#x7C7B;&#x578B;&#x5171;&#x4EAB;&#x5143;&#x8868;&#xFF1B; &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6240;&#x6709;&#x7684;&#x6570;&#x5B57;&#x90FD;&#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;&#x5143;&#x8868;&#xFF0C; &#x6240;&#x6709;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5171;&#x4EAB;&#x53E6;&#x4E00;&#x4E2A;&#x5143;&#x8868;&#x7B49;&#x7B49;&#x3002; &#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x503C;&#x662F;&#x6CA1;&#x6709;&#x5143;&#x8868;&#x7684;&#xFF0C; &#x4F46;&#x5B57;&#x7B26;&#x4E32;&#x5E93;&#x5728;&#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x8BBE;&#x7F6E;&#x4E86;&#x5143;&#x8868; &#xFF08;&#x53C2;&#x89C1; &#xA7;6.4&#xFF09;&#x3002;</p>
<p>&#x5143;&#x8868;&#x51B3;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x5728;&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x3001;&#x4F4D;&#x8FD0;&#x7B97;&#x3001;&#x6BD4;&#x8F83;&#x3001;&#x8FDE;&#x63A5;&#x3001; &#x53D6;&#x957F;&#x5EA6;&#x3001;&#x8C03;&#x7528;&#x3001;&#x7D22;&#x5F15;&#x65F6;&#x7684;&#x884C;&#x4E3A;&#x3002; &#x5143;&#x8868;&#x8FD8;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5F53;&#x8868;&#x5BF9;&#x8C61;&#x6216;&#x7528;&#x6237;&#x6570;&#x636E;&#x5BF9;&#x8C61;&#x5728;&#x5783;&#x573E;&#x56DE;&#x6536; &#xFF08;&#x53C2;&#x89C1;&#xA7;2.5&#xFF09;&#x65F6;&#x8C03;&#x7528;&#x5B83;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x4F1A;&#x7ED9;&#x51FA;&#x4E00;&#x5F20;&#x5143;&#x8868;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x7684;&#x4E8B;&#x4EF6;&#x7684;&#x5B8C;&#x6574;&#x5217;&#x8868;&#x3002; &#x6BCF;&#x4E2A;&#x64CD;&#x4F5C;&#x90FD;&#x7528;&#x5BF9;&#x5E94;&#x7684;&#x4E8B;&#x4EF6;&#x540D;&#x6765;&#x533A;&#x5206;&#x3002; &#x6BCF;&#x4E2A;&#x4E8B;&#x4EF6;&#x7684;&#x952E;&#x540D;&#x7528;&#x52A0;&#x6709; &apos;<strong>&apos; &#x524D;&#x7F00;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6765;&#x8868;&#x793A;&#xFF1B; &#x4F8B;&#x5982; &quot;add&quot; &#x64CD;&#x4F5C;&#x7684;&#x952E;&#x540D;&#x4E3A;&#x5B57;&#x7B26;&#x4E32; &quot;</strong>add&quot;&#x3002; &#x6CE8;&#x610F;&#x3001;<code>Lua</code> &#x4ECE;&#x5143;&#x8868;&#x4E2D;&#x76F4;&#x63A5;&#x83B7;&#x53D6;&#x5143;&#x65B9;&#x6CD5;&#xFF1B; &#x8BBF;&#x95EE;&#x5143;&#x8868;&#x4E2D;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x53E6;&#x4E00;&#x6B21;&#x5143;&#x65B9;&#x6CD5;&#x3002; &#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6A21;&#x62DF;&#x4E86; <code>Lua</code> &#x4ECE;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61; obj &#x4E2D;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x5143;&#x65B9;&#x6CD5;&#x7684;&#x8FC7;&#x7A0B;&#xFF1A;</p>
<pre><code> rawget(getmetatable(obj) or {}, &quot;__&quot; .. event_name)
</code></pre><p>&#x5BF9;&#x4E8E;&#x4E00;&#x5143;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#x53D6;&#x8D1F;&#x3001;&#x6C42;&#x957F;&#x5EA6;&#x3001;&#x4F4D;&#x53CD;&#xFF09;&#xFF0C; &#x5143;&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4E2A;&#x54D1;&#x5143;&#xFF0C;&#x5176;&#x503C;&#x7B49;&#x4E8E;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002; &#x8FD9;&#x6837;&#x5904;&#x7406;&#x4EC5;&#x4EC5;&#x662F;&#x4E3A;&#x4E86;&#x7B80;&#x5316; <code>Lua</code> &#x7684;&#x5185;&#x90E8;&#x5B9E;&#x73B0; &#xFF08;&#x8FD9;&#x6837;&#x5904;&#x7406;&#x53EF;&#x4EE5;&#x8BA9;&#x6240;&#x6709;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x548C;&#x4E8C;&#x5143;&#x64CD;&#x4F5C;&#x4E00;&#x81F4;&#xFF09;&#xFF0C; &#x8FD9;&#x4E2A;&#x884C;&#x4E3A;&#x6709;&#x53EF;&#x80FD;&#x5728;&#x5C06;&#x6765;&#x7684;&#x7248;&#x672C;&#x4E2D;&#x79FB;&#x9664;&#x3002; &#xFF08;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x989D;&#x5916;&#x53C2;&#x6570;&#x7684;&#x884C;&#x4E3A;&#x90FD;&#x662F;&#x4E0D;&#x786E;&#x5B9A;&#x7684;&#x3002;&#xFF09;</p>
<p>&quot;add&quot;: + &#x64CD;&#x4F5C;&#x3002; &#x5982;&#x679C;&#x4EFB;&#x4F55;&#x4E0D;&#x662F;&#x6570;&#x5B57;&#x7684;&#x503C;&#xFF08;&#x5305;&#x62EC;&#x4E0D;&#x80FD;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF09;&#x505A;&#x52A0;&#x6CD5;&#xFF0C; <code>Lua</code> &#x5C31;&#x4F1A;&#x5C1D;&#x8BD5;&#x8C03;&#x7528;&#x5143;&#x65B9;&#x6CD5;&#x3002; &#x9996;&#x5148;&#x3001;<code>Lua</code> &#x68C0;&#x67E5;&#x7B2C;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#xFF08;&#x5373;&#x4F7F;&#x5B83;&#x662F;&#x5408;&#x6CD5;&#x7684;&#xFF09;&#xFF0C; &#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x6CA1;&#x6709;&#x4E3A; &quot;<strong>add&quot; &#x4E8B;&#x4EF6;&#x5B9A;&#x4E49;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; <code>Lua</code> &#x5C31;&#x4F1A;&#x63A5;&#x7740;&#x68C0;&#x67E5;&#x7B2C;&#x4E8C;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x3002; &#x4E00;&#x65E6; Lua &#x627E;&#x5230;&#x4E86;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; &#x5B83;&#x5C06;&#x628A;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; &#x5143;&#x65B9;&#x6CD5;&#x7684;&#x7ED3;&#x679C;&#xFF08;&#x8C03;&#x6574;&#x4E3A;&#x5355;&#x4E2A;&#x503C;&#xFF09;&#x4F5C;&#x4E3A;&#x8FD9;&#x4E2A;&#x64CD;&#x4F5C;&#x7684;&#x7ED3;&#x679C;&#x3002; &#x5982;&#x679C;&#x627E;&#x4E0D;&#x5230;&#x5143;&#x65B9;&#x6CD5;&#xFF0C;&#x5C06;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002;
&quot;sub&quot;: - &#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;mul&quot;: * &#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;div&quot;: / &#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;mod&quot;: % &#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;pow&quot;: ^ &#xFF08;&#x6B21;&#x65B9;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;unm&quot;: - &#xFF08;&#x53D6;&#x8D1F;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;idiv&quot;: // &#xFF08;&#x5411;&#x4E0B;&#x53D6;&#x6574;&#x9664;&#x6CD5;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;band&quot;: &amp; &#xFF08;&#x6309;&#x4F4D;&#x4E0E;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#xFF0C; &#x4E0D;&#x540C;&#x7684;&#x662F; Lua &#x4F1A;&#x5728;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x65E0;&#x6CD5;&#x8F6C;&#x6362;&#x4E3A;&#x6574;&#x6570;&#x65F6; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.3&#xFF09;&#x5C1D;&#x8BD5;&#x53D6;&#x5143;&#x65B9;&#x6CD5;&#x3002;
&quot;bor&quot;: | &#xFF08;&#x6309;&#x4F4D;&#x6216;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;band&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;bxor&quot;: ~ &#xFF08;&#x6309;&#x4F4D;&#x5F02;&#x6216;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;band&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;bnot&quot;: ~ &#xFF08;&#x6309;&#x4F4D;&#x975E;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;band&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;shl&quot;: &lt;&lt; &#xFF08;&#x5DE6;&#x79FB;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;band&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;shr&quot;: &gt;&gt; &#xFF08;&#x53F3;&#x79FB;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;band&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#x3002;
&quot;concat&quot;: .. &#xFF08;&#x8FDE;&#x63A5;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x884C;&#x4E3A;&#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x7C7B;&#x4F3C;&#xFF0C; &#x4E0D;&#x540C;&#x7684;&#x662F; Lua &#x5728;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x6570;&#x5373;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32; &#x4E5F;&#x4E0D;&#x662F;&#x6570;&#x5B57;&#xFF08;&#x6570;&#x5B57;&#x603B;&#x80FD;&#x8F6C;&#x6362;&#x4E3A;&#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF09;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5C1D;&#x8BD5;&#x5143;&#x65B9;&#x6CD5;&#x3002;
&quot;len&quot;: # &#xFF08;&#x53D6;&#x957F;&#x5EA6;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x5982;&#x679C;&#x5BF9;&#x8C61;&#x4E0D;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;Lua &#x4F1A;&#x5C1D;&#x8BD5;&#x5B83;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#x3002; &#x5982;&#x679C;&#x6709;&#x5143;&#x65B9;&#x6CD5;&#xFF0C;&#x5219;&#x8C03;&#x7528;&#x5B83;&#x5E76;&#x5C06;&#x5BF9;&#x8C61;&#x4EE5;&#x53C2;&#x6570;&#x5F62;&#x5F0F;&#x4F20;&#x5165;&#xFF0C; &#x800C;&#x8FD4;&#x56DE;&#x503C;&#xFF08;&#x88AB;&#x8C03;&#x6574;&#x4E3A;&#x5355;&#x4E2A;&#xFF09;&#x5219;&#x4F5C;&#x4E3A;&#x7ED3;&#x679C;&#x3002; &#x5982;&#x679C;&#x5BF9;&#x8C61;&#x662F;&#x4E00;&#x5F20;&#x8868;&#x4E14;&#x6CA1;&#x6709;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; Lua &#x4F7F;&#x7528;&#x8868;&#x7684;&#x53D6;&#x957F;&#x5EA6;&#x64CD;&#x4F5C;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.7&#xFF09;&#x3002; &#x5176;&#x5B83;&#x60C5;&#x51B5;&#xFF0C;&#x5747;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;
&quot;eq&quot;: == &#xFF08;&#x7B49;&#x4E8E;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x884C;&#x4E3A;&#x7C7B;&#x4F3C;&#xFF0C; &#x4E0D;&#x540C;&#x7684;&#x662F; Lua &#x4EC5;&#x5728;&#x4E24;&#x4E2A;&#x503C;&#x90FD;&#x662F;&#x8868;&#x6216;&#x90FD;&#x662F;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E; &#x4E14;&#x5B83;&#x4EEC;&#x4E0D;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x65F6;&#x624D;&#x5C1D;&#x8BD5;&#x5143;&#x65B9;&#x6CD5;&#x3002; &#x8C03;&#x7528;&#x7684;&#x7ED3;&#x679C;&#x603B;&#x4F1A;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x5E03;&#x5C14;&#x91CF;&#x3002;
&quot;lt&quot;: &lt; &#xFF08;&#x5C0F;&#x4E8E;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x548C; &quot;add&quot; &#x64CD;&#x4F5C;&#x884C;&#x4E3A;&#x7C7B;&#x4F3C;&#xFF0C; &#x4E0D;&#x540C;&#x7684;&#x662F; Lua &#x4EC5;&#x5728;&#x4E24;&#x4E2A;&#x503C;&#x4E0D;&#x5168;&#x4E3A;&#x6574;&#x6570;&#x4E5F;&#x4E0D;&#x5168;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#x624D;&#x5C1D;&#x8BD5;&#x5143;&#x65B9;&#x6CD5;&#x3002; &#x8C03;&#x7528;&#x7684;&#x7ED3;&#x679C;&#x603B;&#x4F1A;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x5E03;&#x5C14;&#x91CF;&#x3002;
&quot;le&quot;: &lt;= &#xFF08;&#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;&#xFF09;&#x64CD;&#x4F5C;&#x3002; &#x548C;&#x5176;&#x5B83;&#x64CD;&#x4F5C;&#x4E0D;&#x540C;&#xFF0C; &#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;&#x64CD;&#x4F5C;&#x53EF;&#x80FD;&#x7528;&#x5230;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x4E8B;&#x4EF6;&#x3002; &#x9996;&#x5148;&#xFF0C;&#x50CF; &quot;lt&quot; &#x64CD;&#x4F5C;&#x7684;&#x884C;&#x4E3A;&#x90A3;&#x6837;&#xFF0C;Lua &#x5728;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x4E2D;&#x67E5;&#x627E; &quot;</strong>le&quot; &#x5143;&#x65B9;&#x6CD5;&#x3002; &#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5143;&#x65B9;&#x6CD5;&#x90FD;&#x627E;&#x4E0D;&#x5230;&#xFF0C;&#x5C31;&#x4F1A;&#x518D;&#x6B21;&#x67E5;&#x627E; &quot;__lt&quot; &#x4E8B;&#x4EF6;&#xFF0C; &#x5B83;&#x4F1A;&#x5047;&#x8BBE; a &lt;= b &#x7B49;&#x4EF7;&#x4E8E; not (b &lt; a)&#x3002; &#x800C;&#x5176;&#x5B83;&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x7B26;&#x7C7B;&#x4F3C;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x4F1A;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x5E03;&#x5C14;&#x91CF;&#x3002;
&quot;index&quot;: &#x7D22;&#x5F15; table[key]&#x3002; &#x5F53; table &#x4E0D;&#x662F;&#x8868;&#x6216;&#x662F;&#x8868; table &#x4E2D;&#x4E0D;&#x5B58;&#x5728; key &#x8FD9;&#x4E2A;&#x952E;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x88AB;&#x89E6;&#x53D1;&#x3002; &#x6B64;&#x65F6;&#xFF0C;&#x4F1A;&#x8BFB;&#x51FA; table &#x76F8;&#x5E94;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#x3002;
&#x5C3D;&#x7BA1;&#x540D;&#x5B57;&#x53D6;&#x6210;&#x8FD9;&#x6837;&#xFF0C; &#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#x5176;&#x5B9E;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x5F20;&#x8868;&#x3002; &#x5982;&#x679C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5219;&#x4EE5; table &#x548C; key &#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x5B83;&#x3002; &#x5982;&#x679C;&#x5B83;&#x662F;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x6700;&#x7EC8;&#x7684;&#x7ED3;&#x679C;&#x5C31;&#x662F;&#x4EE5; key &#x53D6;&#x7D22;&#x5F15;&#x8FD9;&#x5F20;&#x8868;&#x7684;&#x7ED3;&#x679C;&#x3002; &#xFF08;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x8FC7;&#x7A0B;&#x662F;&#x8D70;&#x5E38;&#x89C4;&#x7684;&#x6D41;&#x7A0B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x7D22;&#x5F15;&#xFF0C; &#x6240;&#x4EE5;&#x8FD9;&#x6B21;&#x7D22;&#x5F15;&#x6709;&#x53EF;&#x80FD;&#x5F15;&#x53D1;&#x53E6;&#x4E00;&#x6B21;&#x5143;&#x65B9;&#x6CD5;&#x3002;&#xFF09;</p>
<p>&quot;newindex&quot;: &#x7D22;&#x5F15;&#x8D4B;&#x503C; table[key] = value &#x3002; &#x548C;&#x7D22;&#x5F15;&#x4E8B;&#x4EF6;&#x7C7B;&#x4F3C;&#xFF0C;&#x5B83;&#x53D1;&#x751F;&#x5728; table &#x4E0D;&#x662F;&#x8868;&#x6216;&#x662F;&#x8868; table &#x4E2D;&#x4E0D;&#x5B58;&#x5728; key &#x8FD9;&#x4E2A;&#x952E;&#x7684;&#x65F6;&#x5019;&#x3002; &#x6B64;&#x65F6;&#xFF0C;&#x4F1A;&#x8BFB;&#x51FA; table &#x76F8;&#x5E94;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#x3002;
&#x540C;&#x7D22;&#x5F15;&#x8FC7;&#x7A0B;&#x90A3;&#x6837;&#xFF0C; &#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x4EE5;&#x662F;&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x5F20;&#x8868;&#x3002; &#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C; &#x5219;&#x4EE5; table&#x3001; key&#x3001;&#x4EE5;&#x53CA; value &#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x3002; &#x5982;&#x679C;&#x662F;&#x4E00;&#x5F20;&#x8868;&#xFF0C; Lua &#x5BF9;&#x8FD9;&#x5F20;&#x8868;&#x505A;&#x7D22;&#x5F15;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x3002; &#xFF08;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x8FC7;&#x7A0B;&#x662F;&#x8D70;&#x5E38;&#x89C4;&#x7684;&#x6D41;&#x7A0B;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x7D22;&#x5F15;&#x8D4B;&#x503C;&#xFF0C; &#x6240;&#x4EE5;&#x8FD9;&#x6B21;&#x7D22;&#x5F15;&#x8D4B;&#x503C;&#x6709;&#x53EF;&#x80FD;&#x5F15;&#x53D1;&#x53E6;&#x4E00;&#x6B21;&#x5143;&#x65B9;&#x6CD5;&#x3002;&#xFF09;</p>
<p>&#x4E00;&#x65E6;&#x6709;&#x4E86; &quot;newindex&quot; &#x5143;&#x65B9;&#x6CD5;&#xFF0C; Lua &#x5C31;&#x4E0D;&#x518D;&#x505A;&#x6700;&#x521D;&#x7684;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x3002; &#xFF08;&#x5982;&#x679C;&#x6709;&#x5FC5;&#x8981;&#xFF0C;&#x5728;&#x5143;&#x65B9;&#x6CD5;&#x5185;&#x90E8;&#x53EF;&#x4EE5;&#x8C03;&#x7528; rawset &#x6765;&#x505A;&#x8D4B;&#x503C;&#x3002;&#xFF09;</p>
<p>&quot;call&quot;: &#x51FD;&#x6570;&#x8C03;&#x7528;&#x64CD;&#x4F5C; func(args)&#x3002; &#x5F53; Lua &#x5C1D;&#x8BD5;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x975E;&#x51FD;&#x6570;&#x7684;&#x503C;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x89E6;&#x53D1;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6; &#xFF08;&#x5373; func &#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF09;&#x3002; &#x67E5;&#x627E; func &#x7684;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; &#x5982;&#x679C;&#x627E;&#x5F97;&#x5230;&#xFF0C;&#x5C31;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; func &#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#xFF0C;&#x539F;&#x6765;&#x8C03;&#x7528;&#x7684;&#x53C2;&#x6570;&#xFF08;args&#xFF09;&#x540E;&#x4F9D;&#x6B21;&#x6392;&#x5728;&#x540E;&#x9762;&#x3002;</p>
<h2 id="&#x5783;&#x573E;&#x6536;&#x96C6;">&#x5783;&#x573E;&#x6536;&#x96C6; <a href="#&#x5783;&#x573E;&#x6536;&#x96C6;"> # </a></h2>
<p>Lua &#x91C7;&#x7528;&#x4E86;&#x81EA;&#x52A8;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x3002; &#x8FD9;&#x610F;&#x5473;&#x7740;&#x4F60;&#x4E0D;&#x7528;&#x64CD;&#x5FC3;&#x65B0;&#x521B;&#x5EFA;&#x7684;&#x5BF9;&#x8C61;&#x9700;&#x8981;&#x7684;&#x5185;&#x5B58;&#x5982;&#x4F55;&#x5206;&#x914D;&#x51FA;&#x6765;&#xFF0C; &#x4E5F;&#x4E0D;&#x7528;&#x8003;&#x8651;&#x5728;&#x5BF9;&#x8C61;&#x4E0D;&#x518D;&#x88AB;&#x4F7F;&#x7528;&#x540E;&#x600E;&#x6837;&#x91CA;&#x653E;&#x5B83;&#x4EEC;&#x6240;&#x5360;&#x7528;&#x7684;&#x5185;&#x5B58;&#x3002; Lua &#x8FD0;&#x884C;&#x4E86;&#x4E00;&#x4E2A; &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668; &#x6765;&#x6536;&#x96C6;&#x6240;&#x6709; &#x6B7B;&#x5BF9;&#x8C61; &#xFF08;&#x5373;&#x5728; Lua &#x4E2D;&#x4E0D;&#x53EF;&#x80FD;&#x518D;&#x8BBF;&#x95EE;&#x5230;&#x7684;&#x5BF9;&#x8C61;&#xFF09;&#x6765;&#x5B8C;&#x6210;&#x81EA;&#x52A8;&#x5185;&#x5B58;&#x7BA1;&#x7406;&#x7684;&#x5DE5;&#x4F5C;&#x3002; Lua &#x4E2D;&#x6240;&#x6709;&#x7528;&#x5230;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x5982;&#xFF1A;&#x5B57;&#x7B26;&#x4E32;&#x3001;&#x8868;&#x3001;&#x7528;&#x6237;&#x6570;&#x636E;&#x3001;&#x51FD;&#x6570;&#x3001;&#x7EBF;&#x7A0B;&#x3001; &#x5185;&#x90E8;&#x7ED3;&#x6784;&#x7B49;&#xFF0C;&#x90FD;&#x670D;&#x4ECE;&#x81EA;&#x52A8;&#x7BA1;&#x7406;&#x3002;</p>
<p>Lua &#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x589E;&#x91CF;&#x6807;&#x8BB0;-&#x626B;&#x63CF;&#x6536;&#x96C6;&#x5668;&#x3002; &#x5B83;&#x4F7F;&#x7528;&#x8FD9;&#x4E24;&#x4E2A;&#x6570;&#x5B57;&#x6765;&#x63A7;&#x5236;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5FAA;&#x73AF;&#xFF1A; &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x95F4;&#x6B47;&#x7387; &#x548C; &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x6B65;&#x8FDB;&#x500D;&#x7387;&#x3002; &#x8FD9;&#x4E24;&#x4E2A;&#x6570;&#x5B57;&#x90FD;&#x4F7F;&#x7528;&#x767E;&#x5206;&#x6570;&#x4E3A;&#x5355;&#x4F4D; &#xFF08;&#x4F8B;&#x5982;&#xFF1A;&#x503C; 100 &#x5728;&#x5185;&#x90E8;&#x8868;&#x793A; 1 &#xFF09;&#x3002;</p>
<p>&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x95F4;&#x6B47;&#x7387;&#x63A7;&#x5236;&#x7740;&#x6536;&#x96C6;&#x5668;&#x9700;&#x8981;&#x5728;&#x5F00;&#x542F;&#x65B0;&#x7684;&#x5FAA;&#x73AF;&#x524D;&#x8981;&#x7B49;&#x5F85;&#x591A;&#x4E45;&#x3002; &#x589E;&#x5927;&#x8FD9;&#x4E2A;&#x503C;&#x4F1A;&#x51CF;&#x5C11;&#x6536;&#x96C6;&#x5668;&#x7684;&#x79EF;&#x6781;&#x6027;&#x3002; &#x5F53;&#x8FD9;&#x4E2A;&#x503C;&#x6BD4; 100 &#x5C0F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6536;&#x96C6;&#x5668;&#x5728;&#x5F00;&#x542F;&#x65B0;&#x7684;&#x5FAA;&#x73AF;&#x524D;&#x4E0D;&#x4F1A;&#x6709;&#x7B49;&#x5F85;&#x3002; &#x8BBE;&#x7F6E;&#x8FD9;&#x4E2A;&#x503C;&#x4E3A; 200 &#x5C31;&#x4F1A;&#x8BA9;&#x6536;&#x96C6;&#x5668;&#x7B49;&#x5230;&#x603B;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x91CF;&#x8FBE;&#x5230; &#x4E4B;&#x524D;&#x7684;&#x4E24;&#x500D;&#x65F6;&#x624D;&#x5F00;&#x59CB;&#x65B0;&#x7684;&#x5FAA;&#x73AF;&#x3002;</p>
<p>&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x6B65;&#x8FDB;&#x500D;&#x7387;&#x63A7;&#x5236;&#x7740;&#x6536;&#x96C6;&#x5668;&#x8FD0;&#x4F5C;&#x901F;&#x5EA6;&#x76F8;&#x5BF9;&#x4E8E;&#x5185;&#x5B58;&#x5206;&#x914D;&#x901F;&#x5EA6;&#x7684;&#x500D;&#x7387;&#x3002; &#x589E;&#x5927;&#x8FD9;&#x4E2A;&#x503C;&#x4E0D;&#x4EC5;&#x4F1A;&#x8BA9;&#x6536;&#x96C6;&#x5668;&#x66F4;&#x52A0;&#x79EF;&#x6781;&#xFF0C;&#x8FD8;&#x4F1A;&#x589E;&#x52A0;&#x6BCF;&#x4E2A;&#x589E;&#x91CF;&#x6B65;&#x9AA4;&#x7684;&#x957F;&#x5EA6;&#x3002; &#x4E0D;&#x8981;&#x628A;&#x8FD9;&#x4E2A;&#x503C;&#x8BBE;&#x5F97;&#x5C0F;&#x4E8E; 100 &#xFF0C; &#x90A3;&#x6837;&#x7684;&#x8BDD;&#x6536;&#x96C6;&#x5668;&#x5C31;&#x5DE5;&#x4F5C;&#x7684;&#x592A;&#x6162;&#x4E86;&#x4EE5;&#x81F3;&#x4E8E;&#x6C38;&#x8FDC;&#x90FD;&#x5E72;&#x4E0D;&#x5B8C;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x3002; &#x9ED8;&#x8BA4;&#x503C;&#x662F; 200 &#xFF0C;&#x8FD9;&#x8868;&#x793A;&#x6536;&#x96C6;&#x5668;&#x4EE5;&#x5185;&#x5B58;&#x5206;&#x914D;&#x7684;&#x201C;&#x4E24;&#x500D;&#x201D;&#x901F;&#x5DE5;&#x4F5C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4F60;&#x628A;&#x6B65;&#x8FDB;&#x500D;&#x7387;&#x8BBE;&#x4E3A;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5927;&#x7684;&#x6570;&#x5B57; &#xFF08;&#x6BD4;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x53EF;&#x80FD;&#x7528;&#x5230;&#x7684;&#x5B57;&#x8282;&#x6570;&#x8FD8;&#x5927; 10% &#xFF09;&#xFF0C; &#x6536;&#x96C6;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x5C31;&#x50CF;&#x4E00;&#x4E2A; stop-the-world &#x6536;&#x96C6;&#x5668;&#x3002; &#x63A5;&#x7740;&#x4F60;&#x82E5;&#x628A;&#x95F4;&#x6B47;&#x7387;&#x8BBE;&#x4E3A; 200 &#xFF0C; &#x6536;&#x96C6;&#x5668;&#x7684;&#x884C;&#x4E3A;&#x5C31;&#x548C;&#x8FC7;&#x53BB;&#x7684; Lua &#x7248;&#x672C;&#x4E00;&#x6837;&#x4E86;&#xFF1A; &#x6BCF;&#x6B21; Lua &#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#x7FFB;&#x500D;&#x65F6;&#xFF0C;&#x5C31;&#x505A;&#x4E00;&#x6B21;&#x5B8C;&#x6574;&#x7684;&#x6536;&#x96C6;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728; C &#x4E2D;&#x8C03;&#x7528; lua_gc &#x6216;&#x5728; Lua &#x4E2D;&#x8C03;&#x7528; collectgarbage &#x6765;&#x6539;&#x53D8;&#x8FD9;&#x4FE9;&#x6570;&#x5B57;&#x3002; &#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x76F4;&#x63A5;&#x63A7;&#x5236;&#x6536;&#x96C6;&#x5668;&#xFF08;&#x4F8B;&#x5982;&#x505C;&#x6B62;&#x5B83;&#x6216;&#x91CD;&#x542F;&#x5B83;&#xFF09;&#x3002;</p>
<h3 id="&#x5783;&#x573E;&#x6536;&#x96C6;&#x5143;&#x65B9;&#x6CD5;">&#x5783;&#x573E;&#x6536;&#x96C6;&#x5143;&#x65B9;&#x6CD5; <a href="#&#x5783;&#x573E;&#x6536;&#x96C6;&#x5143;&#x65B9;&#x6CD5;"> # </a></h3>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x4E3A;&#x8868;&#x8BBE;&#x5B9A;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; &#x5BF9;&#x4E8E;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09;&#xFF0C; &#x5219;&#x9700;&#x8981;&#x4F7F;&#x7528; C API &#x3002; &#x8BE5;&#x5143;&#x65B9;&#x6CD5;&#x88AB;&#x79F0;&#x4E3A; &#x7EC8;&#x7ED3;&#x5668;&#x3002; &#x7EC8;&#x7ED3;&#x5668;&#x5141;&#x8BB8;&#x4F60;&#x914D;&#x5408; Lua &#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x505A;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x8D44;&#x6E90;&#x7BA1;&#x7406;&#x5DE5;&#x4F5C; &#xFF08;&#x4F8B;&#x5982;&#x5173;&#x95ED;&#x6587;&#x4EF6;&#x3001;&#x7F51;&#x7EDC;&#x6216;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#xFF0C;&#x6216;&#x662F;&#x91CA;&#x653E;&#x4E00;&#x4E9B;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x5185;&#x5B58;&#xFF09;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8981;&#x8BA9;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF08;&#x8868;&#x6216;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF09;&#x5728;&#x6536;&#x96C6;&#x8FC7;&#x7A0B;&#x4E2D;&#x8FDB;&#x5165;&#x7EC8;&#x7ED3;&#x6D41;&#x7A0B;&#xFF0C; &#x4F60;&#x5FC5;&#x987B; &#x6807;&#x8BB0; &#x5B83;&#x9700;&#x8981;&#x89E6;&#x53D1;&#x7EC8;&#x7ED3;&#x5668;&#x3002; &#x5F53;&#x4F60;&#x4E3A;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x8BBE;&#x7F6E;&#x5143;&#x8868;&#x65F6;&#xFF0C;&#x82E5;&#x6B64;&#x523B;&#x8FD9;&#x5F20;&#x5143;&#x8868;&#x4E2D;&#x7528;&#x4E00;&#x4E2A;&#x4EE5;&#x5B57;&#x7B26;&#x4E32; &quot;<strong>gc&quot; &#x4E3A;&#x7D22;&#x5F15;&#x7684;&#x57DF;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x6807;&#x8BB0;&#x4E86;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x9700;&#x8981;&#x89E6;&#x53D1;&#x7EC8;&#x7ED3;&#x5668;&#x3002; &#x6CE8;&#x610F;&#xFF1A;&#x5982;&#x679C;&#x4F60;&#x7ED9;&#x5BF9;&#x8C61;&#x8BBE;&#x7F6E;&#x4E86;&#x4E00;&#x4E2A;&#x6CA1;&#x6709; </strong>gc &#x57DF;&#x7684;&#x5143;&#x8868;&#xFF0C;&#x4E4B;&#x540E;&#x624D;&#x7ED9;&#x5143;&#x8868;&#x52A0;&#x4E0A;&#x8FD9;&#x4E2A;&#x57DF;&#xFF0C; &#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x662F;&#x6CA1;&#x6709;&#x88AB;&#x6807;&#x8BB0;&#x6210;&#x9700;&#x8981;&#x89E6;&#x53D1;&#x7EC8;&#x7ED3;&#x5668;&#x7684;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x4E00;&#x65E6;&#x5BF9;&#x8C61;&#x88AB;&#x6807;&#x8BB0;&#xFF0C; &#x4F60;&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x81EA;&#x7531;&#x7684;&#x6539;&#x53D8;&#x5176;&#x5143;&#x8868;&#x4E2D;&#x7684; __gc &#x57DF;&#x7684;&#x3002;</p>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x88AB;&#x6807;&#x8BB0;&#x7684;&#x5BF9;&#x8C61;&#x6210;&#x4E3A;&#x4E86;&#x5783;&#x573E;&#x540E;&#xFF0C; &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x5E76;&#x4E0D;&#x4F1A;&#x7ACB;&#x523B;&#x56DE;&#x6536;&#x5B83;&#x3002; &#x53D6;&#x800C;&#x4EE3;&#x4E4B;&#x7684;&#x662F;&#xFF0C;Lua &#x4F1A;&#x5C06;&#x5176;&#x7F6E;&#x5165;&#x4E00;&#x4E2A;&#x94FE;&#x8868;&#x3002; &#x5728;&#x6536;&#x96C6;&#x5B8C;&#x6210;&#x540E;&#xFF0C;Lua &#x5C06;&#x904D;&#x5386;&#x8FD9;&#x4E2A;&#x94FE;&#x8868;&#x3002; Lua &#x4F1A;&#x68C0;&#x67E5;&#x6BCF;&#x4E2A;&#x94FE;&#x8868;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x7684; __gc &#x5143;&#x65B9;&#x6CD5;&#xFF1A;&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4EE5;&#x5BF9;&#x8C61;&#x4E3A;&#x552F;&#x4E00;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x5B83;&#xFF1B; &#x5426;&#x5219;&#x76F4;&#x63A5;&#x5FFD;&#x7565;&#x5B83;&#x3002;</p>
<p>&#x5728;&#x6BCF;&#x6B21;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5FAA;&#x73AF;&#x7684;&#x6700;&#x540E;&#x9636;&#x6BB5;&#xFF0C; &#x672C;&#x6B21;&#x5FAA;&#x73AF;&#x4E2D;&#x68C0;&#x6D4B;&#x5230;&#x7684;&#x9700;&#x8981;&#x88AB;&#x56DE;&#x6536;&#x4E4B;&#x5BF9;&#x8C61;&#xFF0C; &#x5176;&#x7EC8;&#x7ED3;&#x5668;&#x7684;&#x89E6;&#x53D1;&#x6B21;&#x5E8F;&#x6309;&#x5F53;&#x521D;&#x7ED9;&#x5BF9;&#x8C61;&#x4F5C;&#x9700;&#x8981;&#x89E6;&#x53D1;&#x7EC8;&#x7ED3;&#x5668;&#x7684;&#x6807;&#x8BB0;&#x4E4B;&#x6B21;&#x5E8F;&#x7684;&#x9006;&#x5E8F;&#x8FDB;&#x884C;&#xFF1B; &#x8FD9;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x7EC8;&#x7ED3;&#x5668;&#x662F;&#x7A0B;&#x5E8F;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x88AB;&#x6807;&#x8BB0;&#x7684;&#x5BF9;&#x8C61;&#x6240;&#x643A;&#x7684;&#x90A3;&#x4E2A;&#x3002; &#x6BCF;&#x4E2A;&#x7EC8;&#x7ED3;&#x5668;&#x7684;&#x8FD0;&#x884C;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x5728;&#x6267;&#x884C;&#x5E38;&#x89C4;&#x4EE3;&#x7801;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x523B;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x88AB;&#x56DE;&#x6536;&#x7684;&#x5BF9;&#x8C61;&#x8FD8;&#x9700;&#x8981;&#x88AB;&#x7EC8;&#x7ED3;&#x5668;&#x4F7F;&#x7528;&#xFF0C; &#x8BE5;&#x5BF9;&#x8C61;&#xFF08;&#x4EE5;&#x53CA;&#x4EC5;&#x80FD;&#x901A;&#x8FC7;&#x5B83;&#x8BBF;&#x95EE;&#x5230;&#x7684;&#x5176;&#x5B83;&#x5BF9;&#x8C61;&#xFF09;&#x4E00;&#x5B9A;&#x4F1A;&#x88AB; Lua &#x590D;&#x6D3B;&#x3002; &#x901A;&#x5E38;&#xFF0C;&#x590D;&#x6D3B;&#x662F;&#x77ED;&#x6682;&#x7684;&#xFF0C;&#x5BF9;&#x8C61;&#x6240;&#x5C5E;&#x5185;&#x5B58;&#x4F1A;&#x5728;&#x4E0B;&#x4E00;&#x4E2A;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5FAA;&#x73AF;&#x91CA;&#x653E;&#x3002; &#x7136;&#x540E;&#xFF0C;&#x82E5;&#x7EC8;&#x7ED3;&#x5668;&#x53C8;&#x5C06;&#x5BF9;&#x8C61;&#x4FDD;&#x5B58;&#x53BB;&#x4E00;&#x4E9B;&#x5168;&#x5C40;&#x7684;&#x5730;&#x65B9; &#xFF08;&#x4F8B;&#x5982;&#xFF1A;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x91CC;&#xFF09;&#xFF0C;&#x8FD9;&#x6B21;&#x590D;&#x6D3B;&#x5C31;&#x6301;&#x7EED;&#x751F;&#x6548;&#x4E86;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x7EC8;&#x7ED3;&#x5668;&#x4E2D;&#x5BF9;&#x4E00;&#x4E2A;&#x6B63;&#x8FDB;&#x5165;&#x7EC8;&#x7ED3;&#x6D41;&#x7A0B;&#x7684;&#x5BF9;&#x8C61;&#x518D;&#x6B21;&#x505A;&#x4E00;&#x6B21;&#x6807;&#x8BB0;&#x8BA9;&#x5B83;&#x89E6;&#x53D1;&#x7EC8;&#x7ED3;&#x5668;&#xFF0C; &#x53EA;&#x8981;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x5728;&#x4E0B;&#x4E2A;&#x5FAA;&#x73AF;&#x4E2D;&#x4F9D;&#x65E7;&#x4E0D;&#x53EF;&#x8FBE;&#xFF0C;&#x5B83;&#x7684;&#x7EC8;&#x7ED3;&#x51FD;&#x6570;&#x8FD8;&#x4F1A;&#x518D;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x3002; &#x65E0;&#x8BBA;&#x662F;&#x54EA;&#x79CD;&#x60C5;&#x51B5;&#xFF0C; &#x5BF9;&#x8C61;&#x6240;&#x5C5E;&#x5185;&#x5B58;&#x4EC5;&#x5728;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5FAA;&#x73AF;&#x4E2D;&#x8BE5;&#x5BF9;&#x8C61;&#x4E0D;&#x53EF;&#x8FBE;&#x4E14; &#x6CA1;&#x6709;&#x88AB;&#x6807;&#x8BB0;&#x6210;&#x9700;&#x8981;&#x89E6;&#x53D1;&#x7EC8;&#x7ED3;&#x5668;&#x624D;&#x4F1A;&#x88AB;&#x91CA;&#x653E;&#x3002;</p>
<p>&#x5F53;&#x4F60;&#x5173;&#x95ED;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x673A;&#xFF08;&#x53C2;&#x89C1; lua_close&#xFF09;&#xFF0C; Lua &#x5C06;&#x8C03;&#x7528;&#x6240;&#x6709;&#x88AB;&#x6807;&#x8BB0;&#x4E86;&#x9700;&#x8981;&#x89E6;&#x53D1;&#x7EC8;&#x7ED3;&#x5668;&#x5BF9;&#x8C61;&#x7684;&#x7EC8;&#x7ED3;&#x8FC7;&#x7A0B;&#xFF0C; &#x5176;&#x6B21;&#x5E8F;&#x4E3A;&#x6807;&#x8BB0;&#x6B21;&#x5E8F;&#x7684;&#x9006;&#x5E8F;&#x3002; &#x5728;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4EFB;&#x4F55;&#x7EC8;&#x7ED3;&#x5668;&#x518D;&#x6B21;&#x6807;&#x8BB0;&#x5BF9;&#x8C61;&#x7684;&#x884C;&#x4E3A;&#x90FD;&#x4E0D;&#x4F1A;&#x751F;&#x6548;&#x3002;</p>
<h3 id="&#x5F31;&#x8868;">&#x5F31;&#x8868; <a href="#&#x5F31;&#x8868;"> # </a></h3>
<p>&#x5F31;&#x8868; &#x6307;&#x5185;&#x90E8;&#x5143;&#x7D20;&#x4E3A; &#x5F31;&#x5F15;&#x7528; &#x7684;&#x8868;&#x3002; &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x4F1A;&#x5FFD;&#x7565;&#x6389;&#x5F31;&#x5F15;&#x7528;&#x3002; &#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x53EA;&#x88AB;&#x5F31;&#x5F15;&#x7528;&#x5F15;&#x7528;&#x5230;&#xFF0C; &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x5C31;&#x4F1A;&#x56DE;&#x6536;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;</p>
<p>&#x4E00;&#x5F20;&#x5F31;&#x8868;&#x53EF;&#x4EE5;&#x6709;&#x5F31;&#x952E;&#x6216;&#x662F;&#x5F31;&#x503C;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x952E;&#x503C;&#x90FD;&#x662F;&#x5F31;&#x5F15;&#x7528;&#x3002; &#x4EC5;&#x542B;&#x6709;&#x5F31;&#x952E;&#x7684;&#x8868;&#x5141;&#x8BB8;&#x6536;&#x96C6;&#x5668;&#x56DE;&#x6536;&#x5B83;&#x7684;&#x952E;&#xFF0C;&#x4F46;&#x4F1A;&#x963B;&#x6B62;&#x5BF9;&#x503C;&#x6240;&#x6307;&#x7684;&#x5BF9;&#x8C61;&#x88AB;&#x56DE;&#x6536;&#x3002; &#x82E5;&#x4E00;&#x5F20;&#x8868;&#x7684;&#x952E;&#x503C;&#x5747;&#x4E3A;&#x5F31;&#x5F15;&#x7528;&#xFF0C; &#x90A3;&#x4E48;&#x6536;&#x96C6;&#x5668;&#x53EF;&#x4EE5;&#x56DE;&#x6536;&#x5176;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x952E;&#x548C;&#x503C;&#x3002; &#x4EFB;&#x4F55;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x53EA;&#x8981;&#x952E;&#x6216;&#x503C;&#x7684;&#x4EFB;&#x610F;&#x4E00;&#x9879;&#x88AB;&#x56DE;&#x6536;&#xFF0C; &#x76F8;&#x5173;&#x8054;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x90FD;&#x4F1A;&#x4ECE;&#x8868;&#x4E2D;&#x79FB;&#x9664;&#x3002; &#x4E00;&#x5F20;&#x8868;&#x7684;&#x5143;&#x8868;&#x4E2D;&#x7684; <strong>mode &#x57DF;&#x63A7;&#x5236;&#x7740;&#x8FD9;&#x5F20;&#x8868;&#x7684;&#x5F31;&#x5C5E;&#x6027;&#x3002; &#x5F53; </strong>mode &#x57DF;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x5B57;&#x7B26; &apos;k&apos; &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;&#x8FD9;&#x5F20;&#x8868;&#x7684;&#x6240;&#x6709;&#x952E;&#x7686;&#x4E3A;&#x5F31;&#x5F15;&#x7528;&#x3002; &#x5F53; __mode &#x57DF;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x5B57;&#x7B26; &apos;v&apos; &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;&#x8FD9;&#x5F20;&#x8868;&#x7684;&#x6240;&#x6709;&#x503C;&#x7686;&#x4E3A;&#x5F31;&#x5F15;&#x7528;&#x3002;</p>
<p>&#x5C5E;&#x6027;&#x4E3A;&#x5F31;&#x952E;&#x5F3A;&#x503C;&#x7684;&#x8868;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A; &#x6682;&#x65F6;&#x8868;&#x3002; &#x5BF9;&#x4E8E;&#x4E00;&#x5F20;&#x6682;&#x65F6;&#x8868;&#xFF0C; &#x5B83;&#x7684;&#x503C;&#x662F;&#x5426;&#x53EF;&#x8FBE;&#x4EC5;&#x53D6;&#x51B3;&#x4E8E;&#x5176;&#x5BF9;&#x5E94;&#x952E;&#x662F;&#x5426;&#x53EF;&#x8FBE;&#x3002; &#x7279;&#x522B;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x8868;&#x5185;&#x7684;&#x4E00;&#x4E2A;&#x952E;&#x4EC5;&#x4EC5;&#x88AB;&#x5176;&#x503C;&#x6240;&#x5173;&#x8054;&#x5F15;&#x7528;&#xFF0C; &#x8FD9;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#x5C06;&#x88AB;&#x8868;&#x5185;&#x79FB;&#x9664;&#x3002;</p>
<p>&#x5BF9;&#x4E00;&#x5F20;&#x8868;&#x7684;&#x5F31;&#x5C5E;&#x6027;&#x7684;&#x4FEE;&#x6539;&#x4EC5;&#x5728;&#x4E0B;&#x6B21;&#x6536;&#x96C6;&#x5FAA;&#x73AF;&#x624D;&#x751F;&#x6548;&#x3002; &#x5C24;&#x5176;&#x662F;&#x5F53;&#x4F60;&#x628A;&#x8868;&#x7531;&#x5F31;&#x6539;&#x5F3A;&#xFF0C;Lua &#x8FD8;&#x662F;&#x6709;&#x53EF;&#x80FD;&#x5728;&#x4FEE;&#x6539;&#x751F;&#x6548;&#x524D;&#x56DE;&#x6536;&#x8868;&#x5185;&#x4E00;&#x4E9B;&#x9879;&#x76EE;&#x3002;</p>
<p>&#x53EA;&#x6709;&#x90A3;&#x4E9B;&#x6709;&#x663E;&#x5F0F;&#x6784;&#x9020;&#x8FC7;&#x7A0B;&#x7684;&#x5BF9;&#x8C61;&#x624D;&#x4F1A;&#x4ECE;&#x5F31;&#x8868;&#x4E2D;&#x79FB;&#x9664;&#x3002; &#x503C;&#xFF0C;&#x4F8B;&#x5982;&#x6570;&#x5B57;&#x548C;&#x8F7B;&#x91CF; C &#x51FD;&#x6570;&#xFF0C;&#x4E0D;&#x53D7;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x7BA1;&#x8F96;&#xFF0C; &#x56E0;&#x6B64;&#x4E0D;&#x4F1A;&#x4ECE;&#x5F31;&#x8868;&#x4E2D;&#x79FB;&#x9664; &#xFF08;&#x9664;&#x975E;&#x5B83;&#x4EEC;&#x7684;&#x5173;&#x8054;&#x9879;&#x88AB;&#x56DE;&#x6536;&#xFF09;&#x3002; &#x867D;&#x7136;&#x5B57;&#x7B26;&#x4E32;&#x53D7;&#x5783;&#x573E;&#x56DE;&#x6536;&#x5668;&#x7BA1;&#x8F96;&#xFF0C; &#x4F46;&#x5B83;&#x4EEC;&#x6CA1;&#x6709;&#x663E;&#x5F0F;&#x7684;&#x6784;&#x9020;&#x8FC7;&#x7A0B;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x4E0D;&#x4F1A;&#x4ECE;&#x5F31;&#x8868;&#x4E2D;&#x79FB;&#x9664;&#x3002;</p>
<p>&#x5F31;&#x8868;&#x9488;&#x5BF9;&#x590D;&#x6D3B;&#x7684;&#x5BF9;&#x8C61; &#xFF08;&#x6307;&#x90A3;&#x4E9B;&#x6B63;&#x5728;&#x8D70;&#x7EC8;&#x7ED3;&#x6D41;&#x7A0B;&#xFF0C;&#x4EC5;&#x80FD;&#x88AB;&#x7EC8;&#x7ED3;&#x5668;&#x8BBF;&#x95EE;&#x7684;&#x5BF9;&#x8C61;&#xFF09; &#x6709;&#x7740;&#x7279;&#x6B8A;&#x7684;&#x884C;&#x4E3A;&#x3002; &#x5F31;&#x503C;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5728;&#x8FD0;&#x884C;&#x5B83;&#x4EEC;&#x7684;&#x7EC8;&#x7ED3;&#x5668;&#x524D;&#x5C31;&#x88AB;&#x79FB;&#x9664;&#x4E86;&#xFF0C; &#x800C;&#x5F31;&#x952E;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x5219;&#x8981;&#x7B49;&#x5230;&#x7EC8;&#x7ED3;&#x5668;&#x8FD0;&#x884C;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x5230;&#x4E0B;&#x6B21;&#x6536;&#x96C6;&#x5F53;&#x5BF9;&#x8C61;&#x771F;&#x7684;&#x88AB;&#x91CA;&#x653E;&#x65F6;&#x624D;&#x88AB;&#x79FB;&#x9664;&#x3002; &#x8FD9;&#x4E2A;&#x884C;&#x4E3A;&#x4F7F;&#x5F97;&#x7EC8;&#x7ED3;&#x5668;&#x8FD0;&#x884C;&#x65F6;&#x5F97;&#x4EE5;&#x8BBF;&#x95EE;&#x5230;&#x7531;&#x8BE5;&#x5BF9;&#x8C61;&#x5728;&#x5F31;&#x8868;&#x4E2D;&#x6240;&#x5173;&#x8054;&#x7684;&#x5C5E;&#x6027;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E00;&#x5F20;&#x5F31;&#x8868;&#x5728;&#x5F53;&#x6B21;&#x6536;&#x96C6;&#x5FAA;&#x73AF;&#x5185;&#x7684;&#x590D;&#x6D3B;&#x5BF9;&#x8C61;&#x4E2D;&#xFF0C; &#x90A3;&#x4E48;&#x5728;&#x4E0B;&#x4E2A;&#x5FAA;&#x73AF;&#x524D;&#x8FD9;&#x5F20;&#x8868;&#x6709;&#x53EF;&#x80FD;&#x672A;&#x88AB;&#x6B63;&#x786E;&#x5730;&#x6E05;&#x7406;&#x3002;</p>
<h2 id="&#x534F;&#x7A0B;">&#x534F;&#x7A0B; <a href="#&#x534F;&#x7A0B;"> # </a></h2>
<p>Lua &#x652F;&#x6301;&#x534F;&#x7A0B;&#xFF0C;&#x4E5F;&#x53EB; &#x534F;&#x540C;&#x5F0F;&#x591A;&#x7EBF;&#x7A0B;&#x3002; &#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x5728; Lua &#x4E2D;&#x4EE3;&#x8868;&#x4E86;&#x4E00;&#x6BB5;&#x72EC;&#x7ACB;&#x7684;&#x6267;&#x884C;&#x7EBF;&#x7A0B;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x4E0E;&#x591A;&#x7EBF;&#x7A0B;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x7684;&#x533A;&#x522B;&#x5728;&#x4E8E;&#xFF0C; &#x534F;&#x7A0B;&#x4EC5;&#x5728;&#x663E;&#x5F0F;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x8BA9;&#x51FA;&#xFF08;yield&#xFF09;&#x51FD;&#x6570;&#x65F6;&#x624D;&#x6302;&#x8D77;&#x5F53;&#x524D;&#x7684;&#x6267;&#x884C;&#x3002;</p>
<p>&#x8C03;&#x7528;&#x51FD;&#x6570; coroutine.create &#x53EF;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x3002; &#x5176;&#x552F;&#x4E00;&#x7684;&#x53C2;&#x6570;&#x662F;&#x8BE5;&#x534F;&#x7A0B;&#x7684;&#x4E3B;&#x51FD;&#x6570;&#x3002; create &#x51FD;&#x6570;&#x53EA;&#x8D1F;&#x8D23;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x5E76;&#x8FD4;&#x56DE;&#x5176;&#x53E5;&#x67C4; &#xFF08;&#x4E00;&#x4E2A; thread &#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#xFF09;&#xFF1B; &#x800C;&#x4E0D;&#x4F1A;&#x542F;&#x52A8;&#x8BE5;&#x534F;&#x7A0B;&#x3002;</p>
<p>&#x8C03;&#x7528; coroutine.resume &#x51FD;&#x6570;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x3002; &#x7B2C;&#x4E00;&#x6B21;&#x8C03;&#x7528; coroutine.resume &#x65F6;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x5E94;&#x4F20;&#x5165; coroutine.create &#x8FD4;&#x56DE;&#x7684;&#x7EBF;&#x7A0B;&#x5BF9;&#x8C61;&#xFF0C;&#x7136;&#x540E;&#x534F;&#x7A0B;&#x4ECE;&#x5176;&#x4E3B;&#x51FD;&#x6570;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x3002; &#x4F20;&#x9012;&#x7ED9; coroutine.resume &#x7684;&#x5176;&#x4ED6;&#x53C2;&#x6570;&#x5C06;&#x4F5C;&#x4E3A;&#x534F;&#x7A0B;&#x4E3B;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x3002; &#x534F;&#x7A0B;&#x542F;&#x52A8;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x4E00;&#x76F4;&#x8FD0;&#x884C;&#x5230;&#x5B83;&#x7EC8;&#x6B62;&#x6216; &#x8BA9;&#x51FA;&#x3002;</p>
<p>&#x534F;&#x7A0B;&#x7684;&#x8FD0;&#x884C;&#x53EF;&#x80FD;&#x88AB;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x7EC8;&#x6B62;&#xFF1A; &#x6B63;&#x5E38;&#x9014;&#x5F84;&#x662F;&#x4E3B;&#x51FD;&#x6570;&#x8FD4;&#x56DE; &#xFF08;&#x663E;&#x5F0F;&#x8FD4;&#x56DE;&#x6216;&#x8FD0;&#x884C;&#x5B8C;&#x6700;&#x540E;&#x4E00;&#x6761;&#x6307;&#x4EE4;&#xFF09;&#xFF1B; &#x975E;&#x6B63;&#x5E38;&#x9014;&#x5F84;&#x662F;&#x53D1;&#x751F;&#x4E86;&#x4E00;&#x4E2A;&#x672A;&#x88AB;&#x6355;&#x83B7;&#x7684;&#x9519;&#x8BEF;&#x3002; &#x5BF9;&#x4E8E;&#x6B63;&#x5E38;&#x7ED3;&#x675F;&#xFF0C; coroutine.resume &#x5C06;&#x8FD4;&#x56DE; true&#xFF0C; &#x5E76;&#x63A5;&#x4E0A;&#x534F;&#x7A0B;&#x4E3B;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002; &#x5F53;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x65F6;&#xFF0C; coroutine.resume &#x5C06;&#x8FD4;&#x56DE; false &#x4E0E;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x8C03;&#x7528; coroutine.yield &#x4F7F;&#x534F;&#x7A0B;&#x6682;&#x505C;&#x6267;&#x884C;&#xFF0C;&#x8BA9;&#x51FA;&#x6267;&#x884C;&#x6743;&#x3002; &#x534F;&#x7A0B;&#x8BA9;&#x51FA;&#x65F6;&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x6700;&#x8FD1; coroutine.resume &#x51FD;&#x6570;&#x4F1A;&#x7ACB;&#x523B;&#x8FD4;&#x56DE;&#xFF0C;&#x5373;&#x4F7F;&#x8BE5;&#x8BA9;&#x51FA;&#x64CD;&#x4F5C;&#x53D1;&#x751F;&#x5728;&#x5185;&#x5D4C;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E2D; &#xFF08;&#x5373;&#x4E0D;&#x5728;&#x4E3B;&#x51FD;&#x6570;&#xFF0C;&#x4F46;&#x5728;&#x4E3B;&#x51FD;&#x6570;&#x76F4;&#x63A5;&#x6216;&#x95F4;&#x63A5;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x5185;&#x90E8;&#xFF09;&#x3002; &#x5728;&#x534F;&#x7A0B;&#x8BA9;&#x51FA;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C; coroutine.resume &#x4E5F;&#x4F1A;&#x8FD4;&#x56DE; true&#xFF0C; &#x5E76;&#x52A0;&#x4E0A;&#x4F20;&#x7ED9; coroutine.yield &#x7684;&#x53C2;&#x6570;&#x3002; &#x5F53;&#x4E0B;&#x6B21;&#x91CD;&#x542F;&#x540C;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x65F6;&#xFF0C; &#x534F;&#x7A0B;&#x4F1A;&#x63A5;&#x7740;&#x4ECE;&#x8BA9;&#x51FA;&#x70B9;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x3002; &#x8C03;&#x7528;coroutine.yield &#x4F1A;&#x8FD4;&#x56DE;&#x4EFB;&#x4F55;&#x4F20;&#x7ED9; coroutine.resume &#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4E4B;&#x5916;&#x7684;&#x5176;&#x4ED6;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x4E0E; coroutine.create &#x7C7B;&#x4F3C;&#xFF0C; coroutine.wrap &#x51FD;&#x6570;&#x4E5F;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x3002; &#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#xFF0C;&#x5B83;&#x4E0D;&#x8FD4;&#x56DE;&#x534F;&#x7A0B;&#x672C;&#x8EAB;&#xFF0C;&#x800C;&#x662F;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x3002; &#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06;&#x542F;&#x52A8;&#x8BE5;&#x534F;&#x7A0B;&#x3002; &#x4F20;&#x9012;&#x7ED9;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x5747;&#x5F53;&#x4F5C; coroutine.resume &#x7684;&#x989D;&#x5916;&#x53C2;&#x6570;&#x3002; coroutine.wrap &#x8FD4;&#x56DE; coroutine.resume &#x7684;&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF0C;&#x9664;&#x4E86;&#x7B2C;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#xFF08;&#x5E03;&#x5C14;&#x578B;&#x7684;&#x9519;&#x8BEF;&#x7801;&#xFF09;&#x3002; &#x548C; coroutine.resume &#x4E0D;&#x540C;&#xFF0C; coroutine.wrap &#x4E0D;&#x4F1A;&#x6355;&#x83B7;&#x9519;&#x8BEF;&#xFF1B; &#x800C;&#x662F;&#x5C06;&#x4EFB;&#x4F55;&#x9519;&#x8BEF;&#x90FD;&#x4F20;&#x64AD;&#x7ED9;&#x8C03;&#x7528;&#x8005;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x5C55;&#x793A;&#x4E86;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x5DE5;&#x4F5C;&#x7684;&#x8303;&#x4F8B;&#xFF1A;</p>
<pre><code>     function foo (a)
       print(&quot;foo&quot;, a)
       return coroutine.yield(2*a)
     end

     co = coroutine.create(function (a,b)
           print(&quot;co-body&quot;, a, b)
           local r = foo(a+1)
           print(&quot;co-body&quot;, r)
           local r, s = coroutine.yield(a+b, a-b)
           print(&quot;co-body&quot;, r, s)
           return b, &quot;end&quot;
     end)

     print(&quot;main&quot;, coroutine.resume(co, 1, 10))
     print(&quot;main&quot;, coroutine.resume(co, &quot;r&quot;))
     print(&quot;main&quot;, coroutine.resume(co, &quot;x&quot;, &quot;y&quot;))
     print(&quot;main&quot;, coroutine.resume(co, &quot;x&quot;, &quot;y&quot;))
&#x5F53;&#x4F60;&#x8FD0;&#x884C;&#x5B83;&#xFF0C;&#x5C06;&#x4EA7;&#x751F;&#x4E0B;&#x5217;&#x8F93;&#x51FA;&#xFF1A;

     co-body 1       10
     foo     2
     main    true    4
     co-body r
     main    true    11      -9
     co-body x       y
     main    true    10      end
     main    false   cannot resume dead coroutine
</code></pre><p>&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; C API &#x6765;&#x521B;&#x5EFA;&#x53CA;&#x64CD;&#x4F5C;&#x534F;&#x7A0B;&#xFF1A; &#x53C2;&#x89C1;&#x51FD;&#x6570; lua_newthread&#xFF0C; lua_resume&#xFF0C; &#x4EE5;&#x53CA; lua_yield&#x3002;</p>
<h1 id="&#x8BED;&#x8A00;&#x5B9A;&#x4E49;">&#x8BED;&#x8A00;&#x5B9A;&#x4E49; <a href="#&#x8BED;&#x8A00;&#x5B9A;&#x4E49;"> # </a></h1>
<p>&#x8FD9;&#x4E00;&#x7AE0;&#x63CF;&#x8FF0;&#x4E86; Lua &#x7684;&#x8BCD;&#x6CD5;&#x3001;&#x8BED;&#x6CD5;&#x548C;&#x53E5;&#x6CD5;&#x3002; &#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x672C;&#x7AE0;&#x63CF;&#x8FF0;&#x54EA;&#x4E9B;&#x7B26;&#x8BB0;&#x662F;&#x6709;&#x6548;&#x7684;&#xFF0C; &#x5B83;&#x4EEC;&#x5982;&#x4F55;&#x88AB;&#x7EC4;&#x5408;&#x8D77;&#x6765;&#xFF0C;&#x8FD9;&#x4E9B;&#x7EC4;&#x5408;&#x65B9;&#x5F0F;&#x6709;&#x4EC0;&#x4E48;&#x542B;&#x4E49;&#x3002;</p>
<p>&#x5173;&#x4E8E;&#x8BED;&#x8A00;&#x7684;&#x6784;&#x6210;&#x6982;&#x5FF5;&#x5C06;&#x7528;&#x5E38;&#x89C1;&#x7684;&#x6269;&#x5C55; BNF &#x8868;&#x8FBE;&#x5F0F;&#x5199;&#x51FA;&#x3002; &#x4E5F;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#xFF1A; {a} &#x8868;&#x793A; 0 &#x6216;&#x591A;&#x4E2A; a&#xFF0C; [a] &#x8868;&#x793A;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x7684; a&#x3002; &#x53EF;&#x4EE5;&#x88AB;&#x5206;&#x89E3;&#x7684;&#x975E;&#x6700;&#x7EC8;&#x7B26;&#x53F7;&#x4F1A;&#x8FD9;&#x6837;&#x5199; non-terminal &#xFF0C; &#x5173;&#x952E;&#x5B57;&#x4F1A;&#x5199;&#x6210;&#x8FD9;&#x6837; kword&#xFF0C; &#x800C;&#x5176;&#x5B83;&#x4E0D;&#x80FD;&#x88AB;&#x5206;&#x89E3;&#x7684;&#x6700;&#x7EC8;&#x7B26;&#x53F7;&#x5219;&#x5199;&#x6210;&#x8FD9;&#x6837; &#x2018;=&#x2019; &#x3002; &#x5B8C;&#x6574;&#x7684; Lua &#x8BED;&#x6CD5;&#x53EF;&#x4EE5;&#x5728;&#x672C;&#x624B;&#x518C;&#x6700;&#x540E;&#x4E00;&#x7AE0; &#xA7;9 &#x627E;&#x5230;&#x3002;</p>
<h2 id="&#x8BCD;&#x6CD5;&#x7EA6;&#x5B9A;">&#x8BCD;&#x6CD5;&#x7EA6;&#x5B9A; <a href="#&#x8BCD;&#x6CD5;&#x7EA6;&#x5B9A;"> # </a></h2>
<p>Lua &#x8BED;&#x8A00;&#x7684;&#x683C;&#x5F0F;&#x81EA;&#x7531;&#x3002; &#x5B83;&#x4F1A;&#x5FFD;&#x7565;&#x8BED;&#x6CD5;&#x5143;&#x7D20;&#xFF08;&#x7B26;&#x8BB0;&#xFF09;&#x95F4;&#x7684;&#x7A7A;&#x683C;&#xFF08;&#x5305;&#x62EC;&#x6362;&#x884C;&#xFF09;&#x548C;&#x6CE8;&#x91CA;&#xFF0C; &#x4EC5;&#x628A;&#x5B83;&#x4EEC;&#x770B;&#x4F5C;&#x4E3A;&#x540D;&#x5B57;&#x548C;&#x5173;&#x952E;&#x5B57;&#x95F4;&#x7684;&#x5206;&#x5272;&#x7B26;&#x3002;</p>
<p>Lua &#x4E2D;&#x7684; &#x540D;&#x5B57; &#xFF08;&#x4E5F;&#x88AB;&#x79F0;&#x4E3A; &#x6807;&#x8BC6;&#x7B26;&#xFF09; &#x53EF;&#x4EE5;&#x662F;&#x7531;&#x975E;&#x6570;&#x5B57;&#x6253;&#x5934;&#x7684;&#x4EFB;&#x610F;&#x5B57;&#x6BCD;&#x4E0B;&#x5212;&#x7EBF;&#x548C;&#x6570;&#x5B57;&#x6784;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x6807;&#x8BC6;&#x7B26;&#x53EF;&#x7528;&#x4E8E;&#x5BF9;&#x53D8;&#x91CF;&#x3001;&#x8868;&#x7684;&#x57DF;&#x3001;&#x4EE5;&#x53CA;&#x6807;&#x7B7E;&#x547D;&#x540D;&#x3002;</p>
<p>&#x4E0B;&#x5217; &#x5173;&#x952E;&#x5B57; &#x662F;&#x4FDD;&#x7559;&#x7684;&#xFF0C;&#x4E0D;&#x53EF;&#x7528;&#x4E8E;&#x540D;&#x5B57;&#xFF1A;</p>
<pre><code>     and       break     do        else      elseif    end
     false     for       function  goto      if        in
     local     nil       not       or        repeat    return
     then      true      until     while
</code></pre><p>Lua &#x8BED;&#x8A00;&#x5BF9;&#x5927;&#x5C0F;&#x5199;&#x654F;&#x611F;&#xFF1A; and &#x662F;&#x4E00;&#x4E2A;&#x4FDD;&#x7559;&#x5B57;&#xFF0C;&#x4F46; And &#x4E0E; AND &#x5219;&#x662F;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x6709;&#x6548;&#x540D;&#x5B57;&#x3002; &#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x7EA6;&#x5B9A;&#xFF0C;&#x7A0B;&#x5E8F;&#x5E94;&#x907F;&#x514D;&#x521B;&#x5EFA;&#x4EE5;&#x4E0B;&#x5212;&#x7EBF;&#x52A0;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#x6784;&#x6210;&#x7684;&#x540D;&#x5B57; &#xFF08;&#x4F8B;&#x5982; _VERSION&#xFF09;&#x3002;</p>
<p>&#x4E0B;&#x5217;&#x5B57;&#x7B26;&#x4E32;&#x662F;&#x53E6;&#x5916;&#x4E00;&#x4E9B;&#x7B26;&#x8BB0;&#xFF1A;</p>
<pre><code>     +     -     *     /     %     ^     #
     &amp;     ~     |     &lt;&lt;    &gt;&gt;    //
     ==    ~=    &lt;=    &gt;=    &lt;     &gt;     =
     (     )     {     }     [     ]     ::
     ;     :     ,     .     ..    ...
</code></pre><p>&#x5B57;&#x9762;&#x4E32; &#x53EF;&#x4EE5;&#x7528;&#x5355;&#x5F15;&#x53F7;&#x6216;&#x53CC;&#x5F15;&#x53F7;&#x62EC;&#x8D77;&#x3002; &#x5B57;&#x9762;&#x4E32;&#x5185;&#x90E8;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x4E0B;&#x5217; C &#x98CE;&#x683C;&#x7684;&#x8F6C;&#x4E49;&#x4E32;&#xFF1A; &apos;\a&apos; &#xFF08;&#x54CD;&#x94C3;&#xFF09;&#xFF0C; &apos;\b&apos; &#xFF08;&#x9000;&#x683C;&#xFF09;&#xFF0C; &apos;\f&apos; &#xFF08;&#x6362;&#x9875;&#xFF09;&#xFF0C; &apos;\n&apos; &#xFF08;&#x6362;&#x884C;&#xFF09;&#xFF0C; &apos;\r&apos; &#xFF08;&#x56DE;&#x8F66;&#xFF09;&#xFF0C; &apos;\t&apos; &#xFF08;&#x6A2A;&#x9879;&#x5236;&#x8868;&#xFF09;&#xFF0C; &apos;\v&apos; &#xFF08;&#x7EB5;&#x5411;&#x5236;&#x8868;&#xFF09;&#xFF0C; &apos;\&apos; &#xFF08;&#x53CD;&#x659C;&#x6760;&#xFF09;&#xFF0C; &apos;\&quot;&apos; &#xFF08;&#x53CC;&#x5F15;&#x53F7;&#xFF09;&#xFF0C; &#x4EE5;&#x53CA; &apos;\&apos;&apos; (&#x5355;&#x5F15;&#x53F7;)&#x3002; &#x5728;&#x53CD;&#x659C;&#x6760;&#x540E;&#x8DDF;&#x4E00;&#x4E2A;&#x771F;&#x6B63;&#x7684;&#x6362;&#x884C;&#x7B49;&#x4EF7;&#x4E8E;&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x5199;&#x4E00;&#x4E2A;&#x6362;&#x884C;&#x7B26;&#x3002; &#x8F6C;&#x4E49;&#x4E32; &apos;\z&apos; &#x4F1A;&#x5FFD;&#x7565;&#x5176;&#x540E;&#x7684;&#x4E00;&#x7CFB;&#x5217;&#x7A7A;&#x767D;&#x7B26;&#xFF0C;&#x5305;&#x62EC;&#x6362;&#x884C;&#xFF1B; &#x5B83;&#x5728;&#x4F60;&#x9700;&#x8981;&#x5BF9;&#x4E00;&#x4E2A;&#x5F88;&#x957F;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5E38;&#x91CF;&#x65AD;&#x884C;&#x4E3A;&#x591A;&#x884C;&#x5E76;&#x5E0C;&#x671B;&#x5728;&#x6BCF;&#x4E2A;&#x65B0;&#x884C;&#x4FDD;&#x6301;&#x7F29;&#x8FDB;&#x65F6;&#x975E;&#x5E38;&#x6709;&#x7528;&#x3002;</p>
<p>Lua &#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x4FDD;&#x5B58;&#x4EFB;&#x610F; 8 &#x4F4D;&#x503C;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x7528; &apos;\0&apos; &#x8868;&#x793A;&#x7684; 0 &#x3002; &#x4E00;&#x822C;&#x800C;&#x8A00;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x5B57;&#x7B26;&#x7684;&#x6570;&#x5B57;&#x503C;&#x6765;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x3002; &#x65B9;&#x5F0F;&#x662F;&#x7528;&#x8F6C;&#x4E49;&#x4E32; \xXX&#xFF0C; &#x6B64;&#x5904;&#x7684; XX &#x5FC5;&#x987B;&#x662F;&#x6070;&#x597D;&#x4E24;&#x4E2A;&#x5B57;&#x7B26;&#x7684; 16 &#x8FDB;&#x5236;&#x6570;&#x3002; &#x6216;&#x8005;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8F6C;&#x4E49;&#x4E32; \ddd &#xFF0C; &#x8FD9;&#x91CC;&#x7684; ddd &#x662F;&#x4E00;&#x5230;&#x4E09;&#x4E2A;&#x5341;&#x8FDB;&#x5236;&#x6570;&#x5B57;&#x3002; &#xFF08;&#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x8F6C;&#x4E49;&#x7B26;&#x540E;&#x63A5;&#x7740;&#x6070;&#x5DE7;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x7B26;&#x53F7;&#x7684;&#x8BDD;&#xFF0C; &#x4F60;&#x5C31;&#x5FC5;&#x987B;&#x5728;&#x8FD9;&#x4E2A;&#x8F6C;&#x4E49;&#x5F62;&#x5F0F;&#x4E2D;&#x5199;&#x6EE1;&#x4E09;&#x4E2A;&#x6570;&#x5B57;&#x3002;&#xFF09;</p>
<p>&#x5BF9;&#x4E8E;&#x7528; UTF-8 &#x7F16;&#x7801;&#x7684; Unicode &#x5B57;&#x7B26;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7528; &#x8F6C;&#x4E49;&#x7B26; \u{XXX} &#x6765;&#x8868;&#x793A; &#xFF08;&#x8FD9;&#x91CC;&#x5FC5;&#x987B;&#x6709;&#x4E00;&#x5BF9;&#x82B1;&#x62EC;&#x53F7;&#xFF09;&#xFF0C; &#x6B64;&#x5904;&#x7684; XXX &#x662F;&#x7528; 16 &#x8FDB;&#x5236;&#x8868;&#x793A;&#x7684;&#x5B57;&#x7B26;&#x7F16;&#x53F7;&#x3002;</p>
<p>&#x5B57;&#x9762;&#x4E32;&#x8FD8;&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x79CD; &#x957F;&#x62EC;&#x53F7; &#x62EC;&#x8D77;&#x6765;&#x7684;&#x65B9;&#x5F0F;&#x5B9A;&#x4E49;&#x3002; &#x6211;&#x4EEC;&#x628A;&#x4E24;&#x4E2A;&#x6B63;&#x7684;&#x65B9;&#x62EC;&#x53F7;&#x95F4;&#x63D2;&#x5165; n &#x4E2A;&#x7B49;&#x53F7;&#x5B9A;&#x4E49;&#x4E3A; &#x7B2C; n &#x7EA7;&#x5F00;&#x957F;&#x62EC;&#x53F7;&#x3002; &#x5C31;&#x662F;&#x8BF4;&#xFF0C;0 &#x7EA7;&#x5F00;&#x7684;&#x957F;&#x62EC;&#x53F7;&#x5199;&#x4F5C; [[ &#xFF0C; &#x4E00;&#x7EA7;&#x5F00;&#x957F;&#x62EC;&#x53F7;&#x5199;&#x4F5C; [=[ &#xFF0C; &#x5982;&#x6B64;&#x7B49;&#x7B49;&#x3002; &#x95ED;&#x957F;&#x62EC;&#x53F7;&#x4E5F;&#x4F5C;&#x7C7B;&#x4F3C;&#x5B9A;&#x4E49;&#xFF1B; &#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;4 &#x7EA7;&#x53CD;&#x7684;&#x957F;&#x62EC;&#x53F7;&#x5199;&#x4F5C; ]====] &#x3002; &#x4E00;&#x4E2A; &#x957F;&#x5B57;&#x9762;&#x4E32; &#x53EF;&#x4EE5;&#x7531;&#x4EFB;&#x4F55;&#x4E00;&#x7EA7;&#x7684;&#x5F00;&#x957F;&#x62EC;&#x53F7;&#x5F00;&#x59CB;&#xFF0C;&#x800C;&#x7531;&#x7B2C;&#x4E00;&#x4E2A;&#x78B0;&#x5230;&#x7684;&#x540C;&#x7EA7;&#x7684;&#x95ED;&#x957F;&#x62EC;&#x53F7;&#x7ED3;&#x675F;&#x3002; &#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x63CF;&#x8FF0;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#xFF0C;&#x5F53;&#x7136;&#x7279;&#x5B9A;&#x7EA7;&#x522B;&#x7684;&#x53CD;&#x957F;&#x62EC;&#x53F7;&#x9664;&#x5916;&#x3002; &#x6574;&#x4E2A;&#x8BCD;&#x6CD5;&#x5206;&#x6790;&#x8FC7;&#x7A0B;&#x5C06;&#x4E0D;&#x53D7;&#x5206;&#x884C;&#x9650;&#x5236;&#xFF0C;&#x4E0D;&#x5904;&#x7406;&#x4EFB;&#x4F55;&#x8F6C;&#x4E49;&#x7B26;&#xFF0C;&#x5E76;&#x4E14;&#x5FFD;&#x7565;&#x6389;&#x4EFB;&#x4F55;&#x4E0D;&#x540C;&#x7EA7;&#x522B;&#x7684;&#x957F;&#x62EC;&#x53F7;&#x3002; &#x5176;&#x4E2D;&#x78B0;&#x5230;&#x7684;&#x4EFB;&#x4F55;&#x5F62;&#x5F0F;&#x7684;&#x6362;&#x884C;&#x4E32;&#xFF08;&#x56DE;&#x8F66;&#x3001;&#x6362;&#x884C;&#x3001;&#x56DE;&#x8F66;&#x52A0;&#x6362;&#x884C;&#x3001;&#x6362;&#x884C;&#x52A0;&#x56DE;&#x8F66;&#xFF09;&#xFF0C;&#x90FD;&#x4F1A;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x5355;&#x4E2A;&#x6362;&#x884C;&#x7B26;&#x3002;</p>
<p>&#x5B57;&#x9762;&#x4E32;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x4E0D;&#x88AB;&#x4E0A;&#x8FF0;&#x89C4;&#x5219;&#x5F71;&#x54CD;&#x7684;&#x5B57;&#x8282;&#x90FD;&#x5448;&#x73B0;&#x4E3A;&#x672C;&#x8EAB;&#x3002; &#x7136;&#x800C;&#xFF0C;Lua &#x662F;&#x7528;&#x6587;&#x672C;&#x6A21;&#x5F0F;&#x6253;&#x5F00;&#x6E90;&#x6587;&#x4EF6;&#x89E3;&#x6790;&#x7684;&#xFF0C; &#x4E00;&#x4E9B;&#x7CFB;&#x7EDF;&#x7684;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x5BF9;&#x67D0;&#x4E9B;&#x63A7;&#x5236;&#x5B57;&#x7B26;&#x7684;&#x5904;&#x7406;&#x53EF;&#x80FD;&#x6709;&#x95EE;&#x9898;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5BF9;&#x4E8E;&#x975E;&#x6587;&#x672C;&#x6570;&#x636E;&#xFF0C;&#x7528;&#x5F15;&#x53F7;&#x62EC;&#x8D77;&#x6765;&#x5E76;&#x663E;&#x5F0F;&#x6309;&#x8F6C;&#x4E49;&#x7B26;&#x89C4;&#x5219;&#x6765;&#x8868;&#x8FF0;&#x66F4;&#x5B89;&#x5168;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#x8D77;&#x89C1;&#xFF0C; &#x5F53;&#x4E00;&#x4E2A;&#x5F00;&#x957F;&#x62EC;&#x53F7;&#x540E;&#x7D27;&#x63A5;&#x4E00;&#x4E2A;&#x6362;&#x884C;&#x7B26;&#x65F6;&#xFF0C; &#x8FD9;&#x4E2A;&#x6362;&#x884C;&#x7B26;&#x4E0D;&#x4F1A;&#x653E;&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x5185;&#x3002; &#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x5047;&#x8BBE;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x4F7F;&#x7528; ASCII &#x7801; &#xFF08;&#x6B64;&#x65F6; &apos;a&apos; &#x7F16;&#x7801;&#x4E3A; 97 &#xFF0C; &#x6362;&#x884C;&#x7F16;&#x7801;&#x4E3A; 10 &#xFF0C;&apos;1&apos; &#x7F16;&#x7801;&#x4E3A; 49 &#xFF09;&#xFF0C; &#x4E0B;&#x9762;&#x4E94;&#x79CD;&#x65B9;&#x5F0F;&#x63CF;&#x8FF0;&#x4E86;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF1A;</p>
<pre><code> a = &apos;alo\n123&quot;&apos;
 a = &quot;alo\n123\&quot;&quot;
 a = &apos;\97lo\10\04923&quot;&apos;
 a = [[alo
 123&quot;]]
 a = [==[
 alo
 123&quot;]==]
</code></pre><p>&#x6570;&#x5B57;&#x5E38;&#x91CF; &#xFF08;&#x6216;&#x79F0;&#x4E3A; &#x6570;&#x5B57;&#x91CF;&#xFF09; &#x53EF;&#x4EE5;&#x7531;&#x53EF;&#x9009;&#x7684;&#x5C0F;&#x6570;&#x90E8;&#x5206;&#x548C;&#x53EF;&#x9009;&#x7684;&#x5341;&#x4E3A;&#x5E95;&#x7684;&#x6307;&#x6570;&#x90E8;&#x5206;&#x6784;&#x6210;&#xFF0C; &#x6307;&#x6570;&#x90E8;&#x5206;&#x7528;&#x5B57;&#x7B26; &apos;e&apos; &#x6216; &apos;E&apos; &#x6765;&#x6807;&#x8BB0;&#x3002; Lua &#x4E5F;&#x63A5;&#x53D7;&#x4EE5; 0x &#x6216; 0X &#x5F00;&#x5934;&#x7684; 16 &#x8FDB;&#x5236;&#x5E38;&#x91CF;&#x3002; 16 &#x8FDB;&#x5236;&#x5E38;&#x91CF;&#x4E5F;&#x63A5;&#x53D7;&#x5C0F;&#x6570;&#x52A0;&#x6307;&#x6570;&#x90E8;&#x5206;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x6307;&#x6570;&#x90E8;&#x5206;&#x662F;&#x4EE5;&#x4E8C;&#x4E3A;&#x5E95;&#xFF0C; &#x7528;&#x5B57;&#x7B26; &apos;p&apos; &#x6216; &apos;P&apos; &#x6765;&#x6807;&#x8BB0;&#x3002; &#x6570;&#x5B57;&#x5E38;&#x91CF;&#x4E2D;&#x5305;&#x542B;&#x5C0F;&#x6570;&#x70B9;&#x6216;&#x6307;&#x6570;&#x90E8;&#x5206;&#x65F6;&#xFF0C;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x4E00;&#x4E2A;&#x6D6E;&#x70B9;&#x6570;&#xFF1B; &#x5426;&#x5219;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x3002; &#x4E0B;&#x9762;&#x6709;&#x4E00;&#x4E9B;&#x5408;&#x6CD5;&#x7684;&#x6574;&#x6570;&#x5E38;&#x91CF;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code> 3   345   0xff   0xBEBADA
</code></pre><p>&#x4EE5;&#x4E0B;&#x4E3A;&#x5408;&#x6CD5;&#x7684;&#x6D6E;&#x70B9;&#x5E38;&#x91CF;&#xFF1A;</p>
<pre><code> 3.0     3.1416     314.16e-2     0.31416E1     34e1
 0x0.1E  0xA23p-4   0X1.921FB54442D18P+1
</code></pre><p>&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x51FA;&#x73B0;&#x4EE5;&#x53CC;&#x6A2A;&#x7EBF; (--) &#x5F00;&#x5934;&#x7684;&#x90E8;&#x5206;&#x662F; &#x6CE8;&#x91CA; &#x3002; &#x5982;&#x679C; -- &#x540E;&#x6CA1;&#x6709;&#x7D27;&#x8DDF;&#x7740;&#x4E00;&#x4E2A;&#x5F00;&#x5927;&#x62EC;&#x53F7;&#xFF0C; &#x8BE5;&#x6CE8;&#x91CA;&#x4E3A; &#x77ED;&#x6CE8;&#x91CA;&#xFF0C; &#x6CE8;&#x91CA;&#x5230;&#x5F53;&#x524D;&#x884C;&#x672B;&#x622A;&#x81F3;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x6BB5; &#x957F;&#x6CE8;&#x91CA; &#xFF0C; &#x6CE8;&#x91CA;&#x533A;&#x4E00;&#x76F4;&#x7EF4;&#x6301;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x95ED;&#x957F;&#x62EC;&#x53F7;&#x3002; &#x957F;&#x6CE8;&#x91CA;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x4E34;&#x65F6;&#x5C4F;&#x853D;&#x6389;&#x4E00;&#x5927;&#x6BB5;&#x4EE3;&#x7801;&#x3002;</p>
<h2 id="&#x53D8;&#x91CF;">&#x53D8;&#x91CF; <a href="#&#x53D8;&#x91CF;"> # </a></h2>
<p>&#x53D8;&#x91CF;&#x662F;&#x50A8;&#x5B58;&#x503C;&#x7684;&#x5730;&#x65B9;&#x3002; Lua &#x4E2D;&#x6709;&#x4E09;&#x79CD;&#x53D8;&#x91CF;&#xFF1A; &#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3001;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x548C;&#x8868;&#x7684;&#x57DF;&#x3002;</p>
<p>&#x5355;&#x4E2A;&#x540D;&#x5B57;&#x53EF;&#x4EE5;&#x6307;&#x4EE3;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4E5F;&#x53EF;&#x4EE5;&#x6307;&#x4EE3;&#x4E00;&#x4E2A;&#x5C40;&#x90E8;&#x53D8;&#x91CF; &#xFF08;&#x6216;&#x8005;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x5F62;&#x53C2;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x7279;&#x6B8A;&#x5F62;&#x5F0F;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF09;&#x3002;</p>
<pre><code>var ::= Name
</code></pre><p>&#x540D;&#x5B57;&#x6307; &#xA7;3.1 &#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#x3002;</p>
<p>&#x6240;&#x6709;&#x6CA1;&#x6709;&#x663E;&#x5F0F;&#x58F0;&#x660E;&#x4E3A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.7&#xFF09; &#x7684;&#x53D8;&#x91CF;&#x540D;&#x90FD;&#x88AB;&#x5F53;&#x505A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3002; &#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x6709;&#x5176; &#x4F5C;&#x7528;&#x8303;&#x56F4; &#xFF1A; &#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x53EF;&#x4EE5;&#x88AB;&#x5B9A;&#x4E49;&#x5728;&#x5B83;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x81EA;&#x7531;&#x4F7F;&#x7528;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.5&#xFF09;&#x3002;</p>
<p>&#x5728;&#x53D8;&#x91CF;&#x7684;&#x9996;&#x6B21;&#x8D4B;&#x503C;&#x4E4B;&#x524D;&#xFF0C;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x5747;&#x4E3A; nil&#x3002;</p>
<p>&#x65B9;&#x62EC;&#x53F7;&#x88AB;&#x7528;&#x6765;&#x5BF9;&#x8868;&#x4F5C;&#x7D22;&#x5F15;&#xFF1A;</p>
<pre><code>var ::= prefixexp &#x2018;[&#x2019; exp &#x2018;]&#x2019;
</code></pre><p>&#x5BF9;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4EE5;&#x53CA;&#x8868;&#x7684;&#x57DF;&#x4E4B;&#x8BBF;&#x95EE;&#x7684;&#x542B;&#x4E49;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5143;&#x8868;&#x6765;&#x6539;&#x53D8;&#x3002; &#x4EE5;&#x7D22;&#x5F15;&#x65B9;&#x5F0F;&#x8BBF;&#x95EE;&#x4E00;&#x4E2A;&#x53D8;&#x91CF; t[i] &#x7B49;&#x4EF7;&#x4E8E; &#x8C03;&#x7528; gettable_event(t,i)&#x3002; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4 &#xFF0C;&#x6709;&#x4E00;&#x4EFD;&#x5B8C;&#x6574;&#x7684;&#x5173;&#x4E8E; gettable_event &#x51FD;&#x6570;&#x7684;&#x8BF4;&#x660E;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5E76;&#x6CA1;&#x6709;&#x5728; lua &#x4E2D;&#x5B9A;&#x4E49;&#x51FA;&#x6765;&#xFF0C;&#x4E5F;&#x4E0D;&#x80FD;&#x5728; lua &#x4E2D;&#x8C03;&#x7528;&#x3002;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x628A;&#x63D0;&#x5230;&#x5B83;&#x53EA;&#x662F;&#x65B9;&#x4FBF;&#x8BF4;&#x660E;&#x95EE;&#x9898;&#x3002;&#xFF09;</p>
<p>var.Name &#x8FD9;&#x79CD;&#x8BED;&#x6CD5;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x8BED;&#x6CD5;&#x7CD6;&#xFF0C;&#x7528;&#x6765;&#x8868;&#x793A; var[&quot;Name&quot;]&#xFF1A;</p>
<pre><code>var ::= prefixexp &#x2018;.&#x2019; Name
</code></pre><p>&#x5BF9;&#x5168;&#x5C40;&#x53D8;&#x91CF; x &#x7684;&#x64CD;&#x4F5C;&#x7B49;&#x4EF7;&#x4E8E;&#x64CD;&#x4F5C; _ENV.x&#x3002; &#x7531;&#x4E8E;&#x4EE3;&#x7801;&#x5757;&#x7F16;&#x8BD1;&#x7684;&#x65B9;&#x5F0F;&#xFF0C; _ENV &#x6C38;&#x8FDC;&#x4E5F;&#x4E0D;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x540D;&#x5B57; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.2&#xFF09;&#x3002;</p>
<h2 id="&#x8BED;&#x53E5;">&#x8BED;&#x53E5; <a href="#&#x8BED;&#x53E5;"> # </a></h2>
<p>Lua &#x652F;&#x6301;&#x6240;&#x6709;&#x4E0E; Pascal &#x6216;&#x662F; C &#x7C7B;&#x4F3C;&#x7684;&#x5E38;&#x89C1;&#x5F62;&#x5F0F;&#x7684;&#x8BED;&#x53E5;&#xFF0C; &#x8FD9;&#x4E2A;&#x96C6;&#x5408;&#x5305;&#x62EC;&#x8D4B;&#x503C;&#xFF0C;&#x63A7;&#x5236;&#x7ED3;&#x6784;&#xFF0C;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF0C;&#x8FD8;&#x6709;&#x53D8;&#x91CF;&#x58F0;&#x660E;&#x3002;</p>
<h3 id="&#x8BED;&#x53E5;&#x5757;">&#x8BED;&#x53E5;&#x5757; <a href="#&#x8BED;&#x53E5;&#x5757;"> # </a></h3>
<p>&#x8BED;&#x53E5;&#x5757;&#x662F;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x5E8F;&#x5217;&#xFF0C;&#x5B83;&#x4EEC;&#x4F1A;&#x6309;&#x6B21;&#x5E8F;&#x6267;&#x884C;&#xFF1A;</p>
<pre><code>block ::= {stat}
</code></pre><p>Lua &#x652F;&#x6301; &#x7A7A;&#x8BED;&#x53E5;&#xFF0C; &#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x5206;&#x53F7;&#x5206;&#x5272;&#x8BED;&#x53E5;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4EE5;&#x5206;&#x53F7;&#x5F00;&#x59CB;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x5757;&#xFF0C; &#x6216;&#x662F;&#x8FDE;&#x7740;&#x5199;&#x4E24;&#x4E2A;&#x5206;&#x53F7;&#xFF1A;</p>
<pre><code>stat ::= &#x2018;;&#x2019;
</code></pre><p>&#x51FD;&#x6570;&#x8C03;&#x7528;&#x548C;&#x8D4B;&#x503C;&#x8BED;&#x53E5;&#x90FD;&#x53EF;&#x80FD;&#x4EE5;&#x4E00;&#x4E2A;&#x5C0F;&#x62EC;&#x53F7;&#x6253;&#x5934;&#xFF0C; &#x8FD9;&#x53EF;&#x80FD;&#x8BA9; Lua &#x7684;&#x8BED;&#x6CD5;&#x4EA7;&#x751F;&#x6B67;&#x4E49;&#x3002; &#x6211;&#x4EEC;&#x6765;&#x770B;&#x770B;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x7247;&#x65AD;&#xFF1A;</p>
<pre><code> a = b + c
 (print or io.write)(&apos;done&apos;)
</code></pre><p>&#x4ECE;&#x8BED;&#x6CD5;&#x4E0A;&#x8BF4;&#xFF0C;&#x53EF;&#x80FD;&#x6709;&#x4E24;&#x79CD;&#x89E3;&#x91CA;&#x65B9;&#x5F0F;&#xFF1A;</p>
<pre><code> a = b + c(print or io.write)(&apos;done&apos;)

 a = b + c; (print or io.write)(&apos;done&apos;)
</code></pre><p>&#x5F53;&#x524D;&#x7684;&#x89E3;&#x6790;&#x5668;&#x603B;&#x662F;&#x7528;&#x7B2C;&#x4E00;&#x79CD;&#x7ED3;&#x6784;&#x6765;&#x89E3;&#x6790;&#xFF0C; &#x5B83;&#x4F1A;&#x5C06;&#x5F00;&#x62EC;&#x53F7;&#x770B;&#x6210;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x5F00;&#x59CB;&#x5904;&#x3002; &#x4E3A;&#x4E86;&#x907F;&#x514D;&#x8FD9;&#x79CD;&#x4E8C;&#x4E49;&#x6027;&#xFF0C; &#x5728;&#x4E00;&#x6761;&#x8BED;&#x53E5;&#x4EE5;&#x5C0F;&#x62EC;&#x53F7;&#x5F00;&#x5934;&#x65F6;&#xFF0C;&#x524D;&#x9762;&#x653E;&#x4E00;&#x4E2A;&#x5206;&#x53F7;&#x662F;&#x4E2A;&#x597D;&#x4E60;&#x60EF;&#xFF1A;</p>
<pre><code> ;(print or io.write)(&apos;done&apos;)
</code></pre><p>&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x5757;&#x53EF;&#x4EE5;&#x88AB;&#x663E;&#x5F0F;&#x7684;&#x5B9A;&#x754C;&#x4E3A;&#x5355;&#x6761;&#x8BED;&#x53E5;&#xFF1A;</p>
<pre><code>stat ::= do block end
</code></pre><p>&#x663E;&#x5F0F;&#x7684;&#x5BF9;&#x4E00;&#x4E2A;&#x5757;&#x5B9A;&#x754C;&#x901A;&#x5E38;&#x7528;&#x6765;&#x63A7;&#x5236;&#x5185;&#x90E8;&#x53D8;&#x91CF;&#x58F0;&#x660E;&#x7684;&#x4F5C;&#x7528;&#x57DF;&#x3002; &#x6709;&#x65F6;&#xFF0C;&#x663E;&#x5F0F;&#x5B9A;&#x754C;&#x4E5F;&#x7528;&#x4E8E;&#x5728;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x5757;&#x4E2D;&#x95F4;&#x63D2;&#x5165; return &#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.4&#xFF09;&#x3002;</p>
<h3 id="&#x4EE3;&#x7801;&#x5757;">&#x4EE3;&#x7801;&#x5757; <a href="#&#x4EE3;&#x7801;&#x5757;"> # </a></h3>
<p>Lua &#x7684;&#x4E00;&#x4E2A;&#x7F16;&#x8BD1;&#x5355;&#x5143;&#x88AB;&#x79F0;&#x4E3A;&#x4E00;&#x4E2A; &#x4EE3;&#x7801;&#x5757;&#x3002; &#x4ECE;&#x53E5;&#x6CD5;&#x6784;&#x6210;&#x4E0A;&#x8BB2;&#xFF0C;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x5757;&#x3002;</p>
<pre><code>chunk ::= block
</code></pre><p>Lua &#x628A;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x5F53;&#x4F5C;&#x4E00;&#x4E2A;&#x62E5;&#x6709;&#x4E0D;&#x5B9A;&#x53C2;&#x6570;&#x7684;&#x533F;&#x540D;&#x51FD;&#x6570; &#xFF08;&#x53C2;&#x89C1;&#xA7;3.4.11&#xFF09;&#x6765;&#x5904;&#x7406;&#x3002; &#x6B63;&#x662F;&#x8FD9;&#x6837;&#xFF0C;&#x4EE3;&#x7801;&#x5757;&#x5185;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x63A5;&#x6536;&#x53C2;&#x6570;&#xFF0C;&#x8FD4;&#x56DE;&#x82E5;&#x5E72;&#x503C;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x8FD9;&#x4E2A;&#x533F;&#x540D;&#x51FD;&#x6570;&#x5728;&#x7F16;&#x8BD1;&#x65F6;&#x8FD8;&#x4E3A;&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x57DF;&#x7ED1;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x5916;&#x90E8;&#x5C40;&#x90E8;&#x53D8;&#x91CF; _ENV &#xFF08;&#x53C2;&#x89C1; &#xA7;2.2&#xFF09;&#x3002; &#x8BE5;&#x51FD;&#x6570;&#x603B;&#x662F;&#x628A; _ENV &#x4F5C;&#x4E3A;&#x5B83;&#x552F;&#x4E00;&#x7684;&#x4E00;&#x4E2A;&#x4E0A;&#x503C;&#xFF0C; &#x5373;&#x4F7F;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E0D;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x5B83;&#x4E5F;&#x5B58;&#x5728;&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x5757;&#x53EF;&#x4EE5;&#x88AB;&#x4FDD;&#x5B58;&#x5728;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x5185;&#x90E8;&#x7684;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x8981;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#xFF0C; &#x9996;&#x5148;&#x8981;&#x8BA9; Lua &#x52A0;&#x8F7D; &#x5B83;&#xFF0C; &#x5C06;&#x4EE3;&#x7801;&#x5757;&#x4E2D;&#x7684;&#x4EE3;&#x7801;&#x9884;&#x7F16;&#x8BD1;&#x6210;&#x865A;&#x62DF;&#x673A;&#x4E2D;&#x7684;&#x6307;&#x4EE4;&#xFF0C; &#x800C;&#x540E;&#xFF0C;Lua &#x7528;&#x865A;&#x62DF;&#x673A;&#x89E3;&#x91CA;&#x5668;&#x6765;&#x8FD0;&#x884C;&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x5757;&#x53EF;&#x4EE5;&#x88AB;&#x9884;&#x7F16;&#x8BD1;&#x4E3A;&#x4E8C;&#x8FDB;&#x5236;&#x5F62;&#x5F0F;&#xFF1B; &#x53C2;&#x89C1;&#x7A0B;&#x5E8F; luac &#x4EE5;&#x53CA;&#x51FD;&#x6570; string.dump &#x53EF;&#x83B7;&#x5F97;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x3002; &#x7528;&#x6E90;&#x7801;&#x8868;&#x793A;&#x7684;&#x7A0B;&#x5E8F;&#x548C;&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x5F62;&#x5F0F;&#x53EF;&#x81EA;&#x7531;&#x66FF;&#x6362;&#xFF1B; Lua &#x4F1A;&#x81EA;&#x52A8;&#x68C0;&#x6D4B;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x505A;&#x76F8;&#x5E94;&#x7684;&#x5904;&#x7406; &#xFF08;&#x53C2;&#x89C1; load&#xFF09;&#x3002;</p>
<h3 id="&#x8D4B;&#x503C;">&#x8D4B;&#x503C; <a href="#&#x8D4B;&#x503C;"> # </a></h3>
<p>Lua &#x5141;&#x8BB8;&#x591A;&#x91CD;&#x8D4B;&#x503C;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x8D4B;&#x503C;&#x7684;&#x8BED;&#x6CD5;&#x5B9A;&#x4E49;&#x662F;&#x7B49;&#x53F7;&#x5DE6;&#x8FB9;&#x653E;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x5217;&#x8868;&#xFF0C; &#x800C;&#x7B49;&#x53F7;&#x53F3;&#x8FB9;&#x653E;&#x4E00;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x5217;&#x8868;&#x3002; &#x4E24;&#x8FB9;&#x7684;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x90FD;&#x7528;&#x9017;&#x53F7;&#x95F4;&#x5F00;&#xFF1A;</p>
<pre><code>stat ::= varlist &#x2018;=&#x2019; explist
varlist ::= var {&#x2018;,&#x2019; var}
explist ::= exp {&#x2018;,&#x2019; exp}
</code></pre><p>&#x8868;&#x8FBE;&#x5F0F;&#x653E;&#x5728; &#xA7;3.4 &#x4E2D;&#x8BA8;&#x8BBA;&#x3002;</p>
<p>&#x5728;&#x4F5C;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#xFF0C; &#x90A3;&#x503C;&#x5217;&#x8868;&#x4F1A;&#x88AB; &#x8C03;&#x6574; &#x4E3A;&#x5DE6;&#x8FB9;&#x53D8;&#x91CF;&#x5217;&#x8868;&#x7684;&#x4E2A;&#x6570;&#x3002; &#x5982;&#x679C;&#x503C;&#x6BD4;&#x9700;&#x8981;&#x7684;&#x66F4;&#x591A;&#x7684;&#x8BDD;&#xFF0C;&#x591A;&#x4F59;&#x7684;&#x503C;&#x5C31;&#x88AB;&#x6254;&#x6389;&#x3002; &#x5982;&#x679C;&#x503C;&#x7684;&#x6570;&#x91CF;&#x4E0D;&#x591F;&#x9700;&#x6C42;&#xFF0C; &#x5C06;&#x4F1A;&#x6309;&#x6240;&#x9700;&#x6269;&#x5C55;&#x82E5;&#x5E72;&#x4E2A; nil&#x3002; &#x5982;&#x679C;&#x8868;&#x8FBE;&#x5F0F;&#x5217;&#x8868;&#x4EE5;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7ED3;&#x675F;&#xFF0C; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6240;&#x8FD4;&#x56DE;&#x7684;&#x6240;&#x6709;&#x503C;&#x90FD;&#x4F1A;&#x5728;&#x8C03;&#x6574;&#x64CD;&#x4F5C;&#x4E4B;&#x524D;&#x88AB;&#x7F6E;&#x5165;&#x503C;&#x5217;&#x8868;&#x4E2D; &#xFF08;&#x9664;&#x975E;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x88AB;&#x7528;&#x62EC;&#x53F7;&#x62EC;&#x4E86;&#x8D77;&#x6765;&#xFF1B;&#x53C2;&#x89C1; &#xA7;3.4&#xFF09;&#x3002;</p>
<p>&#x8D4B;&#x503C;&#x8BED;&#x53E5;&#x9996;&#x5148;&#x8BA9;&#x6240;&#x6709;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x5B8C;&#x6210;&#x8FD0;&#x7B97;&#xFF0C; &#x4E4B;&#x540E;&#x518D;&#x505A;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x4E0B;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;</p>
<pre><code> i = 3
 i, a[i] = i+1, 20
</code></pre><p>&#x4F1A;&#x628A; a[3] &#x8BBE;&#x7F6E;&#x4E3A; 20&#xFF0C;&#x800C;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5230; a[4] &#x3002; &#x8FD9;&#x662F;&#x56E0;&#x4E3A; a[i] &#x4E2D;&#x7684; i &#x5728;&#x88AB;&#x8D4B;&#x503C;&#x4E3A; 4 &#x4E4B;&#x524D;&#x5C31;&#x88AB;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x4E86;&#xFF08;&#x5F53;&#x65F6;&#x662F; 3 &#xFF09;&#x3002; &#x7B80;&#x5355;&#x8BF4; &#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x884C;</p>
<pre><code> x, y = y, x
</code></pre><p>&#x4F1A;&#x4EA4;&#x6362; x &#x548C; y &#x7684;&#x503C;&#xFF0C; &#x53CA;</p>
<pre><code> x, y, z = y, z, x
</code></pre><p>&#x4F1A;&#x8F6E;&#x6362; x&#xFF0C;y&#xFF0C;z &#x7684;&#x503C;&#x3002;</p>
<p>&#x5BF9;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x4EE5;&#x53CA;&#x8868;&#x7684;&#x57DF;&#x7684;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x7684;&#x542B;&#x4E49;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5143;&#x8868;&#x6765;&#x6539;&#x53D8;&#x3002; &#x5BF9; t[i] = val &#x8FD9;&#x6837;&#x7684;&#x53D8;&#x91CF;&#x7D22;&#x5F15;&#x8D4B;&#x503C;&#xFF0C; &#x7B49;&#x4EF7;&#x4E8E; settable_event(t,i,val)&#x3002; &#xFF08;&#x5173;&#x4E8E;&#x51FD;&#x6570; settable_event &#x7684;&#x8BE6;&#x7EC6;&#x8BF4;&#x660E;&#xFF0C;&#x53C2;&#x89C1; &#xA7;2.4&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5E76;&#x6CA1;&#x6709;&#x5728; Lua &#x4E2D;&#x5B9A;&#x4E49;&#x51FA;&#x6765;&#xFF0C;&#x4E5F;&#x4E0D;&#x53EF;&#x4EE5;&#x88AB;&#x8C03;&#x7528;&#x3002; &#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5217;&#x51FA;&#x6765;&#xFF0C;&#x4EC5;&#x4EC5;&#x51FA;&#x4E8E;&#x65B9;&#x4FBF;&#x89E3;&#x91CA;&#x7684;&#x76EE;&#x7684;&#x3002;&#xFF09;</p>
<p>&#x5BF9;&#x4E8E;&#x5168;&#x5C40;&#x53D8;&#x91CF; x = val &#x7684;&#x8D4B;&#x503C;&#x7B49;&#x4EF7;&#x4E8E; _ENV.x = val &#xFF08;&#x53C2;&#x89C1; &#xA7;2.2&#xFF09;&#x3002;</p>
<h3 id="&#x63A7;&#x5236;&#x7ED3;&#x6784;">&#x63A7;&#x5236;&#x7ED3;&#x6784; <a href="#&#x63A7;&#x5236;&#x7ED3;&#x6784;"> # </a></h3>
<p>if, while, and repeat &#x8FD9;&#x4E9B;&#x63A7;&#x5236;&#x7ED3;&#x6784;&#x7B26;&#x5408;&#x901A;&#x5E38;&#x7684;&#x610F;&#x4E49;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x6709;&#x7C7B;&#x4F3C;&#x7684;&#x8BED;&#x6CD5;&#xFF1A;</p>
<pre><code>stat ::= while exp do block end
stat ::= repeat block until exp
stat ::= if exp then block {elseif exp then block} [else block] end
</code></pre><p>Lua &#x4E5F;&#x6709;&#x4E00;&#x4E2A; for &#x8BED;&#x53E5;&#xFF0C;&#x5B83;&#x6709;&#x4E24;&#x79CD;&#x5F62;&#x5F0F; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.5&#xFF09;&#x3002;</p>
<p>&#x63A7;&#x5236;&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x6761;&#x4EF6;&#x8868;&#x8FBE;&#x5F0F;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x4EFB;&#x4F55;&#x503C;&#x3002; false &#x4E0E; nil &#x4E24;&#x8005;&#x90FD;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x5047;&#x3002; &#x6240;&#x6709;&#x4E0D;&#x540C;&#x4E8E; nil &#x4E0E; false &#x7684;&#x5176;&#x5B83;&#x503C;&#x90FD;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x771F; &#xFF08;&#x7279;&#x522B;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x6570;&#x5B57; 0 &#x548C;&#x7A7A;&#x5B57;&#x7B26;&#x4E32;&#x4E5F;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x771F;&#xFF09;&#x3002;</p>
<p>&#x5728; repeat&#x2013;until &#x5FAA;&#x73AF;&#x4E2D;&#xFF0C; &#x5185;&#x90E8;&#x8BED;&#x53E5;&#x5757;&#x7684;&#x7ED3;&#x675F;&#x70B9;&#x4E0D;&#x662F;&#x5728; until &#x8FD9;&#x4E2A;&#x5173;&#x952E;&#x5B57;&#x5904;&#xFF0C; &#x5B83;&#x8FD8;&#x5305;&#x62EC;&#x4E86;&#x5176;&#x540E;&#x7684;&#x6761;&#x4EF6;&#x8868;&#x8FBE;&#x5F0F;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x6761;&#x4EF6;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5FAA;&#x73AF;&#x5185;&#x90E8;&#x8BED;&#x53E5;&#x5757;&#x4E2D;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x3002;</p>
<p>goto &#x8BED;&#x53E5;&#x5C06;&#x7A0B;&#x5E8F;&#x7684;&#x63A7;&#x5236;&#x70B9;&#x8F6C;&#x79FB;&#x5230;&#x4E00;&#x4E2A;&#x6807;&#x7B7E;&#x5904;&#x3002; &#x7531;&#x4E8E;&#x53E5;&#x6CD5;&#x4E0A;&#x7684;&#x539F;&#x56E0;&#xFF0C; Lua &#x91CC;&#x7684;&#x6807;&#x7B7E;&#x4E5F;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x8BED;&#x53E5;&#xFF1A;</p>
<pre><code>stat ::= goto Name
stat ::= label
label ::= &#x2018;::&#x2019; Name &#x2018;::&#x2019;
</code></pre><p>&#x9664;&#x4E86;&#x5728;&#x5185;&#x5D4C;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x5185;&#x5D4C;&#x8BED;&#x53E5;&#x5757;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;&#x540C;&#x540D;&#x6807;&#x7B7E;&#xFF0C;&#x7684;&#x60C5;&#x51B5;&#x5916;&#xFF0C; &#x6807;&#x7B7E;&#x5BF9;&#x4E8E;&#x5B83;&#x5B9A;&#x4E49;&#x6240;&#x5728;&#x7684;&#x6574;&#x4E2A;&#x8BED;&#x53E5;&#x5757;&#x53EF;&#x89C1;&#x3002; &#x53EA;&#x8981; goto &#x6CA1;&#x6709;&#x8FDB;&#x5165;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x4F5C;&#x7528;&#x57DF;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x8DF3;&#x8F6C;&#x5230;&#x4EFB;&#x610F;&#x53EF;&#x89C1;&#x6807;&#x7B7E;&#x5904;&#x3002;</p>
<p>&#x6807;&#x7B7E;&#x548C;&#x6CA1;&#x6709;&#x5185;&#x5BB9;&#x7684;&#x8BED;&#x53E5;&#x88AB;&#x79F0;&#x4E3A;&#x7A7A;&#x8BED;&#x53E5;&#xFF0C;&#x5B83;&#x4EEC;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x3002;</p>
<p>break &#x88AB;&#x7528;&#x6765;&#x7ED3;&#x675F; while&#x3001; repeat&#x3001;&#x6216; for &#x5FAA;&#x73AF;&#xFF0C; &#x5B83;&#x5C06;&#x8DF3;&#x5230;&#x5FAA;&#x73AF;&#x5916;&#x63A5;&#x7740;&#x4E4B;&#x540E;&#x7684;&#x8BED;&#x53E5;&#x8FD0;&#x884C;&#xFF1A;</p>
<pre><code>stat ::= break
</code></pre><p>break &#x8DF3;&#x51FA;&#x6700;&#x5185;&#x5C42;&#x7684;&#x5FAA;&#x73AF;&#x3002;</p>
<p>return &#x88AB;&#x7528;&#x4E8E;&#x4ECE;&#x51FD;&#x6570;&#x6216;&#x662F;&#x4EE3;&#x7801;&#x5757;&#xFF08;&#x5176;&#x5B9E;&#x5B83;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF09; &#x4E2D;&#x8FD4;&#x56DE;&#x503C;&#x3002; &#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x4E0D;&#x6B62;&#x4E00;&#x4E2A;&#x503C;&#xFF0C;&#x6240;&#x4EE5; return &#x7684;&#x8BED;&#x6CD5;&#x4E3A;</p>
<pre><code>stat ::= return [explist] [&#x2018;;&#x2019;]
</code></pre><p>return &#x53EA;&#x80FD;&#x88AB;&#x5199;&#x5728;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x5757;&#x7684;&#x6700;&#x540E;&#x4E00;&#x53E5;&#x3002; &#x5982;&#x679C;&#x4F60;&#x771F;&#x7684;&#x9700;&#x8981;&#x4ECE;&#x8BED;&#x53E5;&#x5757;&#x7684;&#x4E2D;&#x95F4; return&#xFF0C; &#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x7684;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x5185;&#x90E8;&#x8BED;&#x53E5;&#x5757;&#xFF0C; &#x4E00;&#x822C;&#x5199;&#x4F5C; do return end&#x3002; &#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x5199;&#x662F;&#x56E0;&#x4E3A;&#x73B0;&#x5728; return &#x6210;&#x4E86;&#xFF08;&#x5185;&#x90E8;&#xFF09;&#x8BED;&#x53E5;&#x5757;&#x7684;&#x6700;&#x540E;&#x4E00;&#x53E5;&#x4E86;&#x3002;</p>
<h3 id="For &#x8BED;&#x53E5;">For &#x8BED;&#x53E5; <a href="#For &#x8BED;&#x53E5;"> # </a></h3>
<p>for &#x6709;&#x4E24;&#x79CD;&#x5F62;&#x5F0F;&#xFF1A;&#x4E00;&#x79CD;&#x662F;&#x6570;&#x5B57;&#x5F62;&#x5F0F;&#xFF0C;&#x53E6;&#x4E00;&#x79CD;&#x662F;&#x901A;&#x7528;&#x5F62;&#x5F0F;&#x3002;</p>
<p>&#x6570;&#x5B57;&#x5F62;&#x5F0F;&#x7684; for &#x5FAA;&#x73AF;&#xFF0C;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x4E0D;&#x65AD;&#x5730;&#x8FD0;&#x884C;&#x5185;&#x90E8;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x3002; &#x4E0B;&#x9762;&#x662F;&#x5B83;&#x7684;&#x8BED;&#x6CD5;&#xFF1A;</p>
<pre><code>stat ::= for Name &#x2018;=&#x2019; exp &#x2018;,&#x2019; exp [&#x2018;,&#x2019; exp] do block end
</code></pre><p>block &#x5C06;&#x628A; name &#x4F5C;&#x5FAA;&#x73AF;&#x53D8;&#x91CF;&#x3002; &#x4ECE;&#x7B2C;&#x4E00;&#x4E2A; exp &#x5F00;&#x59CB;&#x8D77;&#xFF0C;&#x76F4;&#x5230;&#x7B2C;&#x4E8C;&#x4E2A; exp &#x7684;&#x503C;&#x4E3A;&#x6B62;&#xFF0C; &#x5176;&#x6B65;&#x957F;&#x4E3A;&#x7B2C;&#x4E09;&#x4E2A; exp &#x3002; &#x66F4;&#x786E;&#x5207;&#x7684;&#x8BF4;&#xFF0C;&#x4E00;&#x4E2A; for &#x5FAA;&#x73AF;&#x770B;&#x8D77;&#x6765;&#x662F;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;</p>
<pre><code> for v = e1, e2, e3 do block end
</code></pre><p>&#x8FD9;&#x7B49;&#x4EF7;&#x4E8E;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code> do
   local var, limit, step = tonumber(e1), tonumber(e2), tonumber(e3)
   if not (var and limit and step) then error() end
   var = var - step
   while true do
     var = var + step
     if (step &gt;= 0 and var &gt; limit) or (step &lt; 0 and var &lt; limit) then
       break
     end
     local v = var
     block
   end
 end
</code></pre><p>&#x6CE8;&#x610F;&#x4E0B;&#x9762;&#x8FD9;&#x51E0;&#x70B9;&#xFF1A;</p>
<p>&#x6240;&#x6709;&#x4E09;&#x4E2A;&#x63A7;&#x5236;&#x8868;&#x8FBE;&#x5F0F;&#x90FD;&#x53EA;&#x88AB;&#x8FD0;&#x7B97;&#x4E00;&#x6B21;&#xFF0C; &#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x8BA1;&#x7B97;&#x5728;&#x5FAA;&#x73AF;&#x5F00;&#x59CB;&#x4E4B;&#x524D;&#x3002; &#x8FD9;&#x4E9B;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7ED3;&#x679C;&#x5FC5;&#x987B;&#x662F;&#x6570;&#x5B57;&#x3002;
var&#xFF0C;limit&#xFF0C;&#x4EE5;&#x53CA; step &#x90FD;&#x662F;&#x4E00;&#x4E9B;&#x4E0D;&#x53EF;&#x89C1;&#x7684;&#x53D8;&#x91CF;&#x3002; &#x8FD9;&#x91CC;&#x7ED9;&#x5B83;&#x4EEC;&#x8D77;&#x7684;&#x540D;&#x5B57;&#x90FD;&#x4EC5;&#x4EC5;&#x7528;&#x4E8E;&#x89E3;&#x91CA;&#x65B9;&#x4FBF;&#x3002;
&#x5982;&#x679C;&#x7B2C;&#x4E09;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#xFF08;&#x6B65;&#x957F;&#xFF09;&#x6CA1;&#x6709;&#x7ED9;&#x51FA;&#xFF0C;&#x4F1A;&#x628A;&#x6B65;&#x957F;&#x8BBE;&#x4E3A; 1 &#x3002;
&#x4F60;&#x53EF;&#x4EE5;&#x7528; break &#x548C; goto &#x6765;&#x9000;&#x51FA; for &#x5FAA;&#x73AF;&#x3002;
&#x5FAA;&#x73AF;&#x53D8;&#x91CF; v &#x662F;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x5185;&#x90E8;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF1B; &#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x5728;&#x5FAA;&#x73AF;&#x7ED3;&#x675F;&#x540E;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x503C;&#xFF0C; &#x5728;&#x9000;&#x51FA;&#x5FAA;&#x73AF;&#x524D;&#x628A;&#x5B83;&#x8D4B;&#x7ED9;&#x53E6;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x3002;
&#x901A;&#x7528;&#x5F62;&#x5F0F;&#x7684; for &#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x53EB;&#x4F5C; &#x8FED;&#x4EE3;&#x5668; &#x7684;&#x51FD;&#x6570;&#x5DE5;&#x4F5C;&#x3002; &#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#xFF0C;&#x8FED;&#x4EE3;&#x5668;&#x51FD;&#x6570;&#x90FD;&#x4F1A;&#x88AB;&#x8C03;&#x7528;&#x4EE5;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x503C;&#xFF0C; &#x5F53;&#x8FD9;&#x4E2A;&#x503C;&#x4E3A; nil &#x65F6;&#xFF0C;&#x5FAA;&#x73AF;&#x505C;&#x6B62;&#x3002; &#x901A;&#x7528;&#x5F62;&#x5F0F;&#x7684; for &#x5FAA;&#x73AF;&#x7684;&#x8BED;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>stat ::= for namelist in explist do block end
namelist ::= Name {&#x2018;,&#x2019; Name}
</code></pre><p>&#x8FD9;&#x6837;&#x7684; for &#x8BED;&#x53E5;</p>
<pre><code> for var_1, &#xB7;&#xB7;&#xB7;, var_n in explist do block end
</code></pre><p>&#x5B83;&#x7B49;&#x4EF7;&#x4E8E;&#x8FD9;&#x6837;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code> do
   local f, s, var = explist
   while true do
     local var_1, &#xB7;&#xB7;&#xB7;, var_n = f(s, var)
     if var_1 == nil then break end
     var = var_1
     block
   end
 end
</code></pre><p>&#x6CE8;&#x610F;&#x4EE5;&#x4E0B;&#x51E0;&#x70B9;&#xFF1A;</p>
<p>explist &#x53EA;&#x4F1A;&#x88AB;&#x8BA1;&#x7B97;&#x4E00;&#x6B21;&#x3002; &#x5B83;&#x8FD4;&#x56DE;&#x4E09;&#x4E2A;&#x503C;&#xFF0C; &#x4E00;&#x4E2A; &#x8FED;&#x4EE3;&#x5668; &#x51FD;&#x6570;&#xFF0C; &#x4E00;&#x4E2A; &#x72B6;&#x6001;&#xFF0C; &#x4E00;&#x4E2A; &#x8FED;&#x4EE3;&#x5668;&#x7684;&#x521D;&#x59CB;&#x503C;&#x3002;
f&#xFF0C; s&#xFF0C;&#x4E0E; var &#x90FD;&#x662F;&#x4E0D;&#x53EF;&#x89C1;&#x7684;&#x53D8;&#x91CF;&#x3002; &#x8FD9;&#x91CC;&#x7ED9;&#x5B83;&#x4EEC;&#x8D77;&#x7684;&#x540D;&#x5B57;&#x90FD;&#x53EA;&#x662F;&#x4E3A;&#x4E86;&#x89E3;&#x8BF4;&#x65B9;&#x4FBF;&#x3002;
&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; break &#x6765;&#x8DF3;&#x51FA; for &#x5FAA;&#x73AF;&#x3002;
&#x73AF;&#x53D8;&#x91CF; var_i &#x5BF9;&#x4E8E;&#x5FAA;&#x73AF;&#x6765;&#x8BF4;&#x662F;&#x4E00;&#x4E2A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF1B; &#x4F60;&#x4E0D;&#x53EF;&#x4EE5;&#x5728; for &#x5FAA;&#x73AF;&#x7ED3;&#x675F;&#x540E;&#x7EE7;&#x7EED;&#x4F7F;&#x7528;&#x3002; &#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x4FDD;&#x7559;&#x8FD9;&#x4E9B;&#x503C;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x5728;&#x5FAA;&#x73AF;&#x8DF3;&#x51FA;&#x6216;&#x7ED3;&#x675F;&#x524D;&#x8D4B;&#x503C;&#x5230;&#x522B;&#x7684;&#x53D8;&#x91CF;&#x91CC;&#x53BB;&#x3002;</p>
<h3 id="&#x51FD;&#x6570;&#x8C03;&#x7528;&#x8BED;&#x53E5;">&#x51FD;&#x6570;&#x8C03;&#x7528;&#x8BED;&#x53E5; <a href="#&#x51FD;&#x6570;&#x8C03;&#x7528;&#x8BED;&#x53E5;"> # </a></h3>
<p>&#x4E3A;&#x4E86;&#x5141;&#x8BB8;&#x4F7F;&#x7528;&#x51FD;&#x6570;&#x7684;&#x526F;&#x4F5C;&#x7528;&#xFF0C; &#x51FD;&#x6570;&#x8C03;&#x7528;&#x53EF;&#x4EE5;&#x88AB;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x6267;&#x884C;&#xFF1A;</p>
<pre><code>stat ::= functioncall
</code></pre><p>&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x90FD;&#x88AB;&#x820D;&#x5F03;&#x3002; &#x51FD;&#x6570;&#x8C03;&#x7528;&#x5728; &#xA7;3.4.10 &#x4E2D;&#x89E3;&#x91CA;&#x3002;</p>
<h3 id="&#x5C40;&#x90E8;&#x58F0;&#x660E;">&#x5C40;&#x90E8;&#x58F0;&#x660E; <a href="#&#x5C40;&#x90E8;&#x58F0;&#x660E;"> # </a></h3>
<p>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x53EF;&#x4EE5;&#x5728;&#x8BED;&#x53E5;&#x5757;&#x4E2D;&#x4EFB;&#x4F55;&#x5730;&#x65B9;&#x58F0;&#x660E;&#x3002; &#x58F0;&#x660E;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x521D;&#x59CB;&#x5316;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#xFF1A;</p>
<pre><code>stat ::= local namelist [&#x2018;=&#x2019; explist]
</code></pre><p>&#x5982;&#x679C;&#x6709;&#x521D;&#x59CB;&#x5316;&#x503C;&#x7684;&#x8BDD;&#xFF0C;&#x521D;&#x59CB;&#x5316;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x7684;&#x8BED;&#x6CD5;&#x548C;&#x8D4B;&#x503C;&#x64CD;&#x4F5C;&#x4E00;&#x81F4; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.3 &#xFF09;&#x3002; &#x82E5;&#x6CA1;&#x6709;&#x521D;&#x59CB;&#x5316;&#x503C;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x53D8;&#x91CF;&#x90FD;&#x88AB;&#x521D;&#x59CB;&#x5316;&#x4E3A; nil&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x540C;&#x65F6;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x5757;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.2&#xFF09;&#xFF0C; &#x6240;&#x4EE5;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x53EF;&#x4EE5;&#x653E;&#x5728;&#x4EE3;&#x7801;&#x5757;&#x4E2D;&#x90A3;&#x4E9B;&#x663E;&#x5F0F;&#x6CE8;&#x660E;&#x7684;&#x8BED;&#x53E5;&#x5757;&#x4E4B;&#x5916;&#x3002;</p>
<p>&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x53EF;&#x89C1;&#x6027;&#x89C4;&#x5219;&#x5728; &#xA7;3.5 &#x4E2D;&#x89E3;&#x91CA;&#x3002;</p>
<h2 id="&#x8868;&#x8FBE;&#x5F0F;">&#x8868;&#x8FBE;&#x5F0F; <a href="#&#x8868;&#x8FBE;&#x5F0F;"> # </a></h2>
<p>Lua &#x4E2D;&#x6709;&#x8FD9;&#x4E9B;&#x57FA;&#x672C;&#x8868;&#x8FBE;&#x5F0F;&#xFF1A;</p>
<pre><code>exp ::= prefixexp
exp ::= nil | false | true
exp ::= Numeral
exp ::= LiteralString
exp ::= functiondef
exp ::= tableconstructor
exp ::= &#x2018;...&#x2019;
exp ::= exp binop exp
exp ::= unop exp
prefixexp ::= var | functioncall | &#x2018;(&#x2019; exp &#x2018;)&#x2019;
</code></pre><p>&#x6570;&#x5B57;&#x548C;&#x5B57;&#x9762;&#x4E32;&#x5728; &#xA7;3.1 &#x4E2D;&#x89E3;&#x91CA;&#xFF1B; &#x53D8;&#x91CF;&#x5728; &#xA7;3.2 &#x4E2D;&#x89E3;&#x91CA;&#xFF1B; &#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x5728; &#xA7;3.4.11 &#x4E2D;&#x89E3;&#x91CA;&#xFF1B; &#x51FD;&#x6570;&#x8C03;&#x7528;&#x5728; &#xA7;3.4.10 &#x4E2D;&#x89E3;&#x91CA;&#xFF1B; &#x8868;&#x7684;&#x6784;&#x9020;&#x5728; &#xA7;3.4.9 &#x4E2D;&#x89E3;&#x91CA;&#x3002; &#x53EF;&#x53D8;&#x53C2;&#x6570;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x5199;&#x4F5C;&#x4E09;&#x4E2A;&#x70B9;&#xFF08;&apos;...&apos;&#xFF09;&#xFF0C; &#x5B83;&#x53EA;&#x80FD;&#x5728;&#x6709;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x7684;&#x51FD;&#x6570;&#x4E2D;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#xFF1B;&#x8FD9;&#x4E9B;&#x5728; &#xA7;3.4.11 &#x4E2D;&#x89E3;&#x91CA;&#x3002;</p>
<p>&#x4E8C;&#x5143;&#x64CD;&#x4F5C;&#x7B26;&#x5305;&#x542B;&#x6709;&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.1&#xFF09;&#xFF0C; &#x4F4D;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.2&#xFF09;&#xFF0C; &#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.4&#xFF09;&#xFF0C; &#x903B;&#x8F91;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.5&#xFF09;&#xFF0C; &#x4EE5;&#x53CA;&#x8FDE;&#x63A5;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.6&#xFF09;&#x3002; &#x4E00;&#x5143;&#x64CD;&#x4F5C;&#x7B26;&#x5305;&#x62EC;&#x8D1F;&#x53F7;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.1&#xFF09;&#xFF0C; &#x6309;&#x4F4D;&#x975E;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.2&#xFF09;&#xFF0C; &#x903B;&#x8F91;&#x975E;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.5&#xFF09;&#xFF0C; &#x548C;&#x53D6;&#x957F;&#x5EA6;&#x64CD;&#x4F5C;&#x7B26;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.7&#xFF09;&#x3002;</p>
<p>&#x51FD;&#x6570;&#x8C03;&#x7528;&#x548C;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x8868;&#x8FBE;&#x5F0F;&#x90FD;&#x53EF;&#x4EE5;&#x653E;&#x5728;&#x591A;&#x91CD;&#x8FD4;&#x56DE;&#x503C;&#x4E2D;&#x3002; &#x5982;&#x679C;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x88AB;&#x5F53;&#x4F5C;&#x4E00;&#x6761;&#x8BED;&#x53E5;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.6&#xFF09;&#xFF0C; &#x5176;&#x8FD4;&#x56DE;&#x503C;&#x5217;&#x8868;&#x88AB;&#x8C03;&#x6574;&#x4E3A;&#x96F6;&#x4E2A;&#x5143;&#x7D20;&#xFF0C;&#x5373;&#x629B;&#x5F03;&#x6240;&#x6709;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002; &#x5982;&#x679C;&#x8868;&#x8FBE;&#x5F0F;&#x88AB;&#x7528;&#x4E8E;&#x8868;&#x8FBE;&#x5F0F;&#x5217;&#x8868;&#x7684;&#x6700;&#x540E;&#xFF08;&#x6216;&#x662F;&#x552F;&#x4E00;&#x7684;&#xFF09;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C; &#x90A3;&#x4E48;&#x4E0D;&#x4F1A;&#x505A;&#x4EFB;&#x4F55;&#x8C03;&#x6574;&#xFF08;&#x9664;&#x975E;&#x8868;&#x8FBE;&#x5F0F;&#x88AB;&#x62EC;&#x53F7;&#x62EC;&#x8D77;&#x6765;&#xFF09;&#x3002; &#x5728;&#x5176;&#x5B83;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C; Lua &#x90FD;&#x4F1A;&#x628A;&#x7ED3;&#x679C;&#x8C03;&#x6574;&#x4E3A;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x7F6E;&#x5165;&#x8868;&#x8FBE;&#x5F0F;&#x5217;&#x8868;&#x4E2D;&#xFF0C; &#x5373;&#x4FDD;&#x7559;&#x7B2C;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#x800C;&#x5FFD;&#x7565;&#x4E4B;&#x540E;&#x7684;&#x6240;&#x6709;&#x503C;&#xFF0C;&#x6216;&#x662F;&#x5728;&#x6CA1;&#x6709;&#x7ED3;&#x679C;&#x65F6;&#xFF0C; &#x8865;&#x5355;&#x4E2A; nil&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E9B;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code> f()                -- &#x8C03;&#x6574;&#x4E3A; 0 &#x4E2A;&#x7ED3;&#x679C;
 g(f(), x)          -- f() &#x4F1A;&#x88AB;&#x8C03;&#x6574;&#x4E3A;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;
 g(x, f())          -- g &#x6536;&#x5230; x &#x4EE5;&#x53CA; f() &#x8FD4;&#x56DE;&#x7684;&#x6240;&#x6709;&#x7ED3;&#x679C;
 a,b,c = f(), x     -- f() &#x88AB;&#x8C03;&#x6574;&#x4E3A; 1 &#x4E2A;&#x7ED3;&#x679C; &#xFF08;c &#x6536;&#x5230; nil&#xFF09;
 a,b = ...          -- a &#x6536;&#x5230;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x5217;&#x8868;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;
                    -- b &#x6536;&#x5230;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#xFF08;&#x5982;&#x679C;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x5217;&#x8868;&#x4E2D;
                    -- &#x6CA1;&#x6709;&#x5B9E;&#x9645;&#x7684;&#x53C2;&#x6570;&#xFF0C;a &#x548C; b &#x90FD;&#x4F1A;&#x6536;&#x5230; nil&#xFF09;

 a,b,c = x, f()     -- f() &#x88AB;&#x8C03;&#x6574;&#x4E3A; 2 &#x4E2A;&#x7ED3;&#x679C;
 a,b,c = f()        -- f() &#x88AB;&#x8C03;&#x6574;&#x4E3A; 3 &#x4E2A;&#x7ED3;&#x679C;
 return f()         -- &#x8FD4;&#x56DE; f() &#x7684;&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;
 return ...         -- &#x8FD4;&#x56DE;&#x4ECE;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x5217;&#x8868;&#x4E2D;&#x63A5;&#x6536;&#x5230;&#x7684;&#x6240;&#x6709;&#x53C2;&#x6570;parameters
 return x,y,f()     -- &#x8FD4;&#x56DE; x, y, &#x4EE5;&#x53CA; f() &#x7684;&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x503C;
 {f()}              -- &#x7528; f() &#x7684;&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5217;&#x8868;
 {...}              -- &#x7528;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x503C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5217;&#x8868;
 {f(), nil}         -- f() &#x88AB;&#x8C03;&#x6574;&#x4E3A;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;
</code></pre><p>&#x88AB;&#x62EC;&#x53F7;&#x62EC;&#x8D77;&#x6765;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x6C38;&#x8FDC;&#x88AB;&#x5F53;&#x4F5C;&#x4E00;&#x4E2A;&#x503C;&#x3002; &#x6240;&#x4EE5;&#xFF0C; (f(x,y,z)) &#x5373;&#x4F7F; f &#x8FD4;&#x56DE;&#x591A;&#x4E2A;&#x503C;&#xFF0C; &#x8FD9;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x6C38;&#x8FDC;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x4E00;&#x503C;&#x3002; &#xFF08;(f(x,y,z)) &#x7684;&#x503C;&#x662F; f &#x8FD4;&#x56DE;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x503C;&#x3002; &#x5982;&#x679C; f &#x4E0D;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x7684;&#x503C;&#x5C31;&#x662F; nil &#x3002;&#xFF09;</p>
<h3 id="&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x64CD;&#x4F5C;&#x7B26;">&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x64CD;&#x4F5C;&#x7B26; <a href="#&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x64CD;&#x4F5C;&#x7B26;"> # </a></h3>
<p>Lua &#x652F;&#x6301;&#x4E0B;&#x5217;&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x64CD;&#x4F5C;&#x7B26;&#xFF1A;</p>
<p>+: &#x52A0;&#x6CD5;
-: &#x51CF;&#x6CD5;
*: &#x4E58;&#x6CD5;
/: &#x6D6E;&#x70B9;&#x9664;&#x6CD5;
//: &#x5411;&#x4E0B;&#x53D6;&#x6574;&#x9664;&#x6CD5;
%: &#x53D6;&#x6A21;
^: &#x4E58;&#x65B9;
-: &#x53D6;&#x8D1F;
&#x9664;&#x4E86;&#x4E58;&#x65B9;&#x548C;&#x6D6E;&#x70B9;&#x9664;&#x6CD5;&#x8FD0;&#x7B97;&#xFF0C; &#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x6309;&#x5982;&#x4E0B;&#x65B9;&#x5F0F;&#x5DE5;&#x4F5C;&#xFF1A; &#x5982;&#x679C;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x90FD;&#x662F;&#x6574;&#x6570;&#xFF0C; &#x8BE5;&#x64CD;&#x4F5C;&#x4EE5;&#x6574;&#x6570;&#x65B9;&#x5F0F;&#x64CD;&#x4F5C;&#x4E14;&#x7ED3;&#x679C;&#x4E5F;&#x5C06;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x5F53;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x90FD;&#x662F;&#x6570;&#x5B57;&#x6216;&#x53EF;&#x4EE5;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26;&#x4E32; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.3&#xFF09;&#x65F6;&#xFF0C; &#x64CD;&#x4F5C;&#x6570;&#x4F1A;&#x88AB;&#x8F6C;&#x6362;&#x6210;&#x4E24;&#x4E2A;&#x6D6E;&#x70B9;&#x6570;&#xFF0C; &#x64CD;&#x4F5C;&#x6309;&#x901A;&#x5E38;&#x7684;&#x6D6E;&#x70B9;&#x89C4;&#x5219;&#xFF08;&#x4E00;&#x822C;&#x9075;&#x5FAA; IEEE 754 &#x6807;&#x51C6;&#xFF09; &#x6765;&#x8FDB;&#x884C;&#xFF0C;&#x7ED3;&#x679C;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x6D6E;&#x70B9;&#x6570;&#x3002;</p>
<p>&#x4E58;&#x65B9;&#x548C;&#x6D6E;&#x70B9;&#x9664;&#x6CD5; &#xFF08;/&#xFF09; &#x603B;&#x662F;&#x628A;&#x64CD;&#x4F5C;&#x6570;&#x8F6C;&#x6362;&#x6210;&#x6D6E;&#x70B9;&#x6570;&#x8FDB;&#x884C;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x603B;&#x662F;&#x6D6E;&#x70B9;&#x6570;&#x3002; &#x4E58;&#x65B9;&#x4F7F;&#x7528; ISO C &#x51FD;&#x6570; pow&#xFF0C; &#x56E0;&#x6B64;&#x5B83;&#x4E5F;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x975E;&#x6574;&#x6570;&#x7684;&#x6307;&#x6570;&#x3002;</p>
<p>&#x5411;&#x4E0B;&#x53D6;&#x6574;&#x7684;&#x9664;&#x6CD5; &#xFF08;//&#xFF09; &#x6307;&#x505A;&#x4E00;&#x6B21;&#x9664;&#x6CD5;&#xFF0C;&#x5E76;&#x5C06;&#x5546;&#x5706;&#x6574;&#x5230;&#x9760;&#x8FD1;&#x8D1F;&#x65E0;&#x7A77;&#x7684;&#x4E00;&#x4FA7;&#xFF0C; &#x5373;&#x5BF9;&#x64CD;&#x4F5C;&#x6570;&#x505A;&#x9664;&#x6CD5;&#x540E;&#x53D6; floor &#x3002;</p>
<p>&#x53D6;&#x6A21;&#x88AB;&#x5B9A;&#x4E49;&#x6210;&#x9664;&#x6CD5;&#x7684;&#x4F59;&#x6570;&#xFF0C;&#x5176;&#x5546;&#x88AB;&#x5706;&#x6574;&#x5230;&#x9760;&#x8FD1;&#x8D1F;&#x65E0;&#x7A77;&#x7684;&#x4E00;&#x4FA7;&#xFF08;&#x5411;&#x4E0B;&#x53D6;&#x6574;&#x7684;&#x9664;&#x6CD5;&#xFF09;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x6574;&#x6570;&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x7684;&#x6EA2;&#x51FA;&#x95EE;&#x9898;&#xFF0C; &#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x91C7;&#x53D6;&#x7684;&#x7B56;&#x7565;&#x662F;&#x6309;&#x901A;&#x5E38;&#x9075;&#x5FAA;&#x7684;&#x4EE5; 2 &#x4E3A;&#x8865;&#x7801;&#x7684;&#x6570;&#x5B66;&#x8FD0;&#x7B97;&#x7684; &#x73AF;&#x7ED5; &#x89C4;&#x5219;&#x3002; &#xFF08;&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF0C;&#x5B83;&#x4EEC;&#x8FD4;&#x56DE;&#x5176;&#x8FD0;&#x7B97;&#x7684;&#x6570;&#x5B66;&#x7ED3;&#x679C;&#x5BF9; 264 &#x53D6;&#x6A21;&#x540E;&#x7684;&#x6570;&#x5B57;&#x3002;&#xFF09;</p>
<h3 id="&#x4F4D;&#x64CD;&#x4F5C;&#x7B26;">&#x4F4D;&#x64CD;&#x4F5C;&#x7B26; <a href="#&#x4F4D;&#x64CD;&#x4F5C;&#x7B26;"> # </a></h3>
<p>Lua &#x652F;&#x6301;&#x4E0B;&#x5217;&#x4F4D;&#x64CD;&#x4F5C;&#x7B26;&#xFF1A;</p>
<p>&amp;: &#x6309;&#x4F4D;&#x4E0E;
|: &#x6309;&#x4F4D;&#x6216;
~: &#x6309;&#x4F4D;&#x5F02;&#x6216;</p>
<blockquote>
<blockquote>
<p>: &#x53F3;&#x79FB;
&lt;&lt;: &#x5DE6;&#x79FB;
~: &#x6309;&#x4F4D;&#x975E;
&#x6240;&#x6709;&#x7684;&#x4F4D;&#x64CD;&#x4F5C;&#x90FD;&#x5C06;&#x64CD;&#x4F5C;&#x6570;&#x5148;&#x8F6C;&#x6362;&#x4E3A;&#x6574;&#x6570; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.3&#xFF09;&#xFF0C; &#x7136;&#x540E;&#x6309;&#x4F4D;&#x64CD;&#x4F5C;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x3002;</p>
</blockquote>
</blockquote>
<p>&#x5BF9;&#x4E8E;&#x53F3;&#x79FB;&#x548C;&#x5DE6;&#x79FB;&#xFF0C;&#x5747;&#x7528;&#x96F6;&#x6765;&#x586B;&#x8865;&#x7A7A;&#x4F4D;&#x3002; &#x79FB;&#x52A8;&#x7684;&#x4F4D;&#x6570;&#x82E5;&#x4E3A;&#x8D1F;&#xFF0C;&#x5219;&#x5411;&#x53CD;&#x65B9;&#x5411;&#x4F4D;&#x79FB;&#xFF1B; &#x82E5;&#x79FB;&#x52A8;&#x7684;&#x4F4D;&#x6570;&#x7684;&#x7EDD;&#x5BF9;&#x503C;&#x5927;&#x4E8E;&#x7B49;&#x4E8E; &#x6574;&#x6570;&#x672C;&#x8EAB;&#x7684;&#x4F4D;&#x6570;&#xFF0C;&#x5176;&#x7ED3;&#x679C;&#x4E3A;&#x96F6; &#xFF08;&#x6240;&#x6709;&#x4F4D;&#x90FD;&#x88AB;&#x79FB;&#x51FA;&#xFF09;&#x3002;</p>
<h3 id="&#x5F3A;&#x5236;&#x8F6C;&#x6362;">&#x5F3A;&#x5236;&#x8F6C;&#x6362; <a href="#&#x5F3A;&#x5236;&#x8F6C;&#x6362;"> # </a></h3>
<p>Lua &#x5BF9;&#x4E00;&#x4E9B;&#x7C7B;&#x578B;&#x548C;&#x503C;&#x7684;&#x5185;&#x90E8;&#x8868;&#x793A;&#x4F1A;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x505A;&#x4E00;&#x4E9B;&#x6570;&#x5B66;&#x8F6C;&#x6362;&#x3002; &#x4F4D;&#x64CD;&#x4F5C;&#x603B;&#x662F;&#x5C06;&#x6D6E;&#x70B9;&#x64CD;&#x4F5C;&#x6570;&#x8F6C;&#x6362;&#x6210;&#x6574;&#x6570;&#x3002; &#x4E58;&#x65B9;&#x548C;&#x6D6E;&#x70B9;&#x9664;&#x6CD5;&#x603B;&#x662F;&#x5C06;&#x6574;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x6D6E;&#x70B9;&#x6570;&#x3002; &#x5176;&#x5B83;&#x6570;&#x5B66;&#x64CD;&#x4F5C;&#x82E5;&#x9488;&#x5BF9;&#x6DF7;&#x5408;&#x64CD;&#x4F5C;&#x6570; &#xFF08;&#x6574;&#x6570;&#x548C;&#x6D6E;&#x70B9;&#x6570;&#xFF09;&#x5C06;&#x628A;&#x6574;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x6D6E;&#x70B9;&#x6570;&#xFF1B; &#x8FD9;&#x4E00;&#x70B9;&#x88AB;&#x79F0;&#x4E3A; &#x901A;&#x5E38;&#x89C4;&#x5219;&#x3002; C API &#x540C;&#x6837;&#x4F1A;&#x6309;&#x9700;&#x628A;&#x6574;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x6D6E;&#x70B9;&#x6570;&#x4EE5;&#x53CA; &#x628A;&#x6D6E;&#x70B9;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x6574;&#x6570;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x8FDE;&#x63A5;&#x64CD;&#x4F5C;&#x9664;&#x4E86;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x6570;&#x5B57;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x5F53;&#x64CD;&#x4F5C;&#x9700;&#x8981;&#x6570;&#x5B57;&#x65F6;&#xFF0C;Lua &#x8FD8;&#x4F1A;&#x628A;&#x5B57;&#x7B26;&#x4E32;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x5B57;&#x3002;</p>
<p>&#x5F53;&#x628A;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x6D6E;&#x70B9;&#x6570;&#x65F6;&#xFF0C; &#x82E5;&#x6574;&#x6570;&#x503C;&#x6070;&#x597D;&#x53EF;&#x4EE5;&#x8868;&#x793A;&#x4E3A;&#x4E00;&#x4E2A;&#x6D6E;&#x70B9;&#x6570;&#xFF0C;&#x90A3;&#x5C31;&#x53D6;&#x90A3;&#x4E2A;&#x6D6E;&#x70B9;&#x6570;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x8F6C;&#x6362;&#x4F1A;&#x53D6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x8F83;&#x5927;&#x503C;&#x6216;&#x8F83;&#x5C0F;&#x503C;&#x6765;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x6570;&#x3002; &#x8FD9;&#x79CD;&#x8F6C;&#x6362;&#x662F;&#x4E0D;&#x4F1A;&#x5931;&#x8D25;&#x7684;&#x3002;</p>
<p>&#x5C06;&#x6D6E;&#x70B9;&#x6570;&#x8F6C;&#x4E3A;&#x6574;&#x6570;&#x7684;&#x8FC7;&#x7A0B;&#x4F1A;&#x68C0;&#x67E5; &#x6D6E;&#x70B9;&#x6570;&#x80FD;&#x5426;&#x88AB;&#x51C6;&#x786E;&#x7684;&#x8868;&#x8FBE;&#x4E3A;&#x4E00;&#x4E2A;&#x6574;&#x6570; &#xFF08;&#x5373;&#xFF0C;&#x6D6E;&#x70B9;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x503C;&#x4E14;&#x5728;&#x6574;&#x6570;&#x53EF;&#x4EE5;&#x8868;&#x8FBE;&#x7684;&#x533A;&#x95F4;&#xFF09;&#x3002; &#x5982;&#x679C;&#x53EF;&#x4EE5;&#xFF0C;&#x7ED3;&#x679C;&#x5C31;&#x662F;&#x90A3;&#x4E2A;&#x6570;&#xFF0C;&#x5426;&#x5219;&#x8F6C;&#x6362;&#x5931;&#x8D25;&#x3002;</p>
<p>&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x5230;&#x6570;&#x5B57;&#x7684;&#x8F6C;&#x6362;&#x8FC7;&#x7A0B;&#x9075;&#x5FAA;&#x4EE5;&#x4E0B;&#x6D41;&#x7A0B;&#xFF1A; &#x9996;&#x5148;&#xFF0C;&#x9075;&#x5FAA;&#x6309; Lua &#x8BCD;&#x6CD5;&#x5206;&#x6790;&#x5668;&#x7684;&#x89C4;&#x5219;&#x5206;&#x6790;&#x8BED;&#x6CD5;&#x6765;&#x8F6C;&#x6362;&#x4E3A;&#x5BF9;&#x5E94;&#x7684; &#x6574;&#x6570;&#x6216;&#x6D6E;&#x70B9;&#x6570;&#x3002; &#xFF08;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x6709;&#x524D;&#x7F6E;&#x6216;&#x540E;&#x7F6E;&#x7684;&#x7A7A;&#x683C;&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x7B26;&#x53F7;&#x3002;&#xFF09; &#x7136;&#x540E;&#xFF0C;&#x7ED3;&#x679C;&#x6570;&#x5B57;&#x518D;&#x6309;&#x524D;&#x8FF0;&#x89C4;&#x5219;&#x8F6C;&#x6362;&#x4E3A;&#x6240;&#x9700;&#x8981;&#x7684;&#x7C7B;&#x578B;&#xFF08;&#x6D6E;&#x70B9;&#x6216;&#x6574;&#x6570;&#xFF09;&#x3002;</p>
<p>&#x4ECE;&#x6570;&#x5B57;&#x8F6C;&#x6362;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x4F7F;&#x7528;&#x975E;&#x6307;&#x5B9A;&#x7684;&#x4EBA;&#x53EF;&#x8BFB;&#x7684;&#x683C;&#x5F0F;&#x3002; &#x82E5;&#x60F3;&#x5B8C;&#x5168;&#x63A7;&#x5236;&#x6570;&#x5B57;&#x5230;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8F6C;&#x6362;&#x8FC7;&#x7A0B;&#xFF0C; &#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x5E93;&#x4E2D;&#x7684; format &#x51FD;&#x6570; &#xFF08;&#x53C2;&#x89C1; string.format&#xFF09;&#x3002;</p>
<h3 id="&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x7B26;">&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x7B26; <a href="#&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x7B26;"> # </a></h3>
<p>Lua &#x652F;&#x6301;&#x4E0B;&#x5217;&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x7B26;&#xFF1A;</p>
<p>==: &#x7B49;&#x4E8E;
~=: &#x4E0D;&#x7B49;&#x4E8E;
&lt;: &#x5C0F;&#x4E8E;</p>
<blockquote>
<p>: &#x5927;&#x4E8E;
&lt;=: &#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;
=: &#x5927;&#x4E8E;&#x7B49;&#x4E8E;
&#x8FD9;&#x4E9B;&#x64CD;&#x4F5C;&#x7684;&#x7ED3;&#x679C;&#x4E0D;&#x662F; false &#x5C31;&#x662F; true&#x3002;</p>
</blockquote>
<p>&#x7B49;&#x4E8E;&#x64CD;&#x4F5C; &#xFF08;==&#xFF09;&#x5148;&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x3002; &#x5982;&#x679C;&#x7C7B;&#x578B;&#x4E0D;&#x540C;&#xFF0C;&#x7ED3;&#x679C;&#x5C31;&#x662F; false&#x3002; &#x5426;&#x5219;&#xFF0C;&#x7EE7;&#x7EED;&#x6BD4;&#x8F83;&#x503C;&#x3002; &#x5B57;&#x7B26;&#x4E32;&#x6309;&#x4E00;&#x822C;&#x7684;&#x65B9;&#x5F0F;&#x6BD4;&#x8F83;&#x3002; &#x6570;&#x5B57;&#x9075;&#x5FAA;&#x4E8C;&#x5143;&#x64CD;&#x4F5C;&#x7684;&#x89C4;&#x5219;&#xFF1A; &#x5982;&#x679C;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x90FD;&#x662F;&#x6574;&#x6570;&#xFF0C; &#x5B83;&#x4EEC;&#x6309;&#x6574;&#x6570;&#x6BD4;&#x8F83;&#xFF1B; &#x5426;&#x5219;&#xFF0C;&#x5B83;&#x4EEC;&#x5148;&#x8F6C;&#x6362;&#x4E3A;&#x6D6E;&#x70B9;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x505A;&#x6BD4;&#x8F83;&#x3002;</p>
<p>&#x8868;&#xFF0C;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C;&#x4EE5;&#x53CA;&#x7EBF;&#x7A0B;&#x90FD;&#x6309;&#x5F15;&#x7528;&#x6BD4;&#x8F83;&#xFF1A; &#x53EA;&#x6709;&#x4E24;&#x8005;&#x5F15;&#x7528;&#x540C;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x65F6;&#x624D;&#x8BA4;&#x4E3A;&#x5B83;&#x4EEC;&#x76F8;&#x7B49;&#x3002; &#x6BCF;&#x6B21;&#x4F60;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x5BF9;&#x8C61;&#xFF08;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C;&#x6216;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF09;&#xFF0C; &#x65B0;&#x5BF9;&#x8C61;&#x90FD;&#x4E00;&#x5B9A;&#x548C;&#x5DF2;&#x6709;&#x4E14;&#x5B58;&#x5728;&#x7684;&#x5BF9;&#x8C61;&#x4E0D;&#x540C;&#x3002; &#x76F8;&#x540C;&#x5F15;&#x7528;&#x7684;&#x95ED;&#x5305;&#x4E00;&#x5B9A;&#x76F8;&#x7B49;&#x3002; &#x6709;&#x4EFB;&#x4F55;&#x53EF;&#x5BDF;&#x89C9;&#x7684;&#x5DEE;&#x5F02;&#xFF08;&#x4E0D;&#x540C;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x5B9A;&#x4E49;&#xFF09;&#x4E00;&#x5B9A;&#x4E0D;&#x7B49;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528; &quot;eq&quot; &#x5143;&#x65B9;&#x6CD5;&#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09; &#x6765;&#x6539;&#x53D8; Lua &#x6BD4;&#x8F83;&#x8868;&#x548C;&#x7528;&#x6237;&#x6570;&#x636E;&#x65F6;&#x7684;&#x65B9;&#x5F0F;&#x3002;</p>
<p>&#x7B49;&#x4E8E;&#x64CD;&#x4F5C;&#x4E0D;&#x4F1A;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x5B57;&#xFF0C;&#x53CD;&#x4E4B;&#x4EA6;&#x7136;&#x3002; &#x5373;&#xFF0C;&quot;0&quot;==0 &#x7ED3;&#x679C;&#x4E3A; false&#xFF0C; &#x4E14; t[0] &#x4E0E; t[&quot;0&quot;] &#x6307;&#x4EE3;&#x7740;&#x8868;&#x4E2D;&#x7684;&#x4E0D;&#x540C;&#x9879;&#x3002;</p>
<p>~= &#x64CD;&#x4F5C;&#x5B8C;&#x5168;&#x7B49;&#x4EF7;&#x4E8E; (==) &#x64CD;&#x4F5C;&#x7684;&#x53CD;&#x503C;&#x3002;</p>
<p>&#x5927;&#x5C0F;&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x4EE5;&#x4EE5;&#x4E0B;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x3002; &#x5982;&#x679C;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x6570;&#x5B57;&#xFF0C; &#x5B83;&#x4EEC;&#x6309;&#x4E8C;&#x5143;&#x64CD;&#x4F5C;&#x7684;&#x5E38;&#x89C4;&#x8FDB;&#x884C;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x5982;&#x679C;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#xFF0C; &#x5B83;&#x4EEC;&#x7684;&#x503C;&#x6309;&#x5F53;&#x524D;&#x7684;&#x533A;&#x57DF;&#x8BBE;&#x7F6E;&#x6765;&#x6BD4;&#x8F83;&#x3002; &#x518D;&#x5219;&#xFF0C;Lua &#x5C31;&#x8BD5;&#x7740;&#x8C03;&#x7528; &quot;lt&quot; &#x6216;&#x662F; &quot;le&quot; &#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09;&#x3002; a &gt; b &#x7684;&#x6BD4;&#x8F83;&#x88AB;&#x8F6C;&#x8BD1;&#x4E3A; b &lt; a&#xFF0C; a &gt;= b &#x88AB;&#x8F6C;&#x8BD1;&#x4E3A; b &lt;= a&#x3002;</p>
<p>3.4.5 &#x2013; &#x903B;&#x8F91;&#x64CD;&#x4F5C;&#x7B26;</p>
<p>Lua &#x4E2D;&#x7684;&#x903B;&#x8F91;&#x64CD;&#x4F5C;&#x7B26;&#x6709; and&#xFF0C; or&#xFF0C;&#x4EE5;&#x53CA; not&#x3002; &#x548C;&#x63A7;&#x5236;&#x7ED3;&#x6784;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.4&#xFF09;&#x4E00;&#x6837;&#xFF0C; &#x6240;&#x6709;&#x7684;&#x903B;&#x8F91;&#x64CD;&#x4F5C;&#x7B26;&#x628A; false &#x548C; nil &#x90FD;&#x4F5C;&#x4E3A;&#x5047;&#xFF0C; &#x800C;&#x5176;&#x5B83;&#x7684;&#x4E00;&#x5207;&#x90FD;&#x5F53;&#x4F5C;&#x771F;&#x3002;</p>
<p>&#x53D6;&#x53CD;&#x64CD;&#x4F5C; not &#x603B;&#x662F;&#x8FD4;&#x56DE; false &#x6216; true &#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002; &#x4E0E;&#x64CD;&#x4F5C;&#x7B26; and &#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4E3A; false &#x6216; nil &#x65F6; &#x8FD4;&#x56DE;&#x8FD9;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF1B; &#x5426;&#x5219;&#xFF0C;and &#x8FD4;&#x56DE;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x3002; &#x6216;&#x64CD;&#x4F5C;&#x7B26; or &#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4E0D;&#x4E3A; nil &#x4E5F;&#x4E0D;&#x4E3A; false &#x65F6;&#xFF0C; &#x8FD4;&#x56DE;&#x8FD9;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x3002; and &#x548C; or &#x90FD;&#x9075;&#x5FAA;&#x77ED;&#x8DEF;&#x89C4;&#x5219;&#xFF1B; &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x53EA;&#x5728;&#x9700;&#x8981;&#x7684;&#x65F6;&#x5019;&#x53BB;&#x6C42;&#x503C;&#x3002; &#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E9B;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code> 10 or 20            --&gt; 10
 10 or error()       --&gt; 10
 nil or &quot;a&quot;          --&gt; &quot;a&quot;
 nil and 10          --&gt; nil
 false and error()   --&gt; false
 false and nil       --&gt; false
 false or nil        --&gt; nil
 10 and 20           --&gt; 20
</code></pre><p>&#xFF08;&#x5728;&#x8FD9;&#x672C;&#x624B;&#x518C;&#x4E2D;&#xFF0C; --&gt; &#x6307;&#x524D;&#x9762;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x7ED3;&#x679C;&#x3002;&#xFF09;</p>
<p>3.4.6 &#x2013; &#x5B57;&#x7B26;&#x4E32;&#x8FDE;&#x63A5;</p>
<p>Lua &#x4E2D;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8FDE;&#x63A5;&#x64CD;&#x4F5C;&#x7B26;&#x5199;&#x4F5C;&#x4E24;&#x4E2A;&#x70B9;&#xFF08;&apos;..&apos;&#xFF09;&#x3002; &#x5982;&#x679C;&#x4E24;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x90FD;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x90FD;&#x662F;&#x6570;&#x5B57;&#xFF0C; &#x8FDE;&#x63A5;&#x64CD;&#x4F5C;&#x5C06;&#x4EE5; &#xA7;3.4.3 &#x4E2D;&#x63D0;&#x5230;&#x7684;&#x89C4;&#x5219;&#x628A;&#x5176;&#x8F6C;&#x6362;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;&#x5143;&#x65B9;&#x6CD5; __concat &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09;&#x3002;</p>
<p>3.4.7 &#x2013; &#x53D6;&#x957F;&#x5EA6;&#x64CD;&#x4F5C;&#x7B26;</p>
<p>&#x53D6;&#x957F;&#x5EA6;&#x64CD;&#x4F5C;&#x7B26;&#x5199;&#x4F5C;&#x4E00;&#x5143;&#x524D;&#x7F6E;&#x7B26; #&#x3002; &#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#x662F;&#x5B83;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF08;&#x5C31;&#x662F;&#x4EE5;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x8BA1;&#x7B97;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#xFF09;&#x3002;</p>
<p>&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; __len &#x5143;&#x65B9;&#x6CD5;&#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09; &#x6765;&#x4FEE;&#x6539;&#x5BF9;&#x5B57;&#x7B26;&#x4E32;&#x7C7B;&#x578B;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x503C;&#x7684;&#x53D6;&#x957F;&#x5EA6;&#x64CD;&#x4F5C;&#x884C;&#x4E3A;&#x3002;</p>
<p>&#x5982;&#x679C; __len &#x5143;&#x65B9;&#x6CD5;&#x6CA1;&#x6709;&#x7ED9;&#x51FA;&#xFF0C; &#x8868; t &#x7684;&#x957F;&#x5EA6;&#x53EA;&#x5728;&#x8868;&#x662F;&#x4E00;&#x4E2A; &#x5E8F;&#x5217; &#x65F6;&#x6709;&#x5B9A;&#x4E49;&#x3002; &#x5E8F;&#x5217;&#x6307;&#x8868;&#x7684;&#x6B63;&#x6570;&#x952E;&#x96C6;&#x7B49;&#x4E8E; {1..n} &#xFF0C; &#x5176;&#x4E2D; n &#x662F;&#x4E00;&#x4E2A;&#x975E;&#x8D1F;&#x6574;&#x6570;&#x3002; &#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;n &#x662F;&#x8868;&#x7684;&#x957F;&#x5EA6;&#x3002; &#x6CE8;&#x610F;&#x8FD9;&#x6837;&#x7684;&#x8868;</p>
<pre><code> {10, 20, nil, 40}
</code></pre><p>&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x6709;&#x952E; 4 &#x5374;&#x6CA1;&#x6709;&#x952E; 3&#x3002; &#xFF08;&#x56E0;&#x6B64;&#xFF0C;&#x8BE5;&#x8868;&#x7684;&#x6B63;&#x6574;&#x6570;&#x952E;&#x96C6;&#x4E0D;&#x7B49;&#x4E8E; {1..n} &#x96C6;&#x5408;&#xFF0C;&#x6545;&#x800C;&#x5C31;&#x4E0D;&#x5B58;&#x5728; n&#x3002;&#xFF09; &#x6CE8;&#x610F;&#xFF0C;&#x4E00;&#x5F20;&#x8868;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#x548C;&#x5B83;&#x7684;&#x975E;&#x6570;&#x5B57;&#x952E;&#x65E0;&#x5173;&#x3002;</p>
<p>3.4.8 &#x2013; &#x4F18;&#x5148;&#x7EA7;</p>
<p>Lua &#x4E2D;&#x64CD;&#x4F5C;&#x7B26;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x5199;&#x5728;&#x4E0B;&#x8868;&#x4E2D;&#xFF0C;&#x4ECE;&#x4F4E;&#x5230;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x6392;&#x5E8F;&#xFF1A;</p>
<pre><code> or
 and
 &lt;     &gt;     &lt;=    &gt;=    ~=    ==
 |
 ~
 &amp;
 &lt;&lt;    &gt;&gt;
 ..
 +     -
 *     /     //    %
 unary operators (not   #     -     ~)
 ^
</code></pre><p>&#x901A;&#x5E38;&#xFF0C; &#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x62EC;&#x53F7;&#x6765;&#x6539;&#x53D8;&#x8FD0;&#x7B97;&#x6B21;&#x5E8F;&#x3002; &#x8FDE;&#x63A5;&#x64CD;&#x4F5C;&#x7B26; (&apos;..&apos;) &#x548C;&#x4E58;&#x65B9;&#x64CD;&#x4F5C; (&apos;^&apos;) &#x662F;&#x4ECE;&#x53F3;&#x81F3;&#x5DE6;&#x7684;&#x3002; &#x5176;&#x5B83;&#x6240;&#x6709;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x662F;&#x4ECE;&#x5DE6;&#x81F3;&#x53F3;&#x3002;</p>
<p>3.4.9 &#x2013; &#x8868;&#x6784;&#x5EFA;</p>
<p>&#x8868;&#x6784;&#x9020;&#x5B50;&#x662F;&#x4E00;&#x4E2A;&#x6784;&#x9020;&#x8868;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x3002; &#x6BCF;&#x6B21;&#x6784;&#x9020;&#x5B50;&#x88AB;&#x6267;&#x884C;&#xFF0C;&#x90FD;&#x4F1A;&#x6784;&#x9020;&#x51FA;&#x4E00;&#x5F20;&#x65B0;&#x7684;&#x8868;&#x3002; &#x6784;&#x9020;&#x5B50;&#x53EF;&#x4EE5;&#x88AB;&#x7528;&#x6765;&#x6784;&#x9020;&#x4E00;&#x5F20;&#x7A7A;&#x8868;&#xFF0C; &#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x6784;&#x9020;&#x4E00;&#x5F20;&#x8868;&#x5E76;&#x521D;&#x59CB;&#x5316;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E9B;&#x57DF;&#x3002; &#x4E00;&#x822C;&#x7684;&#x6784;&#x9020;&#x5B50;&#x7684;&#x8BED;&#x6CD5;&#x5982;&#x4E0B;</p>
<pre><code>tableconstructor ::= &#x2018;{&#x2019; [fieldlist] &#x2018;}&#x2019;
fieldlist ::= field {fieldsep field} [fieldsep]
field ::= &#x2018;[&#x2019; exp &#x2018;]&#x2019; &#x2018;=&#x2019; exp | Name &#x2018;=&#x2019; exp | exp
fieldsep ::= &#x2018;,&#x2019; | &#x2018;;&#x2019;
</code></pre><p>&#x6BCF;&#x4E2A;&#x5F62;&#x5982; [exp1] = exp2 &#x7684;&#x57DF;&#x5411;&#x8868;&#x4E2D;&#x589E;&#x52A0;&#x65B0;&#x7684;&#x4E00;&#x9879;&#xFF0C; &#x5176;&#x952E;&#x4E3A; exp1 &#x800C;&#x503C;&#x4E3A; exp2&#x3002; &#x5F62;&#x5982; name = exp &#x7684;&#x57DF;&#x7B49;&#x4EF7;&#x4E8E; [&quot;name&quot;] = exp&#x3002; &#x6700;&#x540E;&#xFF0C;&#x5F62;&#x5982; exp &#x7684;&#x57DF;&#x7B49;&#x4EF7;&#x4E8E; [i] = exp &#xFF0C; &#x8FD9;&#x91CC;&#x7684; i &#x662F;&#x4E00;&#x4E2A;&#x4ECE; 1 &#x5F00;&#x59CB;&#x4E0D;&#x65AD;&#x589E;&#x957F;&#x7684;&#x6570;&#x5B57;&#x3002; &#x8FD9;&#x8FD9;&#x4E2A;&#x683C;&#x5F0F;&#x4E2D;&#x7684;&#x5176;&#x5B83;&#x57DF;&#x4E0D;&#x4F1A;&#x7834;&#x574F;&#x5176;&#x8BB0;&#x6570;&#x3002; &#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code> a = { [f(1)] = g; &quot;x&quot;, &quot;y&quot;; x = 1, f(x), [30] = 23; 45 }
</code></pre><p>&#x7B49;&#x4EF7;&#x4E8E;</p>
<pre><code> do
   local t = {}
   t[f(1)] = g
   t[1] = &quot;x&quot;         -- 1st exp
   t[2] = &quot;y&quot;         -- 2nd exp
   t.x = 1            -- t[&quot;x&quot;] = 1
   t[3] = f(x)        -- 3rd exp
   t[30] = 23
   t[4] = 45          -- 4th exp
   a = t
 end
</code></pre><p>&#x6784;&#x9020;&#x5B50;&#x4E2D;&#x8D4B;&#x503C;&#x7684;&#x6B21;&#x5E8F;&#x672A;&#x5B9A;&#x4E49;&#x3002; &#xFF08;&#x6B21;&#x5E8F;&#x95EE;&#x9898;&#x53EA;&#x4F1A;&#x5BF9;&#x90A3;&#x4E9B;&#x952E;&#x91CD;&#x590D;&#x65F6;&#x7684;&#x60C5;&#x51B5;&#x6709;&#x5F71;&#x54CD;&#x3002;&#xFF09;</p>
<p>&#x5982;&#x679C;&#x8868;&#x5355;&#x4E2D;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x57DF;&#x7684;&#x5F62;&#x5F0F;&#x662F; exp &#xFF0C; &#x800C;&#x4E14;&#x5176;&#x8868;&#x8FBE;&#x5F0F;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x6216;&#x8005;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#xFF0C; &#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x6240;&#x6709;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5C06;&#x4F9D;&#x6B21;&#x8FDB;&#x5165;&#x5217;&#x8868; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.10&#xFF09;&#x3002;</p>
<p>&#x521D;&#x59CB;&#x5316;&#x57DF;&#x8868;&#x53EF;&#x4EE5;&#x5728;&#x6700;&#x540E;&#x591A;&#x4E00;&#x4E2A;&#x5206;&#x5272;&#x7B26;&#xFF0C; &#x8FD9;&#x6837;&#x8BBE;&#x8BA1;&#x53EF;&#x4EE5;&#x65B9;&#x4FBF;&#x7531;&#x673A;&#x5668;&#x751F;&#x6210;&#x4EE3;&#x7801;&#x3002;</p>
<p>3.4.10 &#x2013; &#x51FD;&#x6570;&#x8C03;&#x7528;</p>
<p>Lua &#x4E2D;&#x7684;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x8BED;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>functioncall ::= prefixexp args
</code></pre><p>&#x51FD;&#x6570;&#x8C03;&#x7528;&#x65F6;&#xFF0C; &#x7B2C;&#x4E00;&#x6B65;&#xFF0C;prefixexp &#x548C; args &#x5148;&#x88AB;&#x6C42;&#x503C;&#x3002; &#x5982;&#x679C; prefixexp &#x7684;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x662F; function&#xFF0C; &#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x88AB;&#x7528;&#x7ED9;&#x51FA;&#x7684;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x3002; &#x5426;&#x5219; prefixexp &#x7684;&#x5143;&#x65B9;&#x6CD5; &quot;call&quot; &#x5C31;&#x88AB;&#x8C03;&#x7528;&#xFF0C; &#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F; prefixexp &#x7684;&#x503C;&#xFF0C; &#x63A5;&#x4E0B;&#x6765;&#x7684;&#x662F;&#x539F;&#x6765;&#x7684;&#x8C03;&#x7528;&#x53C2;&#x6570; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09;&#x3002;</p>
<p>&#x8FD9;&#x6837;&#x7684;&#x5F62;&#x5F0F;</p>
<pre><code>functioncall ::= prefixexp &#x2018;:&#x2019; Name args
</code></pre><p>&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x8C03;&#x7528; &quot;&#x65B9;&#x6CD5;&quot;&#x3002; &#x8FD9;&#x662F; Lua &#x652F;&#x6301;&#x7684;&#x4E00;&#x79CD;&#x8BED;&#x6CD5;&#x7CD6;&#x3002; &#x50CF; v:name(args) &#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#xFF0C; &#x88AB;&#x89E3;&#x91CA;&#x6210; v.name(v,args)&#xFF0C; &#x8FD9;&#x91CC;&#x7684; v &#x53EA;&#x4F1A;&#x88AB;&#x6C42;&#x503C;&#x4E00;&#x6B21;&#x3002;</p>
<p>&#x53C2;&#x6570;&#x7684;&#x8BED;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>args ::= &#x2018;(&#x2019; [explist] &#x2018;)&#x2019;
args ::= tableconstructor
args ::= LiteralString
</code></pre><p>&#x6240;&#x6709;&#x53C2;&#x6570;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x6C42;&#x503C;&#x90FD;&#x5728;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E4B;&#x524D;&#x3002; &#x8FD9;&#x6837;&#x7684;&#x8C03;&#x7528;&#x5F62;&#x5F0F; f{fields} &#x662F;&#x4E00;&#x79CD;&#x8BED;&#x6CD5;&#x7CD6;&#x7528;&#x4E8E;&#x8868;&#x793A; f({fields})&#xFF1B; &#x8FD9;&#x91CC;&#x6307;&#x53C2;&#x6570;&#x5217;&#x8868;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x5217;&#x8868;&#x3002; &#x800C;&#x8FD9;&#x6837;&#x7684;&#x5F62;&#x5F0F; f&apos;string&apos; &#xFF08;&#x6216;&#x662F; f&quot;string&quot; &#x4EA6;&#x6216;&#x662F; f[[string]]&#xFF09; &#x4E5F;&#x662F;&#x4E00;&#x79CD;&#x8BED;&#x6CD5;&#x7CD6;&#xFF0C;&#x7528;&#x4E8E;&#x8868;&#x793A; f(&apos;string&apos;)&#xFF1B; &#x6B64;&#x65F6;&#x7684;&#x53C2;&#x6570;&#x5217;&#x8868;&#x662F;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>return functioncall &#x8FD9;&#x6837;&#x7684;&#x8C03;&#x7528;&#x5F62;&#x5F0F;&#x5C06;&#x89E6;&#x53D1;&#x4E00;&#x6B21; &#x5C3E;&#x8C03;&#x7528;&#x3002; Lua &#x5B9E;&#x73B0;&#x4E86; &#x5B8C;&#x5168;&#x5C3E;&#x8C03;&#x7528;&#xFF08;&#x6216;&#x79F0;&#x4E3A; &#x5B8C;&#x5168;&#x5C3E;&#x9012;&#x5F52;&#xFF09;&#xFF1A; &#x5728;&#x5C3E;&#x8C03;&#x7528;&#x4E2D;&#xFF0C; &#x88AB;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x91CD;&#x7528;&#x8C03;&#x7528;&#x5B83;&#x7684;&#x51FD;&#x6570;&#x7684;&#x5806;&#x6808;&#x9879;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5BF9;&#x4E8E;&#x7A0B;&#x5E8F;&#x6267;&#x884C;&#x7684;&#x5D4C;&#x5957;&#x5C3E;&#x8C03;&#x7528;&#x7684;&#x5C42;&#x6570;&#x662F;&#x6CA1;&#x6709;&#x9650;&#x5236;&#x7684;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x5C3E;&#x8C03;&#x7528;&#x5C06;&#x5220;&#x9664;&#x8C03;&#x7528;&#x5B83;&#x7684;&#x51FD;&#x6570;&#x7684;&#x4EFB;&#x4F55;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x3002; &#x6CE8;&#x610F;&#xFF0C;&#x5C3E;&#x8C03;&#x7528;&#x53EA;&#x53D1;&#x751F;&#x5728;&#x7279;&#x5B9A;&#x7684;&#x8BED;&#x6CD5;&#x4E0B;&#xFF0C; &#x4EC5;&#x5F53; return &#x53EA;&#x6709;&#x5355;&#x4E00;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x65F6;&#x624D;&#x53D1;&#x751F;&#x5C3E;&#x8C03;&#x7528;&#xFF1B; &#x8FD9;&#x79CD;&#x8BED;&#x6CD5;&#x4F7F;&#x5F97;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x7684;&#x6240;&#x6709;&#x7ED3;&#x679C;&#x53EF;&#x4EE5;&#x5B8C;&#x6574;&#x5730;&#x8FD4;&#x56DE;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x4E0B;&#x9762;&#x8FD9;&#x4E9B;&#x4F8B;&#x5B50;&#x90FD;&#x4E0D;&#x662F;&#x5C3E;&#x8C03;&#x7528;&#xFF1A;</p>
<pre><code> return (f(x))        -- &#x8FD4;&#x56DE;&#x503C;&#x88AB;&#x8C03;&#x6574;&#x4E3A;&#x4E00;&#x4E2A;
 return 2 * f(x)
 return x, f(x)       -- &#x8FFD;&#x52A0;&#x82E5;&#x5E72;&#x8FD4;&#x56DE;&#x503C;
 f(x); return         -- &#x8FD4;&#x56DE;&#x503C;&#x5168;&#x90E8;&#x88AB;&#x820D;&#x5F03;
 return x or f(x)     -- &#x8FD4;&#x56DE;&#x503C;&#x88AB;&#x8C03;&#x6574;&#x4E3A;&#x4E00;&#x4E2A;
</code></pre><p>3.4.11 &#x2013; &#x51FD;&#x6570;&#x5B9A;&#x4E49;</p>
<p>&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x7684;&#x8BED;&#x6CD5;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code>functiondef ::= function funcbody
funcbody ::= &#x2018;(&#x2019; [parlist] &#x2018;)&#x2019; block end
</code></pre><p>&#x53E6;&#x5916;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E9B;&#x8BED;&#x6CD5;&#x7CD6;&#x7B80;&#x5316;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x7684;&#x5199;&#x6CD5;&#xFF1A;</p>
<pre><code>stat ::= function funcname funcbody
stat ::= local function Name funcbody
funcname ::= Name {&#x2018;.&#x2019; Name} [&#x2018;:&#x2019; Name]
</code></pre><p>&#x8BE5;&#x8BED;&#x53E5;</p>
<pre><code> function f () body end
</code></pre><p>&#x88AB;&#x8F6C;&#x8BD1;&#x6210;</p>
<pre><code> f = function () body end
</code></pre><p>&#x8BE5;&#x8BED;&#x53E5;</p>
<pre><code> function t.a.b.c.f () body end
</code></pre><p>&#x88AB;&#x8F6C;&#x8BD1;&#x6210;</p>
<pre><code> t.a.b.c.f = function () body end
</code></pre><p>&#x8BE5;&#x8BED;&#x53E5;</p>
<pre><code> local function f () body end
</code></pre><p>&#x88AB;&#x8F6C;&#x8BD1;&#x6210;</p>
<pre><code> local f; f = function () body end
</code></pre><p>&#x800C;&#x4E0D;&#x662F;</p>
<pre><code> local f = function () body end
</code></pre><p>&#xFF08;&#x8FD9;&#x4E2A;&#x5DEE;&#x522B;&#x53EA;&#x5728;&#x51FD;&#x6570;&#x4F53;&#x5185;&#x9700;&#x8981;&#x5F15;&#x7528; f &#x65F6;&#x624D;&#x6709;&#x3002;&#xFF09;</p>
<p>&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C; &#x6267;&#x884C;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x4E3A; function &#x7684;&#x503C;&#x3002; &#x5F53; Lua &#x9884;&#x7F16;&#x8BD1;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x65F6;&#xFF0C; &#x4EE3;&#x7801;&#x5757;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x6574;&#x4E2A;&#x51FD;&#x6570;&#x4F53;&#x4E5F;&#x5C31;&#x88AB;&#x9884;&#x7F16;&#x8BD1;&#x4E86;&#x3002; &#x90A3;&#x4E48;&#xFF0C;&#x65E0;&#x8BBA;&#x4F55;&#x65F6; Lua &#x6267;&#x884C;&#x4E86;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#xFF0C; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x672C;&#x8EAB;&#x5C31;&#x8FDB;&#x884C;&#x4E86; &#x5B9E;&#x4F8B;&#x5316;&#xFF08;&#x6216;&#x8005;&#x8BF4;&#x662F; &#x5173;&#x95ED;&#x4E86;&#xFF09;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x4F8B;&#xFF08;&#x6216;&#x8005;&#x8BF4;&#x662F; &#x95ED;&#x5305;&#xFF09;&#x662F;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x6700;&#x7EC8;&#x503C;&#x3002;</p>
<p>&#x5F62;&#x53C2;&#x88AB;&#x770B;&#x4F5C;&#x662F;&#x4E00;&#x4E9B;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF0C; &#x5B83;&#x4EEC;&#x5C06;&#x7531;&#x5B9E;&#x53C2;&#x7684;&#x503C;&#x6765;&#x521D;&#x59CB;&#x5316;&#xFF1A;</p>
<pre><code>parlist ::= namelist [&#x2018;,&#x2019; &#x2018;...&#x2019;] | &#x2018;...&#x2019;
</code></pre><p>&#x5F53;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#xFF0C; &#x5982;&#x679C;&#x51FD;&#x6570;&#x5E76;&#x975E;&#x4E00;&#x4E2A; &#x53EF;&#x53D8;&#x53C2;&#x6570;&#x51FD;&#x6570;&#xFF0C; &#x5373;&#x5728;&#x5F62;&#x53C2;&#x5217;&#x8868;&#x7684;&#x672B;&#x5C3E;&#x6CE8;&#x660E;&#x4E09;&#x4E2A;&#x70B9; (&apos;...&apos;)&#xFF0C; &#x90A3;&#x4E48;&#x5B9E;&#x53C2;&#x5217;&#x8868;&#x5C31;&#x4F1A;&#x88AB;&#x8C03;&#x6574;&#x5230;&#x5F62;&#x53C2;&#x5217;&#x8868;&#x7684;&#x957F;&#x5EA6;&#x3002; &#x53D8;&#x957F;&#x53C2;&#x6570;&#x51FD;&#x6570;&#x4E0D;&#x4F1A;&#x8C03;&#x6574;&#x5B9E;&#x53C2;&#x5217;&#x8868;&#xFF1B; &#x53D6;&#x800C;&#x4EE3;&#x4E4B;&#x7684;&#x662F;&#xFF0C;&#x5B83;&#x5C06;&#x628A;&#x6240;&#x6709;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;&#x653E;&#x5728;&#x4E00;&#x8D77;&#x901A;&#x8FC7; &#x53D8;&#x957F;&#x53C2;&#x6570;&#x8868;&#x8FBE;&#x5F0F;&#x4F20;&#x9012;&#x7ED9;&#x51FD;&#x6570;&#xFF0C; &#x5176;&#x5199;&#x6CD5;&#x4F9D;&#x65E7;&#x662F;&#x4E09;&#x4E2A;&#x70B9;&#x3002; &#x8FD9;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E32;&#x5B9E;&#x53C2;&#x503C;&#x7684;&#x5217;&#x8868;&#xFF0C; &#x770B;&#x8D77;&#x6765;&#x5C31;&#x8DDF;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x591A;&#x4E2A;&#x7ED3;&#x679C;&#x7684;&#x51FD;&#x6570;&#x4E00;&#x6837;&#x3002; &#x5982;&#x679C;&#x4E00;&#x4E2A;&#x53D8;&#x957F;&#x53C2;&#x6570;&#x8868;&#x8FBE;&#x5F0F;&#x653E;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x4E2D;&#x4F7F;&#x7528;&#xFF0C; &#x6216;&#x662F;&#x653E;&#x5728;&#x53E6;&#x4E00;&#x4E32;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x4E2D;&#x95F4;&#xFF0C; &#x90A3;&#x4E48;&#x5B83;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5C31;&#x4F1A;&#x88AB;&#x8C03;&#x6574;&#x4E3A;&#x5355;&#x4E2A;&#x503C;&#x3002; &#x82E5;&#x8FD9;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x653E;&#x5728;&#x4E86;&#x4E00;&#x7CFB;&#x5217;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#xFF0C; &#x5C31;&#x4E0D;&#x4F1A;&#x505A;&#x8C03;&#x6574;&#x4E86; &#xFF08;&#x9664;&#x975E;&#x8FD9;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x88AB;&#x62EC;&#x53F7;&#x7ED9;&#x62EC;&#x4E86;&#x8D77;&#x6765;&#xFF09;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x505A;&#x5982;&#x4E0B;&#x5B9A;&#x4E49;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x6765;&#x770B;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code> function f(a, b) end
 function g(a, b, ...) end
 function r() return 1,2,3 end
</code></pre><p>&#x4E0B;&#x9762;&#x770B;&#x770B;&#x5B9E;&#x53C2;&#x5230;&#x5F62;&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x53EF;&#x53D8;&#x957F;&#x53C2;&#x6570;&#x7684;&#x6620;&#x5C04;&#x5173;&#x7CFB;&#xFF1A;</p>
<pre><code> CALL            PARAMETERS

 f(3)             a=3, b=nil
 f(3, 4)          a=3, b=4
 f(3, 4, 5)       a=3, b=4
 f(r(), 10)       a=1, b=10
 f(r())           a=1, b=2

 g(3)             a=3, b=nil, ... --&gt;  (nothing)
 g(3, 4)          a=3, b=4,   ... --&gt;  (nothing)
 g(3, 4, 5, 8)    a=3, b=4,   ... --&gt;  5  8
 g(5, r())        a=5, b=1,   ... --&gt;  2  3
</code></pre><p>&#x7ED3;&#x679C;&#x7531; return &#x6765;&#x8FD4;&#x56DE;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.3.4&#xFF09;&#x3002; &#x5982;&#x679C;&#x6267;&#x884C;&#x5230;&#x51FD;&#x6570;&#x672B;&#x5C3E;&#x4F9D;&#x65E7;&#x6CA1;&#x6709;&#x9047;&#x5230;&#x4EFB;&#x4F55; return &#x8BED;&#x53E5;&#xFF0C; &#x51FD;&#x6570;&#x5C31;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x4EFB;&#x4F55;&#x7ED3;&#x679C;&#x3002;</p>
<p>&#x5173;&#x4E8E;&#x51FD;&#x6570;&#x53EF;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x6570;&#x91CF;&#x9650;&#x5236;&#x548C;&#x7CFB;&#x7EDF;&#x6709;&#x5173;&#x3002; &#x8FD9;&#x4E2A;&#x9650;&#x5236;&#x4E00;&#x5B9A;&#x5927;&#x4E8E; 1000 &#x3002;</p>
<p>&#x5192;&#x53F7; &#x8BED;&#x6CD5;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x5B9A;&#x4E49; &#x65B9;&#x6CD5;&#xFF0C; &#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x6709;&#x4E00;&#x4E2A;&#x9690;&#x5F0F;&#x7684;&#x5F62;&#x53C2; self&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5982;&#x4E0B;&#x8BED;&#x53E5;</p>
<pre><code> function t.a.b.c:f (params) body end
</code></pre><p>&#x662F;&#x8FD9;&#x6837;&#x4E00;&#x79CD;&#x5199;&#x6CD5;&#x7684;&#x8BED;&#x6CD5;&#x7CD6;</p>
<pre><code> t.a.b.c.f = function (self, params) body end
</code></pre><p>3.5 &#x2013; &#x53EF;&#x89C1;&#x6027;&#x89C4;&#x5219;</p>
<p>Lua &#x8BED;&#x8A00;&#x6709;&#x8BCD;&#x6CD5;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#x3002; &#x53D8;&#x91CF;&#x7684;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#x5F00;&#x59CB;&#x4E8E;&#x58F0;&#x660E;&#x5B83;&#x4EEC;&#x4E4B;&#x540E;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x6BB5;&#xFF0C; &#x7ED3;&#x675F;&#x4E8E;&#x5305;&#x542B;&#x8FD9;&#x4E2A;&#x58F0;&#x660E;&#x7684;&#x6700;&#x5185;&#x5C42;&#x8BED;&#x53E5;&#x5757;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x975E;&#x7A7A;&#x8BED;&#x53E5;&#x3002; &#x770B;&#x4E0B;&#x9762;&#x8FD9;&#x4E9B;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code> x = 10                -- &#x5168;&#x5C40;&#x53D8;&#x91CF;
 do                    -- &#x65B0;&#x7684;&#x8BED;&#x53E5;&#x5757;
   local x = x         -- &#x65B0;&#x7684;&#x4E00;&#x4E2A; &apos;x&apos;, &#x5B83;&#x7684;&#x503C;&#x73B0;&#x5728;&#x662F; 10
   print(x)            --&gt; 10
   x = x+1
   do                  -- &#x53E6;&#x4E00;&#x4E2A;&#x8BED;&#x53E5;&#x5757;
     local x = x+1     -- &#x53C8;&#x4E00;&#x4E2A; &apos;x&apos;
     print(x)          --&gt; 12
   end
   print(x)            --&gt; 11
 end
 print(x)              --&gt; 10 &#xFF08;&#x53D6;&#x5230;&#x7684;&#x662F;&#x5168;&#x5C40;&#x7684;&#x90A3;&#x4E00;&#x4E2A;&#xFF09;
</code></pre><p>&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#xFF0C;&#x7C7B;&#x4F3C; local x = x &#x8FD9;&#x6837;&#x7684;&#x58F0;&#x660E;&#xFF0C; &#x65B0;&#x7684; x &#x6B63;&#x5728;&#x88AB;&#x58F0;&#x660E;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x6CA1;&#x6709;&#x8FDB;&#x5165;&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#xFF0C; &#x6240;&#x4EE5;&#x7B2C;&#x4E8C;&#x4E2A; x &#x6307;&#x5411;&#x7684;&#x662F;&#x5916;&#x9762;&#x4E00;&#x5C42;&#x7684;&#x53D8;&#x91CF;&#x3002;</p>
<p>&#x56E0;&#x4E3A;&#x6709;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x8BCD;&#x6CD5;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#x7684;&#x89C4;&#x5219;&#xFF0C; &#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x53EF;&#x4EE5;&#x88AB;&#x5728;&#x5B83;&#x7684;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#x5185;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;&#x81EA;&#x7531;&#x4F7F;&#x7528;&#x3002; &#x5F53;&#x4E00;&#x4E2A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x88AB;&#x5185;&#x5C42;&#x7684;&#x51FD;&#x6570;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C; &#x5B83;&#x88AB;&#x5185;&#x5C42;&#x51FD;&#x6570;&#x79F0;&#x4F5C; &#x4E0A;&#x503C;&#xFF0C;&#x6216;&#x662F; &#x5916;&#x90E8;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x6BCF;&#x6B21;&#x6267;&#x884C;&#x5230;&#x4E00;&#x4E2A; local &#x8BED;&#x53E5;&#x90FD;&#x4F1A;&#x5B9A;&#x4E49;&#x51FA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x3002; &#x770B;&#x770B;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code> a = {}
 local x = 20
 for i=1,10 do
   local y = 0
   a[i] = function () y=y+1; return x+y end
 end
</code></pre><p>&#x8FD9;&#x4E2A;&#x5FAA;&#x73AF;&#x521B;&#x5EFA;&#x4E86;&#x5341;&#x4E2A;&#x95ED;&#x5305;&#xFF08;&#x8FD9;&#x6307;&#x5341;&#x4E2A;&#x533F;&#x540D;&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x4F8B;&#xFF09;&#x3002; &#x8FD9;&#x4E9B;&#x95ED;&#x5305;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x90FD;&#x4F7F;&#x7528;&#x4E86;&#x4E0D;&#x540C;&#x7684; y &#x53D8;&#x91CF;&#xFF0C; &#x800C;&#x5B83;&#x4EEC;&#x53C8;&#x5171;&#x4EAB;&#x4E86;&#x540C;&#x4E00;&#x4EFD; x&#x3002;</p>
<h1 id="&#x7F16;&#x7A0B;&#x63A5;&#x53E3;">&#x7F16;&#x7A0B;&#x63A5;&#x53E3; <a href="#&#x7F16;&#x7A0B;&#x63A5;&#x53E3;"> # </a></h1>
<p>&#x8FD9;&#x4E2A;&#x90E8;&#x5206;&#x63CF;&#x8FF0;&#x4E86; Lua &#x7684; C API &#xFF0C; &#x4E5F;&#x5C31;&#x662F;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x8DDF; Lua &#x901A;&#x8BAF;&#x7528;&#x7684;&#x4E00;&#x7EC4; C &#x51FD;&#x6570;&#x3002; &#x6240;&#x6709;&#x7684; API &#x51FD;&#x6570;&#x6309;&#x76F8;&#x5173;&#x7684;&#x7C7B;&#x578B;&#x4EE5;&#x53CA;&#x5E38;&#x91CF;&#x90FD;&#x58F0;&#x660E;&#x5728;&#x5934;&#x6587;&#x4EF6; lua.h &#x4E2D;&#x3002;</p>
<p>&#x867D;&#x7136;&#x6211;&#x4EEC;&#x8BF4;&#x7684;&#x662F;&#x201C;&#x51FD;&#x6570;&#x201D;&#xFF0C; &#x4F46;&#x4E00;&#x90E8;&#x5206;&#x7B80;&#x5355;&#x7684; API &#x662F;&#x4EE5;&#x5B8F;&#x7684;&#x5F62;&#x5F0F;&#x63D0;&#x4F9B;&#x7684;&#x3002; &#x9664;&#x975E;&#x53E6;&#x6709;&#x8BF4;&#x660E;&#xFF0C; &#x6240;&#x6709;&#x7684;&#x8FD9;&#x4E9B;&#x5B8F;&#x90FD;&#x53EA;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;&#x7684;&#x53C2;&#x6570;&#x4E00;&#x6B21; &#xFF08;&#x9664;&#x4E86;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x90A3;&#x4E00;&#x5B9A;&#x662F; Lua &#x72B6;&#x6001;&#xFF09;&#xFF0C; &#x56E0;&#x6B64;&#x4F60;&#x4E0D;&#x9700;&#x62C5;&#x5FC3;&#x8FD9;&#x4E9B;&#x5B8F;&#x7684;&#x5C55;&#x5F00;&#x4F1A;&#x5F15;&#x8D77;&#x4E00;&#x4E9B;&#x526F;&#x4F5C;&#x7528;&#x3002;</p>
<p>C &#x5E93;&#x4E2D;&#x6240;&#x6709;&#x7684; Lua API &#x51FD;&#x6570;&#x90FD;&#x4E0D;&#x53BB;&#x68C0;&#x67E5;&#x53C2;&#x6570;&#x662F;&#x5426;&#x76F8;&#x5BB9;&#x53CA;&#x6709;&#x6548;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x7F16;&#x8BD1; Lua &#x65F6;&#x52A0;&#x4E0A;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x5B8F;&#x5F00;&#x5173; LUA_USE_APICHECK &#x6765;&#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x884C;&#x4E3A;&#x3002;</p>
<p>4.1 &#x2013; &#x6808;</p>
<p>Lua &#x4F7F;&#x7528;&#x4E00;&#x4E2A; &#x865A;&#x62DF;&#x6808; &#x6765;&#x548C; C &#x4E92;&#x4F20;&#x503C;&#x3002; &#x6808;&#x4E0A;&#x7684;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x662F;&#x4E00;&#x4E2A; Lua &#x503C; &#xFF08;nil&#xFF0C;&#x6570;&#x5B57;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x7B49;&#x7B49;&#xFF09;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x4F55;&#x65F6; Lua &#x8C03;&#x7528; C&#xFF0C;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x6808;&#xFF0C; &#x8FD9;&#x4E2A;&#x6808;&#x72EC;&#x7ACB;&#x4E8E; C &#x51FD;&#x6570;&#x672C;&#x8EAB;&#x7684;&#x6808;&#xFF0C;&#x4E5F;&#x72EC;&#x7ACB;&#x4E8E;&#x4E4B;&#x524D;&#x7684; Lua &#x6808;&#x3002; &#x5B83;&#x91CC;&#x9762;&#x5305;&#x542B;&#x4E86; Lua &#x4F20;&#x9012;&#x7ED9; C &#x51FD;&#x6570;&#x7684;&#x6240;&#x6709;&#x53C2;&#x6570;&#xFF0C; &#x800C; C &#x51FD;&#x6570;&#x5219;&#x628A;&#x8981;&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x653E;&#x5165;&#x8FD9;&#x4E2A;&#x6808;&#x4EE5;&#x8FD4;&#x56DE;&#x7ED9;&#x8C03;&#x7528;&#x8005; &#xFF08;&#x53C2;&#x89C1; lua_CFunction&#xFF09;&#x3002;</p>
<p>&#x65B9;&#x4FBF;&#x8D77;&#x89C1;&#xFF0C; &#x6240;&#x6709;&#x9488;&#x5BF9;&#x6808;&#x7684; API &#x67E5;&#x8BE2;&#x64CD;&#x4F5C;&#x90FD;&#x4E0D;&#x4E25;&#x683C;&#x9075;&#x5FAA;&#x6808;&#x7684;&#x64CD;&#x4F5C;&#x89C4;&#x5219;&#x3002; &#x800C;&#x662F;&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x4E2A; &#x7D22;&#x5F15; &#x6765;&#x6307;&#x5411;&#x6808;&#x4E0A;&#x7684;&#x4EFB;&#x4F55;&#x5143;&#x7D20;&#xFF1A; &#x6B63;&#x7684;&#x7D22;&#x5F15;&#x6307;&#x7684;&#x662F;&#x6808;&#x4E0A;&#x7684;&#x7EDD;&#x5BF9;&#x4F4D;&#x7F6E;&#xFF08;&#x4ECE;1&#x5F00;&#x59CB;&#xFF09;&#xFF1B; &#x8D1F;&#x7684;&#x7D22;&#x5F15;&#x5219;&#x6307;&#x4ECE;&#x6808;&#x9876;&#x5F00;&#x59CB;&#x7684;&#x504F;&#x79FB;&#x91CF;&#x3002; &#x5C55;&#x5F00;&#x6765;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x5806;&#x6808;&#x6709; n &#x4E2A;&#x5143;&#x7D20;&#xFF0C; &#x90A3;&#x4E48;&#x7D22;&#x5F15; 1 &#x8868;&#x793A;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20; &#xFF08;&#x4E5F;&#x5C31;&#x662F;&#x6700;&#x5148;&#x88AB;&#x538B;&#x6808;&#x7684;&#x5143;&#x7D20;&#xFF09; &#x800C;&#x7D22;&#x5F15; n &#x5219;&#x6307;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF1B; &#x7D22;&#x5F15; -1 &#x4E5F;&#x662F;&#x6307;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20; &#xFF08;&#x5373;&#x6808;&#x9876;&#x7684;&#x5143;&#x7D20;&#xFF09;&#xFF0C; &#x7D22;&#x5F15; -n &#x662F;&#x6307;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002;</p>
<p>4.2 &#x2013; &#x6808;&#x5927;&#x5C0F;</p>
<p>&#x5F53;&#x4F60;&#x4F7F;&#x7528; Lua API &#x65F6;&#xFF0C; &#x5C31;&#x6709;&#x8D23;&#x4EFB;&#x4FDD;&#x8BC1;&#x505A;&#x6070;&#x5F53;&#x7684;&#x8C03;&#x7528;&#x3002; &#x7279;&#x522B;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C; &#x4F60;&#x6709;&#x8D23;&#x4EFB;&#x63A7;&#x5236;&#x4E0D;&#x8981;&#x5806;&#x6808;&#x6EA2;&#x51FA;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; lua_checkstack &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x6269;&#x5927;&#x53EF;&#x7528;&#x5806;&#x6808;&#x7684;&#x5C3A;&#x5BF8;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x4F55;&#x65F6; Lua &#x8C03;&#x7528; C &#xFF0C; &#x5B83;&#x90FD;&#x53EA;&#x4FDD;&#x8BC1;&#x81F3;&#x5C11;&#x6709; LUA_MINSTACK &#x8FD9;&#x4E48;&#x591A;&#x7684;&#x5806;&#x6808;&#x7A7A;&#x95F4;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x3002; LUA_MINSTACK &#x4E00;&#x822C;&#x88AB;&#x5B9A;&#x4E49;&#x4E3A; 20 &#xFF0C; &#x56E0;&#x6B64;&#xFF0C;&#x53EA;&#x8981;&#x4F60;&#x4E0D;&#x662F;&#x4E0D;&#x65AD;&#x7684;&#x628A;&#x6570;&#x636E;&#x538B;&#x6808;&#xFF0C; &#x901A;&#x5E38;&#x4F60;&#x4E0D;&#x7528;&#x5173;&#x5FC3;&#x5806;&#x6808;&#x5927;&#x5C0F;&#x3002;</p>
<p>&#x5F53;&#x4F60;&#x8C03;&#x7528;&#x4E00;&#x4E2A; Lua &#x51FD;&#x6570;&#x5374;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x8981;&#x63A5;&#x6536;&#x591A;&#x5C11;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x65F6; &#xFF08;&#x53C2;&#x89C1; lua_call&#xFF09;&#xFF0C; Lua &#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x6808;&#x4E00;&#x5B9A;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x7A7A;&#x95F4;&#x6765;&#x63A5;&#x6536;&#x6240;&#x6709;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF0C; &#x4F46;&#x4E0D;&#x4FDD;&#x8BC1;&#x6B64;&#x5916;&#x7559;&#x6709;&#x989D;&#x5916;&#x7684;&#x7A7A;&#x95F4;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x505A;&#x4E86;&#x4E00;&#x6B21;&#x8FD9;&#x6837;&#x7684;&#x8C03;&#x7528;&#x540E;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x7EE7;&#x7EED;&#x538B;&#x6808;&#xFF0C; &#x5219;&#x9700;&#x8981;&#x4F7F;&#x7528; lua_checkstack&#x3002;</p>
<p>4.3 &#x2013; &#x6709;&#x6548;&#x7D22;&#x5F15;&#x4E0E;&#x53EF;&#x63A5;&#x53D7;&#x7D22;&#x5F15;</p>
<p>API &#x4E2D;&#x7684;&#x51FD;&#x6570;&#x82E5;&#x9700;&#x8981;&#x4F20;&#x5165;&#x6808;&#x7D22;&#x5F15;&#xFF0C;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x5FC5;&#x987B;&#x662F; &#x6709;&#x6548;&#x7D22;&#x5F15; &#x6216;&#x662F; &#x53EF;&#x63A5;&#x53D7;&#x7D22;&#x5F15;&#x3002;</p>
<p>&#x6709;&#x6548;&#x7D22;&#x5F15; &#x6307;&#x5F15;&#x7528;&#x6808;&#x5185;&#x771F;&#x5B9E;&#x4F4D;&#x7F6E;&#x7684;&#x7D22;&#x5F15;&#xFF1B; &#x5373;&#x5728; 1 &#x5230;&#x6808;&#x9876;&#x4E4B;&#x95F4;&#x7684;&#x4F4D;&#x7F6E; &#xFF08;1 &#x2264; abs(index) &#x2264; top&#xFF09;&#x3002; &#x901A;&#x5E38;&#xFF0C;&#x4E00;&#x4E2A;&#x53EF;&#x80FD;&#x4FEE;&#x6539;&#x8BE5;&#x4F4D;&#x7F6E;&#x7684;&#x503C;&#x7684;&#x51FD;&#x6570;&#x9700;&#x8981;&#x4F20;&#x5165;&#x6709;&#x6548;&#x7D22;&#x5F15;&#x3002;</p>
<p>&#x9664;&#x975E;&#x53E6;&#x6709;&#x8BF4;&#x660E;&#xFF0C; &#x4EFB;&#x4F55;&#x53EF;&#x4EE5;&#x63A5;&#x53D7;&#x6709;&#x6548;&#x7D22;&#x5F15;&#x7684;&#x51FD;&#x6570;&#x540C;&#x65F6;&#x4E5F;&#x63A5;&#x53D7; &#x4F2A;&#x7D22;&#x5F15;&#x3002; &#x4F2A;&#x7D22;&#x5F15;&#x6307;&#x4EE3;&#x4E00;&#x4E9B;&#x53EF;&#x4EE5;&#x88AB; C code &#x8BBF;&#x95EE;&#x5F97;&#x5230; Lua &#x503C;&#xFF0C;&#x800C;&#x5B83;&#x4EEC;&#x53C8;&#x4E0D;&#x5728;&#x6808;&#x5185;&#x3002; &#x8FD9;&#x7528;&#x4E8E;&#x8BBF;&#x95EE;&#x6CE8;&#x518C;&#x8868;&#x4EE5;&#x53CA; C &#x51FD;&#x6570;&#x7684;&#x4E0A;&#x503C;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.4&#xFF09;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x90A3;&#x4E9B;&#x53EA;&#x662F;&#x9700;&#x8981;&#x6808;&#x4E2D;&#x7684;&#x503C;&#xFF08;&#x4F8B;&#x5982;&#x67E5;&#x8BE2;&#x51FD;&#x6570;&#xFF09; &#x800C;&#x4E0D;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x6808;&#x4F4D;&#x7F6E;&#x7684;&#x51FD;&#x6570;&#xFF0C; &#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x4E2A;&#x53EF;&#x63A5;&#x53D7;&#x7684;&#x7D22;&#x5F15;&#x53BB;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#x3002; &#x53EF;&#x63A5;&#x53D7;&#x7D22;&#x5F15; &#x4E0D;&#x4EC5;&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x4F55;&#x5305;&#x62EC;&#x4F2A;&#x7D22;&#x5F15;&#x5728;&#x5185;&#x7684;&#x6709;&#x6548;&#x7D22;&#x5F15;&#xFF0C; &#x8FD8;&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x4F55;&#x8D85;&#x8FC7;&#x6808;&#x9876;&#x4F46;&#x843D;&#x5728;&#x4E3A;&#x6808;&#x5206;&#x914D;&#x51FA;&#x6765;&#x7684;&#x7A7A;&#x95F4;&#x5185;&#x7684;&#x6B63;&#x7D22;&#x5F15;&#x3002; &#xFF08;&#x6CE8;&#x610F; 0 &#x6C38;&#x8FDC;&#x90FD;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x63A5;&#x53D7;&#x7D22;&#x5F15;&#x3002;&#xFF09; &#x9664;&#x975E;&#x53E6;&#x6709;&#x8BF4;&#x660E;&#xFF0C;API &#x91CC;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x63A5;&#x53D7;&#x53EF;&#x63A5;&#x53D7;&#x7D22;&#x5F15;&#x3002;</p>
<p>&#x5141;&#x8BB8;&#x53EF;&#x63A5;&#x53D7;&#x7D22;&#x5F15;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x5BF9;&#x6808;&#x9876;&#x4EE5;&#x5916;&#x7684;&#x67E5;&#x8BE2;&#x65F6;&#x505A;&#x989D;&#x5916;&#x7684;&#x68C0;&#x67E5;&#x3002; &#x4F8B;&#x5982;&#xFF0C;C &#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x67E5;&#x8BE2;&#x4F20;&#x7ED9;&#x5B83;&#x7684;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#xFF0C; &#x800C;&#x4E0D;&#x7528;&#x5148;&#x68C0;&#x67E5;&#x662F;&#x4E0D;&#x662F;&#x6709;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;&#xFF0C; &#x5373;&#x4E0D;&#x9700;&#x8981;&#x68C0;&#x67E5; 3 &#x662F;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7D22;&#x5F15;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x90A3;&#x4E9B;&#x4EE5;&#x53EF;&#x63A5;&#x53D7;&#x7D22;&#x5F15;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#xFF0C; &#x65E0;&#x6548;&#x7D22;&#x5F15;&#x88AB;&#x770B;&#x4F5C;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x7C7B;&#x578B; LUA_TNONE &#x7684;&#x503C;&#xFF0C; &#x8FD9;&#x4E2A;&#x503C;&#x7684;&#x884C;&#x4E3A;&#x548C; nil &#x4E00;&#x81F4;&#x3002;</p>
<p>4.4 &#x2013; C &#x95ED;&#x5305;</p>
<p>&#x5F53; C &#x51FD;&#x6570;&#x88AB;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#xFF0C; &#x6211;&#x4EEC;&#x6709;&#x53EF;&#x80FD;&#x4F1A;&#x628A;&#x4E00;&#x4E9B;&#x503C;&#x5173;&#x8054;&#x5728;&#x4E00;&#x8D77;&#xFF0C; &#x4E5F;&#x5C31;&#x662F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; C &#x95ED;&#x5305; &#xFF08;&#x53C2;&#x89C1; lua_pushcclosure&#xFF09;&#xFF1B; &#x8FD9;&#x4E9B;&#x88AB;&#x5173;&#x8054;&#x8D77;&#x6765;&#x7684;&#x503C;&#x88AB;&#x53EB;&#x505A; &#x4E0A;&#x503C; &#xFF0C; &#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x8BBF;&#x95EE;&#x7684;&#x5230;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x4F55;&#x65F6;&#x53BB;&#x8C03;&#x7528; C &#x51FD;&#x6570;&#xFF0C; &#x51FD;&#x6570;&#x7684;&#x4E0A;&#x503C;&#x90FD;&#x53EF;&#x4EE5;&#x7528;&#x4F2A;&#x7D22;&#x5F15;&#x5B9A;&#x4F4D;&#x3002; &#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x7528; lua_upvalueindex &#x8FD9;&#x4E2A;&#x5B8F;&#x6765;&#x751F;&#x6210;&#x8FD9;&#x4E9B;&#x4F2A;&#x7D22;&#x5F15;&#x3002; &#x7B2C;&#x4E00;&#x4E2A;&#x5173;&#x8054;&#x5230;&#x51FD;&#x6570;&#x7684;&#x503C;&#x653E;&#x5728; lua_upvalueindex(1) &#x4F4D;&#x7F6E;&#x5904;&#xFF0C;&#x4F9D;&#x6B64;&#x7C7B;&#x63A8;&#x3002; &#x4F7F;&#x7528; lua_upvalueindex(n) &#x65F6;&#xFF0C; &#x82E5; n &#x5927;&#x4E8E;&#x5F53;&#x524D;&#x51FD;&#x6570;&#x7684;&#x603B;&#x4E0A;&#x503C;&#x4E2A;&#x6570; &#xFF08;&#x4F46;&#x4E0D;&#x53EF;&#x4EE5;&#x5927;&#x4E8E; 256&#xFF09;&#x4F1A;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x53EF;&#x63A5;&#x53D7;&#x7684;&#x4F46;&#x65E0;&#x6548;&#x7684;&#x7D22;&#x5F15;&#x3002;</p>
<p>4.5 &#x2013; &#x6CE8;&#x518C;&#x8868;</p>
<p>Lua &#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A; &#x6CE8;&#x518C;&#x8868;&#xFF0C; &#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x9884;&#x5B9A;&#x4E49;&#x51FA;&#x6765;&#x7684;&#x8868;&#xFF0C; &#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4FDD;&#x5B58;&#x4EFB;&#x4F55; C &#x4EE3;&#x7801;&#x60F3;&#x4FDD;&#x5B58;&#x7684; Lua &#x503C;&#x3002; &#x8FD9;&#x4E2A;&#x8868;&#x53EF;&#x4EE5;&#x7528;&#x6709;&#x6548;&#x4F2A;&#x7D22;&#x5F15; LUA_REGISTRYINDEX &#x6765;&#x5B9A;&#x4F4D;&#x3002; &#x4EFB;&#x4F55; C &#x5E93;&#x90FD;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x5F20;&#x8868;&#x91CC;&#x4FDD;&#x5B58;&#x6570;&#x636E;&#xFF0C; &#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x51B2;&#x7A81;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x7279;&#x522B;&#x5C0F;&#x5FC3;&#x7684;&#x9009;&#x62E9;&#x952E;&#x540D;&#x3002; &#x4E00;&#x822C;&#x7684;&#x7528;&#x6CD5;&#x662F;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x4F60;&#x7684;&#x5E93;&#x540D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x505A;&#x4E3A;&#x952E;&#x540D;&#xFF0C; &#x6216;&#x8005;&#x53D6;&#x4F60;&#x81EA;&#x5DF1; C &#x5BF9;&#x8C61;&#x7684;&#x5730;&#x5740;&#xFF0C;&#x4EE5;&#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x5F62;&#x5F0F;&#x505A;&#x952E;&#xFF0C; &#x8FD8;&#x53EF;&#x4EE5;&#x7528;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x4EFB;&#x610F; Lua &#x5BF9;&#x8C61;&#x505A;&#x952E;&#x3002; &#x5173;&#x4E8E;&#x53D8;&#x91CF;&#x540D;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x952E;&#x540D;&#x4E2D;&#x4EE5;&#x4E0B;&#x5212;&#x7EBF;&#x52A0;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#x7684;&#x540D;&#x5B57;&#x88AB; Lua &#x4FDD;&#x7559;&#x3002;</p>
<p>&#x6CE8;&#x518C;&#x8868;&#x4E2D;&#x7684;&#x6574;&#x6570;&#x952E;&#x7528;&#x4E8E;&#x5F15;&#x7528;&#x673A;&#x5236; &#xFF08;&#x53C2;&#x89C1; luaL_ref&#xFF09;&#xFF0C; &#x4EE5;&#x53CA;&#x4E00;&#x4E9B;&#x9884;&#x5B9A;&#x4E49;&#x7684;&#x503C;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x6574;&#x6570;&#x952E;&#x4E0D;&#x8981;&#x7528;&#x4E8E;&#x522B;&#x7684;&#x76EE;&#x7684;&#x3002;</p>
<p>&#x5F53;&#x4F60;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684; Lua &#x72B6;&#x6001;&#x673A;&#xFF0C; &#x5176;&#x4E2D;&#x7684;&#x6CE8;&#x518C;&#x8868;&#x5185;&#x5C31;&#x9884;&#x5B9A;&#x4E49;&#x597D;&#x4E86;&#x51E0;&#x4E2A;&#x503C;&#x3002; &#x8FD9;&#x4E9B;&#x9884;&#x5B9A;&#x4E49;&#x503C;&#x53EF;&#x4EE5;&#x7528;&#x6574;&#x6570;&#x7D22;&#x5F15;&#x5230;&#xFF0C; &#x8FD9;&#x4E9B;&#x6574;&#x6570;&#x4EE5;&#x5E38;&#x6570;&#x5F62;&#x5F0F;&#x5B9A;&#x4E49;&#x5728; lua.h &#x4E2D;&#x3002; &#x6709;&#x4E0B;&#x5217;&#x5E38;&#x6570;&#xFF1A;</p>
<p>LUA_RIDX_MAINTHREAD: &#x6CE8;&#x518C;&#x8868;&#x4E2D;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x4E0B;&#x662F;&#x72B6;&#x6001;&#x673A;&#x7684;&#x4E3B;&#x7EBF;&#x7A0B;&#x3002; &#xFF08;&#x4E3B;&#x7EBF;&#x7A0B;&#x548C;&#x72B6;&#x6001;&#x673A;&#x540C;&#x65F6;&#x88AB;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x3002;&#xFF09;
LUA_RIDX_GLOBALS: &#x6CE8;&#x518C;&#x8868;&#x7684;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x4E0B;&#x662F;&#x5168;&#x5C40;&#x73AF;&#x5883;&#x3002;
4.6 &#x2013; C &#x4E2D;&#x7684;&#x9519;&#x8BEF;&#x5904;&#x7406;</p>
<p>&#x5728;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;Lua &#x4F7F;&#x7528;&#x4E86; C &#x7684; longjmp &#x673A;&#x5236;&#x6765;&#x5904;&#x7406;&#x9519;&#x8BEF;&#x3002; &#xFF08;&#x5982;&#x679C;&#x4F60;&#x4F7F;&#x7528; C++ &#x7F16;&#x8BD1;&#xFF0C;Lua &#x5C06;&#x6362;&#x6210;&#x5F02;&#x5E38;&#xFF1B; &#x7EC6;&#x8282;&#x8BF7;&#x5728;&#x6E90;&#x4EE3;&#x7801;&#x4E2D;&#x641C;&#x7D22; LUAI_THROW&#x3002;&#xFF09; &#x5F53; Lua &#x78B0;&#x5230;&#x4EFB;&#x4F55;&#x9519;&#x8BEF; &#xFF08;&#x6BD4;&#x5982;&#x5185;&#x5B58;&#x5206;&#x914D;&#x9519;&#x8BEF;&#x3001;&#x7C7B;&#x578B;&#x9519;&#x8BEF;&#x3001;&#x8BED;&#x6CD5;&#x9519;&#x8BEF;&#x3001;&#x8FD8;&#x6709;&#x8FD0;&#x884C;&#x65F6;&#x9519;&#x8BEF;&#xFF09; &#x5B83;&#x90FD;&#x4F1A; &#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x51FA;&#x53BB;&#xFF1B; &#x4E5F;&#x5C31;&#x662F;&#x8C03;&#x7528;&#x4E00;&#x6B21;&#x957F;&#x8DF3;&#x8F6C;&#x3002; &#x5728; &#x4FDD;&#x62A4;&#x73AF;&#x5883; &#x4E0B;&#xFF0C; Lua &#x4F7F;&#x7528; setjmp &#x6765;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x6062;&#x590D;&#x70B9;&#xFF1B; &#x4EFB;&#x4F55;&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x90FD;&#x4F1A;&#x8DF3;&#x8F6C;&#x5230;&#x6700;&#x8FD1;&#x7684;&#x4E00;&#x4E2A;&#x6062;&#x590D;&#x70B9;&#x3002;</p>
<p>&#x5982;&#x679C;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x5728;&#x4FDD;&#x62A4;&#x73AF;&#x5883;&#x4E4B;&#x5916;&#xFF0C; Lua &#x4F1A;&#x5148;&#x8C03;&#x7528; panic &#x51FD;&#x6570; &#xFF08;&#x53C2;&#x89C1; lua_atpanic&#xFF09; &#x7136;&#x540E;&#x8C03;&#x7528; abort &#x6765;&#x9000;&#x51FA;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x3002; &#x4F60;&#x7684; panic &#x51FD;&#x6570;&#x53EA;&#x8981;&#x4E0D;&#x8FD4;&#x56DE; &#xFF08;&#x4F8B;&#x5982;&#xFF1A;&#x957F;&#x8DF3;&#x8F6C;&#x5230;&#x4F60;&#x5728; Lua &#x5916;&#x4F60;&#x81EA;&#x5DF1;&#x8BBE;&#x7F6E;&#x7684;&#x6062;&#x590D;&#x70B9;&#xFF09; &#x5C31;&#x53EF;&#x4EE5;&#x4E0D;&#x9000;&#x51FA;&#x7A0B;&#x5E8F;&#x3002;</p>
<p>panic &#x51FD;&#x6570;&#x4EE5;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x5904;&#x7406;&#x5668;&#xFF08;&#x53C2;&#x89C1; &#xA7;2.3&#xFF09;&#x7684;&#x65B9;&#x5F0F;&#x8FD0;&#x884C;&#xFF1B; &#x9519;&#x8BEF;&#x6D88;&#x606F;&#x5728;&#x6808;&#x9876;&#x3002; &#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x5B83;&#x4E0D;&#x4FDD;&#x8BC1;&#x6808;&#x7A7A;&#x95F4;&#x3002; &#x505A;&#x4EFB;&#x4F55;&#x538B;&#x6808;&#x64CD;&#x4F5C;&#x524D;&#xFF0C;panic &#x51FD;&#x6570;&#x90FD;&#x5FC5;&#x987B;&#x5148;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x7A7A;&#x95F4; &#xFF08;&#x53C2;&#x89C1; &#xA7;4.2&#xFF09;&#x3002;</p>
<p>&#x5927;&#x591A;&#x6570; API &#x51FD;&#x6570;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#xFF0C; &#x4F8B;&#x5982;&#x5728;&#x5185;&#x5B58;&#x5206;&#x914D;&#x9519;&#x8BEF;&#x65F6;&#x5C31;&#x4F1A;&#x629B;&#x51FA;&#x3002; &#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x6587;&#x6863;&#x90FD;&#x4F1A;&#x6CE8;&#x660E;&#x5B83;&#x662F;&#x5426;&#x53EF;&#x80FD;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x5728; C &#x51FD;&#x6570;&#x5185;&#x90E8;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528; lua_error &#x6765;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>4.7 &#x2013; C &#x4E2D;&#x7684;&#x8BA9;&#x51FA;&#x5904;&#x7406;</p>
<p>Lua &#x5185;&#x90E8;&#x4F7F;&#x7528; C &#x7684; longjmp &#x673A;&#x5236;&#x8BA9;&#x51FA;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A; C &#x51FD;&#x6570; foo &#x8C03;&#x7528;&#x4E86;&#x4E00;&#x4E2A; API &#x51FD;&#x6570;&#xFF0C; &#x800C;&#x8FD9;&#x4E2A; API &#x51FD;&#x6570;&#x8BA9;&#x51FA;&#x4E86;&#xFF08;&#x76F4;&#x63A5;&#x6216;&#x95F4;&#x63A5;&#x8C03;&#x7528;&#x4E86;&#x8BA9;&#x51FA;&#x51FD;&#x6570;&#xFF09;&#x3002; &#x7531;&#x4E8E; longjmp &#x4F1A;&#x79FB;&#x9664; C &#x6808;&#x7684;&#x6808;&#x5E27;&#xFF0C; Lua &#x5C31;&#x65E0;&#x6CD5;&#x8FD4;&#x56DE;&#x5230; foo &#x91CC;&#x4E86;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x56DE;&#x907F;&#x8FD9;&#x7C7B;&#x95EE;&#x9898;&#xFF0C; &#x78B0;&#x5230; API &#x8C03;&#x7528;&#x4E2D;&#x8C03;&#x7528;&#x8BA9;&#x51FA;&#x65F6;&#xFF0C;&#x9664;&#x4E86;&#x90A3;&#x4E9B;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x7684; API &#x5916;&#xFF0C;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x4E09;&#x4E2A;&#x51FD;&#x6570;&#xFF1A; lua_yieldk&#xFF0C; lua_callk&#xFF0C;&#x548C; lua_pcallk &#x3002; &#x5B83;&#x4EEC;&#x5728;&#x8BA9;&#x51FA;&#x53D1;&#x751F;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x4ECE;&#x4F20;&#x5165;&#x7684; &#x5EF6;&#x7EED;&#x51FD;&#x6570; &#xFF08;&#x540D;&#x4E3A; k &#x7684;&#x53C2;&#x6570;&#xFF09;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x9884;&#x8BBE;&#x4E00;&#x4E9B;&#x672F;&#x8BED;&#x6765;&#x89E3;&#x91CA;&#x5EF6;&#x7EED;&#x70B9;&#x3002; &#x5BF9;&#x4E8E;&#x4ECE; Lua &#x4E2D;&#x8C03;&#x7528;&#x7684; C &#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A; &#x539F;&#x51FD;&#x6570;&#x3002; &#x4ECE;&#x8FD9;&#x4E2A;&#x539F;&#x51FD;&#x6570;&#x4E2D;&#x8C03;&#x7528;&#x7684;&#x4E0A;&#x9762;&#x6240;&#x8FF0;&#x7684;&#x4E09;&#x4E2A; C API &#x51FD;&#x6570;&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A; &#x88AB;&#x8C03;&#x51FD;&#x6570;&#x3002; &#x88AB;&#x8C03;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x4F7F;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x8BA9;&#x51FA;&#x3002; &#xFF08;&#x8BA9;&#x51FA;&#x53D1;&#x751F;&#x5728;&#x88AB;&#x8C03;&#x51FD;&#x6570;&#x662F; lua_yieldk&#xFF0C; &#x6216;&#x4F20;&#x5165; lua_callk &#x6216; lua_pcallk &#x7684;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E86;&#x8BA9;&#x51FA;&#x65F6;&#x3002;&#xFF09;</p>
<p>&#x5047;&#x8BBE;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x7EBF;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x88AB;&#x8C03;&#x51FD;&#x6570;&#x65F6;&#x8BA9;&#x51FA;&#x3002; &#x5F53;&#x518D;&#x6B21;&#x5EF6;&#x7EED;&#x8FD9;&#x6761;&#x7EBF;&#x7A0B;&#xFF0C;&#x5B83;&#x5E0C;&#x671B;&#x7EE7;&#x7EED;&#x88AB;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x8FD0;&#x884C;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x88AB;&#x8C03;&#x51FD;&#x6570;&#x4E0D;&#x53EF;&#x80FD;&#x8FD4;&#x56DE;&#x5230;&#x539F;&#x51FD;&#x6570;&#x4E2D;&#x3002; &#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x4E4B;&#x524D;&#x7684;&#x8BA9;&#x51FA;&#x64CD;&#x4F5C;&#x7834;&#x574F;&#x4E86; C &#x6808;&#x7684;&#x6808;&#x5E27;&#x3002; &#x4F5C;&#x4E3A;&#x66FF;&#x4EE3;&#x54C1;&#xFF0C;Lua &#x8C03;&#x7528;&#x90A3;&#x4E2A;&#x4F5C;&#x4E3A;&#x88AB;&#x8C03;&#x51FD;&#x6570;&#x53C2;&#x6570;&#x7ED9;&#x51FA;&#x7684; &#x5EF6;&#x7EED;&#x51FD;&#x6570; &#x3002; &#x6B63;&#x5982;&#x5176;&#x540D;&#xFF0C;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x5C06;&#x5EF6;&#x7EED;&#x539F;&#x51FD;&#x6570;&#x7684;&#x4EFB;&#x52A1;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x51FD;&#x6570;&#x4F1A;&#x505A;&#x4E00;&#x4E2A;&#x8BF4;&#x660E;&#xFF1A;</p>
<pre><code> int original_function (lua_State *L) {
   ...     /* code 1 */
   status = lua_pcall(L, n, m, h);  /* calls Lua */
   ...     /* code 2 */
 }
</code></pre><p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x60F3;&#x5141;&#x8BB8;&#x88AB; lua_pcall &#x8FD0;&#x884C;&#x7684; Lua &#x4EE3;&#x7801;&#x8BA9;&#x51FA;&#x3002; &#x9996;&#x5148;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x51FD;&#x6570;&#x6539;&#x5199;&#x6210;&#x8FD9;&#x4E2A;&#x6837;&#x5B50;&#xFF1A;</p>
<pre><code> int k (lua_State *L, int status, lua_KContext ctx) {
   ...  /* code 2 */
 }

 int original_function (lua_State *L) {
   ...     /* code 1 */
   return k(L, lua_pcall(L, n, m, h), ctx);
 }
</code></pre><p>&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#xFF0C;&#x65B0;&#x51FD;&#x6570; k &#x5C31;&#x662F;&#x4E00;&#x4E2A; &#x5EF6;&#x7EED;&#x51FD;&#x6570; &#xFF08;&#x51FD;&#x6570;&#x7C7B;&#x578B;&#x4E3A; lua_KFunction&#xFF09;&#x3002; &#x5B83;&#x7684;&#x5DE5;&#x4F5C;&#x5C31;&#x662F;&#x539F;&#x51FD;&#x6570;&#x4E2D;&#x8C03;&#x7528; lua_pcall &#x4E4B;&#x540E;&#x505A;&#x7684;&#x90A3;&#x4E9B;&#x4E8B;&#x60C5;&#x3002; &#x73B0;&#x5728;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x901A;&#x77E5; Lua &#x8BF4;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x5728;&#x88AB; lua_pcall &#x6267;&#x884C;&#x7684; Lua &#x4EE3;&#x7801;&#x53D1;&#x751F;&#x8FC7;&#x4E2D;&#x65AD;&#xFF08;&#x9519;&#x8BEF;&#x6216;&#x8BA9;&#x51FA;&#xFF09;&#x540E;&#xFF0C; &#x8FD8;&#x5F97;&#x7EE7;&#x7EED;&#x8C03;&#x7528; k &#x3002; &#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8FD8;&#x5F97;&#x7EE7;&#x7EED;&#x6539;&#x5199;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#xFF0C;&#x628A; lua_pcall &#x66FF;&#x6362;&#x6210; lua_pcallk&#xFF1A;</p>
<pre><code> int original_function (lua_State *L) {
   ...     /* code 1 */
   return k(L, lua_pcallk(L, n, m, h, ctx2, k), ctx1);
 }
</code></pre><p>&#x6CE8;&#x610F;&#x8FD9;&#x91CC;&#x90A3;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x663E;&#x5F0F;&#x7684;&#x5BF9;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#xFF1A; Lua &#x4EC5;&#x5728;&#x9700;&#x8981;&#x65F6;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x662F;&#x7531;&#x9519;&#x8BEF;&#x5BFC;&#x81F4;&#x7684;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x53D1;&#x751F;&#x4E86;&#x8BA9;&#x51FA;&#x800C;&#x9700;&#x8981;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#xFF0C;&#x624D;&#x4F1A;&#x8C03;&#x7528;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x53D1;&#x751F;&#x8FC7;&#x4EFB;&#x4F55;&#x8BA9;&#x51FA;&#xFF0C;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x6B63;&#x5E38;&#x8FD4;&#x56DE;&#xFF0C; &#x90A3;&#x4E48; lua_pcallk &#xFF08;&#x4EE5;&#x53CA; lua_callk&#xFF09;&#x4E5F;&#x4F1A;&#x6B63;&#x5E38;&#x8FD4;&#x56DE;&#x3002; &#xFF08;&#x5F53;&#x7136;&#xFF0C;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4E0D;&#x5728;&#x4E4B;&#x540E;&#x8C03;&#x7528;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#xFF0C; &#x800C;&#x662F;&#x5728;&#x539F;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x540E;&#x76F4;&#x63A5;&#x5199;&#x4E0A;&#x9700;&#x8981;&#x505A;&#x7684;&#x5DE5;&#x4F5C;&#x3002;&#xFF09;</p>
<p>&#x9664;&#x4E86; Lua &#x72B6;&#x6001;&#xFF0C;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x8FD8;&#x6709;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF1A; &#x4E00;&#x4E2A;&#x662F;&#x8C03;&#x7528;&#x6700;&#x540E;&#x7684;&#x72B6;&#x6001;&#x7801;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x4E00;&#x5F00;&#x59CB;&#x7531; lua_pcallk &#x4F20;&#x5165;&#x7684;&#x4E0A;&#x4E0B;&#x6587; &#xFF08;ctx&#xFF09;&#x3002; &#xFF08;Lua &#x672C;&#x8EAB;&#x4E0D;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x503C;&#xFF1B;&#x5B83;&#x4EC5;&#x4EC5;&#x4ECE;&#x539F;&#x51FD;&#x6570;&#x8F6C;&#x53D1;&#x8FD9;&#x4E2A;&#x503C;&#x7ED9;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x3002;&#xFF09; &#x5BF9;&#x4E8E; lua_pcallk &#x800C;&#x8A00;&#xFF0C; &#x72B6;&#x6001;&#x7801;&#x548C; lua_pcallk &#x672C;&#x5E94;&#x8FD4;&#x56DE;&#x503C;&#x76F8;&#x540C;&#xFF0C;&#x533A;&#x522B;&#x4EC5;&#x5728;&#x4E8E;&#x53D1;&#x751F;&#x8FC7;&#x8BA9;&#x51FA;&#x540E;&#x624D;&#x6267;&#x884C;&#x5B8C;&#x65F6;&#xFF0C;&#x72B6;&#x6001;&#x7801;&#x4E3A; LUA_YIELD&#xFF08;&#x800C;&#x4E0D;&#x662F; LUA_OK&#xFF09;&#x3002; &#x5BF9;&#x4E8E; lua_yieldk &#x548C; lua_callk &#x800C;&#x8A00;&#xFF0C; &#x8C03;&#x7528;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x4F20;&#x5165;&#x7684;&#x72B6;&#x6001;&#x7801;&#x4E00;&#x5B9A;&#x662F; LUA_YIELD&#x3002; &#xFF08;&#x5BF9;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;Lua &#x4E0D;&#x4F1A;&#x56E0;&#x4EFB;&#x4F55;&#x9519;&#x8BEF;&#x800C;&#x8C03;&#x7528;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x3002; &#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x5E76;&#x4E0D;&#x5904;&#x7406;&#x9519;&#x8BEF;&#x3002;&#xFF09; &#x540C;&#x6837;&#xFF0C;&#x5F53;&#x4F60;&#x4F7F;&#x7528; lua_callk &#x65F6;&#xFF0C; &#x4F60;&#x5E94;&#x8BE5;&#x7528; LUA_OK &#x4F5C;&#x4E3A;&#x72B6;&#x6001;&#x7801;&#x6765;&#x8C03;&#x7528;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x3002; &#xFF08;&#x5BF9;&#x4E8E; lua_yieldk&#xFF0C; &#x51E0;&#x4E4E;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x5730;&#x65B9;&#x9700;&#x8981;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#xFF0C; &#x56E0;&#x4E3A; lua_yieldk &#x672C;&#x8EAB;&#x5E76;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x3002;&#xFF09;</p>
<p>Lua &#x4F1A;&#x628A;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x770B;&#x4F5C;&#x539F;&#x51FD;&#x6570;&#x3002; &#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x5C06;&#x63A5;&#x6536;&#x5230;&#x548C;&#x539F;&#x51FD;&#x6570;&#x76F8;&#x540C;&#x7684; Lua &#x6808;&#xFF0C;&#x5176;&#x63A5;&#x6536;&#x5230;&#x7684; lua &#x72B6;&#x6001;&#x4E5F;&#x548C; &#x88AB;&#x8C03;&#x51FD;&#x6570;&#x82E5;&#x8FD4;&#x56DE;&#x540E;&#x5E94;&#x8BE5;&#x6709;&#x7684;&#x72B6;&#x6001;&#x4E00;&#x81F4;&#x3002; &#xFF08;&#x4F8B;&#x5982;&#xFF0C; lua_callk &#x8C03;&#x7528;&#x4E4B;&#x540E;&#xFF0C; &#x6808;&#x4E2D;&#x4E4B;&#x524D;&#x538B;&#x5165;&#x7684;&#x51FD;&#x6570;&#x548C;&#x8C03;&#x7528;&#x53C2;&#x6570;&#x90FD;&#x88AB;&#x8C03;&#x7528;&#x4EA7;&#x751F;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x6240;&#x66FF;&#x4EE3;&#x3002;&#xFF09; &#x8FD9;&#x65F6;&#x4E5F;&#x6709;&#x76F8;&#x540C;&#x7684;&#x4E0A;&#x503C;&#x3002; &#x7B49;&#x5230;&#x5B83;&#x8FD4;&#x56DE;&#x7684;&#x65F6;&#x5019;&#xFF0C;Lua &#x4F1A;&#x5C06;&#x5176;&#x770B;&#x5F85;&#x6210;&#x539F;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x53BB;&#x64CD;&#x4F5C;&#x3002;</p>
<p>4.8 &#x2013; &#x51FD;&#x6570;&#x548C;&#x7C7B;&#x578B;</p>
<p>&#x8FD9;&#x91CC;&#x6309;&#x5B57;&#x6BCD;&#x6B21;&#x5E8F;&#x5217;&#x51FA;&#x4E86;&#x6240;&#x6709; C API &#x4E2D;&#x7684;&#x51FD;&#x6570;&#x548C;&#x7C7B;&#x578B;&#x3002; &#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;&#x63D0;&#x793A;&#xFF1A; [-o, +p, x]</p>
<p>&#x5BF9;&#x4E8E;&#x7B2C;&#x4E00;&#x4E2A;&#x57DF;&#xFF0C;o&#xFF0C; &#x6307;&#x7684;&#x662F;&#x8BE5;&#x51FD;&#x6570;&#x4F1A;&#x4ECE;&#x6808;&#x4E0A;&#x5F39;&#x51FA;&#x591A;&#x5C11;&#x4E2A;&#x5143;&#x7D20;&#x3002; &#x7B2C;&#x4E8C;&#x4E2A;&#x57DF;&#xFF0C;p&#xFF0C; &#x6307;&#x8BE5;&#x51FD;&#x6570;&#x4F1A;&#x5C06;&#x591A;&#x5C11;&#x4E2A;&#x5143;&#x7D20;&#x538B;&#x6808;&#x3002; &#xFF08;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x4F1A;&#x5728;&#x5F39;&#x51FA;&#x53C2;&#x6570;&#x540E;&#x518D;&#x628A;&#x7ED3;&#x679C;&#x538B;&#x6808;&#x3002;&#xFF09; x|y &#x8FD9;&#x79CD;&#x5F62;&#x5F0F;&#x7684;&#x57DF;&#x8868;&#x793A;&#x8BE5;&#x51FD;&#x6570;&#x6839;&#x636E;&#x5177;&#x4F53;&#x60C5;&#x51B5;&#x53EF;&#x80FD;&#x538B;&#x5165;&#xFF08;&#x6216;&#x5F39;&#x51FA;&#xFF09; x &#x6216; y &#x4E2A;&#x5143;&#x7D20;&#xFF1B; &#x95EE;&#x53F7; &apos;?&apos; &#x8868;&#x793A; &#x6211;&#x4EEC;&#x65E0;&#x6CD5;&#x4EC5;&#x901A;&#x8FC7;&#x53C2;&#x6570;&#x6765;&#x4E86;&#x89E3;&#x8BE5;&#x51FD;&#x6570;&#x4F1A;&#x5F39;&#x51FA;/&#x538B;&#x5165;&#x591A;&#x5C11;&#x5143;&#x7D20; &#xFF08;&#x6BD4;&#x5982;&#xFF0C;&#x6570;&#x91CF;&#x53D6;&#x51B3;&#x4E8E;&#x6808;&#x4E0A;&#x6709;&#x4E9B;&#x4EC0;&#x4E48;&#xFF09;&#x3002; &#x7B2C;&#x4E09;&#x4E2A;&#x57DF;&#xFF0C;x&#xFF0C; &#x89E3;&#x91CA;&#x4E86;&#x8BE5;&#x51FD;&#x6570;&#x662F;&#x5426;&#x4F1A;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#xFF1A; &apos;-&apos; &#x8868;&#x793A;&#x8BE5;&#x51FD;&#x6570;&#x7EDD;&#x5BF9;&#x4E0D;&#x4F1A;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#xFF1B; &apos;e&apos; &#x8868;&#x793A;&#x8BE5;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#xFF1B; &apos;v&apos; &#x8868;&#x793A;&#x8BE5;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x629B;&#x51FA;&#x6709;&#x610F;&#x4E49;&#x7684;&#x9519;&#x8BEF;&#x3002;</p>
<p>lua_absindex</p>
<p>[-0, +0, &#x2013;]
int lua_absindex (lua_State *L, int idx);
&#x5C06;&#x4E00;&#x4E2A;&#x53EF;&#x63A5;&#x53D7;&#x7684;&#x7D22;&#x5F15; idx &#x8F6C;&#x6362;&#x4E3A;&#x7EDD;&#x5BF9;&#x7D22;&#x5F15; &#xFF08;&#x5373;&#xFF0C;&#x4E00;&#x4E2A;&#x4E0D;&#x4F9D;&#x8D56;&#x6808;&#x9876;&#x5728;&#x54EA;&#x7684;&#x503C;&#xFF09;&#x3002;</p>
<p>lua_Alloc</p>
<p>typedef void <em> (</em>lua_Alloc) (void <em>ud,
                             void </em>ptr,
                             size_t osize,
                             size_t nsize);
Lua &#x72B6;&#x6001;&#x673A;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x51FD;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x3002; &#x5185;&#x5B58;&#x5206;&#x914D;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x529F;&#x80FD;&#x7C7B;&#x4F3C;&#x4E8E; realloc &#x4F46;&#x53C8;&#x4E0D;&#x5B8C;&#x5168;&#x76F8;&#x540C;&#x7684;&#x51FD;&#x6570;&#x3002; &#x5B83;&#x7684;&#x53C2;&#x6570;&#x6709; ud &#xFF0C;&#x4E00;&#x4E2A;&#x7531; lua_newstate &#x4F20;&#x7ED9;&#x5B83;&#x7684;&#x6307;&#x9488;&#xFF1B; ptr &#xFF0C;&#x4E00;&#x4E2A;&#x6307;&#x5411;&#x5DF2;&#x5206;&#x914D;&#x51FA;&#x6765;/&#x5C06;&#x88AB;&#x91CD;&#x65B0;&#x5206;&#x914D;/&#x8981;&#x91CA;&#x653E;&#x7684;&#x5185;&#x5B58;&#x5757;&#x6307;&#x9488;&#xFF1B; osize &#xFF0C;&#x5185;&#x5B58;&#x5757;&#x539F;&#x6765;&#x7684;&#x5C3A;&#x5BF8;&#x6216;&#x662F;&#x5173;&#x4E8E;&#x4EC0;&#x4E48;&#x5C06;&#x88AB;&#x5206;&#x914D;&#x51FA;&#x6765;&#x7684;&#x4EE3;&#x7801;&#xFF1B; nsize &#xFF0C;&#x65B0;&#x5185;&#x5B58;&#x5757;&#x7684;&#x5C3A;&#x5BF8;&#x3002;</p>
<p>&#x5982;&#x679C; ptr &#x4E0D;&#x662F; NULL&#xFF0C; osize &#x662F; ptr &#x6307;&#x5411;&#x7684;&#x5185;&#x5B58;&#x5757;&#x7684;&#x5C3A;&#x5BF8;&#xFF0C; &#x5373;&#x8FD9;&#x4E2A;&#x5185;&#x5B58;&#x5757;&#x5F53;&#x521D;&#x88AB;&#x5206;&#x914D;&#x6216;&#x91CD;&#x5206;&#x914D;&#x7684;&#x5C3A;&#x5BF8;&#x3002;</p>
<p>&#x5982;&#x679C; ptr &#x662F; NULL&#xFF0C; osize &#x662F; Lua &#x5373;&#x5C06;&#x5206;&#x914D;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x7684;&#x7F16;&#x7801;&#x3002; &#x5F53;&#xFF08;&#x4E14;&#x4EC5;&#x5F53;&#xFF09;Lua &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7C7B;&#x578B;&#x7684;&#x65B0;&#x5BF9;&#x8C61;&#x65F6;&#xFF0C; osize &#x662F; LUA_TSTRING&#xFF0C;LUA_TTABLE&#xFF0C;LUA_TFUNCTION&#xFF0C; LUA_TUSERDATA&#xFF0C;&#x6216; LUA_TTHREAD &#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x3002; &#x82E5; osize &#x662F;&#x5176;&#x5B83;&#x7C7B;&#x578B;&#xFF0C;Lua &#x5C06;&#x4E3A;&#x5176;&#x5B83;&#x4E1C;&#x897F;&#x5206;&#x914D;&#x5185;&#x5B58;&#x3002;</p>
<p>Lua &#x5047;&#x5B9A;&#x5206;&#x914D;&#x5668;&#x51FD;&#x6570;&#x4F1A;&#x9075;&#x5FAA;&#x4EE5;&#x4E0B;&#x884C;&#x4E3A;&#xFF1A;</p>
<p>&#x5F53; nsize &#x662F;&#x96F6;&#x65F6;&#xFF0C; &#x5206;&#x914D;&#x5668;&#x5FC5;&#x987B;&#x548C; free &#x884C;&#x4E3A;&#x7C7B;&#x4F3C;&#x5E76;&#x8FD4;&#x56DE; NULL&#x3002;</p>
<p>&#x5F53; nsize &#x4E0D;&#x662F;&#x96F6;&#x65F6;&#xFF0C; &#x5206;&#x914D;&#x5668;&#x5FC5;&#x987B;&#x548C; realloc &#x884C;&#x4E3A;&#x7C7B;&#x4F3C;&#x3002; &#x5982;&#x679C;&#x5206;&#x914D;&#x5668;&#x65E0;&#x6CD5;&#x5B8C;&#x6210;&#x8BF7;&#x6C42;&#xFF0C;&#x8FD4;&#x56DE; NULL&#x3002; Lua &#x5047;&#x5B9A;&#x5728; osize &gt;= nsize &#x6210;&#x7ACB;&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#xFF0C; &#x5206;&#x914D;&#x5668;&#x7EDD;&#x4E0D;&#x4F1A;&#x5931;&#x8D25;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5206;&#x914D;&#x5668;&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x73B0;&#x3002; &#x8FD9;&#x4E2A;&#x5B9E;&#x73B0;&#x88AB;&#x653E;&#x5728;&#x8865;&#x5145;&#x5E93;&#x4E2D;&#xFF0C;&#x4F9B; luaL_newstate &#x4F7F;&#x7528;&#x3002;</p>
<pre><code> static void *l_alloc (void *ud, void *ptr, size_t osize,
                                            size_t nsize) {
   (void)ud;  (void)osize;  /* not used */
   if (nsize == 0) {
     free(ptr);
     return NULL;
   }
   else
     return realloc(ptr, nsize);
 }
</code></pre><p>&#x6CE8;&#x610F;&#xFF0C;&#x6807;&#x51C6; C &#x80FD;&#x786E;&#x4FDD; free(NULL) &#x6CA1;&#x6709;&#x526F;&#x4F5C;&#x7528;&#xFF0C; &#x4E14; realloc(NULL,size) &#x7B49;&#x4EF7;&#x4E8E; malloc(size)&#x3002; &#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x5047;&#x5B9A; realloc &#x5728;&#x7F29;&#x5C0F;&#x5757;&#x957F;&#x5EA6;&#x65F6;&#x4E0D;&#x4F1A;&#x5931;&#x8D25;&#x3002; &#xFF08;&#x867D;&#x7136;&#x6807;&#x51C6; C &#x6CA1;&#x6709;&#x5BF9;&#x6B64;&#x884C;&#x4E3A;&#x505A;&#x51FA;&#x4FDD;&#x8BC1;&#xFF0C;&#x4F46;&#x8FD9;&#x770B;&#x8D77;&#x6765;&#x662F;&#x4E00;&#x4E2A;&#x5B89;&#x5168;&#x7684;&#x5047;&#x5B9A;&#x3002;&#xFF09;</p>
<p>lua_arith</p>
<p>[-(2|1), +1, e]
void lua_arith (lua_State *L, int op);
&#x5BF9;&#x6808;&#x9876;&#x7684;&#x4E24;&#x4E2A;&#x503C;&#xFF08;&#x6216;&#x8005;&#x4E00;&#x4E2A;&#xFF0C;&#x6BD4;&#x5982;&#x53D6;&#x53CD;&#xFF09;&#x505A;&#x4E00;&#x6B21;&#x6570;&#x5B66;&#x6216;&#x4F4D;&#x64CD;&#x4F5C;&#x3002; &#x5176;&#x4E2D;&#xFF0C;&#x6808;&#x9876;&#x7684;&#x90A3;&#x4E2A;&#x503C;&#x662F;&#x7B2C;&#x4E8C;&#x4E2A;&#x64CD;&#x4F5C;&#x6570;&#x3002; &#x5B83;&#x4F1A;&#x5F39;&#x51FA;&#x538B;&#x5165;&#x7684;&#x503C;&#xFF0C;&#x5E76;&#x628A;&#x7ED3;&#x679C;&#x653E;&#x5728;&#x6808;&#x9876;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x9075;&#x5FAA; Lua &#x5BF9;&#x5E94;&#x7684;&#x64CD;&#x4F5C;&#x7B26;&#x8FD0;&#x7B97;&#x89C4;&#x5219; &#xFF08;&#x5373;&#x6709;&#x53EF;&#x80FD;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#xFF09;&#x3002;</p>
<p>op &#x7684;&#x503C;&#x5FC5;&#x987B;&#x662F;&#x4E0B;&#x5217;&#x5E38;&#x91CF;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#xFF1A;</p>
<p>LUA_OPADD: &#x52A0;&#x6CD5; (+)
LUA_OPSUB: &#x51CF;&#x6CD5; (-)
LUA_OPMUL: &#x4E58;&#x6CD5; (*)
LUA_OPDIV: &#x6D6E;&#x70B9;&#x9664;&#x6CD5; (/)
LUA_OPIDIV: &#x5411;&#x4E0B;&#x53D6;&#x6574;&#x7684;&#x9664;&#x6CD5; (//)
LUA_OPMOD: &#x53D6;&#x6A21; (%)
LUA_OPPOW: &#x4E58;&#x65B9; (^)
LUA_OPUNM: &#x53D6;&#x8D1F; (&#x4E00;&#x5143; -)
LUA_OPBNOT: &#x6309;&#x4F4D;&#x53D6;&#x53CD; (~)
LUA_OPBAND: &#x6309;&#x4F4D;&#x4E0E; (&amp;)
LUA_OPBOR: &#x6309;&#x4F4D;&#x6216; (|)
LUA_OPBXOR: &#x6309;&#x4F4D;&#x5F02;&#x6216; (~)
LUA_OPSHL: &#x5DE6;&#x79FB; (&lt;&lt;)
LUA_OPSHR: &#x53F3;&#x79FB; (&gt;&gt;)
lua_atpanic</p>
<p>[-0, +0, &#x2013;]
lua_CFunction lua_atpanic (lua_State *L, lua_CFunction panicf);
&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x65B0;&#x7684; panic &#x51FD;&#x6570;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x8BBE;&#x7F6E;&#x7684;&#x90A3;&#x4E2A;&#x3002; &#xFF08;&#x53C2;&#x89C1; &#xA7;4.6&#xFF09;&#x3002;</p>
<p>lua_call</p>
<p>[-(nargs+1), +nresults, e]
void lua_call (lua_State *L, int nargs, int nresults);
&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x8981;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x8BF7;&#x9075;&#x5FAA;&#x4EE5;&#x4E0B;&#x534F;&#x8BAE;&#xFF1A; &#x9996;&#x5148;&#xFF0C;&#x8981;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x5E94;&#x8BE5;&#x88AB;&#x538B;&#x5165;&#x6808;&#xFF1B; &#x63A5;&#x7740;&#xFF0C;&#x628A;&#x9700;&#x8981;&#x4F20;&#x9012;&#x7ED9;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x6309;&#x6B63;&#x5E8F;&#x538B;&#x6808;&#xFF1B; &#x8FD9;&#x662F;&#x6307;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x9996;&#x5148;&#x538B;&#x6808;&#x3002; &#x6700;&#x540E;&#x8C03;&#x7528;&#x4E00;&#x4E0B; lua_call&#xFF1B; nargs &#x662F;&#x4F60;&#x538B;&#x5165;&#x6808;&#x7684;&#x53C2;&#x6570;&#x4E2A;&#x6570;&#x3002; &#x5F53;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x5B8C;&#x6BD5;&#x540E;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x51FD;&#x6570;&#x672C;&#x8EAB;&#x90FD;&#x4F1A;&#x51FA;&#x6808;&#x3002; &#x800C;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x8FD9;&#x65F6;&#x5219;&#x88AB;&#x538B;&#x6808;&#x3002; &#x8FD4;&#x56DE;&#x503C;&#x7684;&#x4E2A;&#x6570;&#x5C06;&#x88AB;&#x8C03;&#x6574;&#x4E3A; nresults &#x4E2A;&#xFF0C; &#x9664;&#x975E; nresults &#x88AB;&#x8BBE;&#x7F6E;&#x6210; LUA_MULTRET&#x3002; &#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x90FD;&#x88AB;&#x538B;&#x5165;&#x5806;&#x6808;&#x4E2D;&#x3002; Lua &#x4F1A;&#x4FDD;&#x8BC1;&#x8FD4;&#x56DE;&#x503C;&#x90FD;&#x653E;&#x5165;&#x6808;&#x7A7A;&#x95F4;&#x4E2D;&#x3002; &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x503C;&#x5C06;&#x6309;&#x6B63;&#x5E8F;&#x538B;&#x6808;&#xFF08;&#x7B2C;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x9996;&#x5148;&#x538B;&#x6808;&#xFF09;&#xFF0C; &#x56E0;&#x6B64;&#x5728;&#x8C03;&#x7528;&#x7ED3;&#x675F;&#x540E;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x5C06;&#x88AB;&#x653E;&#x5728;&#x6808;&#x9876;&#x3002;</p>
<p>&#x88AB;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x5185;&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x5C06;&#xFF08;&#x901A;&#x8FC7; longjmp &#xFF09;&#x4E00;&#x76F4;&#x4E0A;&#x629B;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x8FD9;&#x884C; Lua &#x4EE3;&#x7801;&#x7B49;&#x4EF7;&#x4E8E;&#x5728;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E2D;&#x7528; C &#x4EE3;&#x7801;&#x505A;&#x4E00;&#x4E9B;&#x5DE5;&#x4F5C;&#xFF1A;</p>
<pre><code> a = f(&quot;how&quot;, t.x, 14)
</code></pre><p>&#x8FD9;&#x91CC;&#x662F; C &#x91CC;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code> lua_getglobal(L, &quot;f&quot;);                  /* function to be called */
 lua_pushliteral(L, &quot;how&quot;);                       /* 1st argument */
 lua_getglobal(L, &quot;t&quot;);                    /* table to be indexed */
 lua_getfield(L, -1, &quot;x&quot;);        /* push result of t.x (2nd arg) */
 lua_remove(L, -2);                  /* remove &apos;t&apos; from the stack */
 lua_pushinteger(L, 14);                          /* 3rd argument */
 lua_call(L, 3, 1);     /* call &apos;f&apos; with 3 arguments and 1 result */
 lua_setglobal(L, &quot;a&quot;);                         /* set global &apos;a&apos; */
</code></pre><p>&#x6CE8;&#x610F;&#x4E0A;&#x9762;&#x8FD9;&#x6BB5;&#x4EE3;&#x7801;&#x662F; &#x5E73;&#x8861; &#x7684;&#xFF1A; &#x5230;&#x4E86;&#x6700;&#x540E;&#xFF0C;&#x5806;&#x6808;&#x6062;&#x590D;&#x6210;&#x539F;&#x6709;&#x7684;&#x914D;&#x7F6E;&#x3002; &#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x826F;&#x597D;&#x7684;&#x7F16;&#x7A0B;&#x4E60;&#x60EF;&#x3002;</p>
<p>lua_callk</p>
<p>[-(nargs + 1), +nresults, e]
void lua_callk (lua_State *L,
                int nargs,
                int nresults,
                lua_KContext ctx,
                lua_KFunction k);
&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x884C;&#x4E3A;&#x548C; lua_call &#x5B8C;&#x5168;&#x4E00;&#x81F4;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x5B83;&#x8FD8;&#x5141;&#x8BB8;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x8BA9;&#x51FA; &#xFF08;&#x53C2;&#x89C1; &#xA7;4.7&#xFF09;&#x3002;</p>
<p>lua_CFunction</p>
<p>typedef int (<em>lua_CFunction) (lua_State </em>L);
C &#x51FD;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x6B63;&#x786E;&#x7684;&#x548C; Lua &#x901A;&#x8BAF;&#xFF0C; C &#x51FD;&#x6570;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x4E0B;&#x5217;&#x534F;&#x8BAE;&#x3002; &#x8FD9;&#x4E2A;&#x534F;&#x8BAE;&#x5B9A;&#x4E49;&#x4E86;&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x8FD4;&#x56DE;&#x503C;&#x4F20;&#x9012;&#x65B9;&#x6CD5;&#xFF1A; C &#x51FD;&#x6570;&#x901A;&#x8FC7; Lua &#x4E2D;&#x7684;&#x6808;&#x6765;&#x63A5;&#x53D7;&#x53C2;&#x6570;&#xFF0C; &#x53C2;&#x6570;&#x4EE5;&#x6B63;&#x5E8F;&#x5165;&#x6808;&#xFF08;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x9996;&#x5148;&#x5165;&#x6808;&#xFF09;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5F53;&#x51FD;&#x6570;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#xFF0C; lua_gettop(L) &#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x6536;&#x5230;&#x7684;&#x53C2;&#x6570;&#x4E2A;&#x6570;&#x3002; &#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#x5728;&#x7D22;&#x5F15; 1 &#x7684;&#x5730;&#x65B9;&#xFF0C; &#x800C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x5728;&#x7D22;&#x5F15; lua_gettop(L) &#x5904;&#x3002; &#x5F53;&#x9700;&#x8981;&#x5411; Lua &#x8FD4;&#x56DE;&#x503C;&#x7684;&#x65F6;&#x5019;&#xFF0C; C &#x51FD;&#x6570;&#x53EA;&#x9700;&#x8981;&#x628A;&#x5B83;&#x4EEC;&#x4EE5;&#x6B63;&#x5E8F;&#x538B;&#x5230;&#x5806;&#x6808;&#x4E0A;&#xFF08;&#x7B2C;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x6700;&#x5148;&#x538B;&#x5165;&#xFF09;&#xFF0C; &#x7136;&#x540E;&#x8FD4;&#x56DE;&#x8FD9;&#x4E9B;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x4E2A;&#x6570;&#x3002; &#x5728;&#x8FD9;&#x4E9B;&#x8FD4;&#x56DE;&#x503C;&#x4E4B;&#x4E0B;&#x7684;&#xFF0C;&#x5806;&#x6808;&#x4E0A;&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x4F1A;&#x88AB; Lua &#x4E22;&#x6389;&#x3002; &#x548C; Lua &#x51FD;&#x6570;&#x4E00;&#x6837;&#xFF0C;&#x4ECE; Lua &#x4E2D;&#x8C03;&#x7528; C &#x51FD;&#x6570;&#x4E5F;&#x53EF;&#x4EE5;&#x6709;&#x5F88;&#x591A;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x5C06;&#x63A5;&#x6536;&#x82E5;&#x5E72;&#x6570;&#x5B57;&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x5B83;&#x4EEC;&#x7684;&#x5E73;&#x5747;&#x6570;&#x4E0E;&#x548C;&#xFF1A;</p>
<pre><code> static int foo (lua_State *L) {
   int n = lua_gettop(L);    /* &#x53C2;&#x6570;&#x7684;&#x4E2A;&#x6570; */
   lua_Number sum = 0.0;
   int i;
   for (i = 1; i &lt;= n; i++) {
     if (!lua_isnumber(L, i)) {
       lua_pushliteral(L, &quot;incorrect argument&quot;);
       lua_error(L);
     }
     sum += lua_tonumber(L, i);
   }
   lua_pushnumber(L, sum/n);        /* &#x7B2C;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C; */
   lua_pushnumber(L, sum);         /* &#x7B2C;&#x4E8C;&#x4E2A;&#x8FD4;&#x56DE;&#x503C; */
   return 2;                   /* &#x8FD4;&#x56DE;&#x503C;&#x7684;&#x4E2A;&#x6570; */
 }
</code></pre><p>lua_checkstack</p>
<p>[-0, +0, &#x2013;]
int lua_checkstack (lua_State *L, int n);
&#x786E;&#x4FDD;&#x5806;&#x6808;&#x4E0A;&#x81F3;&#x5C11;&#x6709; n &#x4E2A;&#x989D;&#x5916;&#x7A7A;&#x4F4D;&#x3002; &#x5982;&#x679C;&#x4E0D;&#x80FD;&#x628A;&#x5806;&#x6808;&#x6269;&#x5C55;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x5C3A;&#x5BF8;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5047;&#x3002; &#x5931;&#x8D25;&#x7684;&#x539F;&#x56E0;&#x5305;&#x62EC;&#x5C06;&#x628A;&#x6808;&#x6269;&#x5C55;&#x5230;&#x6BD4;&#x56FA;&#x5B9A;&#x6700;&#x5927;&#x5C3A;&#x5BF8;&#x8FD8;&#x5927; &#xFF08;&#x81F3;&#x5C11;&#x662F;&#x51E0;&#x5343;&#x4E2A;&#x5143;&#x7D20;&#xFF09;&#x6216;&#x5206;&#x914D;&#x5185;&#x5B58;&#x5931;&#x8D25;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x7F29;&#x5C0F;&#x5806;&#x6808;&#xFF1B; &#x5982;&#x679C;&#x5806;&#x6808;&#x5DF2;&#x7ECF;&#x6BD4;&#x9700;&#x8981;&#x7684;&#x5927;&#x4E86;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4FDD;&#x6301;&#x539F;&#x6837;&#x3002;</p>
<p>lua_close</p>
<p>[-0, +0, &#x2013;]
void lua_close (lua_State *L);
&#x9500;&#x6BC1;&#x6307;&#x5B9A; Lua &#x72B6;&#x6001;&#x673A;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61; &#xFF08;&#x5982;&#x679C;&#x6709;&#x5783;&#x573E;&#x6536;&#x96C6;&#x76F8;&#x5173;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#x7684;&#x8BDD;&#xFF0C;&#x4F1A;&#x8C03;&#x7528;&#x5B83;&#x4EEC;&#xFF09;&#xFF0C; &#x5E76;&#x4E14;&#x91CA;&#x653E;&#x72B6;&#x6001;&#x673A;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x6240;&#x6709;&#x52A8;&#x6001;&#x5185;&#x5B58;&#x3002; &#x5728;&#x4E00;&#x4E9B;&#x5E73;&#x53F0;&#x4E0A;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4E0D;&#x5FC5;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C; &#x56E0;&#x4E3A;&#x5F53;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x7ED3;&#x675F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x8D44;&#x6E90;&#x5C31;&#x81EA;&#x7136;&#x88AB;&#x91CA;&#x653E;&#x6389;&#x4E86;&#x3002; &#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;&#x957F;&#x671F;&#x8FD0;&#x884C;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x6BD4;&#x5982;&#x4E00;&#x4E2A;&#x540E;&#x53F0;&#x7A0B;&#x5E8F;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x7F51;&#x7AD9;&#x670D;&#x52A1;&#x5668;&#xFF0C; &#x4F1A;&#x521B;&#x5EFA;&#x51FA;&#x591A;&#x4E2A; Lua &#x72B6;&#x6001;&#x673A;&#x3002;&#x90A3;&#x4E48;&#x5C31;&#x5E94;&#x8BE5;&#x5728;&#x4E0D;&#x9700;&#x8981;&#x65F6;&#x8D76;&#x7D27;&#x5173;&#x95ED;&#x5B83;&#x4EEC;&#x3002;</p>
<p>lua_compare</p>
<p>[-0, +0, e]
int lua_compare (lua_State *L, int index1, int index2, int op);
&#x6BD4;&#x8F83;&#x4E24;&#x4E2A; Lua &#x503C;&#x3002; &#x5F53;&#x7D22;&#x5F15; index1 &#x5904;&#x7684;&#x503C;&#x901A;&#x8FC7; op &#x548C;&#x7D22;&#x5F15; index2 &#x5904;&#x7684;&#x503C;&#x505A;&#x6BD4;&#x8F83;&#x540E;&#x6761;&#x4EF6;&#x6EE1;&#x8DB3;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE; 1 &#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x9075;&#x5FAA; Lua &#x5BF9;&#x5E94;&#x7684;&#x64CD;&#x4F5C;&#x89C4;&#x5219;&#xFF08;&#x5373;&#x6709;&#x53EF;&#x80FD;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#xFF09;&#x3002; &#x53CD;&#x4E4B;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE; 0&#x3002; &#x5F53;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x7D22;&#x5F15;&#x65E0;&#x6548;&#x65F6;&#xFF0C;&#x51FD;&#x6570;&#x4E5F;&#x4F1A;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>op &#x503C;&#x5FC5;&#x987B;&#x662F;&#x4E0B;&#x5217;&#x5E38;&#x91CF;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#xFF1A;</p>
<p>LUA_OPEQ: &#x76F8;&#x7B49;&#x6BD4;&#x8F83; (==)
LUA_OPLT: &#x5C0F;&#x4E8E;&#x6BD4;&#x8F83; (&lt;)
LUA_OPLE: &#x5C0F;&#x4E8E;&#x7B49;&#x4E8E;&#x6BD4;&#x8F83; (&lt;=)
lua_concat</p>
<p>[-n, +1, e]
void lua_concat (lua_State *L, int n);
&#x8FDE;&#x63A5;&#x6808;&#x9876;&#x7684; n &#x4E2A;&#x503C;&#xFF0C; &#x7136;&#x540E;&#x5C06;&#x8FD9;&#x4E9B;&#x503C;&#x51FA;&#x6808;&#xFF0C;&#x5E76;&#x628A;&#x7ED3;&#x679C;&#x653E;&#x5728;&#x6808;&#x9876;&#x3002; &#x5982;&#x679C; n &#x4E3A; 1 &#xFF0C;&#x7ED3;&#x679C;&#x5C31;&#x662F;&#x90A3;&#x4E2A;&#x503C;&#x653E;&#x5728;&#x6808;&#x4E0A;&#xFF08;&#x5373;&#xFF0C;&#x51FD;&#x6570;&#x4EC0;&#x4E48;&#x90FD;&#x4E0D;&#x505A;&#xFF09;&#xFF1B; &#x5982;&#x679C; n &#x4E3A; 0 &#xFF0C;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x7A7A;&#x4E32;&#x3002; &#x8FDE;&#x63A5;&#x4F9D;&#x7167; Lua &#x4E2D;&#x901A;&#x5E38;&#x8BED;&#x4E49;&#x5B8C;&#x6210;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.6 &#xFF09;&#x3002;</p>
<p>lua_copy</p>
<p>[-0, +0, &#x2013;]
void lua_copy (lua_State *L, int fromidx, int toidx);
&#x4ECE;&#x7D22;&#x5F15; fromidx &#x5904;&#x590D;&#x5236;&#x4E00;&#x4E2A;&#x503C;&#x5230;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7D22;&#x5F15; toidx &#x5904;&#xFF0C;&#x8986;&#x76D6;&#x90A3;&#x91CC;&#x7684;&#x539F;&#x6709;&#x503C;&#x3002; &#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x5176;&#x5B83;&#x4F4D;&#x7F6E;&#x7684;&#x503C;&#x3002;</p>
<p>lua_createtable</p>
<p>[-0, +1, e]
void lua_createtable (lua_State *L, int narr, int nrec);
&#x521B;&#x5EFA;&#x4E00;&#x5F20;&#x65B0;&#x7684;&#x7A7A;&#x8868;&#x538B;&#x6808;&#x3002; &#x53C2;&#x6570; narr &#x5EFA;&#x8BAE;&#x4E86;&#x8FD9;&#x5F20;&#x8868;&#x4F5C;&#x4E3A;&#x5E8F;&#x5217;&#x4F7F;&#x7528;&#x65F6;&#x4F1A;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x5143;&#x7D20;&#xFF1B; &#x53C2;&#x6570; nrec &#x5EFA;&#x8BAE;&#x4E86;&#x8FD9;&#x5F20;&#x8868;&#x53EF;&#x80FD;&#x62E5;&#x6709;&#x591A;&#x5C11;&#x5E8F;&#x5217;&#x4E4B;&#x5916;&#x7684;&#x5143;&#x7D20;&#x3002; Lua &#x4F1A;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x5EFA;&#x8BAE;&#x6765;&#x9884;&#x5206;&#x914D;&#x8FD9;&#x5F20;&#x65B0;&#x8868;&#x3002; &#x5982;&#x679C;&#x4F60;&#x77E5;&#x9053;&#x8FD9;&#x5F20;&#x8868;&#x7528;&#x9014;&#x7684;&#x66F4;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x9884;&#x5206;&#x914D;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x6027;&#x80FD;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x51FD;&#x6570; lua_newtable &#x3002;</p>
<p>lua_dump</p>
<p>[-0, +0, e]
int lua_dump (lua_State <em>L,
                        lua_Writer writer,
                        void </em>data,
                        int strip);
&#x628A;&#x51FD;&#x6570;&#x5BFC;&#x51FA;&#x6210;&#x4E8C;&#x8FDB;&#x5236;&#x4EE3;&#x7801;&#x5757; &#x3002; &#x51FD;&#x6570;&#x63A5;&#x6536;&#x6808;&#x9876;&#x7684; Lua &#x51FD;&#x6570;&#x505A;&#x53C2;&#x6570;&#xFF0C; &#x7136;&#x540E;&#x751F;&#x6210;&#x5B83;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x4EE3;&#x7801;&#x5757;&#x3002; &#x82E5;&#x88AB;&#x5BFC;&#x51FA;&#x7684;&#x4E1C;&#x897F;&#x88AB;&#x518D;&#x6B21;&#x52A0;&#x8F7D;&#xFF0C; &#x52A0;&#x8F7D;&#x7684;&#x7ED3;&#x679C;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x539F;&#x6765;&#x7684;&#x51FD;&#x6570;&#x3002; &#x5F53;&#x5B83;&#x5728;&#x4EA7;&#x751F;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x65F6;&#x5019;&#xFF0C; lua_dump &#x901A;&#x8FC7;&#x8C03;&#x7528;&#x51FD;&#x6570; writer &#xFF08;&#x53C2;&#x89C1; lua_Writer &#xFF09; &#x6765;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x540E;&#x9762;&#x7684; data &#x53C2;&#x6570;&#x4F1A;&#x88AB;&#x4F20;&#x5165; writer &#x3002;</p>
<p>&#x5982;&#x679C; strip &#x4E3A;&#x771F;&#xFF0C; &#x4E8C;&#x8FDB;&#x5236;&#x4EE3;&#x7801;&#x5757;&#x5C06;&#x4E0D;&#x5305;&#x542B;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x6700;&#x540E;&#x4E00;&#x6B21;&#x7531; writer &#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5C06;&#x4F5C;&#x4E3A;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x8FD4;&#x56DE;&#xFF1B; 0 &#x8868;&#x793A;&#x6CA1;&#x6709;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x8BE5;&#x51FD;&#x6570;&#x4E0D;&#x4F1A;&#x628A; Lua &#x51FD;&#x6570;&#x5F39;&#x51FA;&#x5806;&#x6808;&#x3002;</p>
<p>lua_error</p>
<p>[-1, +0, v]
int lua_error (lua_State *L);
&#x4EE5;&#x6808;&#x9876;&#x7684;&#x503C;&#x4F5C;&#x4E3A;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#xFF0C;&#x629B;&#x51FA;&#x4E00;&#x4E2A; Lua &#x9519;&#x8BEF;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06;&#x505A;&#x4E00;&#x6B21;&#x957F;&#x8DF3;&#x8F6C;&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x5B9A;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE; &#xFF08;&#x53C2;&#x89C1; luaL_error&#xFF09;&#x3002;</p>
<p>lua_gc</p>
<p>[-0, +0, e]
int lua_gc (lua_State *L, int what, int data);
&#x63A7;&#x5236;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6839;&#x636E;&#x5176;&#x53C2;&#x6570; what &#x53D1;&#x8D77;&#x51E0;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x4EFB;&#x52A1;&#xFF1A;</p>
<p>LUA_GCSTOP: &#x505C;&#x6B62;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x3002;
LUA_GCRESTART: &#x91CD;&#x542F;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x3002;
LUA_GCCOLLECT: &#x53D1;&#x8D77;&#x4E00;&#x6B21;&#x5B8C;&#x6574;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5FAA;&#x73AF;&#x3002;
LUA_GCCOUNT: &#x8FD4;&#x56DE; Lua &#x4F7F;&#x7528;&#x7684;&#x5185;&#x5B58;&#x603B;&#x91CF;&#xFF08;&#x4EE5; K &#x5B57;&#x8282;&#x4E3A;&#x5355;&#x4F4D;&#xFF09;&#x3002;
LUA_GCCOUNTB: &#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x91CF;&#x9664;&#x4EE5; 1024 &#x7684;&#x4F59;&#x6570;&#x3002;
LUA_GCSTEP: &#x53D1;&#x8D77;&#x4E00;&#x6B65;&#x589E;&#x91CF;&#x5783;&#x573E;&#x6536;&#x96C6;&#x3002;
LUA_GCSETPAUSE: &#x628A; data &#x8BBE;&#x4E3A; &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x95F4;&#x6B47;&#x7387; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.5&#xFF09;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x8BBE;&#x7F6E;&#x7684;&#x503C;&#x3002;
LUA_GCSETSTEPMUL: &#x628A; data &#x8BBE;&#x4E3A; &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x6B65;&#x8FDB;&#x500D;&#x7387; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.5&#xFF09;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E4B;&#x524D;&#x8BBE;&#x7F6E;&#x7684;&#x503C;&#x3002;
LUA_GCISRUNNING: &#x8FD4;&#x56DE;&#x6536;&#x96C6;&#x5668;&#x662F;&#x5426;&#x5728;&#x8FD0;&#x884C;&#xFF08;&#x5373;&#x6CA1;&#x6709;&#x505C;&#x6B62;&#xFF09;&#x3002;
&#x5173;&#x4E8E;&#x8FD9;&#x4E9B;&#x9009;&#x9879;&#x7684;&#x7EC6;&#x8282;&#xFF0C;&#x53C2;&#x89C1; collectgarbage &#x3002;</p>
<p>lua_getallocf</p>
<p>[-0, +0, &#x2013;]
lua_Alloc lua_getallocf (lua_State <em>L, void **ud);
&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x72B6;&#x6001;&#x673A;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668;&#x51FD;&#x6570;&#x3002; &#x5982;&#x679C; ud &#x4E0D;&#x662F; NULL &#xFF0C; Lua &#x628A;&#x8BBE;&#x7F6E;&#x5185;&#x5B58;&#x5206;&#x914D;&#x51FD;&#x6570;&#x65F6;&#x8BBE;&#x7F6E;&#x7684;&#x90A3;&#x4E2A;&#x6307;&#x9488;&#x7F6E;&#x5165; </em>ud &#x3002;</p>
<p>lua_getfield</p>
<p>[-0, +1, e]
int lua_getfield (lua_State <em>L, int index, const char </em>k);
&#x628A; t[k] &#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C; &#x8FD9;&#x91CC;&#x7684; t &#x662F;&#x7D22;&#x5F15;&#x6307;&#x5411;&#x7684;&#x503C;&#x3002; &#x5728; Lua &#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x89E6;&#x53D1;&#x5BF9;&#x5E94; &quot;index&quot; &#x4E8B;&#x4EF6;&#x5BF9;&#x5E94;&#x7684;&#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4 &#xFF09;&#x3002;</p>
<p>&#x51FD;&#x6570;&#x5C06;&#x8FD4;&#x56DE;&#x538B;&#x5165;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>lua_getextraspace</p>
<p>[-0, +0, &#x2013;]
void <em>lua_getextraspace (lua_State </em>L);
&#x8FD4;&#x56DE;&#x4E00;&#x4E2A; Lua &#x72B6;&#x6001;&#x673A;&#x4E2D;&#x5173;&#x8054;&#x7684;&#x5185;&#x5B58;&#x5757;&#x6307;&#x9488;&#x3002; &#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x628A;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x7528;&#x4E8E;&#x4EFB;&#x4F55;&#x7528;&#x9014;&#xFF1B;&#x800C; Lua &#x4E0D;&#x4F1A;&#x4F7F;&#x7528;&#x5B83;&#x3002;</p>
<p>&#x6BCF;&#x4E00;&#x4E2A;&#x65B0;&#x7EBF;&#x7A0B;&#x90FD;&#x4F1A;&#x643A;&#x5E26;&#x4E00;&#x5757;&#x5185;&#x5B58;&#xFF0C; &#x521D;&#x59CB;&#x5316;&#x4E3A;&#x4E3B;&#x7EBF;&#x7A0B;&#x7684;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x7684;&#x526F;&#x672C;&#x3002;</p>
<p>&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x4E0B;&#xFF0C;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x7684;&#x5927;&#x5C0F;&#x4E3A;&#x7A7A;&#x6307;&#x9488;&#x7684;&#x5927;&#x5C0F;&#x3002; &#x4E0D;&#x8FC7;&#x4F60;&#x53EF;&#x4EE5;&#x91CD;&#x65B0;&#x7F16;&#x8BD1; Lua &#x8BBE;&#x5B9A;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x4E0D;&#x540C;&#x7684;&#x5927;&#x5C0F;&#x3002; &#xFF08;&#x53C2;&#x89C1; <code>luaconf.h</code> &#x4E2D;&#x7684; <code>LUA_EXTRASPACE</code>&#x3002;&#xFF09;</p>
<p>lua_getglobal</p>
<p>[-0, +1, e]
int lua_getglobal (lua_State <em>L, const char </em>name);
&#x628A;&#x5168;&#x5C40;&#x53D8;&#x91CF; name &#x91CC;&#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C;&#x8FD4;&#x56DE;&#x8BE5;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>lua_geti</p>
<p>[-0, +1, e]
int lua_geti (lua_State *L, int index, lua_Integer i);
&#x628A; t[i] &#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C; &#x8FD9;&#x91CC;&#x7684; t &#x6307;&#x7ED9;&#x5B9A;&#x7684;&#x7D22;&#x5F15;&#x6307;&#x4EE3;&#x7684;&#x503C;&#x3002; &#x548C;&#x5728; Lua &#x91CC;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x4F1A;&#x89E6;&#x53D1; &quot;index&quot; &#x4E8B;&#x4EF6;&#x7684;&#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x538B;&#x5165;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>lua_getmetatable</p>
<p>[-0, +(0|1), &#x2013;]
int lua_getmetatable (lua_State *L, int index);
&#x5982;&#x679C;&#x8BE5;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x503C;&#x6709;&#x5143;&#x8868;&#xFF0C;&#x5219;&#x5C06;&#x5176;&#x5143;&#x8868;&#x538B;&#x6808;&#xFF0C;&#x8FD4;&#x56DE; 1 &#x3002; &#x5426;&#x5219;&#x4E0D;&#x4F1A;&#x5C06;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#x5165;&#x6808;&#xFF0C;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_gettable</p>
<p>[-1, +1, e]
int lua_gettable (lua_State *L, int index);
&#x628A; t[k] &#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C; &#x8FD9;&#x91CC;&#x7684; t &#x662F;&#x6307;&#x7D22;&#x5F15;&#x6307;&#x5411;&#x7684;&#x503C;&#xFF0C; &#x800C; k &#x5219;&#x662F;&#x6808;&#x9876;&#x653E;&#x7684;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x5F39;&#x51FA;&#x5806;&#x6808;&#x4E0A;&#x7684;&#x952E;&#xFF0C;&#x628A;&#x7ED3;&#x679C;&#x653E;&#x5728;&#x6808;&#x4E0A;&#x76F8;&#x540C;&#x4F4D;&#x7F6E;&#x3002; &#x548C;&#x5728; Lua &#x4E2D;&#x4E00;&#x6837;&#xFF0C; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x89E6;&#x53D1;&#x5BF9;&#x5E94; &quot;index&quot; &#x4E8B;&#x4EF6;&#x7684;&#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4 &#xFF09;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x538B;&#x5165;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>lua_gettop</p>
<p>[-0, +0, &#x2013;]
int lua_gettop (lua_State *L);
&#x8FD4;&#x56DE;&#x6808;&#x9876;&#x5143;&#x7D20;&#x7684;&#x7D22;&#x5F15;&#x3002; &#x56E0;&#x4E3A;&#x7D22;&#x5F15;&#x662F;&#x4ECE; 1 &#x5F00;&#x59CB;&#x7F16;&#x53F7;&#x7684;&#xFF0C; &#x6240;&#x4EE5;&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x7B49;&#x4E8E;&#x6808;&#x4E0A;&#x7684;&#x5143;&#x7D20;&#x4E2A;&#x6570;&#xFF1B; &#x7279;&#x522B;&#x6307;&#x51FA;&#xFF0C;0 &#x8868;&#x793A;&#x6808;&#x4E3A;&#x7A7A;&#x3002;</p>
<p>lua_getuservalue</p>
<p>[-0, +1, &#x2013;]
int lua_getuservalue (lua_State *L, int index);
&#x5C06;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x7528;&#x6237;&#x6570;&#x636E;&#x6240;&#x5173;&#x8054;&#x7684; Lua &#x503C;&#x538B;&#x6808;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x538B;&#x5165;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>lua_insert</p>
<p>[-1, +1, &#x2013;]
void lua_insert (lua_State *L, int index);
&#x628A;&#x6808;&#x9876;&#x5143;&#x7D20;&#x79FB;&#x52A8;&#x5230;&#x6307;&#x5B9A;&#x7684;&#x6709;&#x6548;&#x7D22;&#x5F15;&#x5904;&#xFF0C; &#x4F9D;&#x6B21;&#x79FB;&#x52A8;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x4E4B;&#x4E0A;&#x7684;&#x5143;&#x7D20;&#x3002; &#x4E0D;&#x8981;&#x7528;&#x4F2A;&#x7D22;&#x5F15;&#x6765;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C; &#x56E0;&#x4E3A;&#x4F2A;&#x7D22;&#x5F15;&#x6CA1;&#x6709;&#x771F;&#x6B63;&#x6307;&#x5411;&#x6808;&#x4E0A;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>lua_Integer</p>
<p>typedef ... lua_Integer;
Lua &#x4E2D;&#x7684;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x7F3A;&#x7701;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C31;&#x662F; long long&#xFF0C; &#xFF08;&#x901A;&#x5E38;&#x662F;&#x4E00;&#x4E2A; 64 &#x4F4D;&#x4EE5;&#x4E8C;&#x4E3A;&#x8865;&#x7801;&#x7684;&#x6574;&#x6570;&#xFF09;&#xFF0C; &#x4E5F;&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x5B83;&#x4E3A; long &#x6216; int &#xFF08;&#x901A;&#x5E38;&#x662F;&#x4E00;&#x4E2A; 32 &#x4F4D;&#x4EE5;&#x4E8C;&#x4E3A;&#x8865;&#x7801;&#x7684;&#x6574;&#x6570;&#xFF09;&#x3002; &#xFF08;&#x53C2;&#x89C1; luaconf.h &#x4E2D;&#x7684; LUA_INT &#x3002;&#xFF09;</p>
<p>Lua &#x5B9A;&#x4E49;&#x4E86;&#x4E24;&#x4E2A;&#x5E38;&#x91CF;&#xFF1A; LUA_MININTEGER &#x548C; LUA_MAXINTEGER &#x6765;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x8868;&#x793A;&#x7684;&#x6700;&#x5C0F;&#x548C;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<p>lua_isboolean</p>
<p>[-0, +0, &#x2013;]
int lua_isboolean (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_iscfunction</p>
<p>[-0, +0, &#x2013;]
int lua_iscfunction (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A; C &#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isfunction</p>
<p>[-0, +0, &#x2013;]
int lua_isfunction (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF08; C &#x6216; Lua &#x51FD;&#x6570;&#x5747;&#x53EF;&#xFF09;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isinteger</p>
<p>[-0, +0, &#x2013;]
int lua_isinteger (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570; &#xFF08;&#x5176;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x4E14;&#x5185;&#x90E8;&#x4EE5;&#x6574;&#x6570;&#x50A8;&#x5B58;&#xFF09;&#xFF0C; &#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_islightuserdata</p>
<p>[-0, +0, &#x2013;]
int lua_islightuserdata (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isnil</p>
<p>[-0, +0, &#x2013;]
int lua_isnil (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F; nil &#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isnone</p>
<p>[-0, +0, &#x2013;]
int lua_isnone (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x65E0;&#x6548;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isnoneornil</p>
<p>[-0, +0, &#x2013;]
int lua_isnoneornil (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x65E0;&#x6548;&#x6216;&#x5176;&#x503C;&#x662F; nil &#x65F6;&#xFF0C; &#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isnumber</p>
<p>[-0, +0, &#x2013;]
int lua_isnumber (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isstring</p>
<p>[-0, +0, &#x2013;]
int lua_isstring (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57; &#xFF08;&#x6570;&#x5B57;&#x603B;&#x80FD;&#x8F6C;&#x6362;&#x6210;&#x5B57;&#x7B26;&#x4E32;&#xFF09;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_istable</p>
<p>[-0, +0, &#x2013;]
int lua_istable (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x5F20;&#x8868;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isthread</p>
<p>[-0, +0, &#x2013;]
int lua_isthread (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x6761;&#x7EBF;&#x7A0B;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isuserdata</p>
<p>[-0, +0, &#x2013;]
int lua_isuserdata (lua_State *L, int index);
&#x5F53;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF08;&#x65E0;&#x8BBA;&#x662F;&#x5B8C;&#x5168;&#x7684;&#x8FD8;&#x662F;&#x8F7B;&#x91CF;&#x7684;&#xFF09;&#x65F6;&#xFF0C; &#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_isyieldable</p>
<p>[-0, +0, &#x2013;]
int lua_isyieldable (lua_State *L);
&#x5982;&#x679C;&#x7ED9;&#x5B9A;&#x7684;&#x534F;&#x7A0B;&#x53EF;&#x4EE5;&#x8BA9;&#x51FA;&#xFF0C;&#x8FD4;&#x56DE; 1 &#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_KContext</p>
<p>typedef ... lua_KContext;
&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x4E0A;&#x4E0B;&#x6587;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x3002; &#x8FD9;&#x4E00;&#x5B9A;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x7C7B;&#x578B;&#x3002; &#x5F53;&#x6709; intptr_t &#x65F6;&#xFF0C;&#x88AB;&#x5B9A;&#x4E49;&#x4E3A; intptr_t &#xFF0C; &#x56E0;&#x6B64;&#x5B83;&#x4E5F;&#x53EF;&#x4EE5;&#x4FDD;&#x5B58;&#x6307;&#x9488;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x5B83;&#x88AB;&#x5B9A;&#x4E49;&#x4E3A; ptrdiff_t&#x3002;</p>
<p>lua_KFunction</p>
<p>typedef int (<em>lua_KFunction) (lua_State </em>L, int status, lua_KContext ctx);
&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x7684;&#x7C7B;&#x578B;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.7 &#xFF09;&#x3002;</p>
<p>lua_len</p>
<p>[-0, +1, e]
void lua_len (lua_State *L, int index);
&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x7684;&#x503C;&#x7684;&#x957F;&#x5EA6;&#x3002; &#x5B83;&#x7B49;&#x4EF7;&#x4E8E; Lua &#x4E2D;&#x7684; &apos;#&apos; &#x64CD;&#x4F5C;&#x7B26; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.7&#xFF09;&#x3002; &#x5B83;&#x6709;&#x53EF;&#x80FD;&#x89E6;&#x53D1; &quot;length&quot; &#x4E8B;&#x4EF6;&#x5BF9;&#x5E94;&#x7684;&#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4 &#xFF09;&#x3002; &#x7ED3;&#x679C;&#x538B;&#x6808;&#x3002;</p>
<p>lua_load</p>
<p>[-0, +1, &#x2013;]
int lua_load (lua_State <em>L,
              lua_Reader reader,
              void </em>data,
              const char <em>chunkname,
              const char </em>mode);
&#x52A0;&#x8F7D;&#x4E00;&#x6BB5; Lua &#x4EE3;&#x7801;&#x5757;&#xFF0C;&#x4F46;&#x4E0D;&#x8FD0;&#x884C;&#x5B83;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x9519;&#x8BEF;&#xFF0C; lua_load &#x628A;&#x4E00;&#x4E2A;&#x7F16;&#x8BD1;&#x597D;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A; Lua &#x51FD;&#x6570;&#x538B;&#x5230;&#x6808;&#x9876;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x538B;&#x5165;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;</p>
<p>lua_load &#x7684;&#x8FD4;&#x56DE;&#x503C;&#x53EF;&#x4EE5;&#x662F;&#xFF1A;</p>
<p>LUA_OK: &#x6CA1;&#x6709;&#x9519;&#x8BEF;&#xFF1B;
LUA_ERRSYNTAX: &#x5728;&#x9884;&#x7F16;&#x8BD1;&#x65F6;&#x78B0;&#x5230;&#x8BED;&#x6CD5;&#x9519;&#x8BEF;&#xFF1B;
LUA_ERRMEM: &#x5185;&#x5B58;&#x5206;&#x914D;&#x9519;&#x8BEF;&#xFF1B;
LUA_ERRGCMM: &#x5728;&#x8FD0;&#x884C; __gc &#x5143;&#x65B9;&#x6CD5;&#x65F6;&#x51FA;&#x9519;&#x4E86;&#x3002; &#xFF08;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x548C;&#x4EE3;&#x7801;&#x5757;&#x52A0;&#x8F7D;&#x8FC7;&#x7A0B;&#x65E0;&#x5173;&#xFF0C;&#x5B83;&#x662F;&#x7531;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x5F15;&#x53D1;&#x7684;&#x3002;&#xFF09;
lua_load &#x51FD;&#x6570;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x63D0;&#x4F9B;&#x7684; reader &#x51FD;&#x6570;&#x6765;&#x8BFB;&#x53D6;&#x4EE3;&#x7801;&#x5757;&#xFF08;&#x53C2;&#x89C1; lua_Reader &#xFF09;&#x3002; data &#x53C2;&#x6570;&#x4F1A;&#x88AB;&#x4F20;&#x5165; reader &#x51FD;&#x6570;&#x3002;</p>
<p>chunkname &#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x8D4B;&#x4E88;&#x4EE3;&#x7801;&#x5757;&#x4E00;&#x4E2A;&#x540D;&#x5B57;&#xFF0C; &#x8FD9;&#x4E2A;&#x540D;&#x5B57;&#x88AB;&#x7528;&#x4E8E;&#x51FA;&#x9519;&#x4FE1;&#x606F;&#x548C;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.9&#xFF09;&#x3002;</p>
<p>lua_load &#x4F1A;&#x81EA;&#x52A8;&#x68C0;&#x6D4B;&#x4EE3;&#x7801;&#x5757;&#x662F;&#x6587;&#x672C;&#x7684;&#x8FD8;&#x662F;&#x4E8C;&#x8FDB;&#x5236;&#x7684;&#xFF0C; &#x7136;&#x540E;&#x505A;&#x5BF9;&#x5E94;&#x7684;&#x52A0;&#x8F7D;&#x64CD;&#x4F5C;&#xFF08;&#x53C2;&#x89C1;&#x7A0B;&#x5E8F; luac &#xFF09;&#x3002; &#x5B57;&#x7B26;&#x4E32; mode &#x7684;&#x4F5C;&#x7528;&#x548C;&#x51FD;&#x6570; load &#x4E00;&#x81F4;&#x3002; &#x5B83;&#x8FD8;&#x53EF;&#x4EE5;&#x662F; NULL &#x7B49;&#x4EF7;&#x4E8E;&#x5B57;&#x7B26;&#x4E32; &quot;bt&quot;&#x3002;</p>
<p>lua_load &#x7684;&#x5185;&#x90E8;&#x4F1A;&#x4F7F;&#x7528;&#x6808;&#xFF0C; &#x56E0;&#x6B64; reader &#x51FD;&#x6570;&#x5FC5;&#x987B;&#x6C38;&#x8FDC;&#x5728;&#x6BCF;&#x6B21;&#x8FD4;&#x56DE;&#x65F6;&#x4FDD;&#x7559;&#x6808;&#x7684;&#x539F;&#x6837;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8FD4;&#x56DE;&#x7684;&#x51FD;&#x6570;&#x6709;&#x4E0A;&#x503C;&#xFF0C; &#x7B2C;&#x4E00;&#x4E2A;&#x4E0A;&#x503C;&#x4F1A;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A; &#x4FDD;&#x5B58;&#x5728;&#x6CE8;&#x518C;&#x8868;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.5&#xFF09; LUA_RIDX_GLOBALS &#x7D22;&#x5F15;&#x5904;&#x7684;&#x5168;&#x5C40;&#x73AF;&#x5883;&#x3002; &#x5728;&#x52A0;&#x8F7D;&#x4E3B;&#x4EE3;&#x7801;&#x5757;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x4E0A;&#x503C;&#x662F; _ENV &#x53D8;&#x91CF;&#xFF08;&#x53C2;&#x89C1; &#xA7;2.2&#xFF09;&#x3002; &#x5176;&#x5B83;&#x4E0A;&#x503C;&#x5747;&#x88AB;&#x521D;&#x59CB;&#x5316;&#x4E3A; nil&#x3002;</p>
<p>lua_newstate</p>
<p>[-0, +0, &#x2013;]
lua_State <em>lua_newstate (lua_Alloc f, void </em>ud);
&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x8FD0;&#x884C;&#x5728;&#x65B0;&#x7684;&#x72EC;&#x7ACB;&#x7684;&#x72B6;&#x6001;&#x673A;&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x3002; &#x5982;&#x679C;&#x65E0;&#x6CD5;&#x521B;&#x5EFA;&#x7EBF;&#x7A0B;&#x6216;&#x72B6;&#x6001;&#x673A;&#xFF08;&#x7531;&#x4E8E;&#x5185;&#x5B58;&#x6709;&#x9650;&#xFF09;&#x5219;&#x8FD4;&#x56DE; NULL&#x3002; &#x53C2;&#x6570; f &#x662F;&#x4E00;&#x4E2A;&#x5206;&#x914D;&#x5668;&#x51FD;&#x6570;&#xFF1B; Lua &#x5C06;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x505A;&#x72B6;&#x6001;&#x673A;&#x5185;&#x6240;&#x6709;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x64CD;&#x4F5C;&#x3002; &#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570; ud &#xFF0C;&#x8FD9;&#x4E2A;&#x6307;&#x9488;&#x5C06;&#x5728;&#x6BCF;&#x6B21;&#x8C03;&#x7528;&#x5206;&#x914D;&#x5668;&#x65F6;&#x88AB;&#x8F6C;&#x5165;&#x3002;</p>
<p>lua_newtable</p>
<p>[-0, +1, e]
void lua_newtable (lua_State *L);
&#x521B;&#x5EFA;&#x4E00;&#x5F20;&#x7A7A;&#x8868;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x538B;&#x6808;&#x3002; &#x5B83;&#x7B49;&#x4EF7;&#x4E8E; lua_createtable(L, 0, 0) &#x3002;</p>
<p>lua_newthread</p>
<p>[-0, +1, e]
lua_State <em>lua_newthread (lua_State </em>L);
&#x521B;&#x5EFA;&#x4E00;&#x6761;&#x65B0;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x538B;&#x6808;&#xFF0C; &#x5E76;&#x8FD4;&#x56DE;&#x7EF4;&#x62A4;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684; lua_State &#x6307;&#x9488;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x65B0;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x539F;&#x7EBF;&#x7A0B;&#x7684;&#x5168;&#x5C40;&#x73AF;&#x5883;&#xFF0C; &#x4F46;&#x662F;&#x5B83;&#x6709;&#x72EC;&#x7ACB;&#x7684;&#x8FD0;&#x884C;&#x6808;&#x3002;</p>
<p>&#x6CA1;&#x6709;&#x663E;&#x5F0F;&#x7684;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x5173;&#x95ED;&#x6216;&#x9500;&#x6BC1;&#x6389;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x3002; &#x7EBF;&#x7A0B;&#x8DDF;&#x5176;&#x5B83; Lua &#x5BF9;&#x8C61;&#x4E00;&#x6837;&#x662F;&#x5783;&#x573E;&#x6536;&#x96C6;&#x7684;&#x6761;&#x76EE;&#x4E4B;&#x4E00;&#x3002;</p>
<p>lua_newuserdata</p>
<p>[-0, +1, e]
void <em>lua_newuserdata (lua_State </em>L, size_t size);
&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5206;&#x914D;&#x4E00;&#x5757;&#x6307;&#x5B9A;&#x5927;&#x5C0F;&#x7684;&#x5185;&#x5B58;&#x5757;&#xFF0C; &#x628A;&#x5185;&#x5B58;&#x5757;&#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E;&#x538B;&#x6808;&#xFF0C; &#x5E76;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x3002; &#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x968F;&#x610F;&#x4F7F;&#x7528;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x3002;</p>
<p>lua_next</p>
<p>[-1, +(2|0), e]
int lua_next (lua_State *L, int index);
&#x4ECE;&#x6808;&#x9876;&#x5F39;&#x51FA;&#x4E00;&#x4E2A;&#x952E;&#xFF0C; &#x7136;&#x540E;&#x628A;&#x7D22;&#x5F15;&#x6307;&#x5B9A;&#x7684;&#x8868;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x952E;&#x503C;&#x5BF9;&#x538B;&#x6808; &#xFF08;&#x5F39;&#x51FA;&#x7684;&#x952E;&#x4E4B;&#x540E;&#x7684; &#x201C;&#x4E0B;&#x4E00;&#x201D; &#x5BF9;&#xFF09;&#x3002; &#x5982;&#x679C;&#x8868;&#x4E2D;&#x4EE5;&#x65E0;&#x66F4;&#x591A;&#x5143;&#x7D20;&#xFF0C; &#x90A3;&#x4E48; lua_next &#x5C06;&#x8FD4;&#x56DE; 0 &#xFF08;&#x4EC0;&#x4E48;&#x4E5F;&#x4E0D;&#x538B;&#x6808;&#xFF09;&#x3002;</p>
<p>&#x5178;&#x578B;&#x7684;&#x904D;&#x5386;&#x65B9;&#x6CD5;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<pre><code> /*  &#x8868;&#x653E;&#x5728;&#x7D22;&#x5F15; &apos;t&apos; &#x5904; */
 lua_pushnil(L);  /* &#x7B2C;&#x4E00;&#x4E2A;&#x952E; */
 while (lua_next(L, t) != 0) {
   /* &#x4F7F;&#x7528; &apos;&#x952E;&apos; &#xFF08;&#x5728;&#x7D22;&#x5F15; -2 &#x5904;&#xFF09; &#x548C; &apos;&#x503C;&apos; &#xFF08;&#x5728;&#x7D22;&#x5F15; -1 &#x5904;&#xFF09;*/
   printf(&quot;%s - %s\n&quot;,
          lua_typename(L, lua_type(L, -2)),
          lua_typename(L, lua_type(L, -1)));
   /* &#x79FB;&#x9664; &apos;&#x503C;&apos; &#xFF1B;&#x4FDD;&#x7559; &apos;&#x952E;&apos; &#x505A;&#x4E0B;&#x4E00;&#x6B21;&#x8FED;&#x4EE3; */
   lua_pop(L, 1);
 }
</code></pre><p>&#x5728;&#x904D;&#x5386;&#x4E00;&#x5F20;&#x8868;&#x7684;&#x65F6;&#x5019;&#xFF0C; &#x4E0D;&#x8981;&#x76F4;&#x63A5;&#x5BF9;&#x952E;&#x8C03;&#x7528; lua_tolstring &#xFF0C; &#x9664;&#x975E;&#x4F60;&#x77E5;&#x9053;&#x8FD9;&#x4E2A;&#x952E;&#x4E00;&#x5B9A;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x8C03;&#x7528; lua_tolstring &#x6709;&#x53EF;&#x80FD;&#x6539;&#x53D8;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x4F4D;&#x7F6E;&#x7684;&#x503C;&#xFF1B; &#x8FD9;&#x4F1A;&#x5BF9;&#x4E0B;&#x4E00;&#x6B21;&#x8C03;&#x7528; lua_next &#x9020;&#x6210;&#x5F71;&#x54CD;&#x3002;</p>
<p>&#x5173;&#x4E8E;&#x8FED;&#x4EE3;&#x8FC7;&#x7A0B;&#x4E2D;&#x4FEE;&#x6539;&#x88AB;&#x8FED;&#x4EE3;&#x7684;&#x8868;&#x7684;&#x6CE8;&#x610F;&#x4E8B;&#x9879;&#x53C2;&#x89C1; next &#x51FD;&#x6570;&#x3002;</p>
<p>lua_Number</p>
<p>typedef double lua_Number;
Lua &#x4E2D;&#x6D6E;&#x70B9;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>Lua &#x4E2D;&#x6570;&#x5B57;&#x7684;&#x7C7B;&#x578B;&#x3002;&#x7F3A;&#x7701;&#x662F; double &#xFF0C;&#x4F46;&#x662F;&#x4F60;&#x53EF;&#x4EE5;&#x6539;&#x6210; float &#x3002; &#xFF08;&#x53C2;&#x89C1; luaconf.h &#x4E2D;&#x7684; LUA_REAL &#x3002;&#xFF09;</p>
<p>lua_numbertointeger</p>
<p>int lua_numbertointeger (lua_Number n, lua_Integer <em>p);
&#x5C06;&#x4E00;&#x4E2A; Lua &#x6D6E;&#x70B9;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A; Lua &#x6574;&#x6570;&#x3002; &#x8FD9;&#x4E2A;&#x5B8F;&#x5047;&#x8BBE; n &#x6709;&#x5BF9;&#x5E94;&#x7684;&#x6574;&#x6570;&#x503C;&#x3002; &#x5982;&#x679C;&#x8BE5;&#x503C;&#x5728; Lua &#x6574;&#x6570;&#x53EF;&#x8868;&#x793A;&#x8303;&#x56F4;&#x5185;&#xFF0C; &#x5C31;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x8D4B;&#x7ED9; </em>p&#x3002; &#x5B8F;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#xFF0C;&#x8868;&#x793A;&#x8F6C;&#x6362;&#x662F;&#x5426;&#x6210;&#x529F;&#x3002; &#xFF08;&#x6CE8;&#x610F;&#x3001;&#x7531;&#x4E8E;&#x5706;&#x6574;&#x5173;&#x7CFB;&#xFF0C;&#x8FD9;&#x4E2A;&#x8303;&#x56F4;&#x6D4B;&#x8BD5;&#x4E0D;&#x7528;&#x6B64;&#x5B8F;&#x5F88;&#x96BE;&#x505A;&#x5BF9;&#x3002;&#xFF09;</p>
<p>&#x8BE5;&#x5B8F;&#x6709;&#x53EF;&#x80FD;&#x5BF9;&#x5176;&#x53C2;&#x6570;&#x505A;&#x591A;&#x6B21;&#x53D6;&#x503C;&#x3002;</p>
<p>lua_pcall</p>
<p>[-(nargs + 1), +(nresults|1), &#x2013;]
int lua_pcall (lua_State *L, int nargs, int nresults, int msgh);
&#x4EE5;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x3002;</p>
<p>nargs &#x548C; nresults &#x7684;&#x542B;&#x4E49;&#x4E0E; lua_call &#x4E2D;&#x7684;&#x76F8;&#x540C;&#x3002; &#x5982;&#x679C;&#x5728;&#x8C03;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x6CA1;&#x6709;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#xFF0C; lua_pcall &#x7684;&#x884C;&#x4E3A;&#x548C; lua_call &#x5B8C;&#x5168;&#x4E00;&#x81F4;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x7684;&#x8BDD;&#xFF0C; lua_pcall &#x4F1A;&#x6355;&#x83B7;&#x5B83;&#xFF0C; &#x7136;&#x540E;&#x628A;&#x552F;&#x4E00;&#x7684;&#x503C;&#xFF08;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#xFF09;&#x538B;&#x6808;&#xFF0C;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x7801;&#x3002; &#x540C; lua_call &#x4E00;&#x6837;&#xFF0C; lua_pcall &#x603B;&#x662F;&#x628A;&#x51FD;&#x6570;&#x672C;&#x8EAB;&#x548C;&#x5B83;&#x7684;&#x53C2;&#x6570;&#x4ECE;&#x6808;&#x4E0A;&#x79FB;&#x9664;&#x3002;</p>
<p>&#x5982;&#x679C; msgh &#x662F; 0 &#xFF0C; &#x8FD4;&#x56DE;&#x5728;&#x6808;&#x9876;&#x7684;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x5C31;&#x548C;&#x539F;&#x59CB;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x5B8C;&#x5168;&#x4E00;&#x81F4;&#x3002; &#x5426;&#x5219;&#xFF0C; msgh &#x5C31;&#x88AB;&#x5F53;&#x6210;&#x662F; &#x9519;&#x8BEF;&#x5904;&#x7406;&#x51FD;&#x6570; &#x5728;&#x6808;&#x4E0A;&#x7684;&#x7D22;&#x5F15;&#x4F4D;&#x7F6E;&#x3002; &#xFF08;&#x5728;&#x5F53;&#x524D;&#x7684;&#x5B9E;&#x73B0;&#x91CC;&#xFF0C;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x4E0D;&#x80FD;&#x662F;&#x4F2A;&#x7D22;&#x5F15;&#x3002;&#xFF09; &#x5728;&#x53D1;&#x751F;&#x8FD0;&#x884C;&#x65F6;&#x9519;&#x8BEF;&#x65F6;&#xFF0C; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x88AB;&#x8C03;&#x7528;&#x800C;&#x53C2;&#x6570;&#x5C31;&#x662F;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002; &#x9519;&#x8BEF;&#x5904;&#x7406;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x5C06;&#x88AB; lua_pcall &#x4F5C;&#x4E3A;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x8FD4;&#x56DE;&#x5728;&#x5806;&#x6808;&#x4E0A;&#x3002;</p>
<p>&#x5178;&#x578B;&#x7684;&#x7528;&#x6CD5;&#x4E2D;&#xFF0C;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x51FD;&#x6570;&#x88AB;&#x7528;&#x6765;&#x7ED9;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x52A0;&#x4E0A;&#x66F4;&#x591A;&#x7684;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#xFF0C; &#x6BD4;&#x5982;&#x6808;&#x8DDF;&#x8E2A;&#x4FE1;&#x606F;&#x3002; &#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x5728; lua_pcall &#x8FD4;&#x56DE;&#x540E;&#xFF0C; &#x7531;&#x4E8E;&#x6808;&#x5DF2;&#x7ECF;&#x5C55;&#x5F00;&#xFF0C;&#x6240;&#x4EE5;&#x6536;&#x96C6;&#x4E0D;&#x5230;&#x4E86;&#x3002;</p>
<p>lua_pcall &#x51FD;&#x6570;&#x4F1A;&#x8FD4;&#x56DE;&#x4E0B;&#x5217;&#x5E38;&#x6570; &#xFF08;&#x5B9A;&#x4E49;&#x5728; lua.h &#x5185;&#xFF09;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#xFF1A;</p>
<p>LUA_OK (0): &#x6210;&#x529F;&#x3002;
LUA_ERRRUN: &#x8FD0;&#x884C;&#x65F6;&#x9519;&#x8BEF;&#x3002;
LUA_ERRMEM: &#x5185;&#x5B58;&#x5206;&#x914D;&#x9519;&#x8BEF;&#x3002;&#x5BF9;&#x4E8E;&#x8FD9;&#x79CD;&#x9519;&#xFF0C;Lua &#x4E0D;&#x4F1A;&#x8C03;&#x7528;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x51FD;&#x6570;&#x3002;
LUA_ERRERR: &#x5728;&#x8FD0;&#x884C;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x51FD;&#x6570;&#x65F6;&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x3002;
LUA_ERRGCMM: &#x5728;&#x8FD0;&#x884C; __gc &#x5143;&#x65B9;&#x6CD5;&#x65F6;&#x53D1;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x3002; &#xFF08;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x548C;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x65E0;&#x5173;&#x3002;&#xFF09;
lua_pcallk</p>
<p>[-(nargs + 1), +(nresults|1), &#x2013;]
int lua_pcallk (lua_State *L,
                int nargs,
                int nresults,
                int msgh,
                lua_KContext ctx,
                lua_KFunction k);
&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x884C;&#x4E3A;&#x548C; lua_pcall &#x5B8C;&#x5168;&#x4E00;&#x81F4;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x5B83;&#x8FD8;&#x5141;&#x8BB8;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#x8BA9;&#x51FA; &#xFF08;&#x53C2;&#x89C1; &#xA7;4.7&#xFF09;&#x3002;</p>
<p>lua_pop</p>
<p>[-n, +0, &#x2013;]
void lua_pop (lua_State *L, int n);
&#x4ECE;&#x6808;&#x4E2D;&#x5F39;&#x51FA; n &#x4E2A;&#x5143;&#x7D20;&#x3002;</p>
<p>lua_pushboolean</p>
<p>[-0, +1, &#x2013;]
void lua_pushboolean (lua_State *L, int b);
&#x628A; b &#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#x538B;&#x6808;&#x3002;</p>
<p>lua_pushcclosure</p>
<p>[-n, +1, e]
void lua_pushcclosure (lua_State *L, lua_CFunction fn, int n);
&#x628A;&#x4E00;&#x4E2A;&#x65B0;&#x7684; C &#x95ED;&#x5305;&#x538B;&#x6808;&#x3002;</p>
<p>&#x5F53;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A; C &#x51FD;&#x6570;&#x540E;&#xFF0C; &#x4F60;&#x53EF;&#x4EE5;&#x7ED9;&#x5B83;&#x5173;&#x8054;&#x4E00;&#x4E9B;&#x503C;&#xFF0C; &#x8FD9;&#x5C31;&#x662F;&#x5728;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; C &#x95ED;&#x5305;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.4&#xFF09;&#xFF1B; &#x63A5;&#x4E0B;&#x6765;&#x65E0;&#x8BBA;&#x51FD;&#x6570;&#x4F55;&#x65F6;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x4E9B;&#x503C;&#x90FD;&#x53EF;&#x4EE5;&#x88AB;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8BBF;&#x95EE;&#x5230;&#x3002; &#x4E3A;&#x4E86;&#x5C06;&#x4E00;&#x4E9B;&#x503C;&#x5173;&#x8054;&#x5230;&#x4E00;&#x4E2A; C &#x51FD;&#x6570;&#x4E0A;&#xFF0C; &#x9996;&#x5148;&#x8FD9;&#x4E9B;&#x503C;&#x9700;&#x8981;&#x5148;&#x88AB;&#x538B;&#x5165;&#x5806;&#x6808;&#xFF08;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x503C;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x5148;&#x538B;&#xFF09;&#x3002; &#x63A5;&#x4E0B;&#x6765;&#x8C03;&#x7528; lua_pushcclosure &#x6765;&#x521B;&#x5EFA;&#x51FA;&#x95ED;&#x5305;&#x5E76;&#x628A;&#x8FD9;&#x4E2A; C &#x51FD;&#x6570;&#x538B;&#x5230;&#x6808;&#x4E0A;&#x3002; &#x53C2;&#x6570; n &#x544A;&#x4E4B;&#x51FD;&#x6570;&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x503C;&#x9700;&#x8981;&#x5173;&#x8054;&#x5230;&#x51FD;&#x6570;&#x4E0A;&#x3002; lua_pushcclosure &#x4E5F;&#x4F1A;&#x628A;&#x8FD9;&#x4E9B;&#x503C;&#x4ECE;&#x6808;&#x4E0A;&#x5F39;&#x51FA;&#x3002;</p>
<p>n &#x7684;&#x6700;&#x5927;&#x503C;&#x662F; 255 &#x3002;</p>
<p>&#x5F53; n &#x4E3A;&#x96F6;&#x65F6;&#xFF0C; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06;&#x521B;&#x5EFA;&#x51FA;&#x4E00;&#x4E2A; &#x8F7B;&#x91CF; C &#x51FD;&#x6570;&#xFF0C; &#x5B83;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x5411; C &#x51FD;&#x6570;&#x7684;&#x6307;&#x9488;&#x3002; &#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E0D;&#x53EF;&#x80FD;&#x629B;&#x51FA;&#x5185;&#x5B58;&#x9519;&#x8BEF;&#x3002;</p>
<p>lua_pushcfunction</p>
<p>[-0, +1, &#x2013;]
void lua_pushcfunction (lua_State *L, lua_CFunction f);
&#x5C06;&#x4E00;&#x4E2A; C &#x51FD;&#x6570;&#x538B;&#x6808;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x63A5;&#x6536;&#x4E00;&#x4E2A; C &#x51FD;&#x6570;&#x6307;&#x9488;&#xFF0C; &#x5E76;&#x5C06;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x4E3A; function &#x7684; Lua &#x503C;&#x538B;&#x6808;&#x3002; &#x5F53;&#x8FD9;&#x4E2A;&#x6808;&#x9876;&#x7684;&#x503C;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x5C06;&#x89E6;&#x53D1;&#x5BF9;&#x5E94;&#x7684; C &#x51FD;&#x6570;&#x3002;</p>
<p>&#x6CE8;&#x518C;&#x5230; Lua &#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x51FD;&#x6570;&#x90FD;&#x5FC5;&#x987B;&#x9075;&#x5FAA;&#x6B63;&#x786E;&#x7684;&#x534F;&#x8BAE;&#x6765;&#x63A5;&#x6536;&#x53C2;&#x6570;&#x548C;&#x8FD4;&#x56DE;&#x503C; &#xFF08;&#x53C2;&#x89C1; lua_CFunction &#xFF09;&#x3002;</p>
<p>lua_pushcfunction &#x662F;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5B8F;&#x5B9A;&#x4E49;&#x51FA;&#x73B0;&#x7684;&#xFF1A;</p>
<pre><code> #define lua_pushcfunction(L,f)  lua_pushcclosure(L,f,0)
</code></pre><p>lua_pushfstring</p>
<p>[-0, +1, e]
const char <em>lua_pushfstring (lua_State </em>L, const char *fmt, ...);
&#x628A;&#x4E00;&#x4E2A;&#x683C;&#x5F0F;&#x5316;&#x8FC7;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x538B;&#x6808;&#xFF0C; &#x7136;&#x540E;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x6307;&#x9488;&#x3002; &#x5B83;&#x548C; C &#x51FD;&#x6570; sprintf &#x6BD4;&#x8F83;&#x50CF;&#xFF0C; &#x4E0D;&#x8FC7;&#x6709;&#x4E00;&#x4E9B;&#x91CD;&#x8981;&#x7684;&#x533A;&#x522B;&#xFF1A;</p>
<p>&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x4E3A;&#x7ED3;&#x679C;&#x5206;&#x914D;&#x7A7A;&#x95F4;&#xFF1A; &#x5176;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A; Lua &#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x7531; Lua &#x6765;&#x5173;&#x5FC3;&#x5176;&#x5185;&#x5B58;&#x5206;&#x914D; &#xFF08;&#x540C;&#x65F6;&#x901A;&#x8FC7;&#x5783;&#x573E;&#x6536;&#x96C6;&#x6765;&#x91CA;&#x653E;&#x5185;&#x5B58;&#xFF09;&#x3002;
&#x8FD9;&#x4E2A;&#x8F6C;&#x6362;&#x975E;&#x5E38;&#x7684;&#x53D7;&#x9650;&#x3002; &#x4E0D;&#x652F;&#x6301;&#x7B26;&#x53F7;&#x3001;&#x5BBD;&#x5EA6;&#x3001;&#x7CBE;&#x5EA6;&#x3002; &#x8F6C;&#x6362;&#x7B26;&#x53EA;&#x652F;&#x6301; &apos;%%&apos; &#xFF08;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x5B57;&#x7B26; &apos;%&apos;&#xFF09;&#xFF0C; &apos;%s&apos; &#xFF08;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x5E26;&#x96F6;&#x7EC8;&#x6B62;&#x7B26;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6CA1;&#x6709;&#x957F;&#x5EA6;&#x9650;&#x5236;&#xFF09;, &apos;%f&apos; &#xFF08;&#x63D2;&#x5165;&#x4E00;&#x4E2A; lua_Number&#xFF09;&#xFF0C; &apos;%L&apos; &#xFF08;&#x63D2;&#x5165;&#x4E00;&#x4E2A; lua_Integer&#xFF09;&#xFF0C; &apos;%p&apos; &#xFF08;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x5341;&#x516D;&#x8FDB;&#x5236;&#x6570;&#xFF09;&#xFF0C; &apos;%d&apos; &#xFF08;&#x63D2;&#x5165;&#x4E00;&#x4E2A; int&#xFF09;&#xFF0C; &apos;%c&apos; &#xFF08;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x7528; int &#x8868;&#x793A;&#x7684;&#x5355;&#x5B57;&#x8282;&#x5B57;&#x7B26;&#xFF09;&#xFF0C;&#x4EE5;&#x53CA; &apos;%U&apos; &#xFF08;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x7528; long int &#x8868;&#x793A;&#x7684; UTF-8 &#x5B57;&#xFF09;&#x3002;
lua_pushglobaltable</p>
<p>[-0, +1, &#x2013;]
void lua_pushglobaltable (lua_State *L);
&#x5C06;&#x5168;&#x5C40;&#x73AF;&#x5883;&#x538B;&#x6808;&#x3002;</p>
<p>lua_pushinteger</p>
<p>[-0, +1, &#x2013;]
void lua_pushinteger (lua_State *L, lua_Integer n);
&#x628A;&#x503C;&#x4E3A; n &#x7684;&#x6574;&#x6570;&#x538B;&#x6808;&#x3002;</p>
<p>lua_pushlightuserdata</p>
<p>[-0, +1, &#x2013;]
void lua_pushlightuserdata (lua_State <em>L, void </em>p);
&#x628A;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E;&#x538B;&#x6808;&#x3002;</p>
<p>&#x7528;&#x6237;&#x6570;&#x636E;&#x662F;&#x4FDD;&#x7559;&#x5728; Lua &#x4E2D;&#x7684; C &#x503C;&#x3002; &#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E; &#x8868;&#x793A;&#x4E00;&#x4E2A;&#x6307;&#x9488; void*&#x3002; &#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x50CF;&#x6570;&#x5B57;&#x4E00;&#x6837;&#x7684;&#x503C;&#xFF1A; &#x4F60;&#x4E0D;&#x9700;&#x8981;&#x4E13;&#x95E8;&#x521B;&#x5EFA;&#x5B83;&#xFF0C;&#x5B83;&#x4E5F;&#x6CA1;&#x6709;&#x72EC;&#x7ACB;&#x7684;&#x5143;&#x8868;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x4E0D;&#x4F1A;&#x88AB;&#x6536;&#x96C6;&#xFF08;&#x56E0;&#x4E3A;&#x4ECE;&#x6765;&#x4E0D;&#x9700;&#x8981;&#x521B;&#x5EFA;&#xFF09;&#x3002; &#x53EA;&#x8981;&#x8868;&#x793A;&#x7684; C &#x5730;&#x5740;&#x76F8;&#x540C;&#xFF0C;&#x4E24;&#x4E2A;&#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E;&#x5C31;&#x76F8;&#x7B49;&#x3002;</p>
<p>lua_pushliteral</p>
<p>[-0, +1, e]
const char <em>lua_pushliteral (lua_State </em>L, const char *s);
&#x8FD9;&#x4E2A;&#x5B8F;&#x7B49;&#x4EF7;&#x4E8E; lua_pushlstring&#xFF0C; &#x533A;&#x522B;&#x4EC5;&#x5728;&#x4E8E;&#x53EA;&#x80FD;&#x5728; s &#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x9762;&#x91CF;&#x65F6;&#x624D;&#x80FD;&#x7528;&#x5B83;&#x3002; &#x5B83;&#x4F1A;&#x81EA;&#x52A8;&#x7ED9;&#x51FA;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#x3002;</p>
<p>lua_pushlstring</p>
<p>[-0, +1, e]
const char <em>lua_pushlstring (lua_State </em>L, const char *s, size_t len);
&#x628A;&#x6307;&#x9488; s &#x6307;&#x5411;&#x7684;&#x957F;&#x5EA6;&#x4E3A; len &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x538B;&#x6808;&#x3002; Lua &#x5BF9;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x505A;&#x4E00;&#x4E2A;&#x5185;&#x90E8;&#x526F;&#x672C;&#xFF08;&#x6216;&#x662F;&#x590D;&#x7528;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#xFF09;&#xFF0C; &#x56E0;&#x6B64; s &#x5904;&#x7684;&#x5185;&#x5B58;&#x5728;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x91CA;&#x653E;&#x6389;&#x6216;&#x662F;&#x7ACB;&#x523B;&#x91CD;&#x7528;&#x4E8E;&#x5176;&#x5B83;&#x7528;&#x9014;&#x3002; &#x5B57;&#x7B26;&#x4E32;&#x5185;&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x610F;&#x4E8C;&#x8FDB;&#x5236;&#x6570;&#x636E;&#xFF0C;&#x5305;&#x62EC;&#x96F6;&#x5B57;&#x7B26;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x5185;&#x90E8;&#x526F;&#x672C;&#x7684;&#x6307;&#x9488;&#x3002;</p>
<p>lua_pushnil</p>
<p>[-0, +1, &#x2013;]
void lua_pushnil (lua_State *L);
&#x5C06;&#x7A7A;&#x503C;&#x538B;&#x6808;&#x3002;</p>
<p>lua_pushnumber</p>
<p>[-0, +1, &#x2013;]
void lua_pushnumber (lua_State *L, lua_Number n);
&#x628A;&#x4E00;&#x4E2A;&#x503C;&#x4E3A; n &#x7684;&#x6D6E;&#x70B9;&#x6570;&#x538B;&#x6808;&#x3002;</p>
<p>lua_pushstring</p>
<p>[-0, +1, e]
const char <em>lua_pushstring (lua_State </em>L, const char *s);
&#x5C06;&#x6307;&#x9488; s &#x6307;&#x5411;&#x7684;&#x96F6;&#x7ED3;&#x5C3E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x538B;&#x6808;&#x3002; &#x56E0;&#x6B64; s &#x5904;&#x7684;&#x5185;&#x5B58;&#x5728;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x91CA;&#x653E;&#x6389;&#x6216;&#x662F;&#x7ACB;&#x523B;&#x91CD;&#x7528;&#x4E8E;&#x5176;&#x5B83;&#x7528;&#x9014;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x5185;&#x90E8;&#x526F;&#x672C;&#x7684;&#x6307;&#x9488;&#x3002;</p>
<p>&#x5982;&#x679C; s &#x4E3A; NULL&#xFF0C;&#x5C06; nil &#x538B;&#x6808;&#x5E76;&#x8FD4;&#x56DE; NULL&#x3002;</p>
<p>lua_pushthread</p>
<p>[-0, +1, &#x2013;]
int lua_pushthread (lua_State *L);
&#x628A; L &#x8868;&#x793A;&#x7684;&#x7EBF;&#x7A0B;&#x538B;&#x6808;&#x3002; &#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x662F;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x673A;&#x7684;&#x4E3B;&#x7EBF;&#x7A0B;&#x7684;&#x8BDD;&#xFF0C;&#x8FD4;&#x56DE; 1 &#x3002;</p>
<p>lua_pushvalue</p>
<p>[-0, +1, &#x2013;]
void lua_pushvalue (lua_State *L, int index);
&#x628A;&#x6808;&#x4E0A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x5143;&#x7D20;&#x4F5C;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#x538B;&#x6808;&#x3002;</p>
<p>lua_pushvfstring</p>
<p>[-0, +1, e]
const char <em>lua_pushvfstring (lua_State </em>L,
                              const char *fmt,
                              va_list argp);
&#x7B49;&#x4EF7;&#x4E8E; lua_pushfstring &#xFF0C; &#x4E0D;&#x8FC7;&#x662F;&#x7528; va_list &#x63A5;&#x6536;&#x53C2;&#x6570;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x7528;&#x53EF;&#x53D8;&#x6570;&#x91CF;&#x7684;&#x5B9E;&#x9645;&#x53C2;&#x6570;&#x3002;</p>
<p>lua_rawequal</p>
<p>[-0, +0, &#x2013;]
int lua_rawequal (lua_State *L, int index1, int index2);
&#x5982;&#x679C;&#x7D22;&#x5F15; index1 &#x4E0E;&#x7D22;&#x5F15; index2 &#x5904;&#x7684;&#x503C; &#x672C;&#x8EAB;&#x76F8;&#x7B49;&#xFF08;&#x5373;&#x4E0D;&#x8C03;&#x7528;&#x5143;&#x65B9;&#x6CD5;&#xFF09;&#xFF0C;&#x8FD4;&#x56DE; 1 &#x3002; &#x5426;&#x5219;&#x8FD4;&#x56DE; 0 &#x3002; &#x5F53;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x7D22;&#x5F15;&#x65E0;&#x6548;&#x65F6;&#xFF0C;&#x4E5F;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_rawget</p>
<p>[-1, +1, &#x2013;]
int lua_rawget (lua_State *L, int index);
&#x7C7B;&#x4F3C;&#x4E8E; lua_gettable &#xFF0C; &#x4F46;&#x662F;&#x4F5C;&#x4E00;&#x6B21;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#xFF08;&#x4E0D;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#xFF09;&#x3002;</p>
<p>lua_rawgeti</p>
<p>[-0, +1, &#x2013;]
int lua_rawgeti (lua_State *L, int index, lua_Integer n);
&#x628A; t[n] &#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C; &#x8FD9;&#x91CC;&#x7684; t &#x662F;&#x6307;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x8868;&#x3002; &#x8FD9;&#x662F;&#x4E00;&#x6B21;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#xFF1B;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5B83;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x5165;&#x6808;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>lua_rawgetp</p>
<p>[-0, +1, &#x2013;]
int lua_rawgetp (lua_State <em>L, int index, const void </em>p);
&#x628A; t[k] &#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C; &#x8FD9;&#x91CC;&#x7684; t &#x662F;&#x6307;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x8868;&#xFF0C; k &#x662F;&#x6307;&#x9488; p &#x5BF9;&#x5E94;&#x7684;&#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E;&#x3002; &#x8FD9;&#x662F;&#x4E00;&#x6B21;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#xFF1B;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5B83;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x5165;&#x6808;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>lua_rawlen</p>
<p>[-0, +0, &#x2013;]
size_t lua_rawlen (lua_State *L, int index);
&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x503C;&#x7684;&#x56FA;&#x6709;&#x201C;&#x957F;&#x5EA6;&#x201D;&#xFF1A; &#x5BF9;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5B83;&#x6307;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#xFF1B; &#x5BF9;&#x4E8E;&#x8868;&#xFF1B;&#x5B83;&#x6307;&#x4E0D;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x53D6;&#x957F;&#x5EA6;&#x64CD;&#x4F5C;&#xFF08;&apos;#&apos;&#xFF09;&#x5E94;&#x5F97;&#x5230;&#x7684;&#x503C;&#xFF1B; &#x5BF9;&#x4E8E;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C;&#x5B83;&#x6307;&#x4E3A;&#x8BE5;&#x7528;&#x6237;&#x6570;&#x636E;&#x5206;&#x914D;&#x7684;&#x5185;&#x5B58;&#x5757;&#x7684;&#x5927;&#x5C0F;&#xFF1B; &#x5BF9;&#x4E8E;&#x5176;&#x5B83;&#x503C;&#xFF0C;&#x5B83;&#x4E3A; 0 &#x3002;</p>
<p>lua_rawset</p>
<p>[-2, +0, e]
void lua_rawset (lua_State *L, int index);
&#x7C7B;&#x4F3C;&#x4E8E; lua_settable &#xFF0C; &#x4F46;&#x662F;&#x662F;&#x505A;&#x4E00;&#x6B21;&#x76F4;&#x63A5;&#x8D4B;&#x503C;&#xFF08;&#x4E0D;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#xFF09;&#x3002;</p>
<p>lua_rawseti</p>
<p>[-1, +0, e]
void lua_rawseti (lua_State *L, int index, lua_Integer i);
&#x7B49;&#x4EF7;&#x4E8E; t[i] = v &#xFF0C; &#x8FD9;&#x91CC;&#x7684; t &#x662F;&#x6307;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x8868;&#xFF0C; &#x800C; v &#x662F;&#x6808;&#x9876;&#x7684;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x5C06;&#x503C;&#x5F39;&#x51FA;&#x6808;&#x3002; &#x8D4B;&#x503C;&#x662F;&#x76F4;&#x63A5;&#x7684;&#xFF1B;&#x5373;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#x3002;</p>
<p>lua_rawsetp</p>
<p>[-1, +0, e]
void lua_rawsetp (lua_State <em>L, int index, const void </em>p);
&#x7B49;&#x4EF7;&#x4E8E; t[k] = v &#xFF0C; &#x8FD9;&#x91CC;&#x7684; t &#x662F;&#x6307;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x8868;&#xFF0C; k &#x662F;&#x6307;&#x9488; p &#x5BF9;&#x5E94;&#x7684;&#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E;&#x3002; &#x800C; v &#x662F;&#x6808;&#x9876;&#x7684;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x5C06;&#x503C;&#x5F39;&#x51FA;&#x6808;&#x3002; &#x8D4B;&#x503C;&#x662F;&#x76F4;&#x63A5;&#x7684;&#xFF1B;&#x5373;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#x3002;</p>
<p>lua_Reader</p>
<p>typedef const char <em> (</em>lua_Reader) (lua_State <em>L,
                                    void </em>data,
                                    size_t *size);
lua_load &#x7528;&#x5230;&#x7684;&#x8BFB;&#x53D6;&#x5668;&#x51FD;&#x6570;&#xFF0C; &#x6BCF;&#x6B21;&#x5B83;&#x9700;&#x8981;&#x4E00;&#x5757;&#x65B0;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x65F6;&#x5019;&#xFF0C; lua_load &#x5C31;&#x8C03;&#x7528;&#x8BFB;&#x53D6;&#x5668;&#xFF0C; &#x6BCF;&#x6B21;&#x90FD;&#x4F1A;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x53C2;&#x6570; data &#x3002; &#x8BFB;&#x53D6;&#x5668;&#x9700;&#x8981;&#x8FD4;&#x56DE;&#x542B;&#x6709;&#x65B0;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x4E00;&#x5757;&#x5185;&#x5B58;&#x7684;&#x6307;&#x9488;&#xFF0C; &#x5E76;&#x628A; size &#x8BBE;&#x4E3A;&#x8FD9;&#x5757;&#x5185;&#x5B58;&#x7684;&#x5927;&#x5C0F;&#x3002; &#x5185;&#x5B58;&#x5757;&#x5FC5;&#x987B;&#x5728;&#x4E0B;&#x4E00;&#x6B21;&#x51FD;&#x6570;&#x88AB;&#x8C03;&#x7528;&#x4E4B;&#x524D;&#x4E00;&#x76F4;&#x5B58;&#x5728;&#x3002; &#x8BFB;&#x53D6;&#x5668;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD4;&#x56DE; NULL &#x6216;&#x8BBE; size &#x4E3A; 0 &#x6765;&#x6307;&#x793A;&#x4EE3;&#x7801;&#x5757;&#x7ED3;&#x675F;&#x3002; &#x8BFB;&#x53D6;&#x5668;&#x53EF;&#x80FD;&#x8FD4;&#x56DE;&#x591A;&#x4E2A;&#x5757;&#xFF0C;&#x6BCF;&#x4E2A;&#x5757;&#x53EF;&#x4EE5;&#x6709;&#x4EFB;&#x610F;&#x7684;&#x5927;&#x4E8E;&#x96F6;&#x7684;&#x5C3A;&#x5BF8;&#x3002;</p>
<p>lua_register</p>
<p>[-0, +0, e]
void lua_register (lua_State <em>L, const char </em>name, lua_CFunction f);
&#x628A; C &#x51FD;&#x6570; f &#x8BBE;&#x5230;&#x5168;&#x5C40;&#x53D8;&#x91CF; name &#x4E2D;&#x3002; &#x5B83;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x5B8F;&#x5B9A;&#x4E49;&#xFF1A;</p>
<pre><code> #define lua_register(L,n,f) \
        (lua_pushcfunction(L, f), lua_setglobal(L, n))
</code></pre><p>lua_remove</p>
<p>[-1, +0, &#x2013;]
void lua_remove (lua_State *L, int index);
&#x4ECE;&#x7ED9;&#x5B9A;&#x6709;&#x6548;&#x7D22;&#x5F15;&#x5904;&#x79FB;&#x9664;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#xFF0C; &#x628A;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x4E4B;&#x4E0A;&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x79FB;&#x4E0B;&#x6765;&#x586B;&#x8865;&#x4E0A;&#x8FD9;&#x4E2A;&#x7A7A;&#x9699;&#x3002; &#x4E0D;&#x80FD;&#x7528;&#x4F2A;&#x7D22;&#x5F15;&#x6765;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x56E0;&#x4E3A;&#x4F2A;&#x7D22;&#x5F15;&#x5E76;&#x4E0D;&#x6307;&#x5411;&#x771F;&#x5B9E;&#x7684;&#x6808;&#x4E0A;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>lua_replace</p>
<p>[-1, +0, &#x2013;]
void lua_replace (lua_State *L, int index);
&#x628A;&#x6808;&#x9876;&#x5143;&#x7D20;&#x653E;&#x7F6E;&#x5230;&#x7ED9;&#x5B9A;&#x4F4D;&#x7F6E;&#x800C;&#x4E0D;&#x79FB;&#x52A8;&#x5176;&#x5B83;&#x5143;&#x7D20; &#xFF08;&#x56E0;&#x6B64;&#x8986;&#x76D6;&#x4E86;&#x90A3;&#x4E2A;&#x4F4D;&#x7F6E;&#x5904;&#x7684;&#x503C;&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6808;&#x9876;&#x5143;&#x7D20;&#x5F39;&#x51FA;&#x3002;</p>
<p>lua_resume</p>
<p>[-?, +?, &#x2013;]
int lua_resume (lua_State <em>L, lua_State </em>from, int nargs);
&#x5728;&#x7ED9;&#x5B9A;&#x7EBF;&#x7A0B;&#x4E2D;&#x542F;&#x52A8;&#x6216;&#x5EF6;&#x7EED;&#x4E00;&#x6761;&#x534F;&#x7A0B; &#x3002;</p>
<p>&#x8981;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#x7684;&#x8BDD;&#xFF0C; &#x4F60;&#x9700;&#x8981;&#x628A;&#x4E3B;&#x51FD;&#x6570;&#x4EE5;&#x53CA;&#x5B83;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#x538B;&#x5165;&#x7EBF;&#x7A0B;&#x6808;&#xFF1B; &#x7136;&#x540E;&#x8C03;&#x7528; lua_resume &#xFF0C; &#x628A; nargs &#x8BBE;&#x4E3A;&#x53C2;&#x6570;&#x7684;&#x4E2A;&#x6570;&#x3002; &#x8FD9;&#x6B21;&#x8C03;&#x7528;&#x4F1A;&#x5728;&#x534F;&#x7A0B;&#x6302;&#x8D77;&#x65F6;&#x6216;&#x662F;&#x7ED3;&#x675F;&#x8FD0;&#x884C;&#x540E;&#x8FD4;&#x56DE;&#x3002; &#x5F53;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;&#x5806;&#x6808;&#x4E2D;&#x4F1A;&#x6709;&#x4F20;&#x7ED9; lua_yield &#x7684;&#x6240;&#x6709;&#x503C;&#xFF0C; &#x6216;&#x662F;&#x4E3B;&#x51FD;&#x6570;&#x7684;&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#x3002; &#x5F53;&#x534F;&#x7A0B;&#x8BA9;&#x51FA;&#xFF0C; lua_resume &#x8FD4;&#x56DE; LUA_YIELD &#xFF0C; &#x82E5;&#x534F;&#x7A0B;&#x7ED3;&#x675F;&#x8FD0;&#x884C;&#x4E14;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x9519;&#x8BEF;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; 0 &#x3002; &#x5982;&#x679C;&#x6709;&#x9519;&#x5219;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x4EE3;&#x7801;&#xFF08;&#x53C2;&#x89C1; lua_pcall &#xFF09;&#x3002;</p>
<p>&#x5728;&#x53D1;&#x751F;&#x9519;&#x8BEF;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C; &#x5806;&#x6808;&#x6CA1;&#x6709;&#x5C55;&#x5F00;&#xFF0C; &#x56E0;&#x6B64;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8C03;&#x8BD5; API &#x6765;&#x5904;&#x7406;&#x5B83;&#x3002; &#x9519;&#x8BEF;&#x6D88;&#x606F;&#x653E;&#x5728;&#x6808;&#x9876;&#x5728;&#x3002;</p>
<p>&#x8981;&#x5EF6;&#x7EED;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#xFF0C; &#x4F60;&#x9700;&#x8981;&#x6E05;&#x9664;&#x4E0A;&#x6B21; lua_yield &#x9057;&#x7559;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x7ED3;&#x679C;&#xFF0C; &#x4F60;&#x628A;&#x9700;&#x8981;&#x4F20;&#x7ED9; yield &#x4F5C;&#x7ED3;&#x679C;&#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C; &#x7136;&#x540E;&#x8C03;&#x7528; lua_resume &#x3002;</p>
<p>&#x53C2;&#x6570; from &#x8868;&#x793A;&#x534F;&#x7A0B;&#x4ECE;&#x54EA;&#x4E2A;&#x534F;&#x7A0B;&#x4E2D;&#x6765;&#x5EF6;&#x7EED; L &#x7684;&#x3002; &#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x53EF;&#x4EE5;&#x662F; NULL &#x3002;</p>
<p>lua_rotate</p>
<p>[-0, +0, &#x2013;]
void lua_rotate (lua_State *L, int idx, int n);
&#x628A;&#x4ECE; idx &#x5F00;&#x59CB;&#x5230;&#x6808;&#x9876;&#x7684;&#x5143;&#x7D20;&#x8F6E;&#x8F6C; n &#x4E2A;&#x4F4D;&#x7F6E;&#x3002; &#x5BF9;&#x4E8E; n &#x4E3A;&#x6B63;&#x6570;&#x65F6;&#xFF0C;&#x8F6E;&#x8F6C;&#x65B9;&#x5411;&#x662F;&#x5411;&#x6808;&#x9876;&#x7684;&#xFF1B; &#x5F53; n &#x4E3A;&#x8D1F;&#x6570;&#x65F6;&#xFF0C;&#x5411;&#x6808;&#x5E95;&#x65B9;&#x5411;&#x8F6E;&#x8F6C; -n &#x4E2A;&#x4F4D;&#x7F6E;&#x3002; n &#x7684;&#x7EDD;&#x5BF9;&#x503C;&#x4E0D;&#x53EF;&#x4EE5;&#x6BD4;&#x53C2;&#x4E8E;&#x8F6E;&#x8F6C;&#x7684;&#x5207;&#x7247;&#x957F;&#x5EA6;&#x5927;&#x3002;</p>
<p>lua_setallocf</p>
<p>[-0, +0, &#x2013;]
void lua_setallocf (lua_State <em>L, lua_Alloc f, void </em>ud);
&#x628A;&#x6307;&#x5B9A;&#x72B6;&#x6001;&#x673A;&#x7684;&#x5206;&#x914D;&#x5668;&#x51FD;&#x6570;&#x6362;&#x6210;&#x5E26;&#x4E0A;&#x7528;&#x6237;&#x6570;&#x636E; ud &#x7684; f &#x3002;</p>
<p>lua_setfield</p>
<p>[-1, +0, e]
void lua_setfield (lua_State <em>L, int index, const char </em>k);
&#x505A;&#x4E00;&#x4E2A;&#x7B49;&#x4EF7;&#x4E8E; t[k] = v &#x7684;&#x64CD;&#x4F5C;&#xFF0C; &#x8FD9;&#x91CC; t &#x662F;&#x7ED9;&#x51FA;&#x7684;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x503C;&#xFF0C; &#x800C; v &#x662F;&#x6808;&#x9876;&#x7684;&#x90A3;&#x4E2A;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06;&#x628A;&#x8FD9;&#x4E2A;&#x503C;&#x5F39;&#x51FA;&#x6808;&#x3002; &#x8DDF;&#x5728; Lua &#x4E2D;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x89E6;&#x53D1;&#x4E00;&#x4E2A; &quot;newindex&quot; &#x4E8B;&#x4EF6;&#x7684;&#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09;&#x3002;</p>
<p>lua_setglobal</p>
<p>[-1, +0, e]
void lua_setglobal (lua_State <em>L, const char </em>name);
&#x4ECE;&#x5806;&#x6808;&#x4E0A;&#x5F39;&#x51FA;&#x4E00;&#x4E2A;&#x503C;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x8BBE;&#x4E3A;&#x5168;&#x5C40;&#x53D8;&#x91CF; name &#x7684;&#x65B0;&#x503C;&#x3002;</p>
<p>lua_seti</p>
<p>[-1, +0, e]
void lua_seti (lua_State *L, int index, lua_Integer n);
&#x505A;&#x4E00;&#x4E2A;&#x7B49;&#x4EF7;&#x4E8E; t[n] = v &#x7684;&#x64CD;&#x4F5C;&#xFF0C; &#x8FD9;&#x91CC; t &#x662F;&#x7ED9;&#x51FA;&#x7684;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x503C;&#xFF0C; &#x800C; v &#x662F;&#x6808;&#x9876;&#x7684;&#x90A3;&#x4E2A;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06;&#x628A;&#x8FD9;&#x4E2A;&#x503C;&#x5F39;&#x51FA;&#x6808;&#x3002; &#x8DDF;&#x5728; Lua &#x4E2D;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x89E6;&#x53D1;&#x4E00;&#x4E2A; &quot;newindex&quot; &#x4E8B;&#x4EF6;&#x7684;&#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09;&#x3002;</p>
<p>lua_setmetatable</p>
<p>[-1, +0, &#x2013;]
void lua_setmetatable (lua_State *L, int index);
&#x628A;&#x4E00;&#x5F20;&#x8868;&#x5F39;&#x51FA;&#x6808;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x8BBE;&#x4E3A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x503C;&#x7684;&#x5143;&#x8868;&#x3002;</p>
<p>lua_settable</p>
<p>[-2, +0, e]
void lua_settable (lua_State *L, int index);
&#x505A;&#x4E00;&#x4E2A;&#x7B49;&#x4EF7;&#x4E8E; t[k] = v &#x7684;&#x64CD;&#x4F5C;&#xFF0C; &#x8FD9;&#x91CC; t &#x662F;&#x7ED9;&#x51FA;&#x7684;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x503C;&#xFF0C; v &#x662F;&#x6808;&#x9876;&#x7684;&#x90A3;&#x4E2A;&#x503C;&#xFF0C; k &#x662F;&#x6808;&#x9876;&#x4E4B;&#x4E0B;&#x7684;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x5C06;&#x952E;&#x548C;&#x503C;&#x90FD;&#x5F39;&#x51FA;&#x6808;&#x3002; &#x8DDF;&#x5728; Lua &#x4E2D;&#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x89E6;&#x53D1;&#x4E00;&#x4E2A; &quot;newindex&quot; &#x4E8B;&#x4EF6;&#x7684;&#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.4&#xFF09;&#x3002;</p>
<p>lua_settop</p>
<p>[-?, +?, &#x2013;]
void lua_settop (lua_State *L, int index);
&#x53C2;&#x6570;&#x5141;&#x8BB8;&#x4F20;&#x5165;&#x4EFB;&#x4F55;&#x7D22;&#x5F15;&#x4EE5;&#x53CA; 0 &#x3002; &#x5B83;&#x5C06;&#x628A;&#x5806;&#x6808;&#x7684;&#x6808;&#x9876;&#x8BBE;&#x4E3A;&#x8FD9;&#x4E2A;&#x7D22;&#x5F15;&#x3002; &#x5982;&#x679C;&#x65B0;&#x7684;&#x6808;&#x9876;&#x6BD4;&#x539F;&#x6765;&#x7684;&#x5927;&#xFF0C; &#x8D85;&#x51FA;&#x90E8;&#x5206;&#x7684;&#x65B0;&#x5143;&#x7D20;&#x5C06;&#x88AB;&#x586B;&#x4E3A; nil &#x3002; &#x5982;&#x679C; index &#x4E3A; 0 &#xFF0C; &#x628A;&#x6808;&#x4E0A;&#x6240;&#x6709;&#x5143;&#x7D20;&#x79FB;&#x9664;&#x3002;</p>
<p>lua_setuservalue</p>
<p>[-1, +0, &#x2013;]
void lua_setuservalue (lua_State *L, int index);
&#x4ECE;&#x6808;&#x4E0A;&#x5F39;&#x51FA;&#x4E00;&#x4E2A;&#x503C;&#x5E76;&#x5C06;&#x5176;&#x8BBE;&#x4E3A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x5173;&#x8054;&#x503C;&#x3002;</p>
<p>lua_State</p>
<p>typedef struct lua_State lua_State;
&#x4E00;&#x4E2A;&#x4E0D;&#x900F;&#x660E;&#x7684;&#x7ED3;&#x6784;&#xFF0C; &#x5B83;&#x6307;&#x5411;&#x4E00;&#x6761;&#x7EBF;&#x7A0B;&#x5E76;&#x95F4;&#x63A5;&#xFF08;&#x901A;&#x8FC7;&#x8BE5;&#x7EBF;&#x7A0B;&#xFF09;&#x5F15;&#x7528;&#x4E86;&#x6574;&#x4E2A; Lua &#x89E3;&#x91CA;&#x5668;&#x7684;&#x72B6;&#x6001;&#x3002; Lua &#x5E93;&#x662F;&#x5B8C;&#x5168;&#x53EF;&#x91CD;&#x5165;&#x7684;&#xFF1A; &#x5B83;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x3002; &#x72B6;&#x6001;&#x673A;&#x6240;&#x6709;&#x7684;&#x4FE1;&#x606F;&#x90FD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x8BBF;&#x95EE;&#x5230;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x7684;&#x6307;&#x9488;&#x5FC5;&#x987B;&#x4F5C;&#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F20;&#x9012;&#x7ED9;&#x6BCF;&#x4E00;&#x4E2A;&#x5E93;&#x51FD;&#x6570;&#x3002; lua_newstate &#x662F;&#x4E00;&#x4E2A;&#x4F8B;&#x5916;&#xFF0C; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x4ECE;&#x5934;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; Lua &#x72B6;&#x6001;&#x673A;&#x3002;</p>
<p>lua_status</p>
<p>[-0, +0, &#x2013;]
int lua_status (lua_State *L);
&#x8FD4;&#x56DE;&#x7EBF;&#x7A0B; L &#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p>&#x6B63;&#x5E38;&#x7684;&#x7EBF;&#x7A0B;&#x72B6;&#x6001;&#x662F; 0 &#xFF08;LUA_OK&#xFF09;&#x3002; &#x5F53;&#x7EBF;&#x7A0B;&#x7528; lua_resume &#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x5E76;&#x629B;&#x51FA;&#x4E86;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x65F6;&#xFF0C; &#x72B6;&#x6001;&#x503C;&#x662F;&#x9519;&#x8BEF;&#x7801;&#x3002; &#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x88AB;&#x6302;&#x8D77;&#xFF0C;&#x72B6;&#x6001;&#x4E3A; LUA_YIELD &#x3002;</p>
<p>&#x4F60;&#x53EA;&#x80FD;&#x5728;&#x72B6;&#x6001;&#x4E3A; LUA_OK &#x7684;&#x7EBF;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x5EF6;&#x7EED;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x4E3A; LUA_OK &#x7684;&#x7EBF;&#x7A0B; &#xFF08;&#x7528;&#x4E8E;&#x5F00;&#x59CB;&#x65B0;&#x534F;&#x7A0B;&#xFF09;&#x6216;&#x662F;&#x72B6;&#x6001;&#x4E3A; LUA_YIELD &#x7684;&#x7EBF;&#x7A0B; &#xFF08;&#x7528;&#x4E8E;&#x5EF6;&#x7EED;&#x534F;&#x7A0B;&#xFF09;&#x3002;</p>
<p>lua_stringtonumber</p>
<p>[-0, +1, &#x2013;]
size_t lua_stringtonumber (lua_State <em>L, const char </em>s);
&#x5C06;&#x4E00;&#x4E2A;&#x96F6;&#x7ED3;&#x5C3E;&#x7684;&#x5B57;&#x7B26;&#x4E32; s &#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C; &#x5C06;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x538B;&#x6808;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x603B;&#x957F;&#x5EA6;&#xFF08;&#x5373;&#x957F;&#x5EA6;&#x52A0;&#x4E00;&#xFF09;&#x3002; &#x8F6C;&#x6362;&#x7684;&#x7ED3;&#x679C;&#x53EF;&#x80FD;&#x662F;&#x6574;&#x6570;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x6D6E;&#x70B9;&#x6570;&#xFF0C; &#x8FD9;&#x53D6;&#x51B3;&#x4E8E; Lua &#x7684;&#x8F6C;&#x6362;&#x8BED;&#x6CD5;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.1&#xFF09;&#x3002; &#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x6709;&#x524D;&#x7F6E;&#x548C;&#x540E;&#x7F6E;&#x7684;&#x7A7A;&#x683C;&#x4EE5;&#x53CA;&#x7B26;&#x53F7;&#x3002; &#x5982;&#x679C;&#x5B57;&#x7B26;&#x4E32;&#x5E76;&#x975E;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x8FD4;&#x56DE; 0 &#x5E76;&#x4E0D;&#x628A;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#x538B;&#x6808;&#x3002; &#xFF08;&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x4E2A;&#x7ED3;&#x679C;&#x53EF;&#x4EE5;&#x5F53;&#x6210;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#x4F7F;&#x7528;&#xFF0C;&#x4E3A;&#x771F;&#x5373;&#x8F6C;&#x6362;&#x6210;&#x529F;&#x3002;&#xFF09;</p>
<p>lua_toboolean</p>
<p>[-0, +0, &#x2013;]
int lua_toboolean (lua_State *L, int index);
&#x628A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684; Lua &#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A; C &#x4E2D;&#x7684;&#x5E03;&#x5C14;&#x91CF;&#xFF08; 0 &#x6216;&#x662F; 1 &#xFF09;&#x3002; &#x548C; Lua &#x4E2D;&#x505A;&#x7684;&#x6240;&#x6709;&#x6D4B;&#x8BD5;&#x4E00;&#x6837;&#xFF0C; lua_toboolean &#x4F1A;&#x628A;&#x4EFB;&#x4F55;&#x4E0D;&#x540C;&#x4E8E; false &#x548C; nil &#x7684;&#x503C;&#x5F53;&#x4F5C;&#x771F;&#x8FD4;&#x56DE;&#xFF1B; &#x5426;&#x5219;&#x5C31;&#x8FD4;&#x56DE;&#x5047;&#x3002; &#xFF08;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x53EA;&#x63A5;&#x6536;&#x771F;&#x6B63;&#x7684; boolean &#x503C;&#xFF0C; &#x5C31;&#x9700;&#x8981;&#x4F7F;&#x7528; lua_isboolean &#x6765;&#x6D4B;&#x8BD5;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x3002;&#xFF09;</p>
<p>lua_tocfunction</p>
<p>[-0, +0, &#x2013;]
lua_CFunction lua_tocfunction (lua_State *L, int index);
&#x628A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684; Lua &#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A; C &#x51FD;&#x6570;&#x3002; &#x8FD9;&#x4E2A;&#x503C;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A; C &#x51FD;&#x6570;&#xFF1B; &#x5982;&#x679C;&#x4E0D;&#x662F;&#x5C31;&#x8FD4;&#x56DE; NULL &#x3002;</p>
<p>lua_tointeger</p>
<p>[-0, +0, &#x2013;]
lua_Integer lua_tointeger (lua_State *L, int index);
&#x7B49;&#x4EF7;&#x4E8E;&#x8C03;&#x7528; lua_tointegerx&#xFF0C; &#x5176;&#x53C2;&#x6570; isnum &#x4E3A; NULL&#x3002;</p>
<p>lua_tointegerx</p>
<p>[-0, +0, &#x2013;]
lua_Integer lua_tointegerx (lua_State <em>L, int index, int </em>isnum);
&#x5C06;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684; Lua &#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x5E26;&#x7B26;&#x53F7;&#x7684;&#x6574;&#x6570;&#x7C7B;&#x578B; lua_Integer&#x3002; &#x8FD9;&#x4E2A; Lua &#x503C;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x6574;&#x6570; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.3&#xFF09;&#x7684;&#x6570;&#x5B57;&#x6216;&#x5B57;&#x7B26;&#x4E32;&#xFF1B; &#x5426;&#x5219;&#xFF0C;lua_tointegerx &#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>&#x5982;&#x679C; isnum &#x4E0D;&#x662F; NULL&#xFF0C; *isnum &#x4F1A;&#x88AB;&#x8BBE;&#x4E3A;&#x64CD;&#x4F5C;&#x662F;&#x5426;&#x6210;&#x529F;&#x3002;</p>
<p>lua_tolstring</p>
<p>[-0, +0, e]
const char <em>lua_tolstring (lua_State </em>L, int index, size_t <em>len);
&#x628A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684; Lua &#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A; C &#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5982;&#x679C; len &#x4E0D;&#x4E3A; NULL &#xFF0C; &#x5B83;&#x8FD8;&#x628A;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x8BBE;&#x5230; </em>len &#x4E2D;&#x3002; &#x8FD9;&#x4E2A; Lua &#x503C;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF1B; &#x5426;&#x5219;&#x8FD4;&#x56DE;&#x8FD4;&#x56DE; NULL &#x3002; &#x5982;&#x679C;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C; lua_tolstring &#x8FD8;&#x4F1A; &#x628A;&#x5806;&#x6808;&#x4E2D;&#x7684;&#x90A3;&#x4E2A;&#x503C;&#x7684;&#x5B9E;&#x9645;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#xFF08;&#x5F53;&#x904D;&#x5386;&#x4E00;&#x5F20;&#x8868;&#x7684;&#x65F6;&#x5019;&#xFF0C; &#x82E5;&#x628A; lua_tolstring &#x4F5C;&#x7528;&#x5728;&#x952E;&#x4E0A;&#xFF0C; &#x8FD9;&#x4E2A;&#x8F6C;&#x6362;&#x6709;&#x53EF;&#x80FD;&#x5BFC;&#x81F4; lua_next &#x5F04;&#x9519;&#x3002;&#xFF09;</p>
<p>lua_tolstring &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5DF2;&#x5BF9;&#x9F50;&#x6307;&#x9488; &#x6307;&#x5411; Lua &#x72B6;&#x6001;&#x673A;&#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x603B;&#x80FD;&#x4FDD;&#x8BC1; &#xFF08; C &#x8981;&#x6C42;&#x7684;&#xFF09;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E3A;&#x96F6; (&apos;\0&apos;) &#xFF0C; &#x800C;&#x4E14;&#x5B83;&#x5141;&#x8BB8;&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x5185;&#x5305;&#x542B;&#x591A;&#x4E2A;&#x8FD9;&#x6837;&#x7684;&#x96F6;&#x3002;</p>
<p>&#x56E0;&#x4E3A; Lua &#x4E2D;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x5783;&#x573E;&#x6536;&#x96C6;&#xFF0C; &#x6240;&#x4EE5;&#x4E0D;&#x4FDD;&#x8BC1; lua_tolstring &#x8FD4;&#x56DE;&#x7684;&#x6307;&#x9488;&#xFF0C; &#x5728;&#x5BF9;&#x5E94;&#x7684;&#x503C;&#x4ECE;&#x5806;&#x6808;&#x4E2D;&#x79FB;&#x9664;&#x540E;&#x4F9D;&#x7136;&#x6709;&#x6548;&#x3002;</p>
<p>lua_tonumber</p>
<p>[-0, +0, &#x2013;]
lua_Number lua_tonumber (lua_State *L, int index);
&#x7B49;&#x4EF7;&#x4E8E;&#x8C03;&#x7528; lua_tonumberx&#xFF0C; &#x5176;&#x53C2;&#x6570; isnum &#x4E3A; NULL&#x3002;</p>
<p>lua_tonumberx</p>
<p>[-0, +0, &#x2013;]
lua_Number lua_tonumberx (lua_State <em>L, int index, int </em>isnum);
&#x628A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684; Lua &#x503C;&#x8F6C;&#x6362;&#x4E3A; lua_Number &#x8FD9;&#x6837;&#x4E00;&#x4E2A; C &#x7C7B;&#x578B; &#xFF08;&#x53C2;&#x89C1; lua_Number &#xFF09;&#x3002; &#x8FD9;&#x4E2A; Lua &#x503C;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26;&#x4E32; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.3&#xFF09;&#xFF1B; &#x5426;&#x5219;&#xFF0C; lua_tonumberx &#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>&#x5982;&#x679C; isnum &#x4E0D;&#x662F; NULL&#xFF0C; *isnum &#x4F1A;&#x88AB;&#x8BBE;&#x4E3A;&#x64CD;&#x4F5C;&#x662F;&#x5426;&#x6210;&#x529F;&#x3002;</p>
<p>lua_topointer</p>
<p>[-0, +0, &#x2013;]
const void <em>lua_topointer (lua_State </em>L, int index);
&#x628A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x822C;&#x7684; C &#x6307;&#x9488; (void*) &#x3002; &#x8FD9;&#x4E2A;&#x503C;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x5BF9;&#x8C61;&#xFF0C;&#x8868; &#xFF0C;&#x7EBF;&#x7A0B;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF1B; &#x5426;&#x5219;&#xFF0C; lua_topointer &#x8FD4;&#x56DE; NULL &#x3002; &#x4E0D;&#x540C;&#x7684;&#x5BF9;&#x8C61;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x6307;&#x9488;&#x3002; &#x4E0D;&#x5B58;&#x5728;&#x628A;&#x6307;&#x9488;&#x518D;&#x8F6C;&#x56DE;&#x539F;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x901A;&#x5E38;&#x53EA;&#x7528;&#x4E8E;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x3002;</p>
<p>lua_tostring</p>
<p>[-0, +0, e]
const char <em>lua_tostring (lua_State </em>L, int index);
&#x7B49;&#x4EF7;&#x4E8E;&#x8C03;&#x7528; lua_tolstring &#xFF0C; &#x5176;&#x53C2;&#x6570; len &#x4E3A; NULL &#x3002;</p>
<p>lua_tothread</p>
<p>[-0, +0, &#x2013;]
lua_State <em>lua_tothread (lua_State </em>L, int index);
&#x628A;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A; Lua &#x7EBF;&#x7A0B; &#xFF08;&#x8868;&#x793A;&#x4E3A; lua_State*&#xFF09;&#x3002; &#x8FD9;&#x4E2A;&#x503C;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF1B; &#x5426;&#x5219;&#x51FD;&#x6570;&#x8FD4;&#x56DE; NULL&#x3002;</p>
<p>lua_touserdata</p>
<p>[-0, +0, &#x2013;]
void <em>lua_touserdata (lua_State </em>L, int index);
&#x5982;&#x679C;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C; &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5176;&#x5185;&#x5B58;&#x5757;&#x7684;&#x5730;&#x5740;&#x3002; &#x5982;&#x679C;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C; &#x90A3;&#x4E48;&#x5C31;&#x8FD4;&#x56DE;&#x5B83;&#x8868;&#x793A;&#x7684;&#x6307;&#x9488;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x8FD4;&#x56DE; NULL &#x3002;</p>
<p>lua_type</p>
<p>[-0, +0, &#x2013;]
int lua_type (lua_State *L, int index);
&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x6709;&#x6548;&#x7D22;&#x5F15;&#x5904;&#x503C;&#x7684;&#x7C7B;&#x578B;&#xFF0C; &#x5F53;&#x7D22;&#x5F15;&#x65E0;&#x6548;&#xFF08;&#x6216;&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#xFF09;&#x65F6;&#x5219;&#x8FD4;&#x56DE; LUA_TNONE&#x3002; lua_type &#x8FD4;&#x56DE;&#x7684;&#x7C7B;&#x578B;&#x88AB;&#x7F16;&#x7801;&#x4E3A;&#x4E00;&#x4E9B;&#x4E2A;&#x5728; lua.h &#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x5E38;&#x91CF;&#xFF1A; LUA_TNIL&#xFF0C; LUA_TNUMBER&#xFF0C; LUA_TBOOLEAN&#xFF0C; LUA_TSTRING&#xFF0C; LUA_TTABLE&#xFF0C; LUA_TFUNCTION&#xFF0C; LUA_TUSERDATA&#xFF0C; LUA_TTHREAD&#xFF0C; LUA_TLIGHTUSERDATA&#x3002;</p>
<p>lua_typename</p>
<p>[-0, +0, &#x2013;]
const char <em>lua_typename (lua_State </em>L, int tp);
&#x8FD4;&#x56DE; tp &#x8868;&#x793A;&#x7684;&#x7C7B;&#x578B;&#x540D;&#xFF0C; &#x8FD9;&#x4E2A; tp &#x5FC5;&#x987B;&#x662F; lua_type &#x53EF;&#x80FD;&#x8FD4;&#x56DE;&#x7684;&#x503C;&#x4E2D;&#x4E4B;&#x4E00;&#x3002;</p>
<p>lua_Unsigned</p>
<p>typedef ... lua_Unsigned;
lua_Integer &#x7684;&#x65E0;&#x7B26;&#x53F7;&#x7248;&#x672C;&#x3002;</p>
<p>lua_upvalueindex</p>
<p>[-0, +0, &#x2013;]
int lua_upvalueindex (int i);
&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x51FD;&#x6570;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.4&#xFF09;&#x7684;&#x7B2C; i &#x4E2A;&#x4E0A;&#x503C;&#x7684;&#x4F2A;&#x7D22;&#x5F15;&#x3002;</p>
<p>lua_version</p>
<p>[-0, +0, v]
const lua_Number <em>lua_version (lua_State </em>L);
&#x8FD4;&#x56DE;&#x4FDD;&#x5B58;&#x5728; Lua &#x5185;&#x6838;&#x4E2D;&#x50A8;&#x5B58;&#x7684;&#x7248;&#x672C;&#x6570;&#x5B57;&#x7684;&#x5730;&#x5740;&#x3002; &#x5F53;&#x8C03;&#x7528;&#x65F6;&#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x5408;&#x6CD5;&#x7684; lua_State &#xFF0C; &#x8FD4;&#x56DE;&#x521B;&#x5EFA;&#x8BE5;&#x72B6;&#x6001;&#x673A;&#x65F6;&#x7684;&#x7248;&#x672C;&#x5730;&#x5740;&#x3002; &#x5982;&#x679C;&#x7528; NULL &#x8C03;&#x7528;&#xFF0C; &#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x8005;&#x7684;&#x7248;&#x672C;&#x5730;&#x5740;&#x3002;</p>
<p>lua_Writer</p>
<p>typedef int (<em>lua_Writer) (lua_State </em>L,
                           const void<em> p,
                           size_t sz,
                           void</em> ud);
&#x88AB; lua_dump &#x7528;&#x5230;&#x7684;&#x5199;&#x5165;&#x5668;&#x51FD;&#x6570;&#x3002; &#x6BCF;&#x6B21; lua_dump &#x4EA7;&#x751F;&#x4E86;&#x4E00;&#x6BB5;&#x65B0;&#x7684;&#x4EE3;&#x7801;&#x5757;&#xFF0C; &#x5B83;&#x90FD;&#x4F1A;&#x8C03;&#x7528;&#x5199;&#x5165;&#x5668;&#x3002; &#x4F20;&#x5165;&#x8981;&#x5199;&#x5165;&#x7684;&#x7F13;&#x51B2;&#x533A; (p) &#x548C;&#x5B83;&#x7684;&#x5C3A;&#x5BF8; (sz) &#xFF0C; &#x4EE5;&#x53CA;&#x4F20;&#x7ED9; lua_dump &#x7684;&#x53C2;&#x6570; data &#x3002;</p>
<p>&#x5199;&#x5165;&#x5668;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x7801;&#xFF1A; 0 &#x8868;&#x793A;&#x6CA1;&#x6709;&#x9519;&#x8BEF;&#xFF1B; &#x522B;&#x7684;&#x503C;&#x5747;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#xFF0C; &#x5E76;&#x4E14;&#x4F1A;&#x8BA9; lua_dump &#x505C;&#x6B62;&#x518D;&#x6B21;&#x8C03;&#x7528;&#x5199;&#x5165;&#x5668;&#x3002;</p>
<p>lua_xmove</p>
<p>[-?, +?, &#x2013;]
void lua_xmove (lua_State <em>from, lua_State </em>to, int n);
&#x4EA4;&#x6362;&#x540C;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x673A;&#x4E0B;&#x4E0D;&#x540C;&#x7EBF;&#x7A0B;&#x4E2D;&#x7684;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x4ECE; from &#x7684;&#x6808;&#x4E0A;&#x5F39;&#x51FA; n &#x4E2A;&#x503C;&#xFF0C; &#x7136;&#x540E;&#x628A;&#x5B83;&#x4EEC;&#x538B;&#x5165; to &#x7684;&#x6808;&#x4E0A;&#x3002;</p>
<p>lua_yield</p>
<p>[-?, +?, e]
int lua_yield (lua_State *L, int nresults);
&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7B49;&#x4EF7;&#x4E8E;&#x8C03;&#x7528; lua_yieldk&#xFF0C; &#x4E0D;&#x540C;&#x7684;&#x662F;&#x4E0D;&#x63D0;&#x4F9B;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.7&#xFF09;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5F53;&#x7EBF;&#x7A0B;&#x88AB;&#x5EF6;&#x7EED;&#xFF0C;&#x7EBF;&#x7A0B;&#x4F1A;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x8C03;&#x7528; lua_yield &#x51FD;&#x6570;&#x7684;&#x51FD;&#x6570;&#x3002;</p>
<p>lua_yieldk</p>
<p>[-?, +?, e]
int lua_yieldk (lua_State *L,
                int nresults,
                lua_KContext ctx,
                lua_KFunction k);
&#x8BA9;&#x51FA;&#x534F;&#x7A0B;&#xFF08;&#x7EBF;&#x7A0B;&#xFF09;&#x3002;</p>
<p>&#x5F53; C &#x51FD;&#x6570;&#x8C03;&#x7528;&#x4E86; lua_yieldk&#xFF0C; &#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x534F;&#x7A0B;&#x4F1A;&#x6302;&#x8D77;&#xFF0C; &#x542F;&#x52A8;&#x8FD9;&#x4E2A;&#x7EBF;&#x7A0B;&#x7684; lua_resume &#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x3002; &#x53C2;&#x6570; nresults &#x6307;&#x6808;&#x4E0A;&#x9700;&#x8FD4;&#x56DE;&#x7ED9; lua_resume &#x7684;&#x8FD4;&#x56DE;&#x503C;&#x7684;&#x4E2A;&#x6570;&#x3002;</p>
<p>&#x5F53;&#x534F;&#x7A0B;&#x518D;&#x6B21;&#x88AB;&#x5EF6;&#x7EED;&#x65F6;&#xFF0C; Lua &#x8C03;&#x7528;&#x5EF6;&#x7EED;&#x51FD;&#x6570; k &#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x88AB;&#x6302;&#x8D77;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.7&#xFF09;&#x7684; C &#x51FD;&#x6570;&#x3002; &#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x4F1A;&#x4ECE;&#x524D;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#x63A5;&#x6536;&#x5230;&#x76F8;&#x540C;&#x7684;&#x6808;&#xFF0C; &#x6808;&#x4E2D;&#x7684; n &#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x88AB;&#x79FB;&#x9664;&#x800C;&#x538B;&#x5165;&#x4E86;&#x4ECE; lua_resume &#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x8FD8;&#x4F1A;&#x6536;&#x5230;&#x4F20;&#x7ED9; lua_yieldk &#x7684;&#x53C2;&#x6570; ctx&#x3002;</p>
<p>&#x901A;&#x5E38;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#xFF1B; &#x5F53;&#x534F;&#x7A0B;&#x4E00;&#x6B21;&#x6B21;&#x5EF6;&#x7EED;&#xFF0C;&#x5C06;&#x4ECE;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x4F8B;&#x5916;&#xFF1A; &#x5F53;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4ECE;&#x4E00;&#x4E2A;&#x9010;&#x884C;&#x8FD0;&#x884C;&#x7684;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.9&#xFF09; &#x4E2D;&#x8C03;&#x7528;&#x65F6;&#xFF0C;lua_yieldk &#x4E0D;&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x3002; &#xFF08;&#x4E5F;&#x5C31;&#x662F;&#x7C7B;&#x4F3C; lua_yield &#x7684;&#x5F62;&#x5F0F;&#xFF09;&#xFF0C; &#x800C;&#x6B64;&#x65F6;&#xFF0C;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x5728;&#x8C03;&#x7528;&#x5B8C;&#x8BA9;&#x51FA;&#x540E;&#x5C06;&#x7ACB;&#x523B;&#x8FD4;&#x56DE;&#x3002; Lua &#x4F1A;&#x4F7F;&#x534F;&#x7A0B;&#x8BA9;&#x51FA;&#xFF0C;&#x4E00;&#x65E6;&#x534F;&#x7A0B;&#x518D;&#x6B21;&#x88AB;&#x5EF6;&#x7EED;&#xFF0C; &#x89E6;&#x53D1;&#x94A9;&#x5B50;&#x7684;&#x51FD;&#x6570;&#x4F1A;&#x7EE7;&#x7EED;&#x6B63;&#x5E38;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x5904;&#x4E8E;&#x672A;&#x63D0;&#x4F9B;&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x7684; C &#x8C03;&#x7528;&#x4E2D;&#xFF0C;&#x8C03;&#x7528;&#x5B83;&#x4F1A;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002; &#x4ECE;&#x5E76;&#x975E;&#x7528;&#x5EF6;&#x7EED;&#x65B9;&#x5F0F;&#xFF08;&#x4F8B;&#x5982;&#xFF1A;&#x4E3B;&#x7EBF;&#x7A0B;&#xFF09;&#x542F;&#x52A8;&#x7684;&#x7EBF;&#x7A0B;&#x4E2D;&#x8C03;&#x7528;&#x5B83;&#x4E5F;&#x4F1A;&#x8FD9;&#x6837;&#x3002;</p>
<p>4.9 &#x2013; &#x8C03;&#x8BD5;&#x63A5;&#x53E3;</p>
<p>Lua &#x6CA1;&#x6709;&#x5185;&#x7F6E;&#x7684;&#x8C03;&#x8BD5;&#x673A;&#x5236;&#x3002; &#x4F46;&#x662F;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x7EC4;&#x7279;&#x6B8A;&#x7684;&#x51FD;&#x6570;&#x63A5;&#x53E3;&#x4EE5;&#x53CA; &#x94A9;&#x5B50;&#x3002; &#x8FD9;&#x7EC4;&#x63A5;&#x53E3;&#x53EF;&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#x51FA;&#x4E0D;&#x540C;&#x7684;&#x8C03;&#x8BD5;&#x5668;&#x3001;&#x6027;&#x80FD;&#x5256;&#x6790;&#x5668;&#x3001; &#x6216;&#x662F;&#x5176;&#x5B83;&#x9700;&#x8981;&#x4ECE;&#x89E3;&#x91CA;&#x5668;&#x83B7;&#x53D6;&#x201C;&#x5185;&#x90E8;&#x4FE1;&#x606F;&#x201D;&#x7684;&#x5DE5;&#x5177;&#x3002;</p>
<p>lua_Debug</p>
<p>typedef struct lua_Debug {
  int event;
  const char <em>name;           /</em> (n) <em>/
  const char </em>namewhat;       /<em> (n) </em>/
  const char <em>what;           /</em> (S) <em>/
  const char </em>source;         /<em> (S) </em>/
  int currentline;            /<em> (l) </em>/
  int linedefined;            /<em> (S) </em>/
  int lastlinedefined;        /<em> (S) </em>/
  unsigned char nups;         /<em> (u) &#x4E0A;&#x503C;&#x7684;&#x6570;&#x91CF; </em>/
  unsigned char nparams;      /<em> (u) &#x53C2;&#x6570;&#x7684;&#x6570;&#x91CF; </em>/
  char isvararg;              /<em> (u) </em>/
  char istailcall;            /<em> (t) </em>/
  char short_src[LUA_IDSIZE]; /<em> (S) </em>/
  /<em> &#x79C1;&#x6709;&#x90E8;&#x5206; </em>/
  &#x5176;&#x5B83;&#x57DF;
} lua_Debug;
&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x643A;&#x5E26;&#x6709;&#x6709;&#x5173;&#x51FD;&#x6570;&#x6216;&#x6D3B;&#x52A8;&#x8BB0;&#x5F55;&#x7684;&#x5404;&#x79CD;&#x4FE1;&#x606F;&#x7684;&#x7ED3;&#x6784;&#x3002; lua_getstack &#x53EA;&#x4F1A;&#x586B;&#x5145;&#x7ED3;&#x6784;&#x7684;&#x79C1;&#x6709;&#x90E8;&#x5206;&#x4F9B;&#x540E;&#x9762;&#x4F7F;&#x7528;&#x3002; &#x8C03;&#x7528; lua_getinfo &#x53EF;&#x4EE5;&#x5728; lua_Debug &#x4E2D;&#x586B;&#x5145;&#x90A3;&#x4E9B;&#x53EF;&#x88AB;&#x4F7F;&#x7528;&#x7684;&#x4FE1;&#x606F;&#x57DF;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x5BF9; lua_Debug &#x7684;&#x5404;&#x4E2A;&#x57DF;&#x505A;&#x4E00;&#x4E2A;&#x8BF4;&#x660E;&#xFF1A;</p>
<p>source: &#x521B;&#x5EFA;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x540D;&#x5B57;&#x3002; &#x5982;&#x679C; source &#x4EE5; &apos;@&apos; &#x6253;&#x5934;&#xFF0C; &#x6307;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x5728;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x800C; &apos;@&apos; &#x4E4B;&#x540E;&#x7684;&#x90E8;&#x5206;&#x5C31;&#x662F;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x82E5; source &#x4EE5; &apos;=&apos; &#x6253;&#x5934;&#xFF0C; &#x5269;&#x4F59;&#x7684;&#x90E8;&#x5206;&#x7531;&#x7528;&#x6237;&#x884C;&#x4E3A;&#x6765;&#x51B3;&#x5B9A;&#x5982;&#x4F55;&#x8868;&#x793A;&#x6E90;&#x7801;&#x3002; &#x5176;&#x5B83;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x5728;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#xFF0C; &#x800C; source &#x6B63;&#x662F;&#x90A3;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002;
short_src: &#x4E00;&#x4E2A;&#x201C;&#x53EF;&#x6253;&#x5370;&#x7248;&#x672C;&#x201D;&#x7684; source &#xFF0C;&#x7528;&#x4E8E;&#x51FA;&#x9519;&#x4FE1;&#x606F;&#x3002;
linedefined: &#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x5F00;&#x59CB;&#x5904;&#x7684;&#x884C;&#x53F7;&#x3002;
lastlinedefined: &#x51FD;&#x6570;&#x5B9A;&#x4E49;&#x7ED3;&#x675F;&#x5904;&#x7684;&#x884C;&#x53F7;&#x3002;
what: &#x5982;&#x679C;&#x51FD;&#x6570;&#x662F;&#x4E00;&#x4E2A; Lua &#x51FD;&#x6570;&#xFF0C;&#x5219;&#x4E3A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32; &quot;Lua&quot; &#xFF1B; &#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A; C &#x51FD;&#x6570;&#xFF0C;&#x5219;&#x4E3A; &quot;C&quot;&#xFF1B; &#x5982;&#x679C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x4E3B;&#x4F53;&#x90E8;&#x5206;&#xFF0C;&#x5219;&#x4E3A; &quot;main&quot;&#x3002;
currentline: &#x7ED9;&#x5B9A;&#x51FD;&#x6570;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7684;&#x90A3;&#x4E00;&#x884C;&#x3002; &#x5F53;&#x63D0;&#x4F9B;&#x4E0D;&#x4E86;&#x884C;&#x53F7;&#x4FE1;&#x606F;&#x7684;&#x65F6;&#x5019;&#xFF0C; currentline &#x88AB;&#x8BBE;&#x4E3A; -1 &#x3002;
name: &#x7ED9;&#x5B9A;&#x51FD;&#x6570;&#x7684;&#x4E00;&#x4E2A;&#x5408;&#x7406;&#x7684;&#x540D;&#x5B57;&#x3002; &#x56E0;&#x4E3A; Lua &#x4E2D;&#x7684;&#x51FD;&#x6570;&#x662F;&#x4E00;&#x7B49;&#x516C;&#x6C11;&#xFF0C; &#x6240;&#x4EE5;&#x5B83;&#x4EEC;&#x6CA1;&#x6709;&#x56FA;&#x5B9A;&#x7684;&#x540D;&#x5B57;&#xFF1A; &#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x662F;&#x5168;&#x5C40;&#x590D;&#x5408;&#x53D8;&#x91CF;&#x7684;&#x503C;&#xFF0C; &#x53E6;&#x4E00;&#x4E9B;&#x53EF;&#x80FD;&#x4EC5;&#x4EC5;&#x53EA;&#x662F;&#x88AB;&#x4FDD;&#x5B58;&#x5728;&#x4E00;&#x5F20;&#x8868;&#x7684;&#x67D0;&#x4E2A;&#x57DF;&#x4E2D;&#x3002; lua_getinfo &#x51FD;&#x6570;&#x4F1A;&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x662F;&#x600E;&#x6837;&#x88AB;&#x8C03;&#x7528;&#x7684;&#xFF0C; &#x4EE5;&#x6B64;&#x6765;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x9002;&#x5408;&#x7684;&#x540D;&#x5B57;&#x3002; &#x5982;&#x679C;&#x5B83;&#x627E;&#x4E0D;&#x5230;&#x540D;&#x5B57;&#xFF0C; name &#x5C31;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A; NULL &#x3002;
namewhat: &#x7528;&#x4E8E;&#x89E3;&#x91CA; name &#x57DF;&#x3002; namewhat &#x7684;&#x503C;&#x53EF;&#x4EE5;&#x662F; &quot;global&quot;, &quot;local&quot;, &quot;method&quot;, &quot;field&quot;, &quot;upvalue&quot;, &#x6216;&#x662F; &quot;&quot; &#xFF08;&#x7A7A;&#x4E32;&#xFF09;&#x3002; &#x8FD9;&#x53D6;&#x51B3;&#x4E8E;&#x51FD;&#x6570;&#x600E;&#x6837;&#x88AB;&#x8C03;&#x7528;&#x3002; &#xFF08;Lua &#x7528;&#x7A7A;&#x4E32;&#x8868;&#x793A;&#x5176;&#x5B83;&#x9009;&#x9879;&#x90FD;&#x4E0D;&#x7B26;&#x5408;&#x3002;&#xFF09;
istailcall: &#x5982;&#x679C;&#x51FD;&#x6570;&#x4EE5;&#x5C3E;&#x8C03;&#x7528;&#x5F62;&#x5F0F;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x4E2A;&#x503C;&#x5C31;&#x4E3A;&#x771F;&#x3002; &#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5F53;&#x5C42;&#x7684;&#x8C03;&#x7528;&#x8005;&#x4E0D;&#x5728;&#x6808;&#x4E2D;&#x3002;
nups: &#x51FD;&#x6570;&#x7684;&#x4E0A;&#x503C;&#x4E2A;&#x6570;&#x3002;
nparams: &#x51FD;&#x6570;&#x56FA;&#x5B9A;&#x5F62;&#x53C2;&#x4E2A;&#x6570; &#xFF08;&#x5BF9;&#x4E8E; C &#x51FD;&#x6570;&#x6C38;&#x8FDC;&#x662F; 0 &#xFF09;&#x3002;
isvararg: &#x5982;&#x679C;&#x51FD;&#x6570;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x51FD;&#x6570;&#x5219;&#x4E3A;&#x771F; &#xFF08;&#x5BF9;&#x4E8E; C &#x51FD;&#x6570;&#x6C38;&#x8FDC;&#x4E3A;&#x771F;&#xFF09;&#x3002;
lua_gethook</p>
<p>[-0, +0, &#x2013;]
lua_Hook lua_gethook (lua_State *L);
&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x7684;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x3002;</p>
<p>lua_gethookcount</p>
<p>[-0, +0, &#x2013;]
int lua_gethookcount (lua_State *L);
&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x7684;&#x94A9;&#x5B50;&#x8BA1;&#x6570;&#x3002;</p>
<p>lua_gethookmask</p>
<p>[-0, +0, &#x2013;]
int lua_gethookmask (lua_State *L);
&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x7684;&#x94A9;&#x5B50;&#x63A9;&#x7801;&#x3002;</p>
<p>lua_getinfo</p>
<p>[-(0|1), +(0|1|2), e]
int lua_getinfo (lua_State <em>L, const char </em>what, lua_Debug *ar);
&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6307;&#x5B9A;&#x7684;&#x51FD;&#x6570;&#x6216;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x5F53;&#x7528;&#x4E8E;&#x53D6;&#x5F97;&#x4E00;&#x6B21;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x4FE1;&#x606F;&#x65F6;&#xFF0C; &#x53C2;&#x6570; ar &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x6D3B;&#x52A8;&#x7684;&#x8BB0;&#x5F55;&#x3002; &#x8FD9;&#x6761;&#x8BB0;&#x5F55;&#x53EF;&#x4EE5;&#x662F;&#x524D;&#x4E00;&#x6B21;&#x8C03;&#x7528; lua_getstack &#x5F97;&#x5230;&#x7684;&#xFF0C; &#x6216;&#x662F;&#x4E00;&#x4E2A;&#x94A9;&#x5B50; &#xFF08;&#x53C2;&#x89C1; lua_Hook &#xFF09;&#x5F97;&#x5230;&#x7684;&#x53C2;&#x6570;&#x3002;</p>
<p>&#x7528;&#x4E8E;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x4FE1;&#x606F;&#x65F6;&#xFF0C; &#x53EF;&#x4EE5;&#x628A;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x538B;&#x5165;&#x5806;&#x6808;&#xFF0C; &#x7136;&#x540E;&#x628A; what &#x5B57;&#x7B26;&#x4E32;&#x4EE5;&#x5B57;&#x7B26; &apos;&gt;&apos; &#x8D77;&#x5934;&#x3002; &#xFF08;&#x8FD9;&#x4F1A;&#x8BA9; lua_getinfo &#x4ECE;&#x6808;&#x9876;&#x4E0A;&#x5F39;&#x51FA;&#x51FD;&#x6570;&#x3002;&#xFF09; &#x4F8B;&#x5982;&#xFF0C;&#x60F3;&#x77E5;&#x9053;&#x51FD;&#x6570; f &#x662F;&#x5728;&#x54EA;&#x4E00;&#x884C;&#x5B9A;&#x4E49;&#x7684;&#xFF0C; &#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E0B;&#x5217;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code> lua_Debug ar;
 lua_getglobal(L, &quot;f&quot;);  /* &#x53D6;&#x5F97;&#x5168;&#x5C40;&#x53D8;&#x91CF; &apos;f&apos; */
 lua_getinfo(L, &quot;&gt;S&quot;, &amp;ar);
 printf(&quot;%d\n&quot;, ar.linedefined);
</code></pre><p>what &#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x90FD;&#x7B5B;&#x9009;&#x51FA;&#x7ED3;&#x6784; ar &#x7ED3;&#x6784;&#x4E2D;&#x4E00;&#x4E9B;&#x57DF;&#x7528;&#x4E8E;&#x586B;&#x5145;&#xFF0C; &#x6216;&#x662F;&#x628A;&#x4E00;&#x4E2A;&#x503C;&#x538B;&#x5165;&#x5806;&#x6808;&#xFF1A;</p>
<p>&apos;n&apos;: &#x586B;&#x5145; name &#x53CA; namewhat &#x57DF;&#xFF1B;
&apos;S&apos;: &#x586B;&#x5145; source &#xFF0C; short_src &#xFF0C; linedefined &#xFF0C; lastlinedefined &#xFF0C;&#x4EE5;&#x53CA; what &#x57DF;&#xFF1B;
&apos;l&apos;: &#x586B;&#x5145; currentline &#x57DF;&#xFF1B;
&apos;t&apos;: &#x586B;&#x5145; istailcall &#x57DF;&#xFF1B;
&apos;u&apos;: &#x586B;&#x5145; nups&#xFF0C; nparams&#xFF0C;&#x53CA; isvararg &#x57DF;&#xFF1B;
&apos;f&apos;: &#x628A;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x4E2D;&#x6307;&#x5B9A;&#x5C42;&#x6B21;&#x5904;&#x51FD;&#x6570;&#x538B;&#x6808;&#xFF1B;
&apos;L&apos;: &#x5C06;&#x4E00;&#x5F20;&#x8868;&#x538B;&#x6808;&#xFF0C;&#x8FD9;&#x5F20;&#x8868;&#x4E2D;&#x7684;&#x6574;&#x6570;&#x7D22;&#x5F15;&#x7528;&#x4E8E;&#x63CF;&#x8FF0;&#x51FD;&#x6570;&#x4E2D;&#x54EA;&#x4E9B;&#x884C;&#x662F;&#x6709;&#x6548;&#x884C;&#x3002; &#xFF08;&#x6709;&#x6548;&#x884C;&#x6307;&#x6709;&#x5B9E;&#x9645;&#x4EE3;&#x7801;&#x7684;&#x884C;&#xFF0C;&#x5373;&#x4F60;&#x53EF;&#x4EE5;&#x7F6E;&#x5165;&#x65AD;&#x70B9;&#x7684;&#x884C;&#x3002; &#x65E0;&#x6548;&#x884C;&#x5305;&#x62EC;&#x7A7A;&#x884C;&#x548C;&#x53EA;&#x6709;&#x6CE8;&#x91CA;&#x7684;&#x884C;&#x3002;&#xFF09;
&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x9009;&#x9879;&#x548C;&#x9009;&#x9879; &apos;f&apos; &#x540C;&#x65F6;&#x4F7F;&#x7528;&#xFF0C; &#x8FD9;&#x5F20;&#x8868;&#x5728;&#x51FD;&#x6570;&#x4E4B;&#x540E;&#x538B;&#x6808;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x51FA;&#x9519;&#x4F1A;&#x8FD4;&#x56DE; 0 &#xFF08;&#x4F8B;&#x5982;&#xFF0C;what &#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x65E0;&#x6548;&#x9009;&#x9879;&#xFF09;&#x3002;</p>
<p>lua_getlocal</p>
<p>[-0, +(0|1), &#x2013;]
const char <em>lua_getlocal (lua_State </em>L, const lua_Debug *ar, int n);
&#x4ECE;&#x7ED9;&#x5B9A;&#x6D3B;&#x52A8;&#x8BB0;&#x5F55;&#x6216;&#x4ECE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x7B2C;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#xFF0C; &#x53C2;&#x6570; ar &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x6D3B;&#x52A8;&#x7684;&#x8BB0;&#x5F55;&#x3002; &#x8FD9;&#x6761;&#x8BB0;&#x5F55;&#x53EF;&#x4EE5;&#x662F;&#x524D;&#x4E00;&#x6B21;&#x8C03;&#x7528; lua_getstack &#x5F97;&#x5230;&#x7684;&#xFF0C; &#x6216;&#x662F;&#x4E00;&#x4E2A;&#x94A9;&#x5B50; &#xFF08;&#x53C2;&#x89C1; lua_Hook &#xFF09;&#x7684;&#x53C2;&#x6570;&#x3002; &#x7D22;&#x5F15; n &#x7528;&#x4E8E;&#x9009;&#x62E9;&#x8981;&#x68C0;&#x9605;&#x54EA;&#x4E2A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF1B; &#x53C2;&#x89C1; debug.getlocal &#x4E2D;&#x5173;&#x4E8E;&#x53D8;&#x91CF;&#x7684;&#x7D22;&#x5F15;&#x548C;&#x540D;&#x5B57;&#x7684;&#x4ECB;&#x7ECD;&#x3002;</p>
<p>lua_getlocal &#x5C06;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x5176;&#x540D;&#x5B57;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x7B2C;&#x4E8C;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;ar &#x5FC5;&#x987B;&#x586B; NULL &#x3002; &#x9700;&#x8981;&#x63A2;&#x77E5;&#x7684;&#x51FD;&#x6570;&#x5FC5;&#x987B;&#x653E;&#x5728;&#x6808;&#x9876;&#x3002; &#x5BF9;&#x4E8E;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x53EA;&#x6709; Lua &#x51FD;&#x6570;&#x7684;&#x5F62;&#x53C2;&#x662F;&#x53EF;&#x89C1;&#x7684; &#xFF08;&#x6CA1;&#x6709;&#x5173;&#x4E8E;&#x8FD8;&#x6709;&#x54EA;&#x4E9B;&#x6D3B;&#x52A8;&#x53D8;&#x91CF;&#x7684;&#x4FE1;&#x606F;&#xFF09; &#x4E5F;&#x4E0D;&#x4F1A;&#x6709;&#x4EFB;&#x4F55;&#x503C;&#x538B;&#x6808;&#x3002;</p>
<p>&#x5F53;&#x7D22;&#x5F15;&#x5927;&#x4E8E;&#x6D3B;&#x52A8;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x6570;&#x91CF;&#xFF0C; &#x8FD4;&#x56DE; NULL &#xFF08;&#x65E0;&#x4EFB;&#x4F55;&#x538B;&#x6808;&#xFF09;</p>
<p>lua_getstack</p>
<p>[-0, +0, &#x2013;]
int lua_getstack (lua_State <em>L, int level, lua_Debug </em>ar);
&#x83B7;&#x53D6;&#x89E3;&#x91CA;&#x5668;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x6808;&#x7684;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x4E2D;&#x7684;&#x6307;&#x5B9A;&#x5C42;&#x6B21;&#x5904;&#x51FD;&#x6570;&#x7684; &#x6D3B;&#x52A8;&#x8BB0;&#x5F55; &#x6765;&#x586B;&#x5199; lua_Debug &#x7ED3;&#x6784;&#x7684;&#x4E00;&#x90E8;&#x5206;&#x3002; 0 &#x5C42;&#x8868;&#x793A;&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x51FD;&#x6570;&#xFF0C; n+1 &#x5C42;&#x7684;&#x51FD;&#x6570;&#x5C31;&#x662F;&#x8C03;&#x7528;&#x7B2C; n &#x5C42; &#xFF08;&#x5C3E;&#x8C03;&#x7528;&#x4F8B;&#x5916;&#xFF0C;&#x5B83;&#x4E0D;&#x7B97;&#x5728;&#x6808;&#x5C42;&#x6B21;&#x4E2D;&#xFF09; &#x51FD;&#x6570;&#x7684;&#x90A3;&#x4E00;&#x4E2A;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x9519;&#x8BEF;&#xFF0C; lua_getstack &#x8FD4;&#x56DE; 1 &#xFF1B; &#x5F53;&#x8C03;&#x7528;&#x4F20;&#x5165;&#x7684;&#x5C42;&#x6B21;&#x5927;&#x4E8E;&#x5806;&#x6808;&#x6DF1;&#x5EA6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x8FD4;&#x56DE; 0 &#x3002;</p>
<p>lua_getupvalue</p>
<p>[-0, +(0|1), &#x2013;]
const char <em>lua_getupvalue (lua_State </em>L, int funcindex, int n);
&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x95ED;&#x5305;&#x7684;&#x4E0A;&#x503C;&#x4FE1;&#x606F;&#x3002; &#xFF08;&#x5BF9;&#x4E8E; Lua &#x51FD;&#x6570;&#xFF0C;&#x4E0A;&#x503C;&#x662F;&#x51FD;&#x6570;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x5916;&#x90E8;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF0C; &#x56E0;&#x6B64;&#x8FD9;&#x4E9B;&#x53D8;&#x91CF;&#x88AB;&#x5305;&#x542B;&#x5728;&#x95ED;&#x5305;&#x4E2D;&#x3002;&#xFF09; lua_getupvalue &#x83B7;&#x53D6;&#x7B2C; n &#x4E2A;&#x4E0A;&#x503C;&#xFF0C; &#x628A;&#x8FD9;&#x4E2A;&#x4E0A;&#x503C;&#x7684;&#x503C;&#x538B;&#x6808;&#xFF0C; &#x5E76;&#x4E14;&#x8FD4;&#x56DE;&#x5B83;&#x7684;&#x540D;&#x5B57;&#x3002; funcindex &#x6307;&#x5411;&#x95ED;&#x5305;&#x5728;&#x6808;&#x4E0A;&#x7684;&#x4F4D;&#x7F6E;&#x3002; &#xFF08; &#x56E0;&#x4E3A;&#x4E0A;&#x503C;&#x5728;&#x6574;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#x90FD;&#x6709;&#x6548;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x4EEC;&#x6CA1;&#x6709;&#x7279;&#x522B;&#x7684;&#x6B21;&#x5E8F;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5B83;&#x4EEC;&#x4EE5;&#x5B57;&#x6BCD;&#x6B21;&#x5E8F;&#x6765;&#x7F16;&#x53F7;&#x3002;&#xFF09;</p>
<p>&#x5F53;&#x7D22;&#x5F15;&#x53F7;&#x6BD4;&#x4E0A;&#x503C;&#x6570;&#x91CF;&#x5927;&#x7684;&#x65F6;&#x5019;&#xFF0C; &#x8FD4;&#x56DE; NULL&#xFF08;&#x800C;&#x4E14;&#x4E0D;&#x4F1A;&#x538B;&#x5165;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#xFF09;&#x3002; &#x5BF9;&#x4E8E; C &#x51FD;&#x6570;&#xFF0C;&#x6240;&#x6709;&#x4E0A;&#x503C;&#x7684;&#x540D;&#x5B57;&#x90FD;&#x662F;&#x7A7A;&#x4E32; &quot;&quot;&#x3002;</p>
<p>lua_Hook</p>
<p>typedef void (<em>lua_Hook) (lua_State </em>L, lua_Debug *ar);
&#x7528;&#x4E8E;&#x8C03;&#x8BD5;&#x7684;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x65E0;&#x8BBA;&#x4F55;&#x65F6;&#x94A9;&#x5B50;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x5B83;&#x7684;&#x53C2;&#x6570; ar &#x4E2D;&#x7684; event &#x57DF;&#x90FD;&#x88AB;&#x8BBE;&#x4E3A;&#x89E6;&#x53D1;&#x94A9;&#x5B50;&#x7684;&#x4E8B;&#x4EF6;&#x3002; Lua &#x628A;&#x8FD9;&#x4E9B;&#x4E8B;&#x4EF6;&#x5B9A;&#x4E49;&#x4E3A;&#x4EE5;&#x4E0B;&#x5E38;&#x91CF;&#xFF1A; LUA_HOOKCALL&#xFF0C;LUA_HOOKRET&#xFF0C; LUA_HOOKTAILCALL&#xFF0C;LUA_HOOKLINE&#xFF0C; LUA_HOOKCOUNT&#x3002; &#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x5BF9;&#x4E8E; line &#x4E8B;&#x4EF6;&#xFF0C; currentline &#x57DF;&#x4E5F;&#x88AB;&#x8BBE;&#x7F6E;&#x3002; &#x8981;&#x60F3;&#x83B7;&#x5F97; ar &#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x57DF;&#xFF0C; &#x94A9;&#x5B50;&#x5FC5;&#x987B;&#x8C03;&#x7528; lua_getinfo &#x3002;</p>
<p>&#x5BF9;&#x4E8E; call &#x4E8B;&#x4EF6;&#xFF0C;event &#x53EF;&#x4EE5;&#x662F; LUA_HOOKCALL &#x8FD9;&#x4E2A;&#x901A;&#x5E38;&#x503C;&#xFF0C; &#x6216;&#x662F; LUA_HOOKTAILCALL &#x8868;&#x793A;&#x5C3E;&#x8C03;&#x7528;&#xFF1B; &#x540E;&#x4E00;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;&#x6CA1;&#x6709;&#x5BF9;&#x5E94;&#x7684;&#x8FD4;&#x56DE;&#x4E8B;&#x4EF6;&#x3002;</p>
<p>&#x5F53; Lua &#x8FD0;&#x884C;&#x5728;&#x4E00;&#x4E2A;&#x94A9;&#x5B50;&#x5185;&#x90E8;&#x65F6;&#xFF0C; &#x5B83;&#x5C06;&#x5C4F;&#x853D;&#x6389;&#x5176;&#x5B83;&#x5BF9;&#x94A9;&#x5B50;&#x7684;&#x8C03;&#x7528;&#x3002; &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x5185;&#x518D;&#x8C03;&#x56DE; Lua &#x6765;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757; &#xFF0C; &#x8FD9;&#x4E2A;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x4E0D;&#x4F1A;&#x89E6;&#x53D1;&#x4EFB;&#x4F55;&#x7684;&#x94A9;&#x5B50;&#x3002;</p>
<p>&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x4E0D;&#x80FD;&#x6709;&#x5EF6;&#x7EED;&#x70B9;&#xFF0C; &#x5373;&#x4E0D;&#x80FD;&#x7528;&#x4E00;&#x4E2A;&#x975E;&#x7A7A;&#x7684; k &#x8C03;&#x7528; lua_yieldk&#xFF0C; lua_pcallk&#xFF0C;&#x6216; lua_callk&#x3002;</p>
<p>&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5728;&#x6EE1;&#x8DB3;&#x4E0B;&#x5217;&#x6761;&#x4EF6;&#x65F6;&#x8BA9;&#x51FA;&#xFF1A; &#x53EA;&#x6709;&#x884C;&#x8BA1;&#x6570;&#x4E8B;&#x4EF6;&#x53EF;&#x4EE5;&#x8BA9;&#x51FA;&#xFF0C;&#x4E14;&#x4E0D;&#x80FD;&#x5728;&#x8BA9;&#x51FA;&#x65F6;&#x4F20;&#x51FA;&#x4EFB;&#x4F55;&#x503C;&#xFF1B; &#x4ECE;&#x94A9;&#x5B50;&#x91CC;&#x8BA9;&#x51FA;&#x5FC5;&#x987B;&#x7528; lua_yield &#x6765;&#x7ED3;&#x675F;&#x94A9;&#x5B50;&#x7684;&#x8FD0;&#x884C;&#xFF0C;&#x4E14; nresults &#x5FC5;&#x987B;&#x4E3A;&#x96F6;&#x3002;</p>
<p>lua_sethook</p>
<p>[-0, +0, &#x2013;]
void lua_sethook (lua_State *L, lua_Hook f, int mask, int count);
&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x8C03;&#x8BD5;&#x7528;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x53C2;&#x6570; f &#x662F;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x3002; mask &#x6307;&#x5B9A;&#x5728;&#x54EA;&#x4E9B;&#x4E8B;&#x4EF6;&#x65F6;&#x4F1A;&#x8C03;&#x7528;&#xFF1A; &#x5B83;&#x7531;&#x4E0B;&#x5217;&#x4E00;&#x7EC4;&#x4F4D;&#x5E38;&#x91CF;&#x6784;&#x6210; LUA_MASKCALL&#xFF0C; LUA_MASKRET&#xFF0C; LUA_MASKLINE&#xFF0C; LUA_MASKCOUNT&#x3002; &#x53C2;&#x6570; count &#x53EA;&#x5728;&#x63A9;&#x7801;&#x4E2D;&#x5305;&#x542B;&#x6709; LUA_MASKCOUNT &#x624D;&#x6709;&#x610F;&#x4E49;&#x3002; &#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x4E8B;&#x4EF6;&#xFF0C;&#x94A9;&#x5B50;&#x88AB;&#x8C03;&#x7528;&#x7684;&#x60C5;&#x51B5;&#x89E3;&#x91CA;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>call hook: &#x5728;&#x89E3;&#x91CA;&#x5668;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x65F6;&#x88AB;&#x8C03;&#x7528;&#x3002; &#x94A9;&#x5B50;&#x5C06;&#x4E8E; Lua &#x8FDB;&#x5165;&#x4E00;&#x4E2A;&#x65B0;&#x51FD;&#x6570;&#x540E;&#xFF0C; &#x51FD;&#x6570;&#x83B7;&#x53D6;&#x53C2;&#x6570;&#x524D;&#x88AB;&#x8C03;&#x7528;&#x3002;
return hook: &#x5728;&#x89E3;&#x91CA;&#x5668;&#x4ECE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4E2D;&#x8FD4;&#x56DE;&#x65F6;&#x8C03;&#x7528;&#x3002; &#x94A9;&#x5B50;&#x5C06;&#x4E8E; Lua &#x79BB;&#x5F00;&#x51FD;&#x6570;&#x4E4B;&#x524D;&#x7684;&#x90A3;&#x4E00;&#x523B;&#x88AB;&#x8C03;&#x7528;&#x3002; &#x6CA1;&#x6709;&#x6807;&#x51C6;&#x65B9;&#x6CD5;&#x6765;&#x8BBF;&#x95EE;&#x88AB;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7684;&#x90A3;&#x4E9B;&#x503C;&#x3002;
line hook: &#x5728;&#x89E3;&#x91CA;&#x5668;&#x51C6;&#x5907;&#x5F00;&#x59CB;&#x6267;&#x884C;&#x65B0;&#x7684;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x65F6;&#xFF0C; &#x6216;&#x662F;&#x8DF3;&#x8F6C;&#x5230;&#x8FD9;&#x884C;&#x4EE3;&#x7801;&#x4E2D;&#x65F6;&#xFF08;&#x5373;&#x4F7F;&#x5728;&#x540C;&#x4E00;&#x884C;&#x5185;&#x8DF3;&#x8F6C;&#xFF09;&#x88AB;&#x8C03;&#x7528;&#x3002; &#xFF08;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x4EC5;&#x4EC5;&#x5728; Lua &#x6267;&#x884C;&#x4E00;&#x4E2A; Lua &#x51FD;&#x6570;&#x65F6;&#x53D1;&#x751F;&#x3002;&#xFF09;
count hook: &#x5728;&#x89E3;&#x91CA;&#x5668;&#x6BCF;&#x6267;&#x884C; count &#x6761;&#x6307;&#x4EE4;&#x540E;&#x88AB;&#x8C03;&#x7528;&#x3002; &#xFF08;&#x8FD9;&#x4E2A;&#x4E8B;&#x4EF6;&#x4EC5;&#x4EC5;&#x5728; Lua &#x6267;&#x884C;&#x4E00;&#x4E2A; Lua &#x51FD;&#x6570;&#x65F6;&#x53D1;&#x751F;&#x3002;&#xFF09;
&#x94A9;&#x5B50;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E; mask &#x4E3A;&#x96F6;&#x5C4F;&#x853D;&#x3002;</p>
<p>lua_setlocal</p>
<p>[-(0|1), +0, &#x2013;]
const char <em>lua_setlocal (lua_State </em>L, const lua_Debug *ar, int n);
&#x8BBE;&#x7F6E;&#x7ED9;&#x5B9A;&#x6D3B;&#x52A8;&#x8BB0;&#x5F55;&#x4E2D;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x3002; &#x53C2;&#x6570; ar &#x4E0E; n &#x548C; lua_getlocal &#x4E2D;&#x7684;&#x4E00;&#x6837; &#xFF08;&#x53C2;&#x89C1; lua_getlocal &#xFF09;&#x3002; lua_setlocal &#x628A;&#x6808;&#x9876;&#x7684;&#x503C;&#x8D4B;&#x7ED9;&#x53D8;&#x91CF;&#x7136;&#x540E;&#x8FD4;&#x56DE;&#x53D8;&#x91CF;&#x7684;&#x540D;&#x5B57;&#x3002; &#x5B83;&#x4F1A;&#x5C06;&#x503C;&#x4ECE;&#x6808;&#x9876;&#x5F39;&#x51FA;&#x3002;</p>
<p>&#x5F53;&#x7D22;&#x5F15;&#x5927;&#x4E8E;&#x6D3B;&#x52A8;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x6570;&#x91CF;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; NULL &#xFF08;&#x4EC0;&#x4E48;&#x4E5F;&#x4E0D;&#x5F39;&#x51FA;&#xFF09;&#x3002;</p>
<p>lua_setupvalue</p>
<p>[-(0|1), +0, &#x2013;]
const char <em>lua_setupvalue (lua_State </em>L, int funcindex, int n);
&#x8BBE;&#x7F6E;&#x95ED;&#x5305;&#x4E0A;&#x503C;&#x7684;&#x503C;&#x3002; &#x5B83;&#x628A;&#x6808;&#x9876;&#x7684;&#x503C;&#x5F39;&#x51FA;&#x5E76;&#x8D4B;&#x4E8E;&#x4E0A;&#x503C;&#x5E76;&#x8FD4;&#x56DE;&#x4E0A;&#x503C;&#x7684;&#x540D;&#x5B57;&#x3002; &#x53C2;&#x6570; funcindex &#x4E0E; n &#x548C; lua_getupvalue &#x4E2D;&#x7684;&#x4E00;&#x6837; &#xFF08;&#x53C2;&#x89C1; lua_getupvalue &#xFF09;&#x3002;</p>
<p>&#x5F53;&#x7D22;&#x5F15;&#x5927;&#x4E8E;&#x4E0A;&#x503C;&#x7684;&#x6570;&#x91CF;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; NULL &#xFF08;&#x4EC0;&#x4E48;&#x4E5F;&#x4E0D;&#x5F39;&#x51FA;&#xFF09;&#x3002;</p>
<p>lua_upvalueid</p>
<p>[-0, +0, &#x2013;]
void <em>lua_upvalueid (lua_State </em>L, int funcindex, int n);
&#x8FD4;&#x56DE;&#x7D22;&#x5F15; funcindex &#x5904;&#x7684;&#x95ED;&#x5305;&#x4E2D; &#x7F16;&#x53F7;&#x4E3A; n &#x7684;&#x4E0A;&#x503C;&#x7684;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7B26;&#x3002; &#x53C2;&#x6570; funcindex &#x4E0E; n &#x548C; lua_getupvalue &#x4E2D;&#x7684;&#x4E00;&#x6837; &#xFF08;&#x53C2;&#x89C1; lua_getupvalue &#xFF09;&#x3002; &#xFF08;&#x4F46; n &#x4E0D;&#x53EF;&#x4EE5;&#x5927;&#x4E8E;&#x4E0A;&#x503C;&#x7684;&#x6570;&#x91CF;&#xFF09;&#x3002;</p>
<p>&#x8FD9;&#x4E9B;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7B26;&#x53EF;&#x7528;&#x4E8E;&#x68C0;&#x6D4B;&#x4E0D;&#x540C;&#x7684;&#x95ED;&#x5305;&#x662F;&#x5426;&#x5171;&#x4EAB;&#x4E86;&#x76F8;&#x540C;&#x7684;&#x4E0A;&#x503C;&#x3002; &#x5171;&#x4EAB;&#x540C;&#x4E00;&#x4E2A;&#x4E0A;&#x503C;&#x7684; Lua &#x95ED;&#x5305;&#xFF08;&#x5373;&#x5B83;&#x4EEC;&#x6307;&#x7684;&#x540C;&#x4E00;&#x4E2A;&#x5916;&#x90E8;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF09; &#x4F1A;&#x9488;&#x5BF9;&#x8FD9;&#x4E2A;&#x4E0A;&#x503C;&#x8FD4;&#x56DE;&#x76F8;&#x540C;&#x7684;&#x6807;&#x8BC6;&#x3002;</p>
<p>lua_upvaluejoin</p>
<p>[-0, +0, &#x2013;]
void lua_upvaluejoin (lua_State *L, int funcindex1, int n1,
                                    int funcindex2, int n2);
&#x8BA9;&#x7D22;&#x5F15; funcindex1 &#x5904;&#x7684; Lua &#x95ED;&#x5305;&#x7684;&#x7B2C; n1 &#x4E2A;&#x4E0A;&#x503C; &#x5F15;&#x7528;&#x7D22;&#x5F15; funcindex2 &#x5904;&#x7684; Lua &#x95ED;&#x5305;&#x7684;&#x7B2C; n2 &#x4E2A;&#x4E0A;&#x503C;&#x3002;</p>
<h1 id="&#x8F85;&#x52A9;&#x5E93;">&#x8F85;&#x52A9;&#x5E93; <a href="#&#x8F85;&#x52A9;&#x5E93;"> # </a></h1>
<p>&#x8F85;&#x52A9;&#x5E93; &#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x4FBF;&#x6377;&#x51FD;&#x6570;&#xFF0C;&#x65B9;&#x4FBF;&#x5728; C &#x4E2D;&#x4E3A; Lua &#x7F16;&#x7A0B;&#x3002; &#x57FA;&#x7840; API &#x63D0;&#x4F9B;&#x4E86; C &#x548C; Lua &#x4EA4;&#x4E92;&#x7528;&#x7684;&#x4E3B;&#x8981;&#x51FD;&#x6570;&#xFF0C; &#x800C;&#x8F85;&#x52A9;&#x5E93;&#x5219;&#x4E3A;&#x4E00;&#x4E9B;&#x5E38;&#x89C1;&#x7684;&#x4EFB;&#x52A1;&#x63D0;&#x4F9B;&#x4E86;&#x9AD8;&#x9636;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x6240;&#x6709;&#x8F85;&#x52A9;&#x5E93;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x548C;&#x7C7B;&#x578B;&#x90FD;&#x5B9A;&#x4E49;&#x5728;&#x5934;&#x6587;&#x4EF6; lauxlib.h &#x4E2D;&#xFF0C; &#x5B83;&#x4EEC;&#x5747;&#x5E26;&#x6709;&#x524D;&#x7F00; luaL_&#x3002;</p>
<p>&#x8F85;&#x52A9;&#x5E93;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x57FA;&#x4E8E;&#x57FA;&#x7840; API &#x5B9E;&#x73B0;&#x3002; &#x6545;&#x800C;&#x5B83;&#x4EEC;&#x5E76;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x57FA;&#x7840; API &#x5B9E;&#x73B0;&#x4E0D;&#x4E86;&#x7684;&#x529F;&#x80FD;&#x3002; &#x867D;&#x7136;&#x5982;&#x6B64;&#xFF0C;&#x4F7F;&#x7528;&#x8F85;&#x52A9;&#x5E93;&#x53EF;&#x4EE5;&#x8BA9;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x66F4;&#x4E3A;&#x5065;&#x58EE;&#x3002;</p>
<p>&#x4E00;&#x4E9B;&#x8F85;&#x52A9;&#x5E93;&#x51FD;&#x6570;&#x4F1A;&#x5728;&#x5185;&#x90E8;&#x4F7F;&#x7528;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x6808;&#x7A7A;&#x95F4;&#x3002; &#x5F53;&#x8F85;&#x52A9;&#x5E93;&#x4F7F;&#x7528;&#x7684;&#x6808;&#x7A7A;&#x95F4;&#x5C11;&#x4E8E;&#x4E94;&#x4E2A;&#x65F6;&#xFF0C; &#x5B83;&#x4EEC;&#x4E0D;&#x53BB;&#x68C0;&#x67E5;&#x6808;&#x5927;&#x5C0F;&#xFF1B;&#x800C;&#x662F;&#x7B80;&#x5355;&#x7684;&#x5047;&#x8BBE;&#x6808;&#x591F;&#x7528;&#x3002;</p>
<p>&#x4E00;&#x4E9B;&#x8F85;&#x52A9;&#x5E93;&#x4E2D;&#x7684;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x68C0;&#x67E5; C &#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x3002; &#x56E0;&#x4E3A;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x683C;&#x5F0F;&#x5316;&#x4E3A;&#x6307;&#x4EE3;&#x53C2;&#x6570; &#xFF08;&#x4F8B;&#x5982;&#xFF0C;&quot;bad argument #1&quot;&#xFF09;&#xFF0C; &#x4F60;&#x5C31;&#x4E0D;&#x8981;&#x628A;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x53C2;&#x6570;&#x4E4B;&#x5916;&#x7684;&#x503C;&#x4E86;&#x3002;</p>
<p>&#x5982;&#x679C;&#x68C0;&#x67E5;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;&#xFF0C; luaL_check* &#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x4E00;&#x5B9A;&#x4F1A;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>5.1 &#x2013; &#x51FD;&#x6570;&#x548C;&#x7C7B;&#x578B;</p>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x6309;&#x5B57;&#x6BCD;&#x8868;&#x6B21;&#x5E8F;&#x5217;&#x51FA;&#x4E86;&#x8F85;&#x52A9;&#x5E93;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6570;&#x548C;&#x7C7B;&#x578B;&#x3002;</p>
<p>luaL_addchar</p>
<p>[-?, +?, e]
void luaL_addchar (luaL_Buffer *B, char c);
&#x5411;&#x7F13;&#x5B58; B &#xFF08;&#x53C2;&#x89C1; luaL_Buffer &#xFF09; &#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x5B57;&#x8282; c&#x3002;</p>
<p>luaL_addlstring</p>
<p>[-?, +?, e]
void luaL_addlstring (luaL_Buffer <em>B, const char </em>s, size_t l);
&#x5411;&#x7F13;&#x5B58; B &#xFF08;&#x53C2;&#x89C1; luaL_Buffer &#xFF09; &#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x4E3A; l &#x7684;&#x5B57;&#x7B26;&#x4E32; s&#x3002; &#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x96F6;&#x3002;</p>
<p>luaL_addsize</p>
<p>[-?, +?, e]
void luaL_addsize (luaL_Buffer *B, size_t n);
&#x5411;&#x7F13;&#x5B58; B &#xFF08;&#x53C2;&#x89C1; luaL_Buffer &#xFF09; &#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x5DF2;&#x5728;&#x4E4B;&#x524D;&#x590D;&#x5236;&#x5230;&#x7F13;&#x51B2;&#x533A;&#xFF08;&#x53C2;&#x89C1; luaL_prepbuffer&#xFF09; &#x7684;&#x957F;&#x5EA6;&#x4E3A; n &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>luaL_addstring</p>
<p>[-?, +?, e]
void luaL_addstring (luaL_Buffer <em>B, const char </em>s);
&#x5411;&#x7F13;&#x5B58; B &#xFF08;&#x53C2;&#x89C1; luaL_Buffer &#xFF09; &#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x96F6;&#x7ED3;&#x5C3E;&#x7684;&#x5B57;&#x7B26;&#x4E32; s&#x3002;</p>
<p>luaL_addvalue</p>
<p>[-1, +?, e]
void luaL_addvalue (luaL_Buffer *B);
&#x5411;&#x7F13;&#x5B58; B &#xFF08;&#x53C2;&#x89C1; luaL_Buffer &#xFF09; &#x6DFB;&#x52A0;&#x6808;&#x9876;&#x7684;&#x4E00;&#x4E2A;&#x503C;&#xFF0C;&#x968F;&#x540E;&#x5C06;&#x5176;&#x5F39;&#x51FA;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x662F;&#x64CD;&#x4F5C;&#x5B57;&#x7B26;&#x4E32;&#x7F13;&#x5B58;&#x7684;&#x51FD;&#x6570;&#x4E2D;&#xFF0C;&#x552F;&#x4E00;&#x4E00;&#x4E2A;&#x4F1A;&#xFF08;&#x4E14;&#x5FC5;&#x987B;&#xFF09;&#x5728;&#x6808;&#x4E0A;&#x653E;&#x7F6E;&#x989D;&#x5916;&#x5143;&#x7D20;&#x7684;&#x3002; &#x8FD9;&#x4E2A;&#x5143;&#x7D20;&#x5C06;&#x88AB;&#x52A0;&#x5165;&#x7F13;&#x5B58;&#x3002;</p>
<p>luaL_argcheck</p>
<p>[-0, +0, v]
void luaL_argcheck (lua_State <em>L,
                    int cond,
                    int arg,
                    const char </em>extramsg);
&#x68C0;&#x67E5; cond &#x662F;&#x5426;&#x4E3A;&#x771F;&#x3002; &#x5982;&#x679C;&#x4E0D;&#x4E3A;&#x771F;&#xFF0C;&#x4EE5;&#x6807;&#x51C6;&#x4FE1;&#x606F;&#x5F62;&#x5F0F;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF; &#xFF08;&#x53C2;&#x89C1; luaL_argerror&#xFF09;&#x3002;</p>
<p>luaL_argerror</p>
<p>[-0, +0, v]
int luaL_argerror (lua_State <em>L, int arg, const char </em>extramsg);
&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x62A5;&#x544A;&#x8C03;&#x7528;&#x7684; C &#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x7684;&#x95EE;&#x9898;&#x3002; &#x5B83;&#x4F7F;&#x7528;&#x4E0B;&#x5217;&#x6807;&#x51C6;&#x4FE1;&#x606F;&#x5E76;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x6BB5; extramsg &#x4F5C;&#x4E3A;&#x6CE8;&#x89E3;&#xFF1A;</p>
<pre><code> bad argument #arg to &apos;funcname&apos; (extramsg)
</code></pre><p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x3002;</p>
<p>luaL_Buffer</p>
<p>typedef struct luaL_Buffer luaL_Buffer;
&#x5B57;&#x7B26;&#x4E32;&#x7F13;&#x5B58; &#x7684;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x5B57;&#x7B26;&#x4E32;&#x7F13;&#x5B58;&#x53EF;&#x4EE5;&#x8BA9; C &#x4EE3;&#x7801;&#x5206;&#x6BB5;&#x6784;&#x9020;&#x4E00;&#x4E2A; Lua &#x5B57;&#x7B26;&#x4E32;&#x3002; &#x4F7F;&#x7528;&#x6A21;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>&#x9996;&#x5148;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x4E3A; luaL_Buffer &#x7684;&#x53D8;&#x91CF; b&#x3002;
&#x8C03;&#x7528; luaL_buffinit(L, &amp;b) &#x521D;&#x59CB;&#x5316;&#x5B83;&#x3002;
&#x7136;&#x540E;&#x8C03;&#x7528; luaL_add* &#x8FD9;&#x7EC4;&#x51FD;&#x6570;&#x5411;&#x5176;&#x6DFB;&#x52A0;&#x5B57;&#x7B26;&#x4E32;&#x7247;&#x65AD;&#x3002;
&#x6700;&#x540E;&#x8C03;&#x7528; luaL_pushresult(&amp;b) &#x3002; &#x6700;&#x540E;&#x8FD9;&#x6B21;&#x8C03;&#x7528;&#x4F1A;&#x5728;&#x6808;&#x9876;&#x7559;&#x4E0B;&#x6700;&#x7EC8;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;
&#x5982;&#x679C;&#x4F60;&#x9884;&#x5148;&#x77E5;&#x9053;&#x7ED3;&#x679C;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#xFF0C; &#x4F60;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x4F7F;&#x7528;&#x7F13;&#x5B58;&#xFF1A;</p>
<p>&#x9996;&#x5148;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x4E3A; luaL_Buffer &#x7684;&#x53D8;&#x91CF; b&#x3002;
&#x7136;&#x540E;&#x8C03;&#x7528; luaL_buffinitsize(L, &amp;b, sz) &#x9884;&#x5206;&#x914D; sz &#x5927;&#x5C0F;&#x7684;&#x7A7A;&#x95F4;&#x3002;
&#x63A5;&#x7740;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x590D;&#x5236;&#x5165;&#x8FD9;&#x4E2A;&#x7A7A;&#x95F4;&#x3002;
&#x6700;&#x540E;&#x8C03;&#x7528; luaL_pushresultsize(&amp;b, sz)&#xFF0C; &#x8FD9;&#x91CC;&#x7684; sz &#x6307;&#x5DF2;&#x7ECF;&#x590D;&#x5236;&#x5230;&#x7F13;&#x5B58;&#x5185;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x3002;
&#x4E00;&#x822C;&#x7684;&#x64CD;&#x4F5C;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x7F13;&#x5B58;&#x4F1A;&#x4F7F;&#x7528;&#x4E0D;&#x5B9A;&#x91CF;&#x7684;&#x6808;&#x69FD;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x4F7F;&#x7528;&#x7F13;&#x5B58;&#x4E2D;&#xFF0C;&#x4F60;&#x4E0D;&#x80FD;&#x5047;&#x5B9A;&#x76EE;&#x524D;&#x6808;&#x9876;&#x5728;&#x54EA;&#x3002; &#x5728;&#x5BF9;&#x7F13;&#x5B58;&#x64CD;&#x4F5C;&#x7684;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x95F4;&#xFF0C;&#x4F60;&#x90FD;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6808;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x4FDD;&#x8BC1;&#x6808;&#x5E73;&#x8861;&#x5373;&#x53EF;&#xFF1B; &#x5373;&#xFF0C;&#x5728;&#x4F60;&#x505A;&#x4E00;&#x6B21;&#x7F13;&#x5B58;&#x64CD;&#x4F5C;&#x8C03;&#x7528;&#x65F6;&#xFF0C;&#x5F53;&#x65F6;&#x7684;&#x6808;&#x4F4D;&#x7F6E;&#x548C;&#x4E0A;&#x6B21;&#x8C03;&#x7528;&#x7F13;&#x5B58;&#x64CD;&#x4F5C;&#x540E;&#x7684;&#x4F4D;&#x7F6E;&#x76F8;&#x540C;&#x3002; &#xFF08;&#x5BF9;&#x4E8E; luaL_addvalue &#x662F;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x4F8B;&#x5916;&#x3002;&#xFF09; &#x5728;&#x8C03;&#x7528;&#x5B8C; luaL_pushresult &#x540E;&#xFF0C; &#x6808;&#x4F1A;&#x6062;&#x590D;&#x5230;&#x7F13;&#x5B58;&#x521D;&#x59CB;&#x5316;&#x65F6;&#x7684;&#x4F4D;&#x7F6E;&#x4E0A;&#xFF0C;&#x5E76;&#x5728;&#x9876;&#x90E8;&#x538B;&#x5165;&#x6700;&#x7EC8;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>luaL_buffinit</p>
<p>[-0, +0, &#x2013;]
void luaL_buffinit (lua_State <em>L, luaL_Buffer </em>B);
&#x521D;&#x59CB;&#x5316;&#x7F13;&#x5B58; B&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E0D;&#x4F1A;&#x5206;&#x914D;&#x4EFB;&#x4F55;&#x7A7A;&#x95F4;&#xFF1B; &#x7F13;&#x5B58;&#x5FC5;&#x987B;&#x4EE5;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x5F62;&#x5F0F;&#x58F0;&#x660E; &#xFF08;&#x53C2;&#x89C1; luaL_Buffer&#xFF09;&#x3002;</p>
<p>luaL_buffinitsize</p>
<p>[-?, +?, e]
char <em>luaL_buffinitsize (lua_State </em>L, luaL_Buffer *B, size_t sz);
&#x7B49;&#x4EF7;&#x4E8E;&#x8C03;&#x7528;&#x5E8F;&#x5217; luaL_buffinit&#xFF0C; luaL_prepbuffsize&#x3002;</p>
<p>luaL_callmeta</p>
<p>[-0, +(0|1), e]
int luaL_callmeta (lua_State <em>L, int obj, const char </em>e);
&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x5143;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5728;&#x7D22;&#x5F15; obj &#x5904;&#x7684;&#x5BF9;&#x8C61;&#x6709;&#x5143;&#x8868;&#xFF0C; &#x4E14;&#x5143;&#x8868;&#x6709;&#x57DF; e &#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x4EE5;&#x8BE5;&#x5BF9;&#x8C61;&#x4E3A;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x57DF;&#x3002; &#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x771F;&#x5E76;&#x5C06;&#x8C03;&#x7528;&#x8FD4;&#x56DE;&#x503C;&#x538B;&#x6808;&#x3002; &#x5982;&#x679C;&#x90A3;&#x4E2A;&#x4F4D;&#x7F6E;&#x6CA1;&#x6709;&#x5143;&#x8868;&#xFF0C;&#x6216;&#x6CA1;&#x6709;&#x5BF9;&#x5E94;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; &#x6B64;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5047;&#xFF08;&#x5E76;&#x4E0D;&#x4F1A;&#x5C06;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;&#x538B;&#x6808;&#xFF09;&#x3002;</p>
<p>luaL_checkany</p>
<p>[-0, +0, v]
void luaL_checkany (lua_State *L, int arg);
&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x5728; arg &#x4F4D;&#x7F6E;&#x662F;&#x5426;&#x6709;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#xFF08;&#x5305;&#x62EC; nil&#xFF09;&#x7684;&#x53C2;&#x6570;&#x3002;</p>
<p>luaL_checkinteger</p>
<p>[-0, +0, v]
lua_Integer luaL_checkinteger (lua_State *L, int arg);
&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A; &#x6574;&#x6570;&#xFF08;&#x6216;&#x662F;&#x53EF;&#x4EE5;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF09; &#x5E76;&#x4EE5; lua_Integer &#x7C7B;&#x578B;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x6574;&#x6570;&#x503C;&#x3002;</p>
<p>luaL_checklstring</p>
<p>[-0, +0, v]
const char <em>luaL_checklstring (lua_State </em>L, int arg, size_t <em>l);
&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A; &#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x8BE5;&#x5B57;&#x7B26;&#x4E32;&#xFF1B; &#x5982;&#x679C; l &#x4E0D;&#x4E3A; NULL &#xFF0C; &#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#x586B;&#x5165; </em>l&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F7F;&#x7528; lua_tolstring &#x6765;&#x83B7;&#x53D6;&#x7ED3;&#x679C;&#x3002; &#x6240;&#x4EE5;&#x8BE5;&#x51FD;&#x6570;&#x6709;&#x53EF;&#x80FD;&#x5F15;&#x53D1;&#x7684;&#x8F6C;&#x6362;&#x90FD;&#x540C;&#x6837;&#x6709;&#x6548;&#x3002;</p>
<p>luaL_checknumber</p>
<p>[-0, +0, v]
lua_Number luaL_checknumber (lua_State *L, int arg);
&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A; &#x6570;&#x5B57;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x3002;</p>
<p>luaL_checkoption</p>
<p>[-0, +0, v]
int luaL_checkoption (lua_State <em>L,
                      int arg,
                      const char </em>def,
                      const char *const lst[]);
&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A; &#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x5728;&#x6570;&#x7EC4; lst &#xFF08;&#x6BD4;&#x5982;&#x662F;&#x96F6;&#x7ED3;&#x5C3E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6570;&#x7EC4;&#xFF09; &#x4E2D;&#x67E5;&#x627E;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x8FD4;&#x56DE;&#x5339;&#x914D;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5728;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x7D22;&#x5F15;&#x53F7;&#x3002; &#x5982;&#x679C;&#x53C2;&#x6570;&#x4E0D;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6216;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x5728;&#x6570;&#x7EC4;&#x4E2D;&#x5339;&#x914D;&#x4E0D;&#x5230;&#xFF0C;&#x90FD;&#x5C06;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x5982;&#x679C; def &#x4E0D;&#x4E3A; NULL&#xFF0C; &#x51FD;&#x6570;&#x5C31;&#x628A; def &#x5F53;&#x4F5C;&#x9ED8;&#x8BA4;&#x503C;&#x3002; &#x9ED8;&#x8BA4;&#x503C;&#x5728;&#x53C2;&#x6570; arg &#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x6216;&#x8BE5;&#x53C2;&#x6570;&#x662F; nil &#x65F6;&#x751F;&#x6548;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x901A;&#x5E38;&#x7528;&#x4E8E;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x6620;&#x5C04;&#x4E3A; C &#x679A;&#x4E3E;&#x91CF;&#x3002; &#xFF08;&#x5728; Lua &#x5E93;&#x4E2D;&#x505A;&#x8FD9;&#x4E2A;&#x8F6C;&#x6362;&#x53EF;&#x4EE5;&#x8BA9;&#x5176;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6570;&#x5B57;&#x6765;&#x505A;&#x4E00;&#x4E9B;&#x9009;&#x9879;&#x3002;&#xFF09;</p>
<p>luaL_checkstack</p>
<p>[-0, +0, v]
void luaL_checkstack (lua_State <em>L, int sz, const char </em>msg);
&#x5C06;&#x6808;&#x7A7A;&#x95F4;&#x6269;&#x5C55;&#x5230; top + sz &#x4E2A;&#x5143;&#x7D20;&#x3002; &#x5982;&#x679C;&#x6269;&#x5C55;&#x4E0D;&#x4E86;&#xFF0C;&#x5219;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002; msg &#x662F;&#x7528;&#x4E8E;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x7684;&#x989D;&#x5916;&#x6587;&#x672C; &#xFF08;NULL &#x8868;&#x793A;&#x4E0D;&#x9700;&#x8981;&#x989D;&#x5916;&#x6587;&#x672C;&#xFF09;&#x3002;</p>
<p>luaL_checkstring</p>
<p>[-0, +0, v]
const char <em>luaL_checkstring (lua_State </em>L, int arg);
&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A; &#x5B57;&#x7B26;&#x4E32;&#x5E76;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F7F;&#x7528; lua_tolstring &#x6765;&#x83B7;&#x53D6;&#x7ED3;&#x679C;&#x3002; &#x6240;&#x4EE5;&#x8BE5;&#x51FD;&#x6570;&#x6709;&#x53EF;&#x80FD;&#x5F15;&#x53D1;&#x7684;&#x8F6C;&#x6362;&#x90FD;&#x540C;&#x6837;&#x6709;&#x6548;&#x3002;</p>
<p>luaL_checktype</p>
<p>[-0, +0, v]
void luaL_checktype (lua_State *L, int arg, int t);
&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x662F;&#x5426;&#x662F; t&#x3002; &#x53C2;&#x89C1; lua_type &#x67E5;&#x9605;&#x7C7B;&#x578B; t &#x7684;&#x7F16;&#x7801;&#x3002;</p>
<p>luaL_checkudata</p>
<p>[-0, +0, v]
void <em>luaL_checkudata (lua_State </em>L, int arg, const char *tname);
&#x68C0;&#x67E5;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x5426;&#x662F;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x4E3A; tname &#x7684;&#x7528;&#x6237;&#x6570;&#x636E; &#xFF08;&#x53C2;&#x89C1; luaL_newmetatable )&#x3002; &#x5B83;&#x4F1A;&#x8FD4;&#x56DE;&#x8BE5;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x5730;&#x5740; &#xFF08;&#x53C2;&#x89C1; lua_touserdata&#xFF09;&#x3002;</p>
<p>luaL_checkversion</p>
<p>[-0, +0, &#x2013;]
void luaL_checkversion (lua_State *L);
&#x68C0;&#x67E5;&#x8C03;&#x7528;&#x5B83;&#x7684;&#x5185;&#x6838;&#x662F;&#x5426;&#x662F;&#x521B;&#x5EFA;&#x8FD9;&#x4E2A; Lua &#x72B6;&#x6001;&#x673A;&#x7684;&#x5185;&#x6838;&#x3002; &#x4EE5;&#x53CA;&#x8C03;&#x7528;&#x5B83;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x5426;&#x4F7F;&#x7528;&#x4E86;&#x76F8;&#x540C;&#x7684; Lua &#x7248;&#x672C;&#x3002; &#x540C;&#x65F6;&#x4E5F;&#x68C0;&#x67E5;&#x8C03;&#x7528;&#x5B83;&#x7684;&#x5185;&#x6838;&#x4E0E;&#x521B;&#x5EFA;&#x8BE5; Lua &#x72B6;&#x6001;&#x673A;&#x7684;&#x5185;&#x6838; &#x662F;&#x5426;&#x4F7F;&#x7528;&#x4E86;&#x540C;&#x4E00;&#x7247;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x3002;</p>
<p>luaL_dofile</p>
<p>[-0, +?, e]
int luaL_dofile (lua_State <em>L, const char </em>filename);
&#x52A0;&#x8F7D;&#x5E76;&#x8FD0;&#x884C;&#x6307;&#x5B9A;&#x7684;&#x6587;&#x4EF6;&#x3002; &#x5B83;&#x662F;&#x7528;&#x4E0B;&#x5217;&#x5B8F;&#x5B9A;&#x4E49;&#x51FA;&#x6765;&#xFF1A;</p>
<pre><code> (luaL_loadfile(L, filename) || lua_pcall(L, 0, LUA_MULTRET, 0))
</code></pre><p>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x9519;&#x8BEF;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5047;&#xFF1B; &#x6709;&#x9519;&#x5219;&#x8FD4;&#x56DE;&#x771F;&#x3002;</p>
<p>luaL_dostring</p>
<p>[-0, +?, &#x2013;]
int luaL_dostring (lua_State <em>L, const char </em>str);
&#x52A0;&#x8F7D;&#x5E76;&#x8FD0;&#x884C;&#x6307;&#x5B9A;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5B83;&#x662F;&#x7528;&#x4E0B;&#x5217;&#x5B8F;&#x5B9A;&#x4E49;&#x51FA;&#x6765;&#xFF1A;</p>
<pre><code> (luaL_loadstring(L, str) || lua_pcall(L, 0, LUA_MULTRET, 0))
</code></pre><p>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x9519;&#x8BEF;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5047;&#xFF1B; &#x6709;&#x9519;&#x5219;&#x8FD4;&#x56DE;&#x771F;&#x3002;</p>
<p>luaL_error</p>
<p>[-0, +0, v]
int luaL_error (lua_State <em>L, const char </em>fmt, ...);
&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002; &#x9519;&#x8BEF;&#x6D88;&#x606F;&#x7684;&#x683C;&#x5F0F;&#x7531; fmt &#x7ED9;&#x51FA;&#x3002; &#x540E;&#x9762;&#x9700;&#x63D0;&#x4F9B;&#x82E5;&#x5E72;&#x53C2;&#x6570;&#xFF0C; &#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x9075;&#x5FAA; lua_pushfstring &#x4E2D;&#x7684;&#x89C4;&#x5219;&#x3002; &#x5982;&#x679C;&#x80FD;&#x83B7;&#x5F97;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x5B83;&#x8FD8;&#x4F1A;&#x5728;&#x6D88;&#x606F;&#x524D;&#x9762;&#x52A0;&#x4E0A;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x65F6;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x53CA;&#x884C;&#x53F7;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x3002; &#x4F46;&#x662F;&#x5728; C &#x51FD;&#x6570;&#x4E2D;&#x901A;&#x5E38;&#x9075;&#x5FAA;&#x60EF;&#x7528;&#x6CD5;&#xFF1A; return luaL_error(args) &#x3002;</p>
<p>luaL_execresult</p>
<p>[-0, +3, e]
int luaL_execresult (lua_State *L, int stat);
&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x6807;&#x51C6;&#x5E93;&#x4E2D;&#x548C;&#x8FDB;&#x7A0B;&#x76F8;&#x5173;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002; &#xFF08;&#x6307; os.execute &#x548C; io.close&#xFF09;&#x3002;</p>
<p>luaL_fileresult</p>
<p>[-0, +(1|3), e]
int luaL_fileresult (lua_State <em>L, int stat, const char </em>fname);
&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x6807;&#x51C6;&#x5E93;&#x4E2D;&#x548C;&#x6587;&#x4EF6;&#x76F8;&#x5173;&#x7684;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002; &#xFF08;&#x6307; (io.open&#xFF0C; os.rename&#xFF0C; file:seek&#xFF0C;&#x7B49;&#x3002;)&#x3002;</p>
<p>luaL_getmetafield</p>
<p>[-0, +(0|1), e]
int luaL_getmetafield (lua_State <em>L, int obj, const char </em>e);
&#x5C06;&#x7D22;&#x5F15; obj &#x5904;&#x5BF9;&#x8C61;&#x7684;&#x5143;&#x8868;&#x4E2D; e &#x57DF;&#x7684;&#x503C;&#x538B;&#x6808;&#x3002; &#x5982;&#x679C;&#x8BE5;&#x5BF9;&#x8C61;&#x6CA1;&#x6709;&#x5143;&#x8868;&#xFF0C;&#x6216;&#x662F;&#x8BE5;&#x5143;&#x8868;&#x6CA1;&#x6709;&#x76F8;&#x5173;&#x57DF;&#xFF0C; &#x6B64;&#x51FD;&#x6570;&#x4EC0;&#x4E48;&#x4E5F;&#x4E0D;&#x4F1A;&#x538B;&#x6808;&#x5E76;&#x8FD4;&#x56DE; LUA_TNIL&#x3002;</p>
<p>luaL_getmetatable</p>
<p>[-0, +1, &#x2013;]
int luaL_getmetatable (lua_State <em>L, const char </em>tname);
&#x5C06;&#x6CE8;&#x518C;&#x8868;&#x4E2D; tname &#x5BF9;&#x5E94;&#x7684;&#x5143;&#x8868; &#xFF08;&#x53C2;&#x89C1; luaL_newmetatable&#xFF09;&#x538B;&#x6808;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709; tname &#x5BF9;&#x5E94;&#x7684;&#x5143;&#x8868;&#xFF0C;&#x5219;&#x5C06; nil &#x538B;&#x6808;&#x5E76;&#x8FD4;&#x56DE;&#x5047;&#x3002;</p>
<p>luaL_getsubtable</p>
<p>[-0, +1, e]
int luaL_getsubtable (lua_State <em>L, int idx, const char </em>fname);
&#x786E;&#x4FDD; t[fname] &#x662F;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x5E76;&#x5C06;&#x8FD9;&#x5F20;&#x8868;&#x538B;&#x6808;&#x3002; &#x8FD9;&#x91CC;&#x7684; t &#x6307;&#x7D22;&#x5F15; idx &#x5904;&#x7684;&#x503C;&#x3002; &#x5982;&#x679C;&#x5B83;&#x539F;&#x6765;&#x5C31;&#x662F;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x8FD4;&#x56DE;&#x771F;&#xFF1B; &#x5426;&#x5219;&#x4E3A;&#x5B83;&#x521B;&#x5EFA;&#x4E00;&#x5F20;&#x65B0;&#x8868;&#xFF0C;&#x8FD4;&#x56DE;&#x5047;&#x3002;</p>
<p>luaL_gsub</p>
<p>[-0, +1, e]
const char <em>luaL_gsub (lua_State </em>L,
                       const char <em>s,
                       const char </em>p,
                       const char *r);
&#x5C06;&#x5B57;&#x7B26;&#x4E32; s &#x751F;&#x6210;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#xFF0C; &#x5E76;&#x5C06;&#x5176;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x4E32; p &#x90FD;&#x66FF;&#x6362;&#x4E3A;&#x5B57;&#x7B26;&#x4E32; r &#x3002; &#x5C06;&#x7ED3;&#x679C;&#x4E32;&#x538B;&#x6808;&#x5E76;&#x8FD4;&#x56DE;&#x5B83;&#x3002;</p>
<p>luaL_len</p>
<p>[-0, +0, e]
lua_Integer luaL_len (lua_State *L, int index);
&#x4EE5;&#x6570;&#x5B57;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x503C;&#x7684;&#x201C;&#x957F;&#x5EA6;&#x201D;&#xFF1B; &#x5B83;&#x7B49;&#x4EF7;&#x4E8E;&#x5728; Lua &#x4E2D;&#x8C03;&#x7528; &apos;#&apos; &#x7684;&#x64CD;&#x4F5C; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.7&#xFF09;&#x3002; &#x5982;&#x679C;&#x64CD;&#x4F5C;&#x7ED3;&#x679C;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x5219;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002; &#xFF08;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x53EA;&#x53D1;&#x751F;&#x5728;&#x89E6;&#x53D1;&#x5143;&#x65B9;&#x6CD5;&#x65F6;&#x3002;&#xFF09;</p>
<p>luaL_loadbuffer</p>
<p>[-0, +1, &#x2013;]
int luaL_loadbuffer (lua_State <em>L,
                     const char </em>buff,
                     size_t sz,
                     const char *name);
&#x7B49;&#x4EF7;&#x4E8E; luaL_loadbufferx&#xFF0C; &#x5176; mode &#x53C2;&#x6570;&#x7B49;&#x4E8E; NULL&#x3002;</p>
<p>luaL_loadbufferx</p>
<p>[-0, +1, &#x2013;]
int luaL_loadbufferx (lua_State <em>L,
                      const char </em>buff,
                      size_t sz,
                      const char <em>name,
                      const char </em>mode);
&#x628A;&#x4E00;&#x6BB5;&#x7F13;&#x5B58;&#x52A0;&#x8F7D;&#x4E3A;&#x4E00;&#x4E2A; Lua &#x4EE3;&#x7801;&#x5757;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F7F;&#x7528; lua_load &#x6765;&#x52A0;&#x8F7D; buff &#x6307;&#x5411;&#x7684;&#x957F;&#x5EA6;&#x4E3A; sz &#x7684;&#x5185;&#x5B58;&#x533A;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x548C; lua_load &#x8FD4;&#x56DE;&#x503C;&#x76F8;&#x540C;&#x3002; name &#x4F5C;&#x4E3A;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x7528;&#x4E8E;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x548C;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002; mode &#x5B57;&#x7B26;&#x4E32;&#x7684;&#x4F5C;&#x7528;&#x540C;&#x51FD;&#x6570; lua_load&#x3002;</p>
<p>luaL_loadfile</p>
<p>[-0, +1, e]
int luaL_loadfile (lua_State <em>L, const char </em>filename);
&#x7B49;&#x4EF7;&#x4E8E; luaL_loadfilex&#xFF0C; &#x5176; mode &#x53C2;&#x6570;&#x7B49;&#x4E8E; NULL&#x3002;</p>
<p>luaL_loadfilex</p>
<p>[-0, +1, e]
int luaL_loadfilex (lua_State <em>L, const char </em>filename,
                                            const char *mode);
&#x628A;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x52A0;&#x8F7D;&#x4E3A; Lua &#x4EE3;&#x7801;&#x5757;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F7F;&#x7528; lua_load &#x52A0;&#x8F7D;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x3002; &#x4EE3;&#x7801;&#x5757;&#x7684;&#x540D;&#x5B57;&#x88AB;&#x547D;&#x540D;&#x4E3A; filename&#x3002; &#x5982;&#x679C; filename &#x4E3A; NULL&#xFF0C; &#x5B83;&#x4ECE;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x52A0;&#x8F7D;&#x3002; &#x5982;&#x679C;&#x6587;&#x4EF6;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x4EE5; # &#x6253;&#x5934;&#xFF0C;&#x5219;&#x5FFD;&#x7565;&#x8FD9;&#x4E00;&#x884C;&#x3002;</p>
<p>mode &#x5B57;&#x7B26;&#x4E32;&#x7684;&#x4F5C;&#x7528;&#x540C;&#x51FD;&#x6570; lua_load&#x3002;</p>
<p>&#x6B64;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x548C; lua_load &#x76F8;&#x540C;&#xFF0C; &#x4E0D;&#x8FC7;&#x5B83;&#x8FD8;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x53EB;&#x505A; LUA_ERRFILE &#x7684;&#x51FA;&#x9519;&#x7801;&#x3002;&#x8FD9;&#x79CD;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#x4E8E;&#x65E0;&#x6CD5;&#x6253;&#x5F00;&#x6216;&#x8BFB;&#x5165;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x6216;&#x662F;&#x6587;&#x4EF6;&#x7684;&#x6A21;&#x5F0F;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x548C; lua_load &#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4EC5;&#x52A0;&#x8F7D;&#x4EE3;&#x7801;&#x5757;&#x4E0D;&#x8FD0;&#x884C;&#x3002;</p>
<p>luaL_loadstring</p>
<p>[-0, +1, &#x2013;]
int luaL_loadstring (lua_State <em>L, const char </em>s);
&#x5C06;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x8F7D;&#x4E3A; Lua &#x4EE3;&#x7801;&#x5757;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F7F;&#x7528; lua_load &#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x96F6;&#x7ED3;&#x5C3E;&#x7684;&#x5B57;&#x7B26;&#x4E32; s&#x3002;</p>
<p>&#x6B64;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x548C; lua_load &#x76F8;&#x540C;&#x3002;</p>
<p>&#x4E5F;&#x548C; lua_load &#x4E00;&#x6837;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4EC5;&#x52A0;&#x8F7D;&#x4EE3;&#x7801;&#x5757;&#x4E0D;&#x8FD0;&#x884C;&#x3002;</p>
<p>luaL_newlib</p>
<p>[-0, +1, e]
void luaL_newlib (lua_State *L, const luaL_Reg l[]);
&#x521B;&#x5EFA;&#x4E00;&#x5F20;&#x65B0;&#x7684;&#x8868;&#xFF0C;&#x5E76;&#x628A;&#x5217;&#x8868; l &#x4E2D;&#x7684;&#x51FD;&#x6570;&#x6CE8;&#x518C;&#x8FDB;&#x53BB;&#x3002;</p>
<p>&#x5B83;&#x662F;&#x7528;&#x4E0B;&#x5217;&#x5B8F;&#x5B9E;&#x73B0;&#x7684;&#xFF1A;</p>
<pre><code> (luaL_newlibtable(L,l), luaL_setfuncs(L,l,0))
</code></pre><p>&#x6570;&#x7EC4; l &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x800C;&#x4E0D;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#x3002;</p>
<p>luaL_newlibtable</p>
<p>[-0, +1, e]
void luaL_newlibtable (lua_State *L, const luaL_Reg l[]);
&#x521B;&#x5EFA;&#x4E00;&#x5F20;&#x65B0;&#x7684;&#x8868;&#xFF0C;&#x5E76;&#x9884;&#x5206;&#x914D;&#x8DB3;&#x591F;&#x4FDD;&#x5B58;&#x4E0B;&#x6570;&#x7EC4; l &#x5185;&#x5BB9;&#x7684;&#x7A7A;&#x95F4;&#xFF08;&#x4F46;&#x4E0D;&#x586B;&#x5145;&#xFF09;&#x3002; &#x8FD9;&#x662F;&#x7ED9; luaL_setfuncs &#x4E00;&#x8D77;&#x7528;&#x7684; &#xFF08;&#x53C2;&#x89C1; luaL_newlib&#xFF09;&#x3002;</p>
<p>&#x5B83;&#x4EE5;&#x5B8F;&#x5F62;&#x5F0F;&#x5B9E;&#x73B0;&#xFF0C; &#x6570;&#x7EC4; l &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x800C;&#x4E0D;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#x3002;</p>
<p>luaL_newmetatable</p>
<p>[-0, +1, e]
int luaL_newmetatable (lua_State <em>L, const char </em>tname);
&#x5982;&#x679C;&#x6CE8;&#x518C;&#x8868;&#x4E2D;&#x5DF2;&#x5B58;&#x5728;&#x952E; tname&#xFF0C;&#x8FD4;&#x56DE; 0 &#x3002; &#x5426;&#x5219;&#xFF0C; &#x4E3A;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x5143;&#x8868;&#x521B;&#x5EFA;&#x4E00;&#x5F20;&#x65B0;&#x8868;&#x3002; &#x5411;&#x8FD9;&#x5F20;&#x8868;&#x52A0;&#x5165; <strong>name = tname &#x952E;&#x503C;&#x5BF9;&#xFF0C; &#x5E76;&#x5C06; [tname] = new table &#x6DFB;&#x52A0;&#x5230;&#x6CE8;&#x518C;&#x8868;&#x4E2D;&#xFF0C; &#x8FD4;&#x56DE; 1 &#x3002; &#xFF08;</strong>name&#x9879;&#x53EF;&#x7528;&#x4E8E;&#x4E00;&#x4E9B;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x51FD;&#x6570;&#x3002;&#xFF09;</p>
<p>&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x90FD;&#x4F1A;&#x628A;&#x6700;&#x7EC8;&#x7684;&#x6CE8;&#x518C;&#x8868;&#x4E2D;&#x5173;&#x8054; tname &#x7684;&#x503C;&#x538B;&#x6808;&#x3002;</p>
<p>luaL_newstate</p>
<p>[-0, +0, &#x2013;]
lua_State *luaL_newstate (void);
&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684; Lua &#x72B6;&#x6001;&#x673A;&#x3002; &#x5B83;&#x4EE5;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E;&#x6807;&#x51C6; C &#x7684; realloc &#x51FD;&#x6570;&#x5B9E;&#x73B0;&#x7684;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5668; &#x8C03;&#x7528; lua_newstate &#x3002; &#x5E76;&#x628A;&#x53EF;&#x6253;&#x5370;&#x4E00;&#x4E9B;&#x51FA;&#x9519;&#x4FE1;&#x606F;&#x5230;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x8F93;&#x51FA;&#x7684; panic &#x51FD;&#x6570;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.6&#xFF09; &#x8BBE;&#x7F6E;&#x597D;&#xFF0C;&#x7528;&#x4E8E;&#x5904;&#x7406;&#x81F4;&#x547D;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x65B0;&#x7684;&#x72B6;&#x6001;&#x673A;&#x3002; &#x5982;&#x679C;&#x5185;&#x5B58;&#x5206;&#x914D;&#x5931;&#x8D25;&#xFF0C;&#x5219;&#x8FD4;&#x56DE; NULL &#x3002;</p>
<p>luaL_openlibs</p>
<p>[-0, +0, e]
void luaL_openlibs (lua_State *L);
&#x6253;&#x5F00;&#x6307;&#x5B9A;&#x72B6;&#x6001;&#x673A;&#x4E2D;&#x7684;&#x6240;&#x6709; Lua &#x6807;&#x51C6;&#x5E93;&#x3002;</p>
<p>luaL_optinteger</p>
<p>[-0, +0, v]
lua_Integer luaL_optinteger (lua_State *L,
                             int arg,
                             lua_Integer d);
&#x5982;&#x679C;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A; &#x6574;&#x6570;&#xFF08;&#x6216;&#x53EF;&#x4EE5;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF09;&#xFF0C; &#x8FD4;&#x56DE;&#x8BE5;&#x6574;&#x6570;&#x3002; &#x82E5;&#x8BE5;&#x53C2;&#x6570;&#x4E0D;&#x5B58;&#x5728;&#x6216;&#x662F; nil&#xFF0C; &#x8FD4;&#x56DE; d&#x3002; &#x9664;&#x6B64;&#x4E4B;&#x5916;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>luaL_optlstring</p>
<p>[-0, +0, v]
const char <em>luaL_optlstring (lua_State </em>L,
                             int arg,
                             const char <em>d,
                             size_t </em>l);
&#x5982;&#x679C;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A; &#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x8FD4;&#x56DE;&#x8BE5;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x82E5;&#x8BE5;&#x53C2;&#x6570;&#x4E0D;&#x5B58;&#x5728;&#x6216;&#x662F; nil&#xFF0C; &#x8FD4;&#x56DE; d&#x3002; &#x9664;&#x6B64;&#x4E4B;&#x5916;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x82E5; l &#x4E0D;&#x4E3A; NULL&#xFF0C; &#x5C06;&#x7ED3;&#x679C;&#x7684;&#x957F;&#x5EA6;&#x586B;&#x5165; *l &#x3002;</p>
<p>luaL_optnumber</p>
<p>[-0, +0, v]
lua_Number luaL_optnumber (lua_State *L, int arg, lua_Number d);
&#x5982;&#x679C;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A; &#x6570;&#x5B57;&#xFF0C;&#x8FD4;&#x56DE;&#x8BE5;&#x6570;&#x5B57;&#x3002; &#x82E5;&#x8BE5;&#x53C2;&#x6570;&#x4E0D;&#x5B58;&#x5728;&#x6216;&#x662F; nil&#xFF0C; &#x8FD4;&#x56DE; d&#x3002; &#x9664;&#x6B64;&#x4E4B;&#x5916;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>luaL_optstring</p>
<p>[-0, +0, v]
const char <em>luaL_optstring (lua_State </em>L,
                            int arg,
                            const char *d);
&#x5982;&#x679C;&#x51FD;&#x6570;&#x7684;&#x7B2C; arg &#x4E2A;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A; &#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x8FD4;&#x56DE;&#x8BE5;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x82E5;&#x8BE5;&#x53C2;&#x6570;&#x4E0D;&#x5B58;&#x5728;&#x6216;&#x662F; nil&#xFF0C; &#x8FD4;&#x56DE; d&#x3002; &#x9664;&#x6B64;&#x4E4B;&#x5916;&#x7684;&#x60C5;&#x51B5;&#xFF0C;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>luaL_prepbuffer</p>
<p>[-?, +?, e]
char <em>luaL_prepbuffer (luaL_Buffer </em>B);
&#x7B49;&#x4EF7;&#x4E8E; luaL_prepbuffsize&#xFF0C; &#x5176;&#x9884;&#x5B9A;&#x4E49;&#x5927;&#x5C0F;&#x4E3A; LUAL_BUFFERSIZE&#x3002;</p>
<p>luaL_prepbuffsize</p>
<p>[-?, +?, e]
char <em>luaL_prepbuffsize (luaL_Buffer </em>B, size_t sz);
&#x8FD4;&#x56DE;&#x4E00;&#x6BB5;&#x5927;&#x5C0F;&#x4E3A; sz &#x7684;&#x7A7A;&#x95F4;&#x5730;&#x5740;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x590D;&#x5236;&#x5176;&#x4E2D;&#x4EE5;&#x52A0;&#x5230;&#x7F13;&#x5B58; B &#x5185; &#xFF08;&#x53C2;&#x89C1; luaL_Buffer&#xFF09;&#x3002; &#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x590D;&#x5236;&#x5176;&#x4E2D;&#x540E;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x8C03;&#x7528; luaL_addsize &#x4F20;&#x5165;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x624D;&#x4F1A;&#x771F;&#x6B63;&#x628A;&#x5B83;&#x52A0;&#x5165;&#x7F13;&#x5B58;&#x3002;</p>
<p>luaL_pushresult</p>
<p>[-?, +1, e]
void luaL_pushresult (luaL_Buffer *B);
&#x7ED3;&#x675F;&#x5BF9;&#x7F13;&#x5B58; B &#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x5C06;&#x6700;&#x7EC8;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x7559;&#x5728;&#x6808;&#x9876;&#x3002;</p>
<p>luaL_pushresultsize</p>
<p>[-?, +1, e]
void luaL_pushresultsize (luaL_Buffer *B, size_t sz);
&#x7B49;&#x4EF7;&#x4E8E; luaL_addsize&#xFF0C;luaL_pushresult&#x3002;</p>
<p>luaL_ref</p>
<p>[-1, +0, e]
int luaL_ref (lua_State *L, int t);
&#x9488;&#x5BF9;&#x6808;&#x9876;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x521B;&#x5EFA;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5728;&#x7D22;&#x5F15; t &#x6307;&#x5411;&#x7684;&#x8868;&#x4E2D;&#x7684; &#x5F15;&#x7528; &#xFF08;&#x6700;&#x540E;&#x4F1A;&#x5F39;&#x51FA;&#x6808;&#x9876;&#x5BF9;&#x8C61;&#xFF09;&#x3002;</p>
<p>&#x6B64;&#x5F15;&#x7528;&#x662F;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;&#x6574;&#x6570;&#x952E;&#x3002; &#x53EA;&#x8981;&#x4F60;&#x4E0D;&#x5411;&#x8868; t &#x624B;&#x5DE5;&#x6DFB;&#x52A0;&#x6574;&#x6570;&#x952E;&#xFF0C; luaL_ref &#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x5B83;&#x8FD4;&#x56DE;&#x7684;&#x952E;&#x7684;&#x552F;&#x4E00;&#x6027;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528; lua_rawgeti(L, t, r) &#x6765;&#x627E;&#x56DE;&#x7531; r &#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x3002; &#x51FD;&#x6570; luaL_unref &#x7528;&#x6765;&#x91CA;&#x653E;&#x4E00;&#x4E2A;&#x5F15;&#x7528;&#x5173;&#x8054;&#x7684;&#x5BF9;&#x8C61;</p>
<p>&#x5982;&#x679C;&#x6808;&#x9876;&#x7684;&#x5BF9;&#x8C61;&#x662F; nil&#xFF0C; luaL_ref &#x5C06;&#x8FD4;&#x56DE;&#x5E38;&#x91CF; LUA_REFNIL&#x3002; &#x5E38;&#x91CF; LUA_NOREF &#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x548C; luaL_ref &#x80FD;&#x8FD4;&#x56DE;&#x7684;&#x5176;&#x5B83;&#x5F15;&#x7528;&#x503C;&#x4E0D;&#x540C;&#x3002;</p>
<p>luaL_Reg</p>
<p>typedef struct luaL_Reg {
  const char *name;
  lua_CFunction func;
} luaL_Reg;
&#x7528;&#x4E8E; luaL_setfuncs &#x6CE8;&#x518C;&#x51FD;&#x6570;&#x7684;&#x6570;&#x7EC4;&#x7C7B;&#x578B;&#x3002; name &#x6307;&#x51FD;&#x6570;&#x540D;&#xFF0C;func &#x662F;&#x51FD;&#x6570;&#x6307;&#x9488;&#x3002; &#x4EFB;&#x4F55; luaL_Reg &#x6570;&#x7EC4;&#x5FC5;&#x987B;&#x4EE5;&#x4E00;&#x5BF9; name &#x4E0E; func &#x7686;&#x4E3A; NULL &#x7ED3;&#x675F;&#x3002;</p>
<p>luaL_requiref</p>
<p>[-0, +1, e]
void luaL_requiref (lua_State <em>L, const char </em>modname,
                    lua_CFunction openf, int glb);
&#x5982;&#x679C; modname &#x4E0D;&#x5728; package.loaded &#x4E2D;&#xFF0C; &#x5219;&#x8C03;&#x7528;&#x51FD;&#x6570; openf &#xFF0C;&#x5E76;&#x4F20;&#x5165;&#x5B57;&#x7B26;&#x4E32; modname&#x3002; &#x5C06;&#x5176;&#x8FD4;&#x56DE;&#x503C;&#x7F6E;&#x5165; package.loaded[modname]&#x3002; &#x8FD9;&#x4E2A;&#x884C;&#x4E3A;&#x597D;&#x4F3C;&#x8BE5;&#x51FD;&#x6570;&#x901A;&#x8FC7; require &#x8C03;&#x7528;&#x8FC7;&#x4E00;&#x6837;&#x3002;</p>
<p>&#x5982;&#x679C; glb &#x4E3A;&#x771F;&#xFF0C; &#x540C;&#x65F6;&#x4E5F;&#x8BB2;&#x6A21;&#x5757;&#x8BBE;&#x5230;&#x5168;&#x5C40;&#x53D8;&#x91CF; modname &#x91CC;&#x3002;</p>
<p>&#x5728;&#x6808;&#x4E0A;&#x7559;&#x4E0B;&#x8BE5;&#x6A21;&#x5757;&#x7684;&#x526F;&#x672C;&#x3002;</p>
<p>luaL_setfuncs</p>
<p>[-nup, +0, e]
void luaL_setfuncs (lua_State <em>L, const luaL_Reg </em>l, int nup);
&#x628A;&#x6570;&#x7EC4; l &#x4E2D;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6570; &#xFF08;&#x53C2;&#x89C1; luaL_Reg&#xFF09; &#x6CE8;&#x518C;&#x5230;&#x6808;&#x9876;&#x7684;&#x8868;&#x4E2D;&#xFF08;&#x8BE5;&#x8868;&#x5728;&#x53EF;&#x9009;&#x7684;&#x4E0A;&#x503C;&#x4E4B;&#x4E0B;&#xFF0C;&#x89C1;&#x4E0B;&#x9762;&#x7684;&#x89E3;&#x8BF4;&#xFF09;&#x3002;</p>
<p>&#x82E5; nup &#x4E0D;&#x4E3A;&#x96F6;&#xFF0C; &#x6240;&#x6709;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x5171;&#x4EAB; nup &#x4E2A;&#x4E0A;&#x503C;&#x3002; &#x8FD9;&#x4E9B;&#x503C;&#x5FC5;&#x987B;&#x5728;&#x8C03;&#x7528;&#x4E4B;&#x524D;&#xFF0C;&#x538B;&#x5728;&#x8868;&#x4E4B;&#x4E0A;&#x3002; &#x8FD9;&#x4E9B;&#x503C;&#x5728;&#x6CE8;&#x518C;&#x5B8C;&#x6BD5;&#x540E;&#x90FD;&#x4F1A;&#x4ECE;&#x6808;&#x5F39;&#x51FA;&#x3002;</p>
<p>luaL_setmetatable</p>
<p>[-0, +0, &#x2013;]
void luaL_setmetatable (lua_State <em>L, const char </em>tname);
&#x5C06;&#x6CE8;&#x518C;&#x8868;&#x4E2D; tname &#x5173;&#x8054;&#x5143;&#x8868; &#xFF08;&#x53C2;&#x89C1; luaL_newmetatable&#xFF09; &#x8BBE;&#x4E3A;&#x6808;&#x9876;&#x5BF9;&#x8C61;&#x7684;&#x5143;&#x8868;&#x3002;</p>
<p>luaL_Stream</p>
<p>typedef struct luaL_Stream {
  FILE *f;
  lua_CFunction closef;
} luaL_Stream;
&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x5E93;&#x4E2D;&#x7528;&#x5230;&#x7684;&#x6807;&#x51C6;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x7ED3;&#x6784;&#x3002;</p>
<p>&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x5B9E;&#x73B0;&#x4E3A;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C; &#x5176;&#x5143;&#x8868;&#x88AB;&#x79F0;&#x4E3A; LUA_FILEHANDLE &#xFF08;LUA_FILEHANDLE &#x662F;&#x4E00;&#x4E2A;&#x4EE3;&#x8868;&#x771F;&#x6B63;&#x5143;&#x8868;&#x7684;&#x540D;&#x5B57;&#x7684;&#x5B8F;&#xFF09;&#x3002; &#x8FD9;&#x5F20;&#x5143;&#x8868;&#x7531;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x5E93;&#xFF08;&#x53C2;&#x89C1; luaL_newmetatable&#xFF09;&#x521B;&#x5EFA;&#x3002;</p>
<p>&#x7528;&#x6237;&#x6570;&#x636E;&#x5FC5;&#x987B;&#x4EE5;&#x7ED3;&#x6784; luaL_Stream &#x5F00;&#x5934;&#xFF1B; &#x6B64;&#x7ED3;&#x6784;&#x5176;&#x540E;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x4EFB;&#x4F55;&#x5176;&#x5B83;&#x6570;&#x636E;&#x3002; f &#x57DF;&#x6307;&#x5411;&#x4E00;&#x4E2A; C &#x6570;&#x636E;&#x6D41; &#xFF08;&#x5982;&#x679C;&#x5B83;&#x4E3A; NULL &#x8868;&#x793A;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x521B;&#x5EFA;&#x597D;&#x7684;&#x53E5;&#x67C4;&#xFF09;&#x3002; closef &#x57DF;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x5728;&#x5173;&#x95ED;&#x6216;&#x56DE;&#x6536;&#x8BE5;&#x6D41;&#x65F6;&#x9700;&#x8981;&#x8C03;&#x7528;&#x7684; Lua &#x51FD;&#x6570;&#x3002; &#x8BE5;&#x51FD;&#x6570;&#x5C06;&#x6536;&#x5230;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5373;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x3002; &#x5B83;&#x9700;&#x8981;&#x8FD4;&#x56DE; true&#xFF08;&#x64CD;&#x4F5C;&#x6210;&#x529F;&#xFF09;&#x6216; nil &#x52A0;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#xFF08;&#x51FA;&#x9519;&#x7684;&#x65F6;&#x5019;&#xFF09;&#x3002; &#x4E00;&#x65E6; Lua &#x8C03;&#x7528;&#x8FC7;&#x8FD9;&#x4E2A;&#x57DF;&#xFF0C;&#x8BE5;&#x57DF;&#x7684;&#x503C;&#x5C31;&#x4F1A;&#x4FEE;&#x6539;&#x4E3A; NULL &#x4EE5;&#x63D0;&#x793A;&#x8FD9;&#x4E2A;&#x53E5;&#x67C4;&#x5DF2;&#x7ECF;&#x88AB;&#x5173;&#x95ED;&#x4E86;&#x3002;</p>
<p>luaL_testudata</p>
<p>[-0, +0, e]
void <em>luaL_testudata (lua_State </em>L, int arg, const char *tname);
&#x6B64;&#x51FD;&#x6570;&#x548C; luaL_checkudata &#x7C7B;&#x4F3C;&#x3002; &#x4F46;&#x5B83;&#x5728;&#x6D4B;&#x8BD5;&#x5931;&#x8D25;&#x65F6;&#x4F1A;&#x8FD4;&#x56DE; NULL &#x800C;&#x4E0D;&#x662F;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>luaL_tolstring</p>
<p>[-0, +1, e]
const char <em>luaL_tolstring (lua_State </em>L, int idx, size_t <em>len);
&#x5C06;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7684; Lua &#x503C;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x76F8;&#x5E94;&#x683C;&#x5F0F;&#x7684; C &#x5B57;&#x7B26;&#x4E32;&#x3002; &#x7ED3;&#x679C;&#x4E32;&#x4E0D;&#x4EC5;&#x4F1A;&#x538B;&#x6808;&#xFF0C;&#x8FD8;&#x4F1A;&#x7531;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x3002; &#x5982;&#x679C; len &#x4E0D;&#x4E3A; NULL &#xFF0C; &#x5B83;&#x8FD8;&#x628A;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x8BBE;&#x5230; </em>len &#x4E2D;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8BE5;&#x503C;&#x6709;&#x4E00;&#x4E2A;&#x5E26; &quot;__tostring&quot; &#x57DF;&#x7684;&#x5143;&#x8868;&#xFF0C; luaL_tolstring &#x4F1A;&#x4EE5;&#x8BE5;&#x503C;&#x4E3A;&#x53C2;&#x6570;&#x53BB;&#x8C03;&#x7528;&#x5BF9;&#x5E94;&#x7684;&#x5143;&#x65B9;&#x6CD5;&#xFF0C; &#x5E76;&#x5C06;&#x5176;&#x8FD4;&#x56DE;&#x503C;&#x4F5C;&#x4E3A;&#x7ED3;&#x679C;&#x3002;</p>
<p>luaL_traceback</p>
<p>[-0, +1, e]
void luaL_traceback (lua_State <em>L, lua_State </em>L1, const char *msg,
                     int level);
&#x5C06;&#x6808; L1 &#x7684;&#x6808;&#x56DE;&#x6EAF;&#x4FE1;&#x606F;&#x538B;&#x6808;&#x3002; &#x5982;&#x679C; msg &#x4E0D;&#x4E3A; NULL &#xFF0C;&#x5B83;&#x4F1A;&#x9644;&#x52A0;&#x5230;&#x6808;&#x56DE;&#x6EAF;&#x4FE1;&#x606F;&#x4E4B;&#x524D;&#x3002; level &#x53C2;&#x6570;&#x6307;&#x660E;&#x4ECE;&#x7B2C;&#x51E0;&#x5C42;&#x5F00;&#x59CB;&#x505A;&#x6808;&#x56DE;&#x6EAF;&#x3002;</p>
<p>luaL_typename</p>
<p>[-0, +0, &#x2013;]
const char <em>luaL_typename (lua_State </em>L, int index);
&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x503C;&#x7684;&#x7C7B;&#x578B;&#x540D;&#x3002;</p>
<p>luaL_unref</p>
<p>[-0, +0, &#x2013;]
void luaL_unref (lua_State *L, int t, int ref);
&#x91CA;&#x653E;&#x7D22;&#x5F15; t &#x5904;&#x8868;&#x7684; ref &#x5F15;&#x7528;&#x5BF9;&#x8C61; &#xFF08;&#x53C2;&#x89C1; luaL_ref &#xFF09;&#x3002; &#x6B64;&#x6761;&#x76EE;&#x4F1A;&#x4ECE;&#x8868;&#x4E2D;&#x79FB;&#x9664;&#x4EE5;&#x8BA9;&#x5176;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#x53EF;&#x88AB;&#x5783;&#x573E;&#x6536;&#x96C6;&#x3002; &#x800C;&#x5F15;&#x7528; ref &#x4E5F;&#x88AB;&#x56DE;&#x6536;&#x518D;&#x6B21;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x5982;&#x679C; ref &#x4E3A; LUA_NOREF &#x6216; LUA_REFNIL&#xFF0C; luaL_unref &#x4EC0;&#x4E48;&#x4E5F;&#x4E0D;&#x505A;&#x3002;</p>
<p>luaL_where</p>
<p>[-0, +1, e]
void luaL_where (lua_State *L, int lvl);
&#x5C06;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x8868;&#x793A; lvl &#x5C42;&#x6808;&#x7684;&#x63A7;&#x5236;&#x70B9;&#x4F4D;&#x7F6E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x538B;&#x6808;&#x3002; &#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x9075;&#x5FAA;&#x4E0B;&#x9762;&#x7684;&#x683C;&#x5F0F;&#xFF1A;</p>
<pre><code> chunkname:currentline:
</code></pre><p>0 &#x5C42;&#x6307;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x51FD;&#x6570;&#xFF0C; 1 &#x5C42;&#x6307;&#x8C03;&#x7528;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x51FD;&#x6570;&#x7684;&#x51FD;&#x6570;&#xFF0C; &#x4F9D;&#x6B21;&#x7C7B;&#x63A8;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x7684;&#x524D;&#x7F00;&#x3002;</p>
<h1 id="&#x6807;&#x51C6;&#x5E93;">&#x6807;&#x51C6;&#x5E93; <a href="#&#x6807;&#x51C6;&#x5E93;"> # </a></h1>
<p>&#x6807;&#x51C6;&#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x6709;&#x7528;&#x7684;&#x51FD;&#x6570;, &#x5B83;&#x4EEC;&#x90FD;&#x662F;&#x76F4;&#x63A5;&#x7528; C API &#x5B9E;&#x73B0;&#x7684;&#x3002; &#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x63D0;&#x4F9B;&#x4E86;&#x539F;&#x672C;&#x8BED;&#x8A00;&#x5C31;&#x6709;&#x7684;&#x670D;&#x52A1; &#xFF08;&#x4F8B;&#x5982;&#xFF0C;type &#x4E0E; getmetatable&#xFF09;&#xFF1B; &#x53E6;&#x4E00;&#x4E9B;&#x63D0;&#x4F9B;&#x548C;&#x201C;&#x5916;&#x90E8;&#x201D;&#x6253;&#x4EA4;&#x9053;&#x7684;&#x670D;&#x52A1;&#xFF08;&#x4F8B;&#x5982; I/O &#xFF09;&#xFF1B; &#x8FD8;&#x6709;&#x4E9B;&#x672C;&#x53EF;&#x4EE5;&#x7528; Lua &#x672C;&#x8EAB;&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x4F46;&#x5728; C &#x4E2D;&#x5B9E;&#x73B0;&#x53EF;&#x4EE5;&#x6EE1;&#x8DB3;&#x5173;&#x952E;&#x70B9;&#x4E0A;&#x7684;&#x6027;&#x80FD;&#x9700;&#x6C42; &#xFF08;&#x4F8B;&#x5982; table.sort&#xFF09;&#x3002;</p>
<p>&#x6240;&#x6709;&#x7684;&#x5E93;&#x90FD;&#x662F;&#x76F4;&#x63A5;&#x7528; C API &#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5E76;&#x4EE5;&#x5206;&#x79BB;&#x7684; C &#x6A21;&#x5757;&#x5F62;&#x5F0F;&#x63D0;&#x4F9B;&#x3002; &#x76EE;&#x524D;&#xFF0C;Lua &#x6709;&#x4E0B;&#x5217;&#x6807;&#x51C6;&#x5E93;&#xFF1A;</p>
<p>&#x57FA;&#x7840;&#x5E93; (&#xA7;6.1);
&#x534F;&#x7A0B;&#x5E93; (&#xA7;6.2);
&#x5305;&#x7BA1;&#x7406;&#x5E93; (&#xA7;6.3);
&#x5B57;&#x7B26;&#x4E32;&#x63A7;&#x5236; (&#xA7;6.4);
&#x57FA;&#x7840; UTF-8 &#x652F;&#x6301; (&#xA7;6.5);
&#x8868;&#x63A7;&#x5236; (&#xA7;6.6);
&#x6570;&#x5B66;&#x51FD;&#x6570; (&#xA7;6.7) (sin &#xFF0C;log &#x7B49;);
&#x8F93;&#x5165;&#x8F93;&#x51FA; (&#xA7;6.8);
&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5E93; (&#xA7;6.9);
&#x8C03;&#x8BD5;&#x5E93; (&#xA7;6.10).
&#x9664;&#x4E86;&#x57FA;&#x7840;&#x5E93;&#x548C;&#x5305;&#x7BA1;&#x7406;&#x5E93;&#xFF0C; &#x5176;&#x5B83;&#x5E93;&#x90FD;&#x628A;&#x81EA;&#x5DF1;&#x7684;&#x51FD;&#x6570;&#x653E;&#x5728;&#x4E00;&#x5F20;&#x5168;&#x5C40;&#x8868;&#x7684;&#x57DF;&#x4E2D;&#xFF0C; &#x6216;&#x662F;&#x4EE5;&#x5BF9;&#x8C61;&#x65B9;&#x6CD5;&#x7684;&#x5F62;&#x5F0F;&#x63D0;&#x4F9B;&#x3002;</p>
<p>&#x8981;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x5E93;&#xFF0C; C &#x7684;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x5148;&#x8C03;&#x7528;&#x4E00;&#x4E0B; luaL_openlibs &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C; &#x8FD9;&#x6837;&#x5C31;&#x80FD;&#x6253;&#x5F00;&#x6240;&#x6709;&#x7684;&#x6807;&#x51C6;&#x5E93;&#x3002; &#x6216;&#x8005;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x4E5F;&#x53EF;&#x4EE5;&#x7528; luaL_requiref &#x5206;&#x522B;&#x6253;&#x5F00;&#x8FD9;&#x4E9B;&#x5E93;&#xFF1A; luaopen_base &#xFF08;&#x57FA;&#x7840;&#x5E93;&#xFF09;&#xFF0C; luaopen_package &#xFF08;&#x5305;&#x7BA1;&#x7406;&#x5E93;&#xFF09;&#xFF0C; luaopen_coroutine &#xFF08;&#x534F;&#x7A0B;&#x5E93;&#xFF09;&#xFF0C; luaopen_string &#xFF08;&#x5B57;&#x7B26;&#x4E32;&#x5E93;&#xFF09;&#xFF0C; luaopen_utf8 &#xFF08;UTF8 &#x5E93;&#xFF09;&#xFF0C; luaopen_table &#xFF08;&#x8868;&#x5904;&#x7406;&#x5E93;&#xFF09;&#xFF0C; luaopen_math &#xFF08;&#x6570;&#x5B66;&#x5E93;&#xFF09;&#xFF0C; luaopen_io &#xFF08;I/O &#x5E93;&#xFF09;&#xFF0C; luaopen_os &#xFF08;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5E93;&#xFF09;&#xFF0C; luaopen_debug &#xFF08;&#x8C03;&#x8BD5;&#x5E93;&#xFF09;&#x3002; &#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x90FD;&#x5B9A;&#x4E49;&#x5728; lualib.h &#x4E2D;&#x3002;</p>
<h2 id="&#x57FA;&#x7840;&#x51FD;&#x6570;">&#x57FA;&#x7840;&#x51FD;&#x6570; <a href="#&#x57FA;&#x7840;&#x51FD;&#x6570;"> # </a></h2>
<p>&#x57FA;&#x7840;&#x5E93;&#x63D0;&#x4F9B;&#x4E86; Lua &#x6838;&#x5FC3;&#x51FD;&#x6570;&#x3002; &#x5982;&#x679C;&#x4F60;&#x4E0D;&#x5C06;&#x8FD9;&#x4E2A;&#x5E93;&#x5305;&#x542B;&#x5728;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C; &#x4F60;&#x5C31;&#x9700;&#x8981;&#x5C0F;&#x5FC3;&#x68C0;&#x67E5;&#x7A0B;&#x5E8F;&#x662F;&#x5426;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x63D0;&#x4F9B;&#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x7279;&#x6027;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<p>assert (v [, message])</p>
<p>&#x5982;&#x679C;&#x5176;&#x53C2;&#x6570; v &#x7684;&#x503C;&#x4E3A;&#x5047;&#xFF08;nil &#x6216; false&#xFF09;&#xFF0C; &#x5B83;&#x5C31;&#x8C03;&#x7528; error&#xFF1B; &#x5426;&#x5219;&#xFF0C;&#x8FD4;&#x56DE;&#x6240;&#x6709;&#x7684;&#x53C2;&#x6570;&#x3002; &#x5728;&#x9519;&#x8BEF;&#x60C5;&#x51B5;&#x65F6;&#xFF0C; message &#x6307;&#x90A3;&#x4E2A;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#xFF1B; &#x5982;&#x679C;&#x4E0D;&#x63D0;&#x4F9B;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x53C2;&#x6570;&#x9ED8;&#x8BA4;&#x4E3A; &quot;assertion failed!&quot; &#x3002;</p>
<p>collectgarbage ([opt [, arg]])</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x662F;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x7684;&#x901A;&#x7528;&#x63A5;&#x53E3;&#x3002; &#x901A;&#x8FC7;&#x53C2;&#x6570; opt &#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x7EC4;&#x4E0D;&#x540C;&#x7684;&#x529F;&#x80FD;&#xFF1A;</p>
<p>&quot;collect&quot;: &#x505A;&#x4E00;&#x6B21;&#x5B8C;&#x6574;&#x7684;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5FAA;&#x73AF;&#x3002; &#x8FD9;&#x662F;&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x3002;
&quot;stop&quot;: &#x505C;&#x6B62;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x7684;&#x8FD0;&#x884C;&#x3002; &#x5728;&#x8C03;&#x7528;&#x91CD;&#x542F;&#x524D;&#xFF0C;&#x6536;&#x96C6;&#x5668;&#x53EA;&#x4F1A;&#x56E0;&#x663E;&#x5F0F;&#x7684;&#x8C03;&#x7528;&#x8FD0;&#x884C;&#x3002;
&quot;restart&quot;: &#x91CD;&#x542F;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x7684;&#x81EA;&#x52A8;&#x8FD0;&#x884C;&#x3002;
&quot;count&quot;: &#x4EE5; K &#x5B57;&#x8282;&#x6570;&#x4E3A;&#x5355;&#x4F4D;&#x8FD4;&#x56DE; Lua &#x4F7F;&#x7528;&#x7684;&#x603B;&#x5185;&#x5B58;&#x6570;&#x3002; &#x8FD9;&#x4E2A;&#x503C;&#x6709;&#x5C0F;&#x6570;&#x90E8;&#x5206;&#xFF0C;&#x6240;&#x4EE5;&#x53EA;&#x9700;&#x8981;&#x4E58;&#x4E0A; 1024 &#x5C31;&#x80FD;&#x5F97;&#x5230; Lua &#x4F7F;&#x7528;&#x7684;&#x51C6;&#x786E;&#x5B57;&#x8282;&#x6570;&#xFF08;&#x9664;&#x975E;&#x6EA2;&#x51FA;&#xFF09;&#x3002;
&quot;step&quot;: &#x5355;&#x6B65;&#x8FD0;&#x884C;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x3002; &#x6B65;&#x957F;&#x201C;&#x5927;&#x5C0F;&#x201D;&#x7531; arg &#x63A7;&#x5236;&#x3002; &#x4F20;&#x5165; 0 &#x65F6;&#xFF0C;&#x6536;&#x96C6;&#x5668;&#x6B65;&#x8FDB;&#xFF08;&#x4E0D;&#x53EF;&#x5206;&#x5272;&#x7684;&#xFF09;&#x4E00;&#x6B65;&#x3002; &#x4F20;&#x5165;&#x975E; 0 &#x503C;&#xFF0C; &#x6536;&#x96C6;&#x5668;&#x6536;&#x96C6;&#x76F8;&#x5F53;&#x4E8E; Lua &#x5206;&#x914D;&#x8FD9;&#x4E9B;&#x591A;&#xFF08;K &#x5B57;&#x8282;&#xFF09;&#x5185;&#x5B58;&#x7684;&#x5DE5;&#x4F5C;&#x3002; &#x5982;&#x679C;&#x6536;&#x96C6;&#x5668;&#x7ED3;&#x675F;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x5C06;&#x8FD4;&#x56DE; true &#x3002;
&quot;setpause&quot;: &#x5C06; arg &#x8BBE;&#x4E3A;&#x6536;&#x96C6;&#x5668;&#x7684; &#x95F4;&#x6B47;&#x7387; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.5&#xFF09;&#x3002; &#x8FD4;&#x56DE; &#x95F4;&#x6B47;&#x7387; &#x7684;&#x524D;&#x4E00;&#x4E2A;&#x503C;&#x3002;
&quot;setstepmul&quot;: &#x5C06; arg &#x8BBE;&#x4E3A;&#x6536;&#x96C6;&#x5668;&#x7684; &#x6B65;&#x8FDB;&#x500D;&#x7387; &#xFF08;&#x53C2;&#x89C1; &#xA7;2.5&#xFF09;&#x3002; &#x8FD4;&#x56DE; &#x6B65;&#x8FDB;&#x500D;&#x7387; &#x7684;&#x524D;&#x4E00;&#x4E2A;&#x503C;&#x3002;
&quot;isrunning&quot;: &#x8FD4;&#x56DE;&#x8868;&#x793A;&#x6536;&#x96C6;&#x5668;&#x662F;&#x5426;&#x5728;&#x5DE5;&#x4F5C;&#x7684;&#x5E03;&#x5C14;&#x503C; &#xFF08;&#x5373;&#x672A;&#x88AB;&#x505C;&#x6B62;&#xFF09;&#x3002;
dofile ([filename])</p>
<p>&#x6253;&#x5F00;&#x8BE5;&#x540D;&#x5B57;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x4E2D;&#x7684; Lua &#x4EE3;&#x7801;&#x5757;&#x3002; &#x4E0D;&#x5E26;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x65F6;&#xFF0C; dofile &#x6267;&#x884C;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x7684;&#x5185;&#x5BB9;&#xFF08;stdin&#xFF09;&#x3002; &#x8FD4;&#x56DE;&#x8BE5;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#x3002; &#x5BF9;&#x4E8E;&#x6709;&#x9519;&#x8BEF;&#x7684;&#x60C5;&#x51B5;&#xFF0C;dofile &#x5C06;&#x9519;&#x8BEF;&#x53CD;&#x9988;&#x7ED9;&#x8C03;&#x7528;&#x8005; &#xFF08;&#x5373;&#xFF0C;dofile &#x6CA1;&#x6709;&#x8FD0;&#x884C;&#x5728;&#x4FDD;&#x62A4;&#x6A21;&#x5F0F;&#x4E0B;&#xFF09;&#x3002;
error (message [, level])</p>
<p>&#x4E2D;&#x6B62;&#x4E0A;&#x4E00;&#x6B21;&#x4FDD;&#x62A4;&#x51FD;&#x6570;&#x8C03;&#x7528;&#xFF0C; &#x5C06;&#x9519;&#x8BEF;&#x5BF9;&#x8C61; message &#x8FD4;&#x56DE;&#x3002; &#x51FD;&#x6570; error &#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;&#x3002;
&#x5F53; message &#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;&#x901A;&#x5E38; error &#x4F1A;&#x628A;&#x4E00;&#x4E9B;&#x6709;&#x5173;&#x51FA;&#x9519;&#x4F4D;&#x7F6E;&#x7684;&#x4FE1;&#x606F;&#x9644;&#x52A0;&#x5728;&#x6D88;&#x606F;&#x7684;&#x524D;&#x5934;&#x3002; level &#x53C2;&#x6570;&#x6307;&#x660E;&#x4E86;&#x600E;&#x6837;&#x83B7;&#x5F97;&#x51FA;&#x9519;&#x4F4D;&#x7F6E;&#x3002; &#x5BF9;&#x4E8E; level 1 &#xFF08;&#x9ED8;&#x8BA4;&#x503C;&#xFF09;&#xFF0C;&#x51FA;&#x9519;&#x4F4D;&#x7F6E;&#x6307; error &#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x4F4D;&#x7F6E;&#x3002; Level 2 &#x5C06;&#x51FA;&#x9519;&#x4F4D;&#x7F6E;&#x6307;&#x5411;&#x8C03;&#x7528; error&#x7684;&#x51FD;&#x6570;&#x7684;&#x51FD;&#x6570;&#xFF1B;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002; &#x4F20;&#x5165; level 0 &#x53EF;&#x4EE5;&#x907F;&#x514D;&#x5728;&#x6D88;&#x606F;&#x524D;&#x6DFB;&#x52A0;&#x51FA;&#x9519;&#x4F4D;&#x7F6E;&#x4FE1;&#x606F;&#x3002;</p>
<p>_G</p>
<p>&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF08;&#x975E;&#x51FD;&#x6570;&#xFF09;&#xFF0C; &#x5185;&#x90E8;&#x50A8;&#x5B58;&#x6709;&#x5168;&#x5C40;&#x73AF;&#x5883;&#xFF08;&#x53C2;&#x89C1; &#xA7;2.2&#xFF09;&#x3002; Lua &#x81EA;&#x5DF1;&#x4E0D;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#xFF1B; &#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x4E0D;&#x4F1A;&#x5BF9;&#x4EFB;&#x4F55;&#x73AF;&#x5883;&#x9020;&#x6210;&#x5F71;&#x54CD;&#xFF0C;&#x53CD;&#x4E4B;&#x4EA6;&#x7136;&#x3002;
getmetatable (object)</p>
<p>&#x5982;&#x679C; object &#x4E0D;&#x5305;&#x542B;&#x5143;&#x8868;&#xFF0C;&#x8FD4;&#x56DE; nil &#x3002; &#x5426;&#x5219;&#xFF0C;&#x5982;&#x679C;&#x5728;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x5143;&#x8868;&#x4E2D;&#x6709; &quot;__metatable&quot; &#x57DF;&#x65F6;&#x8FD4;&#x56DE;&#x5176;&#x5173;&#x8054;&#x503C;&#xFF0C; &#x6CA1;&#x6709;&#x65F6;&#x8FD4;&#x56DE;&#x8BE5;&#x5BF9;&#x8C61;&#x7684;&#x5143;&#x8868;&#x3002;</p>
<p>ipairs (t)</p>
<p>&#x8FD4;&#x56DE;&#x4E09;&#x4E2A;&#x503C;&#xFF08;&#x8FED;&#x4EE3;&#x51FD;&#x6570;&#x3001;&#x8868; t &#x4EE5;&#x53CA; 0 &#xFF09;&#xFF0C; &#x5982;&#x6B64;&#xFF0C;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;</p>
<pre><code> for i,v in ipairs(t) do body end
</code></pre><p>&#x5C06;&#x8FED;&#x4EE3;&#x952E;&#x503C;&#x5BF9;&#xFF08;1,t[1]) &#xFF0C;(2,t[2])&#xFF0C; ... &#xFF0C;&#x76F4;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;&#x7A7A;&#x503C;&#x3002;</p>
<p>load (chunk [, chunkname [, mode [, env]]])</p>
<p>&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x3002;</p>
<p>&#x5982;&#x679C; chunk &#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4EE3;&#x7801;&#x5757;&#x6307;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5982;&#x679C; chunk &#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C; load &#x4E0D;&#x65AD;&#x5730;&#x8C03;&#x7528;&#x5B83;&#x83B7;&#x53D6;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x7247;&#x65AD;&#x3002; &#x6BCF;&#x6B21;&#x5BF9; chunk &#x7684;&#x8C03;&#x7528;&#x90FD;&#x5FC5;&#x987B;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7D27;&#x7D27;&#x8FDE;&#x63A5;&#x5728;&#x4E0A;&#x6B21;&#x8C03;&#x7528;&#x7684;&#x8FD4;&#x56DE;&#x4E32;&#x4E4B;&#x540E;&#x3002; &#x5F53;&#x8FD4;&#x56DE;&#x7A7A;&#x4E32;&#x3001;nil&#x3001;&#x6216;&#x662F;&#x4E0D;&#x8FD4;&#x56DE;&#x503C;&#x65F6;&#xFF0C;&#x90FD;&#x8868;&#x793A;&#x4EE3;&#x7801;&#x5757;&#x7ED3;&#x675F;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8BED;&#x6CD5;&#x9519;&#x8BEF;&#xFF0C; &#x5219;&#x4EE5;&#x51FD;&#x6570;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE;&#x7F16;&#x8BD1;&#x597D;&#x7684;&#x4EE3;&#x7801;&#x5757;&#xFF1B; &#x5426;&#x5219;&#xFF0C;&#x8FD4;&#x56DE; nil &#x52A0;&#x4E0A;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;</p>
<p>&#x5982;&#x679C;&#x7ED3;&#x679C;&#x51FD;&#x6570;&#x6709;&#x4E0A;&#x503C;&#xFF0C; env &#x88AB;&#x8BBE;&#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x4E0A;&#x503C;&#x3002; &#x82E5;&#x4E0D;&#x63D0;&#x4F9B;&#x6B64;&#x53C2;&#x6570;&#xFF0C;&#x5C06;&#x5168;&#x5C40;&#x73AF;&#x5883;&#x66FF;&#x4EE3;&#x5B83;&#x3002; &#x6240;&#x6709;&#x5176;&#x5B83;&#x4E0A;&#x503C;&#x521D;&#x59CB;&#x5316;&#x4E3A; nil&#x3002; &#xFF08;&#x5F53;&#x4F60;&#x52A0;&#x8F7D;&#x4E3B;&#x4EE3;&#x7801;&#x5757;&#x65F6;&#x5019;&#xFF0C;&#x7ED3;&#x679C;&#x51FD;&#x6570;&#x4E00;&#x5B9A;&#x6709;&#x4E14;&#x4EC5;&#x6709;&#x4E00;&#x4E2A;&#x4E0A;&#x503C; _ENV &#xFF08;&#x53C2;&#x89C1; &#xA7;2.2&#xFF09;&#xFF09;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x7528;&#x51FD;&#x6570;&#xFF08;&#x53C2;&#x89C1; string.dump&#xFF0C; &#x7ED3;&#x679C;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x6709;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x4E0A;&#x503C;&#xFF09; &#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x4EE3;&#x7801;&#x5757;&#x65F6;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x4E0A;&#x503C;&#x90FD;&#x662F;&#x65B0;&#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x3002; &#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x5B83;&#x4EEC;&#x4E0D;&#x4F1A;&#x548C;&#x522B;&#x7684;&#x4EFB;&#x4F55;&#x51FD;&#x6570;&#x5171;&#x4EAB;&#x3002;</p>
<p>chunkname &#x5728;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x548C;&#x8C03;&#x8BD5;&#x6D88;&#x606F;&#x4E2D;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.9&#xFF09;&#xFF0C;&#x7528;&#x4E8E;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x540D;&#x5B57;&#x3002; &#x5982;&#x679C;&#x4E0D;&#x63D0;&#x4F9B;&#x6B64;&#x53C2;&#x6570;&#xFF0C;&#x5B83;&#x9ED8;&#x8BA4;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;chunk &#x3002; chunk &#x4E0D;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x65F6;&#xFF0C;&#x5219;&#x4E3A; &quot;=(load)&quot; &#x3002;</p>
<p>&#x5B57;&#x7B26;&#x4E32; mode &#x7528;&#x4E8E;&#x63A7;&#x5236;&#x4EE3;&#x7801;&#x5757;&#x662F;&#x6587;&#x672C;&#x8FD8;&#x662F;&#x4E8C;&#x8FDB;&#x5236;&#xFF08;&#x5373;&#x9884;&#x7F16;&#x8BD1;&#x4EE3;&#x7801;&#x5757;&#xFF09;&#x3002; &#x5B83;&#x53EF;&#x4EE5;&#x662F;&#x5B57;&#x7B26;&#x4E32; &quot;b&quot; &#xFF08;&#x53EA;&#x80FD;&#x662F;&#x4E8C;&#x8FDB;&#x5236;&#x4EE3;&#x7801;&#x5757;&#xFF09;&#xFF0C; &quot;t&quot; &#xFF08;&#x53EA;&#x80FD;&#x662F;&#x6587;&#x672C;&#x4EE3;&#x7801;&#x5757;&#xFF09;&#xFF0C; &#x6216; &quot;bt&quot; &#xFF08;&#x53EF;&#x4EE5;&#x662F;&#x4E8C;&#x8FDB;&#x5236;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x6587;&#x672C;&#xFF09;&#x3002; &#x9ED8;&#x8BA4;&#x503C;&#x4E3A; &quot;bt&quot;&#x3002;</p>
<p>Lua &#x4E0D;&#x4F1A;&#x5BF9;&#x4E8C;&#x8FDB;&#x5236;&#x4EE3;&#x7801;&#x5757;&#x505A;&#x5065;&#x58EE;&#x6027;&#x68C0;&#x67E5;&#x3002; &#x6076;&#x610F;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x4E8C;&#x8FDB;&#x5236;&#x5757;&#x6709;&#x53EF;&#x80FD;&#x628A;&#x89E3;&#x91CA;&#x5668;&#x5F04;&#x5D29;&#x6E83;&#x3002;</p>
<p>loadfile ([filename [, mode [, env]]])</p>
<p>&#x548C; load &#x7C7B;&#x4F3C;&#xFF0C; &#x4E0D;&#x8FC7;&#x662F;&#x4ECE;&#x6587;&#x4EF6; filename &#x6216;&#x6807;&#x51C6;&#x8F93;&#x5165;&#xFF08;&#x5982;&#x679C;&#x6587;&#x4EF6;&#x540D;&#x672A;&#x63D0;&#x4F9B;&#xFF09;&#x4E2D;&#x83B7;&#x53D6;&#x4EE3;&#x7801;&#x5757;&#x3002;</p>
<p>next (table [, index])</p>
<p>&#x8FD0;&#x884C;&#x7A0B;&#x5E8F;&#x6765;&#x904D;&#x5386;&#x8868;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x57DF;&#x3002; &#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x8981;&#x904D;&#x5386;&#x7684;&#x8868;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x8868;&#x4E2D;&#x7684;&#x67D0;&#x4E2A;&#x952E;&#x3002; next &#x8FD4;&#x56DE;&#x8BE5;&#x952E;&#x7684;&#x4E0B;&#x4E00;&#x4E2A;&#x952E;&#x53CA;&#x5176;&#x5173;&#x8054;&#x7684;&#x503C;&#x3002; &#x5982;&#x679C;&#x7528; nil &#x4F5C;&#x4E3A;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x8C03;&#x7528; next &#x5C06;&#x8FD4;&#x56DE;&#x521D;&#x59CB;&#x952E;&#x53CA;&#x5176;&#x5173;&#x8054;&#x503C;&#x3002; &#x5F53;&#x4EE5;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x952E;&#x53BB;&#x8C03;&#x7528;&#xFF0C;&#x6216;&#x662F;&#x4EE5; nil &#x8C03;&#x7528;&#x4E00;&#x5F20;&#x7A7A;&#x8868;&#x65F6;&#xFF0C; next &#x8FD4;&#x56DE; nil&#x3002; &#x5982;&#x679C;&#x4E0D;&#x63D0;&#x4F9B;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x5C06;&#x8BA4;&#x4E3A;&#x5B83;&#x5C31;&#x662F; nil&#x3002; &#x7279;&#x522B;&#x6307;&#x51FA;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7528; next(t) &#x6765;&#x5224;&#x65AD;&#x4E00;&#x5F20;&#x8868;&#x662F;&#x5426;&#x662F;&#x7A7A;&#x7684;&#x3002;</p>
<p>&#x7D22;&#x5F15;&#x5728;&#x904D;&#x5386;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x6B21;&#x5E8F;&#x65E0;&#x5B9A;&#x4E49;&#xFF0C; &#x5373;&#x4F7F;&#x662F;&#x6570;&#x5B57;&#x7D22;&#x5F15;&#x4E5F;&#x662F;&#x8FD9;&#x6837;&#x3002; &#xFF08;&#x5982;&#x679C;&#x60F3;&#x6309;&#x6570;&#x5B57;&#x6B21;&#x5E8F;&#x904D;&#x5386;&#x8868;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6570;&#x5B57;&#x5F62;&#x5F0F;&#x7684; for &#x3002;&#xFF09;</p>
<p>&#x5F53;&#x5728;&#x904D;&#x5386;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F60;&#x7ED9;&#x8868;&#x4E2D;&#x5E76;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x57DF;&#x8D4B;&#x503C;&#xFF0C; next &#x7684;&#x884C;&#x4E3A;&#x662F;&#x672A;&#x5B9A;&#x4E49;&#x7684;&#x3002; &#x7136;&#x800C;&#x4F60;&#x53EF;&#x4EE5;&#x53BB;&#x4FEE;&#x6539;&#x90A3;&#x4E9B;&#x5DF2;&#x5B58;&#x5728;&#x7684;&#x57DF;&#x3002; &#x7279;&#x522B;&#x6307;&#x51FA;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x6E05;&#x9664;&#x4E00;&#x4E9B;&#x5DF2;&#x5B58;&#x5728;&#x7684;&#x57DF;&#x3002;</p>
<p>pairs (t)</p>
<p>&#x5982;&#x679C; t &#x6709;&#x5143;&#x65B9;&#x6CD5; __pairs&#xFF0C; &#x4EE5; t &#x4E3A;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x5B83;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x5176;&#x8FD4;&#x56DE;&#x7684;&#x524D;&#x4E09;&#x4E2A;&#x503C;&#x3002;</p>
<p>&#x5426;&#x5219;&#xFF0C;&#x8FD4;&#x56DE;&#x4E09;&#x4E2A;&#x503C;&#xFF1A;next &#x51FD;&#x6570;&#xFF0C; &#x8868; t&#xFF0C;&#x4EE5;&#x53CA; nil&#x3002; &#x56E0;&#x6B64;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;</p>
<pre><code> for k,v in pairs(t) do body end
</code></pre><p>&#x80FD;&#x8FED;&#x4EE3;&#x8868; t &#x4E2D;&#x7684;&#x6240;&#x6709;&#x952E;&#x503C;&#x5BF9;&#x3002;</p>
<p>&#x53C2;&#x89C1;&#x51FD;&#x6570; next &#x4E2D;&#x5173;&#x4E8E;&#x8FED;&#x4EE3;&#x8FC7;&#x7A0B;&#x4E2D;&#x4FEE;&#x6539;&#x8868;&#x7684;&#x98CE;&#x9669;&#x3002;</p>
<p>pcall (f [, arg1, &#xB7;&#xB7;&#xB7;])</p>
<p>&#x4F20;&#x5165;&#x53C2;&#x6570;&#xFF0C;&#x4EE5; &#x4FDD;&#x62A4;&#x6A21;&#x5F0F; &#x8C03;&#x7528;&#x51FD;&#x6570; f &#x3002; &#x8FD9;&#x610F;&#x5473;&#x7740; f &#x4E2D;&#x7684;&#x4EFB;&#x4F55;&#x9519;&#x8BEF;&#x4E0D;&#x4F1A;&#x629B;&#x51FA;&#xFF1B; &#x53D6;&#x800C;&#x4EE3;&#x4E4B;&#x7684;&#x662F;&#xFF0C;pcall &#x4F1A;&#x5C06;&#x9519;&#x8BEF;&#x6355;&#x83B7;&#x5230;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x7801;&#x3002; &#x7B2C;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x72B6;&#x6001;&#x7801;&#xFF08;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#xFF09;&#xFF0C; &#x5F53;&#x6CA1;&#x6709;&#x9519;&#x8BEF;&#x65F6;&#xFF0C;&#x5176;&#x4E3A;&#x771F;&#x3002; &#x6B64;&#x65F6;&#xFF0C;pcall &#x540C;&#x6837;&#x4F1A;&#x5728;&#x72B6;&#x6001;&#x7801;&#x540E;&#x8FD4;&#x56DE;&#x6240;&#x6709;&#x8C03;&#x7528;&#x7684;&#x7ED3;&#x679C;&#x3002; &#x5728;&#x6709;&#x9519;&#x8BEF;&#x65F6;&#xFF0C;pcall &#x8FD4;&#x56DE; false &#x52A0;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;</p>
<p>print (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x63A5;&#x6536;&#x4EFB;&#x610F;&#x6570;&#x91CF;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x5C06;&#x5B83;&#x4EEC;&#x7684;&#x503C;&#x6253;&#x5370;&#x5230; stdout&#x3002; &#x5B83;&#x7528; tostring &#x51FD;&#x6570;&#x5C06;&#x6BCF;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x8F6C;&#x6362;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x3002; print &#x4E0D;&#x7528;&#x4E8E;&#x505A;&#x683C;&#x5F0F;&#x5316;&#x8F93;&#x51FA;&#x3002;&#x4EC5;&#x4F5C;&#x4E3A;&#x770B;&#x4E00;&#x4E0B;&#x67D0;&#x4E2A;&#x503C;&#x7684;&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#x3002; &#x591A;&#x7528;&#x4E8E;&#x8C03;&#x8BD5;&#x3002; &#x5B8C;&#x6574;&#x7684;&#x5BF9;&#x8F93;&#x51FA;&#x7684;&#x63A7;&#x5236;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528; string.format &#x4EE5;&#x53CA; io.write&#x3002;
rawequal (v1, v2)</p>
<p>&#x5728;&#x4E0D;&#x89E6;&#x53D1;&#x4EFB;&#x4F55;&#x5143;&#x65B9;&#x6CD5;&#x7684;&#x60C5;&#x51B5;&#x4E0B; &#x68C0;&#x67E5; v1 &#x662F;&#x5426;&#x548C; v2 &#x76F8;&#x7B49;&#x3002; &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#x3002;
rawget (table, index)</p>
<p>&#x5728;&#x4E0D;&#x89E6;&#x53D1;&#x4EFB;&#x4F55;&#x5143;&#x65B9;&#x6CD5;&#x7684;&#x60C5;&#x51B5;&#x4E0B; &#x83B7;&#x53D6; table[index] &#x7684;&#x503C;&#x3002; table &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x5F20;&#x8868;&#xFF1B; index &#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x4F55;&#x503C;&#x3002;
rawlen (v)</p>
<p>&#x5728;&#x4E0D;&#x89E6;&#x53D1;&#x4EFB;&#x4F55;&#x5143;&#x65B9;&#x6CD5;&#x7684;&#x60C5;&#x51B5;&#x4E0B; &#x8FD4;&#x56DE;&#x5BF9;&#x8C61; v &#x7684;&#x957F;&#x5EA6;&#x3002; v &#x53EF;&#x4EE5;&#x662F;&#x8868;&#x6216;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5B83;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x3002;
rawset (table, index, value)</p>
<p>&#x5728;&#x4E0D;&#x89E6;&#x53D1;&#x4EFB;&#x4F55;&#x5143;&#x65B9;&#x6CD5;&#x7684;&#x60C5;&#x51B5;&#x4E0B; &#x5C06; table[index] &#x8BBE;&#x4E3A; value&#x3002; table &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x5F20;&#x8868;&#xFF0C; index &#x53EF;&#x4EE5;&#x662F; nil &#x4E0E; NaN &#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x4F55;&#x503C;&#x3002; value &#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x4F55; Lua &#x503C;&#x3002;
&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8FD4;&#x56DE; table&#x3002;</p>
<p>select (index, &#xB7;&#xB7;&#xB7;)</p>
<p>&#x5982;&#x679C; index &#x662F;&#x4E2A;&#x6570;&#x5B57;&#xFF0C; &#x90A3;&#x4E48;&#x8FD4;&#x56DE;&#x53C2;&#x6570;&#x4E2D;&#x7B2C; index &#x4E2A;&#x4E4B;&#x540E;&#x7684;&#x90E8;&#x5206;&#xFF1B; &#x8D1F;&#x7684;&#x6570;&#x5B57;&#x4F1A;&#x4ECE;&#x540E;&#x5411;&#x524D;&#x7D22;&#x5F15;&#xFF08;-1 &#x6307;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF09;&#x3002; &#x5426;&#x5219;&#xFF0C;index &#x5FC5;&#x987B;&#x662F;&#x5B57;&#x7B26;&#x4E32; &quot;#&quot;&#xFF0C; &#x6B64;&#x65F6; select &#x8FD4;&#x56DE;&#x53C2;&#x6570;&#x7684;&#x4E2A;&#x6570;&#x3002;</p>
<p>setmetatable (table, metatable)</p>
<p>&#x7ED9;&#x6307;&#x5B9A;&#x8868;&#x8BBE;&#x7F6E;&#x5143;&#x8868;&#x3002; &#xFF08;&#x4F60;&#x4E0D;&#x80FD;&#x5728; Lua &#x4E2D;&#x6539;&#x53D8;&#x5176;&#x5B83;&#x7C7B;&#x578B;&#x503C;&#x7684;&#x5143;&#x8868;&#xFF0C;&#x90A3;&#x4E9B;&#x53EA;&#x80FD;&#x5728; C &#x91CC;&#x505A;&#x3002;&#xFF09; &#x5982;&#x679C; metatable &#x662F; nil&#xFF0C; &#x5C06;&#x6307;&#x5B9A;&#x8868;&#x7684;&#x5143;&#x8868;&#x79FB;&#x9664;&#x3002; &#x5982;&#x679C;&#x539F;&#x6765;&#x90A3;&#x5F20;&#x5143;&#x8868;&#x6709; &quot;__metatable&quot; &#x57DF;&#xFF0C;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8FD4;&#x56DE; table&#x3002;</p>
<p>tonumber (e [, base])</p>
<p>&#x5982;&#x679C;&#x8C03;&#x7528;&#x7684;&#x65F6;&#x5019;&#x6CA1;&#x6709; base&#xFF0C; tonumber &#x5C1D;&#x8BD5;&#x628A;&#x53C2;&#x6570;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x3002; &#x5982;&#x679C;&#x53C2;&#x6570;&#x5DF2;&#x7ECF;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x6216;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x8F6C;&#x6362;&#x4E3A;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C; tonumber &#x5C31;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#xFF1B; &#x5426;&#x5219;&#x8FD4;&#x56DE; nil&#x3002;</p>
<p>&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8F6C;&#x6362;&#x7ED3;&#x679C;&#x53EF;&#x80FD;&#x662F;&#x6574;&#x6570;&#x4E5F;&#x53EF;&#x80FD;&#x662F;&#x6D6E;&#x70B9;&#x6570;&#xFF0C; &#x8FD9;&#x53D6;&#x51B3;&#x4E8E; Lua &#x7684;&#x8F6C;&#x6362;&#x6587;&#x6CD5;&#xFF08;&#x53C2;&#x89C1; &#xA7;3.1&#xFF09;&#x3002; &#xFF08;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x6709;&#x524D;&#x7F6E;&#x548C;&#x540E;&#x7F6E;&#x7684;&#x7A7A;&#x683C;&#xFF0C;&#x53EF;&#x4EE5;&#x5E26;&#x7B26;&#x53F7;&#x3002;&#xFF09;</p>
<p>&#x5F53;&#x4F20;&#x5165; base &#x8C03;&#x7528;&#x5B83;&#x65F6;&#xFF0C; e &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x4EE5;&#x8BE5;&#x8FDB;&#x5236;&#x8868;&#x793A;&#x7684;&#x6574;&#x6570;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x8FDB;&#x5236;&#x53EF;&#x4EE5;&#x662F; 2 &#x5230; 36 &#xFF08;&#x5305;&#x542B; 2 &#x548C; 36&#xFF09;&#x4E4B;&#x95F4;&#x7684;&#x4EFB;&#x4F55;&#x6574;&#x6570;&#x3002; &#x5927;&#x4E8E; 10 &#x8FDB;&#x5236;&#x65F6;&#xFF0C;&#x5B57;&#x6BCD; &apos;A&apos; &#xFF08;&#x5927;&#x5C0F;&#x5199;&#x5747;&#x53EF;&#xFF09;&#x8868;&#x793A; 10 &#xFF0C; &apos;B&apos; &#x8868;&#x793A; 11&#xFF0C;&#x4F9D;&#x6B21;&#x5230; &apos;Z&apos; &#x8868;&#x793A; 35 &#x3002; &#x5982;&#x679C;&#x5B57;&#x7B26;&#x4E32; e &#x4E0D;&#x662F;&#x8BE5;&#x8FDB;&#x5236;&#x4E0B;&#x7684;&#x5408;&#x6CD5;&#x6570;&#x5B57;&#xFF0C; &#x51FD;&#x6570;&#x8FD4;&#x56DE; nil&#x3002;</p>
<p>tostring (v)</p>
<p>&#x53EF;&#x4EE5;&#x63A5;&#x6536;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#xFF0C;&#x5B83;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x4E3A;&#x4EBA;&#x53EF;&#x9605;&#x8BFB;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5F62;&#x5F0F;&#x3002; &#x6D6E;&#x70B9;&#x6570;&#x603B;&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x6D6E;&#x70B9;&#x6570;&#x7684;&#x8868;&#x73B0;&#x5F62;&#x5F0F;&#xFF08;&#x5C0F;&#x6570;&#x70B9;&#x5F62;&#x5F0F;&#x6216;&#x662F;&#x6307;&#x6570;&#x5F62;&#x5F0F;&#xFF09;&#x3002; &#xFF08;&#x5982;&#x679C;&#x60F3;&#x5B8C;&#x5168;&#x63A7;&#x5236;&#x6570;&#x5B57;&#x5982;&#x4F55;&#x88AB;&#x8F6C;&#x6362;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; string.format&#x3002;&#xFF09;
&#x5982;&#x679C; v &#x6709; &quot;__tostring&quot; &#x57DF;&#x7684;&#x5143;&#x8868;&#xFF0C; tostring &#x4F1A;&#x4EE5; v &#x4E3A;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x5B83;&#x3002; &#x5E76;&#x7528;&#x5B83;&#x7684;&#x7ED3;&#x679C;&#x4F5C;&#x4E3A;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
<p>type (v)</p>
<p>&#x5C06;&#x53C2;&#x6570;&#x7684;&#x7C7B;&#x578B;&#x7F16;&#x7801;&#x4E3A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x8FD4;&#x56DE;&#x3002; &#x51FD;&#x6570;&#x53EF;&#x80FD;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x6709; &quot;nil&quot; &#xFF08;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x800C;&#x4E0D;&#x662F; nil &#x503C;&#xFF09;&#xFF0C; &quot;number&quot;&#xFF0C; &quot;string&quot;&#xFF0C; &quot;boolean&quot;&#xFF0C; &quot;table&quot;&#xFF0C; &quot;function&quot;&#xFF0C; &quot;thread&quot;&#xFF0C; &quot;userdata&quot;&#x3002;
_VERSION</p>
<p>&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x6709;&#x5F53;&#x524D;&#x89E3;&#x91CA;&#x5668;&#x7248;&#x672C;&#x53F7;&#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#xFF08;&#x5E76;&#x975E;&#x51FD;&#x6570;&#xFF09;&#x3002; &#x5F53;&#x524D;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x503C;&#x4E3A; &quot;Lua 5.3&quot;&#x3002;
xpcall (f, msgh [, arg1, &#xB7;&#xB7;&#xB7;])</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x548C; pcall &#x7C7B;&#x4F3C;&#x3002; &#x4E0D;&#x8FC7;&#x5B83;&#x53EF;&#x4EE5;&#x989D;&#x5916;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x6D88;&#x606F;&#x5904;&#x7406;&#x5668; msgh&#x3002;</p>
<p>6.2 &#x2013; &#x534F;&#x7A0B;&#x7BA1;&#x7406;</p>
<p>&#x5173;&#x4E8E;&#x534F;&#x7A0B;&#x7684;&#x64CD;&#x4F5C;&#x4F5C;&#x4E3A;&#x57FA;&#x7840;&#x5E93;&#x7684;&#x4E00;&#x4E2A;&#x5B50;&#x5E93;&#xFF0C; &#x88AB;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x72EC;&#x7ACB;&#x8868; coroutine &#x4E2D;&#x3002; &#x534F;&#x7A0B;&#x7684;&#x4ECB;&#x7ECD;&#x53C2;&#x89C1; &#xA7;2.6 &#x3002;</p>
<p>coroutine.create (f)</p>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4E3B;&#x4F53;&#x51FD;&#x6570;&#x4E3A; f &#x7684;&#x65B0;&#x534F;&#x7A0B;&#x3002; f &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A; Lua &#x7684;&#x51FD;&#x6570;&#x3002; &#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x65B0;&#x534F;&#x7A0B;&#xFF0C;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x4E3A; &quot;thread&quot; &#x7684;&#x5BF9;&#x8C61;&#x3002;</p>
<p>coroutine.isyieldable ()</p>
<p>&#x5982;&#x679C;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x534F;&#x7A0B;&#x53EF;&#x4EE5;&#x8BA9;&#x51FA;&#xFF0C;&#x5219;&#x8FD4;&#x56DE;&#x771F;&#x3002;</p>
<p>&#x4E0D;&#x5728;&#x4E3B;&#x7EBF;&#x7A0B;&#x4E2D;&#x6216;&#x4E0D;&#x5728;&#x4E00;&#x4E2A;&#x65E0;&#x6CD5;&#x8BA9;&#x51FA;&#x7684; C &#x51FD;&#x6570;&#x4E2D;&#x65F6;&#xFF0C;&#x5F53;&#x524D;&#x534F;&#x7A0B;&#x662F;&#x53EF;&#x8BA9;&#x51FA;&#x7684;&#x3002;</p>
<p>coroutine.resume (co [, val1, &#xB7;&#xB7;&#xB7;])</p>
<p>&#x5F00;&#x59CB;&#x6216;&#x7EE7;&#x7EED;&#x534F;&#x7A0B; co &#x7684;&#x8FD0;&#x884C;&#x3002; &#x5F53;&#x4F60;&#x7B2C;&#x4E00;&#x6B21;&#x5EF6;&#x7EED;&#x4E00;&#x4E2A;&#x534F;&#x7A0B;&#xFF0C;&#x5B83;&#x4F1A;&#x4ECE;&#x4E3B;&#x4F53;&#x51FD;&#x6570;&#x5904;&#x5F00;&#x59CB;&#x8FD0;&#x884C;&#x3002; val1, ... &#x8FD9;&#x4E9B;&#x503C;&#x4F1A;&#x4EE5;&#x53C2;&#x6570;&#x5F62;&#x5F0F;&#x4F20;&#x5165;&#x4E3B;&#x4F53;&#x51FD;&#x6570;&#x3002; &#x5982;&#x679C;&#x8BE5;&#x534F;&#x7A0B;&#x88AB;&#x8BA9;&#x51FA;&#xFF0C;resume &#x4F1A;&#x91CD;&#x65B0;&#x542F;&#x52A8;&#x5B83;&#xFF1B; val1, ... &#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x4F1A;&#x4F5C;&#x4E3A;&#x8BA9;&#x51FA;&#x70B9;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x534F;&#x7A0B;&#x8FD0;&#x884C;&#x8D77;&#x6765;&#x6CA1;&#x6709;&#x9519;&#x8BEF;&#xFF0C; resume &#x8FD4;&#x56DE; true &#x52A0;&#x4E0A;&#x4F20;&#x7ED9; yield &#x7684;&#x6240;&#x6709;&#x503C; &#xFF08;&#x5F53;&#x534F;&#x7A0B;&#x8BA9;&#x51FA;&#xFF09;&#xFF0C; &#x6216;&#x662F;&#x4E3B;&#x4F53;&#x51FD;&#x6570;&#x7684;&#x6240;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#xFF08;&#x5F53;&#x534F;&#x7A0B;&#x4E2D;&#x6B62;&#xFF09;&#x3002; &#x5982;&#x679C;&#x6709;&#x4EFB;&#x4F55;&#x9519;&#x8BEF;&#x53D1;&#x751F;&#xFF0C; resume &#x8FD4;&#x56DE; false &#x52A0;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;</p>
<p>coroutine.running ()</p>
<p>&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x534F;&#x7A0B;&#x52A0;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#x3002; &#x5982;&#x679C;&#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x534F;&#x7A0B;&#x662F;&#x4E3B;&#x7EBF;&#x7A0B;&#xFF0C;&#x5176;&#x4E3A;&#x771F;&#x3002;</p>
<p>coroutine.status (co)</p>
<p>&#x4EE5;&#x5B57;&#x7B26;&#x4E32;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE;&#x534F;&#x7A0B; co &#x7684;&#x72B6;&#x6001;&#xFF1A; &#x5F53;&#x534F;&#x7A0B;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#xFF08;&#x5B83;&#x5C31;&#x662F;&#x8C03;&#x7528; status &#x7684;&#x90A3;&#x4E2A;&#xFF09; &#xFF0C;&#x8FD4;&#x56DE; &quot;running&quot;&#xFF1B; &#x5982;&#x679C;&#x534F;&#x7A0B;&#x8C03;&#x7528; yield &#x6302;&#x8D77;&#x6216;&#x662F;&#x8FD8;&#x6CA1;&#x6709;&#x5F00;&#x59CB;&#x8FD0;&#x884C;&#xFF0C;&#x8FD4;&#x56DE; &quot;suspended&quot;&#xFF1B; &#x5982;&#x679C;&#x534F;&#x7A0B;&#x662F;&#x6D3B;&#x52A8;&#x7684;&#xFF0C;&#x90FD;&#x5E76;&#x4E0D;&#x5728;&#x8FD0;&#x884C;&#xFF08;&#x5373;&#x5B83;&#x6B63;&#x5728;&#x5EF6;&#x7EED;&#x5176;&#x5B83;&#x534F;&#x7A0B;&#xFF09;&#xFF0C;&#x8FD4;&#x56DE; &quot;normal&quot;&#xFF1B; &#x5982;&#x679C;&#x534F;&#x7A0B;&#x8FD0;&#x884C;&#x5B8C;&#x4E3B;&#x4F53;&#x51FD;&#x6570;&#x6216;&#x56E0;&#x9519;&#x8BEF;&#x505C;&#x6B62;&#xFF0C;&#x8FD4;&#x56DE; &quot;dead&quot;&#x3002;</p>
<p>coroutine.wrap (f)</p>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4E3B;&#x4F53;&#x51FD;&#x6570;&#x4E3A; f &#x7684;&#x65B0;&#x534F;&#x7A0B;&#x3002; f &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A; Lua &#x7684;&#x51FD;&#x6570;&#x3002; &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF0C; &#x6BCF;&#x6B21;&#x8C03;&#x7528;&#x8BE5;&#x51FD;&#x6570;&#x90FD;&#x4F1A;&#x5EF6;&#x7EED;&#x8BE5;&#x534F;&#x7A0B;&#x3002; &#x4F20;&#x7ED9;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x53C2;&#x6570;&#x90FD;&#x4F1A;&#x4F5C;&#x4E3A; resume &#x7684;&#x989D;&#x5916;&#x53C2;&#x6570;&#x3002; &#x548C; resume &#x8FD4;&#x56DE;&#x76F8;&#x540C;&#x7684;&#x503C;&#xFF0C; &#x53EA;&#x662F;&#x6CA1;&#x6709;&#x7B2C;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#x3002; &#x5982;&#x679C;&#x53D1;&#x751F;&#x4EFB;&#x4F55;&#x9519;&#x8BEF;&#xFF0C;&#x629B;&#x51FA;&#x8FD9;&#x4E2A;&#x9519;&#x8BEF;&#x3002;</p>
<p>coroutine.yield (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x6302;&#x8D77;&#x6B63;&#x5728;&#x8C03;&#x7528;&#x7684;&#x534F;&#x7A0B;&#x7684;&#x6267;&#x884C;&#x3002; &#x4F20;&#x9012;&#x7ED9; yield &#x7684;&#x53C2;&#x6570;&#x90FD;&#x4F1A;&#x8F6C;&#x4E3A; resume &#x7684;&#x989D;&#x5916;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
<h2 id="&#x6A21;&#x5757;">&#x6A21;&#x5757; <a href="#&#x6A21;&#x5757;"> # </a></h2>
<p>&#x5305;&#x7BA1;&#x7406;&#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x4ECE; Lua &#x4E2D;&#x52A0;&#x8F7D;&#x6A21;&#x5757;&#x7684;&#x57FA;&#x7840;&#x5E93;&#x3002; &#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5BFC;&#x51FA;&#x51FD;&#x6570;&#x76F4;&#x63A5;&#x653E;&#x5728;&#x5168;&#x5C40;&#x73AF;&#x5883;&#x4E2D;&#xFF1A; require&#x3002; &#x6240;&#x6709;&#x5176;&#x5B83;&#x7684;&#x90E8;&#x5206;&#x90FD;&#x5BFC;&#x51FA;&#x5728;&#x8868; package &#x4E2D;&#x3002;</p>
<p>require (modname)</p>
<p>&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x9996;&#x5148;&#x67E5;&#x627E; package.loaded &#x8868;&#xFF0C; &#x68C0;&#x6D4B; modname &#x662F;&#x5426;&#x88AB;&#x52A0;&#x8F7D;&#x8FC7;&#x3002; &#x5982;&#x679C;&#x88AB;&#x52A0;&#x8F7D;&#x8FC7;&#xFF0C;require &#x8FD4;&#x56DE; package.loaded[modname] &#x4E2D;&#x4FDD;&#x5B58;&#x7684;&#x503C;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x5B83;&#x8BD5;&#x7740;&#x4E3A;&#x6A21;&#x5757;&#x5BFB;&#x627E; &#x52A0;&#x8F7D;&#x5668; &#x3002;</p>
<p>require &#x9075;&#x5FAA; package.searchers &#x5E8F;&#x5217;&#x7684;&#x6307;&#x5F15;&#x6765;&#x67E5;&#x627E;&#x52A0;&#x8F7D;&#x5668;&#x3002; &#x5982;&#x679C;&#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x5E8F;&#x5217;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6539;&#x53D8; require &#x5982;&#x4F55;&#x67E5;&#x627E;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x3002; &#x4E0B;&#x5217;&#x8BF4;&#x660E;&#x57FA;&#x4E8E; package.searchers &#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x3002;</p>
<p>&#x9996;&#x5148; require &#x67E5;&#x627E; package.preload[modname] &#x3002; &#x5982;&#x679C;&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E2A;&#x503C;&#xFF0C;&#x8FD9;&#x4E2A;&#x503C;&#xFF08;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF09;&#x5C31;&#x662F;&#x90A3;&#x4E2A;&#x52A0;&#x8F7D;&#x5668;&#x3002; &#x5426;&#x5219; require &#x4F7F;&#x7528; Lua &#x52A0;&#x8F7D;&#x5668;&#x53BB;&#x67E5;&#x627E; package.path &#x7684;&#x8DEF;&#x5F84;&#x3002; &#x5982;&#x679C;&#x67E5;&#x627E;&#x5931;&#x8D25;&#xFF0C;&#x63A5;&#x7740;&#x4F7F;&#x7528; C &#x52A0;&#x8F7D;&#x5668;&#x53BB;&#x67E5;&#x627E; package.cpath &#x7684;&#x8DEF;&#x5F84;&#x3002; &#x5982;&#x679C;&#x90FD;&#x5931;&#x8D25;&#x4E86;&#xFF0C;&#x518D;&#x5C1D;&#x8BD5; &#x4E00;&#x4F53;&#x5316; &#x52A0;&#x8F7D;&#x5668; &#xFF08;&#x53C2;&#x89C1; package.searchers&#xFF09;&#x3002;</p>
<p>&#x6BCF;&#x6B21;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x52A0;&#x8F7D;&#x5668;&#xFF0C;require &#x90FD;&#x7528;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x52A0;&#x8F7D;&#x5668;&#xFF1A; modname &#x548C;&#x4E00;&#x4E2A;&#x5728;&#x83B7;&#x53D6;&#x52A0;&#x8F7D;&#x5668;&#x8FC7;&#x7A0B;&#x4E2D;&#x5F97;&#x5230;&#x7684;&#x53C2;&#x6570;&#x3002; &#xFF08;&#x5982;&#x679C;&#x901A;&#x8FC7;&#x67E5;&#x627E;&#x6587;&#x4EF6;&#x5F97;&#x5230;&#x7684;&#x52A0;&#x8F7D;&#x5668;&#xFF0C;&#x8FD9;&#x4E2A;&#x989D;&#x5916;&#x53C2;&#x6570;&#x662F;&#x6587;&#x4EF6;&#x540D;&#x3002;&#xFF09; &#x5982;&#x679C;&#x52A0;&#x8F7D;&#x5668;&#x8FD4;&#x56DE;&#x975E;&#x7A7A;&#x503C;&#xFF0C; require &#x5C06;&#x8FD9;&#x4E2A;&#x503C;&#x8D4B;&#x7ED9; package.loaded[modname]&#x3002; &#x5982;&#x679C;&#x52A0;&#x8F7D;&#x5668;&#x6CA1;&#x80FD;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x975E;&#x7A7A;&#x503C;&#x7528;&#x4E8E;&#x8D4B;&#x7ED9; package.loaded[modname]&#xFF0C; require &#x4F1A;&#x5728;&#x90A3;&#x91CC;&#x8BBE;&#x5165; true &#x3002; &#x65E0;&#x8BBA;&#x662F;&#x4EC0;&#x4E48;&#x60C5;&#x51B5;&#xFF0C;require &#x90FD;&#x4F1A;&#x8FD4;&#x56DE; package.loaded[modname] &#x7684;&#x6700;&#x7EC8;&#x503C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x5728;&#x52A0;&#x8F7D;&#x6216;&#x8FD0;&#x884C;&#x6A21;&#x5757;&#x65F6;&#x6709;&#x9519;&#x8BEF;&#xFF0C; &#x6216;&#x662F;&#x65E0;&#x6CD5;&#x4E3A;&#x6A21;&#x5757;&#x627E;&#x5230;&#x52A0;&#x8F7D;&#x5668;&#xFF0C; require &#x90FD;&#x4F1A;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002;</p>
<p>package.config</p>
<p>&#x4E00;&#x4E2A;&#x63CF;&#x8FF0;&#x6709;&#x4E00;&#x4E9B;&#x4E3A;&#x5305;&#x7BA1;&#x7406;&#x51C6;&#x5907;&#x7684;&#x7F16;&#x8BD1;&#x671F;&#x914D;&#x7F6E;&#x4FE1;&#x606F;&#x7684;&#x4E32;&#x3002; &#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x7531;&#x4E00;&#x7CFB;&#x5217;&#x884C;&#x6784;&#x6210;&#xFF1A;</p>
<p>&#x7B2C;&#x4E00;&#x884C;&#x662F;&#x76EE;&#x5F55;&#x5206;&#x5272;&#x4E32;&#x3002; &#x5BF9;&#x4E8E; Windows &#x9ED8;&#x8BA4;&#x662F; &apos;\&apos; &#xFF0C;&#x5BF9;&#x4E8E;&#x5176;&#x5B83;&#x7CFB;&#x7EDF;&#x662F; &apos;/&apos; &#x3002;
&#x7B2C;&#x4E8C;&#x884C;&#x662F;&#x7528;&#x4E8E;&#x8DEF;&#x5F84;&#x4E2D;&#x7684;&#x5206;&#x5272;&#x7B26;&#x3002;&#x9ED8;&#x8BA4;&#x503C;&#x662F; &apos;;&apos; &#x3002;
&#x7B2C;&#x4E09;&#x884C;&#x662F;&#x7528;&#x4E8E;&#x6807;&#x8BB0;&#x6A21;&#x677F;&#x66FF;&#x6362;&#x70B9;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x9ED8;&#x8BA4;&#x662F; &apos;?&apos; &#x3002;
&#x7B2C;&#x56DB;&#x884C;&#x662F;&#x5728; Windows &#x4E2D;&#x5C06;&#x88AB;&#x66FF;&#x6362;&#x6210;&#x6267;&#x884C;&#x7A0B;&#x5E8F;&#x6240;&#x5728;&#x76EE;&#x5F55;&#x7684;&#x8DEF;&#x5F84;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x9ED8;&#x8BA4;&#x662F; &apos;!&apos; &#x3002;
&#x7B2C;&#x4E94;&#x884C;&#x662F;&#x4E00;&#x4E2A;&#x8BB0;&#x53F7;&#xFF0C;&#x8BE5;&#x8BB0;&#x53F7;&#x4E4B;&#x540E;&#x7684;&#x6240;&#x6709;&#x6587;&#x672C;&#x5C06;&#x5728;&#x6784;&#x5EFA; luaopen_ &#x51FD;&#x6570;&#x540D;&#x65F6;&#x88AB;&#x5FFD;&#x7565;&#x6389;&#x3002; &#x9ED8;&#x8BA4;&#x662F; &apos;-&apos;&#x3002;
package.cpath</p>
<p>&#x8FD9;&#x4E2A;&#x8DEF;&#x5F84;&#x88AB; require &#x5728; C &#x52A0;&#x8F7D;&#x5668;&#x4E2D;&#x505A;&#x641C;&#x7D22;&#x65F6;&#x7528;&#x5230;&#x3002;</p>
<p>Lua &#x7528;&#x548C;&#x521D;&#x59CB;&#x5316; Lua &#x8DEF;&#x5F84; package.path &#x76F8;&#x540C;&#x7684;&#x65B9;&#x5F0F;&#x521D;&#x59CB;&#x5316; C &#x8DEF;&#x5F84; package.cpath &#x3002; &#x5B83;&#x4F1A;&#x4F7F;&#x7528;&#x73AF;&#x5883;&#x53D8;&#x91CF; LUA_CPATH_5_3 &#x6216; &#x73AF;&#x5883;&#x53D8;&#x91CF; LUA_CPATH &#x521D;&#x59CB;&#x5316;&#x3002; &#x8981;&#x4E48;&#x5C31;&#x91C7;&#x7528; luaconf.h &#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x9ED8;&#x8BA4;&#x8DEF;&#x5F84;&#x3002;</p>
<p>package.loaded</p>
<p>&#x7528;&#x4E8E; require &#x63A7;&#x5236;&#x54EA;&#x4E9B;&#x6A21;&#x5757;&#x5DF2;&#x7ECF;&#x88AB;&#x52A0;&#x8F7D;&#x7684;&#x8868;&#x3002; &#x5F53;&#x4F60;&#x8BF7;&#x6C42;&#x4E00;&#x4E2A; modname &#x6A21;&#x5757;&#xFF0C;&#x4E14; package.loaded[modname] &#x4E0D;&#x4E3A;&#x5047;&#x65F6;&#xFF0C; require &#x7B80;&#x5355;&#x8FD4;&#x56DE;&#x50A8;&#x5B58;&#x5728;&#x5185;&#x7684;&#x503C;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x4EC5;&#x4EC5;&#x662F;&#x5BF9;&#x771F;&#x6B63;&#x90A3;&#x5F20;&#x8868;&#x7684;&#x5F15;&#x7528;&#xFF1B; &#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x503C;&#x5E76;&#x4E0D;&#x4F1A;&#x6539;&#x53D8; require &#x4F7F;&#x7528;&#x7684;&#x8868;&#x3002;</p>
<p>package.loadlib (libname, funcname)</p>
<p>&#x8BA9;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x52A8;&#x6001;&#x94FE;&#x63A5; C &#x5E93; libname &#x3002;</p>
<p>&#x5F53; funcname &#x4E3A; &quot;*&quot;&#xFF0C; &#x5B83;&#x4EC5;&#x4EC5;&#x8FDE;&#x63A5;&#x8BE5;&#x5E93;&#xFF0C;&#x8BA9;&#x5E93;&#x4E2D;&#x7684;&#x7B26;&#x53F7;&#x90FD;&#x5BFC;&#x51FA;&#x7ED9;&#x5176;&#x5B83;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5E93;&#x4F7F;&#x7528;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x5B83;&#x67E5;&#x627E;&#x5E93;&#x4E2D;&#x7684;&#x51FD;&#x6570; funcname &#xFF0C;&#x4EE5; C &#x51FD;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002; &#x56E0;&#x6B64;&#xFF0C;funcname &#x5FC5;&#x987B;&#x9075;&#x5FAA;&#x539F;&#x578B; lua_CFunction &#xFF08;&#x53C2;&#x89C1; lua_CFunction&#xFF09;&#x3002;</p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x4F4E;&#x9636;&#x51FD;&#x6570;&#x3002; &#x5B83;&#x5B8C;&#x5168;&#x7ED5;&#x8FC7;&#x4E86;&#x5305;&#x6A21;&#x5757;&#x7CFB;&#x7EDF;&#x3002; &#x548C; require &#x4E0D;&#x540C;&#xFF0C; &#x5B83;&#x4E0D;&#x4F1A;&#x505A;&#x4EFB;&#x4F55;&#x8DEF;&#x5F84;&#x67E5;&#x8BE2;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x52A0;&#x6269;&#x5C55;&#x540D;&#x3002; libname &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A; C &#x5E93;&#x9700;&#x8981;&#x7684;&#x5B8C;&#x6574;&#x7684;&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x5FC5;&#x8981;&#xFF0C;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x8DEF;&#x5F84;&#x548C;&#x6269;&#x5C55;&#x540D;&#x3002; funcname &#x5FC5;&#x987B;&#x662F; C &#x5E93;&#x9700;&#x8981;&#x7684;&#x51C6;&#x786E;&#x540D;&#x5B57; &#xFF08;&#x8FD9;&#x53D6;&#x51B3;&#x4E8E;&#x4F7F;&#x7528;&#x7684; C &#x7F16;&#x8BD1;&#x5668;&#x548C;&#x94FE;&#x63A5;&#x5668;&#xFF09;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5728;&#x6807;&#x51C6; C &#x4E2D;&#x4E0D;&#x652F;&#x6301;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x5B83;&#x53EA;&#x5728;&#x90E8;&#x5206;&#x5E73;&#x53F0;&#x6709;&#x6548; &#xFF08; Windows &#xFF0C;Linux &#xFF0C;Mac OS X, Solaris, BSD, &#x52A0;&#x4E0A;&#x652F;&#x6301; dlfcn &#x6807;&#x51C6;&#x7684; Unix &#x7CFB;&#x7EDF;&#xFF09;&#x3002;</p>
<p>package.path</p>
<p>&#x8FD9;&#x4E2A;&#x8DEF;&#x5F84;&#x88AB; require &#x5728; Lua &#x52A0;&#x8F7D;&#x5668;&#x4E2D;&#x505A;&#x641C;&#x7D22;&#x65F6;&#x7528;&#x5230;&#x3002;</p>
<p>&#x5728;&#x542F;&#x52A8;&#x65F6;&#xFF0C;Lua &#x7528;&#x73AF;&#x5883;&#x53D8;&#x91CF; LUA_PATH_5_3 &#x6216;&#x73AF;&#x5883;&#x53D8;&#x91CF; LUA_PATH &#x6765;&#x521D;&#x59CB;&#x5316;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x3002; &#x6216;&#x91C7;&#x7528; luaconf.h &#x4E2D;&#x7684;&#x9ED8;&#x8BA4;&#x8DEF;&#x5F84;&#x3002; &#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x6240;&#x6709; &quot;;;&quot; &#x90FD;&#x4F1A;&#x88AB;&#x66FF;&#x6362;&#x6210;&#x9ED8;&#x8BA4;&#x8DEF;&#x5F84;&#x3002;</p>
<p>package.preload</p>
<p>&#x4FDD;&#x5B58;&#x6709;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x6A21;&#x5757;&#x7684;&#x52A0;&#x8F7D;&#x5668; &#xFF08;&#x53C2;&#x89C1; require&#xFF09;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x4EC5;&#x4EC5;&#x662F;&#x5BF9;&#x771F;&#x6B63;&#x90A3;&#x5F20;&#x8868;&#x7684;&#x5F15;&#x7528;&#xFF1B; &#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x503C;&#x5E76;&#x4E0D;&#x4F1A;&#x6539;&#x53D8; require &#x4F7F;&#x7528;&#x7684;&#x8868;&#x3002;</p>
<p>package.searchers</p>
<p>&#x7528;&#x4E8E; require &#x63A7;&#x5236;&#x5982;&#x4F55;&#x52A0;&#x8F7D;&#x6A21;&#x5757;&#x7684;&#x8868;&#x3002;</p>
<p>&#x8FD9;&#x5F20;&#x8868;&#x5185;&#x7684;&#x6BCF;&#x4E00;&#x9879;&#x90FD;&#x662F;&#x4E00;&#x4E2A; &#x67E5;&#x627E;&#x5668;&#x51FD;&#x6570;&#x3002; &#x5F53;&#x67E5;&#x627E;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x65F6;&#xFF0C; require &#x6309;&#x6B21;&#x5E8F;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x67E5;&#x627E;&#x5668;&#xFF0C; &#x5E76;&#x4F20;&#x5165;&#x6A21;&#x5757;&#x540D;&#xFF08;require &#x7684;&#x53C2;&#x6570;&#xFF09;&#x4F5C;&#x4E3A;&#x552F;&#x4E00;&#x7684;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002; &#x6B64;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x53E6;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#xFF08;&#x6A21;&#x5757;&#x7684; &#x52A0;&#x8F7D;&#x5668;&#xFF09;&#x52A0;&#x4E0A;&#x53E6;&#x4E00;&#x4E2A;&#x5C06;&#x4F20;&#x9012;&#x7ED9;&#x8FD9;&#x4E2A;&#x52A0;&#x8F7D;&#x5668;&#x7684;&#x53C2;&#x6570;&#x3002; &#x6216;&#x662F;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x63CF;&#x8FF0;&#x4E3A;&#x4F55;&#x6CA1;&#x6709;&#x627E;&#x5230;&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x5B57;&#x7B26;&#x4E32; &#xFF08;&#x6216;&#x662F;&#x8FD4;&#x56DE; nil &#x4EC0;&#x4E48;&#x4E5F;&#x4E0D;&#x60F3;&#x8BF4;&#xFF09;&#x3002;</p>
<p>Lua &#x7528;&#x56DB;&#x4E2A;&#x67E5;&#x627E;&#x5668;&#x51FD;&#x6570;&#x521D;&#x59CB;&#x5316;&#x8FD9;&#x5F20;&#x8868;&#x3002;</p>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x67E5;&#x627E;&#x5668;&#x5C31;&#x662F;&#x7B80;&#x5355;&#x7684;&#x5728; package.preload &#x8868;&#x4E2D;&#x67E5;&#x627E;&#x52A0;&#x8F7D;&#x5668;&#x3002;</p>
<p>&#x7B2C;&#x4E8C;&#x4E2A;&#x67E5;&#x627E;&#x5668;&#x7528;&#x4E8E;&#x67E5;&#x627E; Lua &#x5E93;&#x7684;&#x52A0;&#x8F7D;&#x5E93;&#x3002; &#x5B83;&#x4F7F;&#x7528;&#x50A8;&#x5B58;&#x5728; package.path &#x4E2D;&#x7684;&#x8DEF;&#x5F84;&#x6765;&#x505A;&#x67E5;&#x627E;&#x5DE5;&#x4F5C;&#x3002; &#x67E5;&#x627E;&#x8FC7;&#x7A0B;&#x548C;&#x51FD;&#x6570; package.searchpath &#x63CF;&#x8FF0;&#x7684;&#x4E00;&#x81F4;&#x3002;</p>
<p>&#x7B2C;&#x4E09;&#x4E2A;&#x67E5;&#x627E;&#x5668;&#x7528;&#x4E8E;&#x67E5;&#x627E; C &#x5E93;&#x7684;&#x52A0;&#x8F7D;&#x5E93;&#x3002; &#x5B83;&#x4F7F;&#x7528;&#x50A8;&#x5B58;&#x5728; package.cpath &#x4E2D;&#x7684;&#x8DEF;&#x5F84;&#x6765;&#x505A;&#x67E5;&#x627E;&#x5DE5;&#x4F5C;&#x3002; &#x540C;&#x6837;&#xFF0C; &#x67E5;&#x627E;&#x8FC7;&#x7A0B;&#x548C;&#x51FD;&#x6570; package.searchpath &#x63CF;&#x8FF0;&#x7684;&#x4E00;&#x81F4;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C; C &#x8DEF;&#x5F84;&#x662F;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;</p>
<pre><code> &quot;./?.so;./?.dll;/usr/local/?/init.so&quot;
</code></pre><p>&#x67E5;&#x627E;&#x5668;&#x67E5;&#x627E;&#x6A21;&#x5757; foo &#x4F1A;&#x4F9D;&#x6B21;&#x5C1D;&#x8BD5;&#x6253;&#x5F00;&#x6587;&#x4EF6; ./foo.so&#xFF0C;./foo.dll&#xFF0C; &#x4EE5;&#x53CA; /usr/local/foo/init.so&#x3002; &#x4E00;&#x65E6;&#x5B83;&#x627E;&#x5230;&#x4E00;&#x4E2A; C &#x5E93;&#xFF0C; &#x67E5;&#x627E;&#x5668;&#x9996;&#x5148;&#x4F7F;&#x7528;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x673A;&#x5236;&#x8FDE;&#x63A5;&#x8BE5;&#x5E93;&#x3002; &#x7136;&#x540E;&#x5C1D;&#x8BD5;&#x5728;&#x8BE5;&#x5E93;&#x4E2D;&#x627E;&#x5230;&#x53EF;&#x4EE5;&#x7528;&#x4F5C;&#x52A0;&#x8F7D;&#x5668;&#x7684; C &#x51FD;&#x6570;&#x3002; &#x8FD9;&#x4E2A; C &#x51FD;&#x6570;&#x7684;&#x540D;&#x5B57;&#x662F; &quot;luaopen_&quot; &#x7D27;&#x63A5;&#x6A21;&#x5757;&#x540D;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C; &#x5176;&#x4E2D;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x6240;&#x6709;&#x7684;&#x4E0B;&#x5212;&#x7EBF;&#x90FD;&#x4F1A;&#x88AB;&#x66FF;&#x6362;&#x6210;&#x70B9;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x6A21;&#x5757;&#x540D;&#x4E2D;&#x6709;&#x6A2A;&#x7EBF;&#xFF0C; &#x6A2A;&#x7EBF;&#x540E;&#x9762;&#x7684;&#x90E8;&#x5206;&#xFF08;&#x5305;&#x62EC;&#x6A2A;&#x7EBF;&#xFF09;&#x90FD;&#x88AB;&#x53BB;&#x6389;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x6A21;&#x5757;&#x540D;&#x4E3A; a.b.c-v2.1&#xFF0C; &#x51FD;&#x6570;&#x540D;&#x5C31;&#x662F; luaopen_a_b_c&#x3002;</p>
<p>&#x7B2C;&#x56DB;&#x4E2A;&#x641C;&#x7D22;&#x5668;&#x662F;&#x3000;&#x4E00;&#x4F53;&#x5316;&#x52A0;&#x8F7D;&#x5668;&#x3002; &#x5B83;&#x4ECE; C &#x8DEF;&#x5F84;&#x4E2D;&#x67E5;&#x627E;&#x6307;&#x5B9A;&#x6A21;&#x5757;&#x7684;&#x6839;&#x540D;&#x5B57;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x8BF7;&#x6C42; a.b.c&#x3000;&#x65F6;&#xFF0C; &#x5B83;&#x5C06;&#x67E5;&#x627E; a &#x8FD9;&#x4E2A; C &#x5E93;&#x3002; &#x5982;&#x679C;&#x627E;&#x5F97;&#x5230;&#xFF0C;&#x5B83;&#x4F1A;&#x5728;&#x91CC;&#x9762;&#x627E;&#x5B50;&#x6A21;&#x5757;&#x7684;&#x52A0;&#x8F7D;&#x51FD;&#x6570;&#x3002; &#x5728;&#x6211;&#x4EEC;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x5C31;&#x662F;&#x627E;&#x3000;luaopen_a_b_c&#x3002; &#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x673A;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;&#x82E5;&#x5E72; C &#x5B50;&#x6A21;&#x5757;&#x6253;&#x5305;&#x8FDB;&#x5355;&#x4E2A;&#x5E93;&#x3002; &#x6BCF;&#x4E2A;&#x5B50;&#x6A21;&#x5757;&#x90FD;&#x53EF;&#x4EE5;&#x6709;&#x539F;&#x672C;&#x7684;&#x52A0;&#x8F7D;&#x51FD;&#x6570;&#x540D;&#x3002;</p>
<p>&#x9664;&#x4E86;&#x7B2C;&#x4E00;&#x4E2A;&#xFF08;&#x9884;&#x52A0;&#x8F7D;&#xFF09;&#x641C;&#x7D22;&#x5668;&#x5916;&#xFF0C;&#x6BCF;&#x4E2A;&#x641C;&#x7D22;&#x5668;&#x90FD;&#x4F1A;&#x8FD4;&#x56DE; &#x5B83;&#x627E;&#x5230;&#x7684;&#x6A21;&#x5757;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x3002; &#x8FD9;&#x548C; package.searchpath &#x7684;&#x8FD4;&#x56DE;&#x503C;&#x4E00;&#x6837;&#x3002; &#x7B2C;&#x4E00;&#x4E2A;&#x641C;&#x7D22;&#x5668;&#x6CA1;&#x6709;&#x8FD4;&#x56DE;&#x503C;&#x3002;</p>
<p>package.searchpath (name, path [, sep [, rep]])</p>
<p>&#x5728;&#x6307;&#x5B9A; path &#x4E2D;&#x641C;&#x7D22;&#x6307;&#x5B9A;&#x7684; name &#x3002;</p>
<p>&#x8DEF;&#x5F84;&#x662F;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x6709;&#x4E00;&#x7CFB;&#x5217;&#x4EE5;&#x5206;&#x53F7;&#x5206;&#x5272;&#x7684; &#x6A21;&#x677F; &#x6784;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x6A21;&#x677F;&#xFF0C;&#x90FD;&#x4F1A;&#x7528; name &#x66FF;&#x6362;&#x5176;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x95EE;&#x53F7;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#x3002; &#x4E14;&#x5C06;&#x5176;&#x4E2D;&#x7684; sep &#xFF08;&#x9ED8;&#x8BA4;&#x662F;&#x70B9;&#xFF09;&#x66FF;&#x6362;&#x4E3A; rep &#xFF08;&#x9ED8;&#x8BA4;&#x662F;&#x7CFB;&#x7EDF;&#x7684;&#x76EE;&#x5F55;&#x5206;&#x5272;&#x7B26;&#xFF09;&#x3002; &#x7136;&#x540E;&#x5C1D;&#x8BD5;&#x6253;&#x5F00;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x8DEF;&#x5F84;&#x662F;&#x5B57;&#x7B26;&#x4E32;</p>
<pre><code> &quot;./?.lua;./?.lc;/usr/local/?/init.lua&quot;
</code></pre><p>&#x641C;&#x7D22; foo.a&#x3000;&#x8FD9;&#x4E2A;&#x540D;&#x5B57;&#x5C06; &#x4F9D;&#x6B21;&#x5C1D;&#x8BD5;&#x6253;&#x5F00;&#x6587;&#x4EF6; ./foo/a.lua&#x3000;&#xFF0C; ./foo/a.lc&#x3000;&#xFF0C;&#x4EE5;&#x53CA; /usr/local/foo/a/init.lua&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x7B2C;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x7528;&#x8BFB;&#x6A21;&#x5F0F;&#x6253;&#x5F00;&#xFF08;&#x5E76;&#x9A6C;&#x4E0A;&#x5173;&#x95ED;&#x8BE5;&#x6587;&#x4EF6;&#xFF09;&#x7684;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x5B57;&#x3002; &#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#x8FD9;&#x6837;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x8FD4;&#x56DE; nil &#x52A0;&#x4E0A;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002; &#xFF08;&#x8FD9;&#x6761;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x5217;&#x51FA;&#x4E86;&#x6240;&#x6709;&#x5C1D;&#x8BD5;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x3002;&#xFF09;</p>
<h2 id="&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;">&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406; <a href="#&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;"> # </a></h2>
<p>&#x8FD9;&#x4E2A;&#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;&#x7684;&#x901A;&#x7528;&#x51FD;&#x6570;&#x3002; &#x4F8B;&#x5982;&#x5B57;&#x7B26;&#x4E32;&#x67E5;&#x627E;&#x3001;&#x5B50;&#x4E32;&#x3001;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#x7B49;&#x3002; &#x5F53;&#x5728; Lua &#x4E2D;&#x5BF9;&#x5B57;&#x7B26;&#x4E32;&#x505A;&#x7D22;&#x5F15;&#x65F6;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4ECE; 1 &#x5F00;&#x59CB;&#x8BA1;&#x7B97;&#xFF08;&#x800C;&#x4E0D;&#x662F; C &#x91CC;&#x7684; 0 &#xFF09;&#x3002; &#x7D22;&#x5F15;&#x53EF;&#x4EE5;&#x662F;&#x8D1F;&#x6570;&#xFF0C;&#x5B83;&#x6307;&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x672B;&#x5C3E;&#x53CD;&#x5411;&#x89E3;&#x6790;&#x3002; &#x5373;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x5728; -1 &#x4F4D;&#x7F6E;&#x5904;&#xFF0C;&#x7B49;&#x7B49;&#x3002;</p>
<p>&#x5B57;&#x7B26;&#x4E32;&#x5E93;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x5728;&#x8868; string &#x4E2D;&#x3002; &#x5B83;&#x8FD8;&#x5C06;&#x5176;&#x8BBE;&#x7F6E;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x5143;&#x8868;&#x7684; __index &#x57DF;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4EE5;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x5F62;&#x5F0F;&#x4F7F;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x51FD;&#x6570;&#x3002; &#x4F8B;&#x5982;&#xFF0C;string.byte(s,i) &#x53EF;&#x4EE5;&#x5199;&#x6210; s:byte(i)&#x3002;</p>
<p>&#x5B57;&#x7B26;&#x4E32;&#x5E93;&#x5047;&#x5B9A;&#x91C7;&#x7528;&#x5355;&#x5B57;&#x8282;&#x5B57;&#x7B26;&#x7F16;&#x7801;&#x3002;</p>
<p>string.byte (s [, i [, j]])</p>
<p>&#x8FD4;&#x56DE;&#x5B57;&#x7B26; s[i]&#xFF0C; s[i+1]&#xFF0C; ...&#x3000;&#xFF0C;s[j] &#x7684;&#x5185;&#x90E8;&#x6570;&#x5B57;&#x7F16;&#x7801;&#x3002; i &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x662F; 1 &#xFF1B; j &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x662F; i&#x3002; &#x8FD9;&#x4E9B;&#x7D22;&#x5F15;&#x4EE5;&#x51FD;&#x6570; string.sub &#x7684;&#x89C4;&#x5219;&#x4FEE;&#x6B63;&#x3002;
&#x6570;&#x5B57;&#x7F16;&#x7801;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x8DE8;&#x5E73;&#x53F0;&#x3002;</p>
<p>string.char (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x63A5;&#x6536;&#x96F6;&#x6216;&#x66F4;&#x591A;&#x7684;&#x6574;&#x6570;&#x3002; &#x8FD4;&#x56DE;&#x548C;&#x53C2;&#x6570;&#x6570;&#x91CF;&#x76F8;&#x540C;&#x957F;&#x5EA6;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x5185;&#x90E8;&#x7F16;&#x7801;&#x503C;&#x7B49;&#x4E8E;&#x5BF9;&#x5E94;&#x7684;&#x53C2;&#x6570;&#x503C;&#x3002;
&#x6570;&#x5B57;&#x7F16;&#x7801;&#x6CA1;&#x6709;&#x5FC5;&#x8981;&#x8DE8;&#x5E73;&#x53F0;&#x3002;</p>
<p>string.dump (function [, strip])</p>
<p>&#x8FD4;&#x56DE;&#x5305;&#x542B;&#x6709;&#x4EE5;&#x4E8C;&#x8FDB;&#x5236;&#x65B9;&#x5F0F;&#x8868;&#x793A;&#x7684;&#xFF08;&#x4E00;&#x4E2A; &#x4E8C;&#x8FDB;&#x5236;&#x4EE3;&#x7801;&#x5757; &#xFF09;&#x6307;&#x5B9A;&#x51FD;&#x6570;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x7528; load &#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x83B7;&#x5F97; &#x8BE5;&#x51FD;&#x6570;&#x7684;&#x526F;&#x672C;&#xFF08;&#x4F46;&#x662F;&#x7ED1;&#x5B9A;&#x65B0;&#x7684;&#x4E0A;&#x503C;&#xFF09;&#x3002; &#x5982;&#x679C;&#x3000;strip &#x4E3A;&#x771F;&#x503C;&#xFF0C; &#x4E8C;&#x8FDB;&#x5236;&#x4EE3;&#x7801;&#x5757;&#x4E0D;&#x643A;&#x5E26;&#x8BE5;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x8BD5;&#x4FE1;&#x606F; &#xFF08;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x540D;&#xFF0C;&#x884C;&#x53F7;&#xFF0C;&#x7B49;&#x7B49;&#x3002;&#xFF09;&#x3002;</p>
<p>&#x5E26;&#x4E0A;&#x503C;&#x7684;&#x51FD;&#x6570;&#x53EA;&#x4FDD;&#x5B58;&#x4E0A;&#x503C;&#x7684;&#x6570;&#x76EE;&#x3002; &#x5F53;&#xFF08;&#x518D;&#x6B21;&#xFF09;&#x52A0;&#x8F7D;&#x65F6;&#xFF0C;&#x8FD9;&#x4E9B;&#x4E0A;&#x503C;&#x88AB;&#x66F4;&#x65B0;&#x4E3A; nil &#x7684;&#x5B9E;&#x4F8B;&#x3002; &#xFF08;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8C03;&#x8BD5;&#x5E93;&#x6309;&#x4F60;&#x9700;&#x8981;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x5E8F;&#x5217;&#x5316;&#x4E0A;&#x503C;&#xFF0C;&#x5E76;&#x91CD;&#x8F7D;&#x5230;&#x51FD;&#x6570;&#x4E2D;&#xFF09;</p>
<p>string.find (s, pattern [, init [, plain]])</p>
<p>&#x67E5;&#x627E;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32; s &#x4E2D;&#x5339;&#x914D;&#x5230;&#x7684; pattern &#xFF08;&#x53C2;&#x89C1; &#xA7;6.4.1&#xFF09;&#x3002; &#x5982;&#x679C;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x5339;&#x914D;&#xFF0C;find &#x4F1A;&#x8FD4;&#x56DE; s &#x4E2D;&#x5173;&#x4E8E;&#x5B83;&#x8D77;&#x59CB;&#x53CA;&#x7EC8;&#x70B9;&#x4F4D;&#x7F6E;&#x7684;&#x7D22;&#x5F15;&#xFF1B; &#x5426;&#x5219;&#xFF0C;&#x8FD4;&#x56DE; nil&#x3002; &#x7B2C;&#x4E09;&#x4E2A;&#x53EF;&#x9009;&#x6570;&#x5B57;&#x53C2;&#x6570; init &#x6307;&#x660E;&#x4ECE;&#x54EA;&#x91CC;&#x5F00;&#x59CB;&#x641C;&#x7D22;&#xFF1B; &#x9ED8;&#x8BA4;&#x503C;&#x4E3A; 1 &#xFF0C;&#x540C;&#x65F6;&#x53EF;&#x4EE5;&#x662F;&#x8D1F;&#x503C;&#x3002; &#x7B2C;&#x56DB;&#x4E2A;&#x53EF;&#x9009;&#x53C2;&#x6570; plain &#x4E3A; true &#x65F6;&#xFF0C; &#x5173;&#x95ED;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#x673A;&#x5236;&#x3002; &#x6B64;&#x65F6;&#x51FD;&#x6570;&#x4EC5;&#x505A;&#x76F4;&#x63A5;&#x7684; &#x201C;&#x67E5;&#x627E;&#x5B50;&#x4E32;&#x201D;&#x7684;&#x64CD;&#x4F5C;&#xFF0C; &#x800C; pattern &#x4E2D;&#x6CA1;&#x6709;&#x5B57;&#x7B26;&#x88AB;&#x770B;&#x4F5C;&#x9B54;&#x6CD5;&#x5B57;&#x7B26;&#x3002; &#x6CE8;&#x610F;&#xFF0C;&#x5982;&#x679C;&#x7ED9;&#x5B9A;&#x4E86; plain&#x3000;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x5199;&#x4E0A; init &#x3002;</p>
<p>&#x5982;&#x679C;&#x5728;&#x6A21;&#x5F0F;&#x4E2D;&#x5B9A;&#x4E49;&#x4E86;&#x6355;&#x83B7;&#xFF0C;&#x6355;&#x83B7;&#x5230;&#x7684;&#x82E5;&#x5E72;&#x503C;&#x4E5F;&#x4F1A;&#x5728;&#x4E24;&#x4E2A;&#x7D22;&#x5F15;&#x4E4B;&#x540E;&#x8FD4;&#x56DE;&#x3002;</p>
<p>string.format (formatstring, &#xB7;&#xB7;&#xB7;)</p>
<p>&#x8FD4;&#x56DE;&#x4E0D;&#x5B9A;&#x6570;&#x91CF;&#x53C2;&#x6570;&#x7684;&#x683C;&#x5F0F;&#x5316;&#x7248;&#x672C;&#xFF0C; &#x683C;&#x5F0F;&#x5316;&#x4E32;&#x4E3A;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF08;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF09;&#x3002; &#x683C;&#x5F0F;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#x9075;&#x5FAA; ISO C &#x51FD;&#x6570; sprintf &#x7684;&#x89C4;&#x5219;&#x3002; &#x4E0D;&#x540C;&#x70B9;&#x5728;&#x4E8E;&#x9009;&#x9879; *, h, L, l, n, p &#x4E0D;&#x652F;&#x6301;&#xFF0C; &#x53E6;&#x5916;&#x8FD8;&#x589E;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x9009;&#x9879; q&#x3002; q &#x9009;&#x9879;&#x5C06;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x683C;&#x5F0F;&#x5316;&#x4E3A;&#x4E24;&#x4E2A;&#x53CC;&#x5F15;&#x53F7;&#x62EC;&#x8D77;&#xFF0C;&#x5BF9;&#x5185;&#x90E8;&#x5B57;&#x7B26;&#x505A;&#x6070;&#x5F53;&#x7684;&#x8F6C;&#x4E49;&#x5904;&#x7406;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x8BE5;&#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x5B89;&#x5168;&#x7684;&#x88AB; Lua &#x89E3;&#x91CA;&#x5668;&#x8BFB;&#x56DE;&#x6765;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x8C03;&#x7528;</p>
<pre><code> string.format(&apos;%q&apos;, &apos;a string with &quot;quotes&quot; and \n new line&apos;)
</code></pre><p>&#x4F1A;&#x4EA7;&#x751F;&#x5B57;&#x7B26;&#x4E32;&#xFF1A;</p>
<pre><code> &quot;a string with \&quot;quotes\&quot; and \
  new line&quot;
</code></pre><p>&#x9009;&#x9879; A and a &#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#xFF0C; E, e, f, G, and g &#x90FD;&#x671F;&#x5F85;&#x4E00;&#x4E2A;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x5B57;&#x53C2;&#x6570;&#x3002; &#x9009;&#x9879; c, d, i, o, u, X, and x &#x5219;&#x671F;&#x5F85;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#x3002; &#x9009;&#x9879; q &#x671F;&#x5F85;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF1B; &#x9009;&#x9879; s &#x671F;&#x5F85;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x5185;&#x5D4C;&#x96F6;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5982;&#x679C;&#x9009;&#x9879; s &#x5BF9;&#x5E94;&#x7684;&#x53C2;&#x6570;&#x4E0D;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5B83;&#x4F1A;&#x7528;&#x548C; tostring &#x4E00;&#x81F4;&#x7684;&#x89C4;&#x5219;&#x8F6C;&#x6362;&#x6210;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>string.gmatch (s, pattern)</p>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x8FED;&#x4EE3;&#x5668;&#x51FD;&#x6570;&#x3002; &#x6BCF;&#x6B21;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x4F1A;&#x7EE7;&#x7EED;&#x4EE5; pattern &#xFF08;&#x53C2;&#x89C1;&#x3000;&#xA7;6.4.1&#xFF09; &#x5BF9; s &#x505A;&#x5339;&#x914D;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x6240;&#x6709;&#x6355;&#x83B7;&#x5230;&#x7684;&#x503C;&#x3002; &#x5982;&#x679C; pattern &#x4E2D;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x6355;&#x83B7;&#xFF0C;&#x5219;&#x6BCF;&#x6B21;&#x6355;&#x83B7;&#x6574;&#x4E2A; pattern&#x3002;
&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4F1A;&#x5FAA;&#x73AF;&#x8FED;&#x4EE3;&#x5B57;&#x7B26;&#x4E32; s &#x4E2D;&#x6240;&#x6709;&#x7684;&#x5355;&#x8BCD;&#xFF0C; &#x5E76;&#x9010;&#x884C;&#x6253;&#x5370;&#xFF1A;</p>
<pre><code> s = &quot;hello world from Lua&quot;
 for w in string.gmatch(s, &quot;%a+&quot;) do
   print(w)
 end
</code></pre><p>&#x4E0B;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x4ECE;&#x6307;&#x5B9A;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x6536;&#x96C6;&#x6240;&#x6709;&#x7684;&#x952E;&#x503C;&#x5BF9; key=value &#x7F6E;&#x5165;&#x4E00;&#x5F20;&#x8868;&#xFF1A;</p>
<pre><code> t = {}
 s = &quot;from=world, to=Lua&quot;
 for k, v in string.gmatch(s, &quot;(%w+)=(%w+)&quot;) do
   t[k] = v
 end
</code></pre><p>&#x5BF9;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x8BF4;&#xFF0C;&#x6A21;&#x677F;&#x524D;&#x5F00;&#x59CB;&#x7684; &apos;^&apos; &#x4E0D;&#x4F1A;&#x5F53;&#x6210;&#x951A;&#x70B9;&#x3002;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x4F1A;&#x963B;&#x6B62;&#x8FED;&#x4EE3;&#x3002;</p>
<p>string.gsub (s, pattern, repl [, n])</p>
<p>&#x5C06;&#x5B57;&#x7B26;&#x4E32; s &#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x7684;&#xFF08;&#x6216;&#x662F;&#x5728; n &#x7ED9;&#x51FA;&#x65F6;&#x7684;&#x524D; n &#x4E2A;&#xFF09; pattern &#xFF08;&#x53C2;&#x89C1; &#xA7;6.4.1&#xFF09;&#x90FD;&#x66FF;&#x6362;&#x6210; repl &#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x5176;&#x526F;&#x672C;&#x3002; repl &#x53EF;&#x4EE5;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x3001;&#x8868;&#x3001;&#x6216;&#x51FD;&#x6570;&#x3002; gsub &#x8FD8;&#x4F1A;&#x5728;&#x7B2C;&#x4E8C;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x8FD4;&#x56DE;&#x4E00;&#x5171;&#x53D1;&#x751F;&#x4E86;&#x591A;&#x5C11;&#x6B21;&#x5339;&#x914D;&#x3002; gsub &#x8FD9;&#x4E2A;&#x540D;&#x5B57;&#x6765;&#x6E90;&#x4E8E; Global SUBstitution &#x3002;
&#x5982;&#x679C; repl &#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x90A3;&#x4E48;&#x628A;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x4F5C;&#x4E3A;&#x66FF;&#x6362;&#x54C1;&#x3002; &#x5B57;&#x7B26; % &#x662F;&#x4E00;&#x4E2A;&#x8F6C;&#x4E49;&#x7B26;&#xFF1A; repl &#x4E2D;&#x7684;&#x6240;&#x6709;&#x5F62;&#x5F0F;&#x4E3A; %d &#x7684;&#x4E32;&#x8868;&#x793A; &#x7B2C; d &#x4E2A;&#x6355;&#x83B7;&#x5230;&#x7684;&#x5B50;&#x4E32;&#xFF0C;d &#x53EF;&#x4EE5;&#x662F; 1 &#x5230; 9 &#x3002; &#x4E32; %0 &#x8868;&#x793A;&#x6574;&#x4E2A;&#x5339;&#x914D;&#x3002; &#x4E32; %% &#x8868;&#x793A;&#x5355;&#x4E2A; %&#x3002;</p>
<p>&#x5982;&#x679C; repl &#x662F;&#x5F20;&#x8868;&#xFF0C;&#x6BCF;&#x6B21;&#x5339;&#x914D;&#x65F6;&#x90FD;&#x4F1A;&#x7528;&#x7B2C;&#x4E00;&#x4E2A;&#x6355;&#x83B7;&#x7269;&#x4F5C;&#x4E3A;&#x952E;&#x53BB;&#x67E5;&#x8FD9;&#x5F20;&#x8868;&#x3002;</p>
<p>&#x5982;&#x679C; repl &#x662F;&#x4E2A;&#x51FD;&#x6570;&#xFF0C;&#x5219;&#x5728;&#x6BCF;&#x6B21;&#x5339;&#x914D;&#x53D1;&#x751F;&#x65F6;&#x90FD;&#x4F1A;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002; &#x6240;&#x6709;&#x6355;&#x83B7;&#x5230;&#x7684;&#x5B50;&#x4E32;&#x4F9D;&#x6B21;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#x4F20;&#x5165;&#x3002;</p>
<p>&#x4EFB;&#x4F55;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6A21;&#x677F;&#x4E2D;&#x6CA1;&#x6709;&#x8BBE;&#x5B9A;&#x6355;&#x83B7;&#x90FD;&#x770B;&#x6210;&#x662F;&#x6355;&#x83B7;&#x6574;&#x4E2A;&#x6A21;&#x677F;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8868;&#x7684;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x6216;&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x662F;&#x4E2A;&#x6570;&#x5B57;&#xFF0C; &#x90FD;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x66FF;&#x6362;&#x7528;&#x4E32;&#xFF1B; &#x800C;&#x5728;&#x8FD4;&#x56DE; false &#x6216; nil&#x3000;&#x65F6;&#x4E0D;&#x4F5C;&#x66FF;&#x6362; &#xFF08;&#x5373;&#x4FDD;&#x7559;&#x5339;&#x914D;&#x524D;&#x7684;&#x539F;&#x59CB;&#x4E32;&#xFF09;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x6709;&#x4E00;&#x4E9B;&#x7528;&#x4F8B;&#xFF1A;</p>
<pre><code> x = string.gsub(&quot;hello world&quot;, &quot;(%w+)&quot;, &quot;%1 %1&quot;)
 --&gt; x=&quot;hello hello world world&quot;

 x = string.gsub(&quot;hello world&quot;, &quot;%w+&quot;, &quot;%0 %0&quot;, 1)
 --&gt; x=&quot;hello hello world&quot;

 x = string.gsub(&quot;hello world from Lua&quot;, &quot;(%w+)%s*(%w+)&quot;, &quot;%2 %1&quot;)
 --&gt; x=&quot;world hello Lua from&quot;

 x = string.gsub(&quot;home = $HOME, user = $USER&quot;, &quot;%$(%w+)&quot;, os.getenv)
 --&gt; x=&quot;home = /home/roberto, user = roberto&quot;

 x = string.gsub(&quot;4+5 = $return 4+5$&quot;, &quot;%$(.-)%$&quot;, function (s)
       return load(s)()
     end)
 --&gt; x=&quot;4+5 = 9&quot;

 local t = {name=&quot;lua&quot;, version=&quot;5.3&quot;}
 x = string.gsub(&quot;$name-$version.tar.gz&quot;, &quot;%$(%w+)&quot;, t)
 --&gt; x=&quot;lua-5.3.tar.gz&quot;
</code></pre><p>string.len (s)</p>
<p>&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x8FD4;&#x56DE;&#x5176;&#x957F;&#x5EA6;&#x3002; &#x7A7A;&#x4E32; &quot;&quot; &#x7684;&#x957F;&#x5EA6;&#x4E3A; 0 &#x3002; &#x5185;&#x5D4C;&#x96F6;&#x4E5F;&#x7EDF;&#x8BA1;&#x5728;&#x5185;&#xFF0C;&#x56E0;&#x6B64; &quot;a\000bc\000&quot; &#x7684;&#x957F;&#x5EA6;&#x4E3A; 5 &#x3002;
string.lower (s)</p>
<p>&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5C06;&#x5176;&#x4E2D;&#x7684;&#x5927;&#x5199;&#x5B57;&#x7B26;&#x90FD;&#x8F6C;&#x4E3A;&#x5C0F;&#x5199;&#x540E;&#x8FD4;&#x56DE;&#x5176;&#x526F;&#x672C;&#x3002; &#x5176;&#x5B83;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E0D;&#x4F1A;&#x66F4;&#x6539;&#x3002; &#x5BF9;&#x5927;&#x5199;&#x5B57;&#x7B26;&#x7684;&#x5B9A;&#x4E49;&#x53D6;&#x51B3;&#x4E8E;&#x5F53;&#x524D;&#x7684;&#x533A;&#x57DF;&#x8BBE;&#x7F6E;&#x3002;
string.match (s, pattern [, init])</p>
<p>&#x5728;&#x5B57;&#x7B26;&#x4E32; s &#x4E2D;&#x627E;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;&#x80FD;&#x7528; pattern &#xFF08;&#x53C2;&#x89C1; &#xA7;6.4.1&#xFF09;&#x5339;&#x914D;&#x5230;&#x7684;&#x90E8;&#x5206;&#x3002; &#x5982;&#x679C;&#x80FD;&#x627E;&#x5230;&#xFF0C;match &#x8FD4;&#x56DE;&#x5176;&#x4E2D;&#x7684;&#x6355;&#x83B7;&#x7269;&#xFF1B; &#x5426;&#x5219;&#x8FD4;&#x56DE; nil &#x3002; &#x5982;&#x679C; pattern &#x4E2D;&#x672A;&#x6307;&#x5B9A;&#x6355;&#x83B7;&#xFF0C; &#x8FD4;&#x56DE;&#x6574;&#x4E2A; pattern &#x6355;&#x83B7;&#x5230;&#x7684;&#x4E32;&#x3002; &#x7B2C;&#x4E09;&#x4E2A;&#x53EF;&#x9009;&#x6570;&#x5B57;&#x53C2;&#x6570; init &#x6307;&#x660E;&#x4ECE;&#x54EA;&#x91CC;&#x5F00;&#x59CB;&#x641C;&#x7D22;&#xFF1B; &#x5B83;&#x9ED8;&#x8BA4;&#x4E3A; 1 &#x4E14;&#x53EF;&#x4EE5;&#x662F;&#x8D1F;&#x6570;&#x3002;
string.pack (fmt, v1, v2, &#xB7;&#xB7;&#xB7;)</p>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6253;&#x5305;&#x4E86;&#xFF08;&#x5373;&#x4EE5;&#x4E8C;&#x8FDB;&#x5236;&#x5F62;&#x5F0F;&#x5E8F;&#x5217;&#x5316;&#xFF09; v1, v2 &#x7B49;&#x503C;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5B57;&#x7B26;&#x4E32; fmt &#x4E3A;&#x6253;&#x5305;&#x683C;&#x5F0F;&#xFF08;&#x53C2;&#x89C1; &#xA7;6.4.2&#xFF09;&#x3002;</p>
<p>string.packsize (fmt)</p>
<p>&#x8FD4;&#x56DE;&#x4EE5;&#x6307;&#x5B9A;&#x683C;&#x5F0F;&#x7528; string.pack &#x6253;&#x5305;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#x3002; &#x683C;&#x5F0F;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x4E0D;&#x53EF;&#x4EE5;&#x6709;&#x53D8;&#x957F;&#x9009;&#x9879; &apos;s&apos; &#x6216; &apos;z&apos; &#xFF08;&#x53C2;&#x89C1; &#xA7;6.4.2&#xFF09;&#x3002;</p>
<p>string.rep (s, n [, sep])</p>
<p>&#x8FD4;&#x56DE; n &#x4E2A;&#x5B57;&#x7B26;&#x4E32; s &#x4EE5;&#x5B57;&#x7B26;&#x4E32; sep &#x4E3A;&#x5206;&#x5272;&#x7B26;&#x8FDE;&#x5728;&#x4E00;&#x8D77;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x9ED8;&#x8BA4;&#x7684; sep &#x503C;&#x4E3A;&#x7A7A;&#x5B57;&#x7B26;&#x4E32;&#xFF08;&#x5373;&#x6CA1;&#x6709;&#x5206;&#x5272;&#x7B26;&#xFF09;&#x3002; &#x5982;&#x679C; n &#x4E0D;&#x662F;&#x6B63;&#x6570;&#x5219;&#x8FD4;&#x56DE;&#x7A7A;&#x4E32;&#x3002;
string.reverse (s)</p>
<p>&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x4E32; s &#x7684;&#x7FFB;&#x8F6C;&#x4E32;&#x3002;
string.sub (s, i [, j])</p>
<p>&#x8FD4;&#x56DE; s &#x7684;&#x5B50;&#x4E32;&#xFF0C; &#x8BE5;&#x5B50;&#x4E32;&#x4ECE; i &#x5F00;&#x59CB;&#x5230; j &#x4E3A;&#x6B62;&#xFF1B; i &#x548C; j &#x90FD;&#x53EF;&#x4EE5;&#x4E3A;&#x8D1F;&#x6570;&#x3002; &#x5982;&#x679C;&#x4E0D;&#x7ED9;&#x51FA; j &#xFF0C;&#x5C31;&#x5F53;&#x5B83;&#x662F; -1 &#xFF08;&#x548C;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x76F8;&#x540C;&#xFF09;&#x3002; &#x7279;&#x522B;&#x662F;&#xFF0C; &#x8C03;&#x7528; string.sub(s,1,j) &#x53EF;&#x4EE5;&#x8FD4;&#x56DE; s &#x7684;&#x957F;&#x5EA6;&#x4E3A; j &#x7684;&#x524D;&#x7F00;&#x4E32;&#xFF0C; &#x800C; string.sub(s, -i) &#x8FD4;&#x56DE;&#x957F;&#x5EA6;&#x4E3A; i &#x7684;&#x540E;&#x7F00;&#x4E32;&#x3002;
&#x5982;&#x679C;&#x5728;&#x5BF9;&#x8D1F;&#x6570;&#x7D22;&#x5F15;&#x8F6C;&#x4E49;&#x540E; i &#x5C0F;&#x4E8E; 1 &#x7684;&#x8BDD;&#xFF0C;&#x5C31;&#x4FEE;&#x6B63;&#x56DE; 1 &#x3002; &#x5982;&#x679C; j &#x6BD4;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x957F;&#x5EA6;&#x8FD8;&#x5927;&#xFF0C;&#x5C31;&#x4FEE;&#x6B63;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x3002; &#x5982;&#x679C;&#x5728;&#x4FEE;&#x6B63;&#x4E4B;&#x540E;&#xFF0C;i &#x5927;&#x4E8E; j&#xFF0C; &#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x7A7A;&#x4E32;&#x3002;</p>
<p>string.unpack (fmt, s [, pos])</p>
<p>&#x8FD4;&#x56DE;&#x4EE5;&#x683C;&#x5F0F; fmt &#xFF08;&#x53C2;&#x89C1; &#xA7;6.4.2&#xFF09; &#x6253;&#x5305;&#x5728;&#x5B57;&#x7B26;&#x4E32; s &#xFF08;&#x53C2;&#x89C1; string.pack&#xFF09; &#x4E2D;&#x7684;&#x503C;&#x3002; &#x9009;&#x9879; pos&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A; 1 &#xFF09;&#x6807;&#x8BB0;&#x4E86;&#x4ECE; s &#x4E2D;&#x54EA;&#x91CC;&#x5F00;&#x59CB;&#x8BFB;&#x8D77;&#x3002; &#x8BFB;&#x5B8C;&#x6240;&#x6709;&#x7684;&#x503C;&#x540E;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE; s &#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x672A;&#x8BFB;&#x5B57;&#x8282;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>string.upper (s)</p>
<p>&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5C06;&#x5176;&#x4E2D;&#x7684;&#x5C0F;&#x5199;&#x5B57;&#x7B26;&#x90FD;&#x8F6C;&#x4E3A;&#x5927;&#x5199;&#x540E;&#x8FD4;&#x56DE;&#x5176;&#x526F;&#x672C;&#x3002; &#x5176;&#x5B83;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E0D;&#x4F1A;&#x66F4;&#x6539;&#x3002; &#x5BF9;&#x5C0F;&#x5199;&#x5B57;&#x7B26;&#x7684;&#x5B9A;&#x4E49;&#x53D6;&#x51B3;&#x4E8E;&#x5F53;&#x524D;&#x7684;&#x533A;&#x57DF;&#x8BBE;&#x7F6E;&#x3002;</p>
<h3 id="&#x5339;&#x914D;&#x6A21;&#x5F0F;">&#x5339;&#x914D;&#x6A21;&#x5F0F; <a href="#&#x5339;&#x914D;&#x6A21;&#x5F0F;"> # </a></h3>
<p>Lua &#x4E2D;&#x7684;&#x5339;&#x914D;&#x6A21;&#x5F0F;&#x76F4;&#x63A5;&#x7528;&#x5E38;&#x89C4;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6765;&#x63CF;&#x8FF0;&#x3002; &#x5B83;&#x7528;&#x4E8E;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#x51FD;&#x6570; string.find, string.gmatch, string.gsub, string.match&#x3002; &#x8FD9;&#x4E00;&#x8282;&#x8868;&#x8FF0;&#x4E86;&#x8FD9;&#x4E9B;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x8BED;&#x6CD5;&#x53CA;&#x542B;&#x4E49;&#xFF08;&#x5373;&#x5B83;&#x80FD;&#x5339;&#x914D;&#x5230;&#x4EC0;&#x4E48;&#xFF09;&#x3002;</p>
<p>&#x5B57;&#x7B26;&#x7C7B;&#xFF1A;</p>
<p>&#x5B57;&#x7B26;&#x7C7B; &#x7528;&#x4E8E;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x96C6;&#x5408;&#x3002; &#x4E0B;&#x5217;&#x7EC4;&#x5408;&#x53EF;&#x7528;&#x4E8E;&#x5B57;&#x7B26;&#x7C7B;&#xFF1A;</p>
<p>x: &#xFF08;&#x8FD9;&#x91CC; x &#x4E0D;&#x80FD;&#x662F; &#x9B54;&#x6CD5;&#x5B57;&#x7B26; ^$()%.[]*+-? &#x4E2D;&#x7684;&#x4E00;&#x5458;&#xFF09; &#x8868;&#x793A;&#x5B57;&#x7B26; x &#x81EA;&#x8EAB;&#x3002;
.: &#xFF08;&#x4E00;&#x4E2A;&#x70B9;&#xFF09;&#x53EF;&#x8868;&#x793A;&#x4EFB;&#x4F55;&#x5B57;&#x7B26;&#x3002;
%a: &#x8868;&#x793A;&#x4EFB;&#x4F55;&#x5B57;&#x6BCD;&#x3002;
%c: &#x8868;&#x793A;&#x4EFB;&#x4F55;&#x63A7;&#x5236;&#x5B57;&#x7B26;&#x3002;
%d: &#x8868;&#x793A;&#x4EFB;&#x4F55;&#x6570;&#x5B57;&#x3002;
%g: &#x8868;&#x793A;&#x4EFB;&#x4F55;&#x9664;&#x7A7A;&#x767D;&#x7B26;&#x5916;&#x7684;&#x53EF;&#x6253;&#x5370;&#x5B57;&#x7B26;&#x3002;
%l: &#x8868;&#x793A;&#x6240;&#x6709;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x3002;
%p: &#x8868;&#x793A;&#x6240;&#x6709;&#x6807;&#x70B9;&#x7B26;&#x53F7;&#x3002;
%s: &#x8868;&#x793A;&#x6240;&#x6709;&#x7A7A;&#x767D;&#x5B57;&#x7B26;&#x3002;
%u: &#x8868;&#x793A;&#x6240;&#x6709;&#x5927;&#x5199;&#x5B57;&#x6BCD;&#x3002;
%w: &#x8868;&#x793A;&#x6240;&#x6709;&#x5B57;&#x6BCD;&#x53CA;&#x6570;&#x5B57;&#x3002;
%x: &#x8868;&#x793A;&#x6240;&#x6709; 16 &#x8FDB;&#x5236;&#x6570;&#x5B57;&#x7B26;&#x53F7;&#x3002;
%x: &#xFF08;&#x8FD9;&#x91CC;&#x7684; x &#x662F;&#x4EFB;&#x610F;&#x975E;&#x5B57;&#x6BCD;&#x6216;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26;&#xFF09; &#x8868;&#x793A;&#x5B57;&#x7B26; x&#x3002; &#x8FD9;&#x662F;&#x5BF9;&#x9B54;&#x6CD5;&#x5B57;&#x7B26;&#x8F6C;&#x4E49;&#x7684;&#x6807;&#x51C6;&#x65B9;&#x6CD5;&#x3002; &#x6240;&#x6709;&#x975E;&#x5B57;&#x6BCD;&#x6216;&#x6570;&#x5B57;&#x7684;&#x5B57;&#x7B26; &#xFF08;&#x5305;&#x62EC;&#x6240;&#x6709;&#x6807;&#x70B9;&#xFF0C;&#x4E5F;&#x5305;&#x62EC;&#x975E;&#x9B54;&#x6CD5;&#x5B57;&#x7B26;&#xFF09; &#x90FD;&#x53EF;&#x4EE5;&#x7528;&#x524D;&#x7F6E;&#x4E00;&#x4E2A; &apos;%&apos; &#x653E;&#x5728;&#x6A21;&#x5F0F;&#x4E32;&#x4E2D;&#x8868;&#x793A;&#x81EA;&#x8EAB;&#x3002;
[set]: &#x8868;&#x793A; set&#x3000;&#x4E2D;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x7684;&#x8054;&#x5408;&#x3002; &#x53EF;&#x4EE5;&#x4EE5; &apos;-&apos; &#x8FDE;&#x63A5;&#xFF0C;&#x5347;&#x5E8F;&#x4E66;&#x5199;&#x8303;&#x56F4;&#x4E24;&#x7AEF;&#x7684;&#x5B57;&#x7B26;&#x6765;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x8303;&#x56F4;&#x7684;&#x5B57;&#x7B26;&#x96C6;&#x3002; &#x4E0A;&#x9762;&#x63D0;&#x5230;&#x7684; %x &#x5F62;&#x5F0F;&#x4E5F;&#x53EF;&#x4EE5;&#x5728; set &#x4E2D;&#x4F7F;&#x7528; &#x8868;&#x793A;&#x5176;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002; &#x5176;&#x5B83;&#x51FA;&#x73B0;&#x5728; set &#x4E2D;&#x7684;&#x5B57;&#x7B26;&#x5219;&#x4EE3;&#x8868;&#x5B83;&#x4EEC;&#x81EA;&#x5DF1;&#x3002; &#x4F8B;&#x5982;&#xFF0C;[%w<em>] &#xFF08;&#x6216; [</em>%w]&#xFF09; &#x8868;&#x793A;&#x6240;&#x6709;&#x7684;&#x5B57;&#x6BCD;&#x6570;&#x5B57;&#x52A0;&#x4E0B;&#x5212;&#x7EBF;&#xFF09;&#xFF0C; [0-7] &#x8868;&#x793A; 8 &#x8FDB;&#x5236;&#x6570;&#x5B57;&#xFF0C; [0-7%l%-]&#x3000;&#x8868;&#x793A; 8 &#x8FDB;&#x5236;&#x6570;&#x5B57;&#x52A0;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x4E0E; &apos;-&apos; &#x5B57;&#x7B26;&#x3002;
&#x4EA4;&#x53C9;&#x4F7F;&#x7528;&#x7C7B;&#x548C;&#x8303;&#x56F4;&#x7684;&#x884C;&#x4E3A;&#x672A;&#x5B9A;&#x4E49;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x50CF; [%a-z] &#x6216; [a-%%] &#x8FD9;&#x6837;&#x7684;&#x6A21;&#x5F0F;&#x4E32;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x3002;</p>
<p>[^set]: &#x8868;&#x793A; set &#x7684;&#x8865;&#x96C6;&#xFF0C; &#x5176;&#x4E2D; set &#x5982;&#x4E0A;&#x9762;&#x7684;&#x89E3;&#x91CA;&#x3002;
&#x6240;&#x6709;&#x5355;&#x4E2A;&#x5B57;&#x6BCD;&#x8868;&#x793A;&#x7684;&#x7C7B;&#x522B;&#xFF08;%a&#xFF0C;%c&#xFF0C;&#x7B49;&#xFF09;&#xFF0C; &#x82E5;&#x5C06;&#x5176;&#x5B57;&#x6BCD;&#x6539;&#x4E3A;&#x5927;&#x5199;&#xFF0C;&#x5747;&#x8868;&#x793A;&#x5BF9;&#x5E94;&#x7684;&#x8865;&#x96C6;&#x3002; &#x4F8B;&#x5982;&#xFF0C;%S &#x8868;&#x793A;&#x6240;&#x6709;&#x975E;&#x7A7A;&#x683C;&#x7684;&#x5B57;&#x7B26;&#x3002;</p>
<p>&#x5982;&#x4F55;&#x5B9A;&#x4E49;&#x5B57;&#x6BCD;&#x3001;&#x7A7A;&#x683C;&#x3001;&#x6216;&#x662F;&#x5176;&#x4ED6;&#x5B57;&#x7B26;&#x7EC4;&#x53D6;&#x51B3;&#x4E8E;&#x5F53;&#x524D;&#x7684;&#x533A;&#x57DF;&#x8BBE;&#x7F6E;&#x3002; &#x7279;&#x522B;&#x6CE8;&#x610F;&#xFF1A;[a-z]&#x3000;&#x672A;&#x5FC5;&#x7B49;&#x4EF7;&#x4E8E; %l &#x3002;</p>
<p>&#x6A21;&#x5F0F;&#x6761;&#x76EE;&#xFF1A;</p>
<p>&#x6A21;&#x5F0F;&#x6761;&#x76EE; &#x53EF;&#x4EE5;&#x662F;</p>
<p>&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x7C7B;&#x5339;&#x914D;&#x8BE5;&#x7C7B;&#x522B;&#x4E2D;&#x4EFB;&#x610F;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#xFF1B;
&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x7C7B;&#x8DDF;&#x4E00;&#x4E2A; &apos;<em>&apos;&#xFF0C; &#x5C06;&#x5339;&#x914D;&#x96F6;&#x6216;&#x591A;&#x4E2A;&#x8BE5;&#x7C7B;&#x7684;&#x5B57;&#x7B26;&#x3002; &#x8FD9;&#x4E2A;&#x6761;&#x76EE;&#x603B;&#x662F;&#x5339;&#x914D;&#x5C3D;&#x53EF;&#x80FD;&#x957F;&#x7684;&#x4E32;&#xFF1B;
&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x7C7B;&#x8DDF;&#x4E00;&#x4E2A; &apos;+&apos;&#xFF0C; &#x5C06;&#x5339;&#x914D;&#x4E00;&#x6216;&#x66F4;&#x591A;&#x4E2A;&#x8BE5;&#x7C7B;&#x7684;&#x5B57;&#x7B26;&#x3002; &#x8FD9;&#x4E2A;&#x6761;&#x76EE;&#x603B;&#x662F;&#x5339;&#x914D;&#x5C3D;&#x53EF;&#x80FD;&#x957F;&#x7684;&#x4E32;&#xFF1B;
&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x7C7B;&#x8DDF;&#x4E00;&#x4E2A; &apos;-&apos;&#xFF0C; &#x5C06;&#x5339;&#x914D;&#x96F6;&#x6216;&#x66F4;&#x591A;&#x4E2A;&#x8BE5;&#x7C7B;&#x7684;&#x5B57;&#x7B26;&#x3002; &#x548C; &apos;</em>&apos; &#x4E0D;&#x540C;&#xFF0C; &#x8FD9;&#x4E2A;&#x6761;&#x76EE;&#x603B;&#x662F;&#x5339;&#x914D;&#x5C3D;&#x53EF;&#x80FD;&#x77ED;&#x7684;&#x4E32;&#xFF1B;
&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x7C7B;&#x8DDF;&#x4E00;&#x4E2A; &apos;?&apos;&#xFF0C; &#x5C06;&#x5339;&#x914D;&#x96F6;&#x6216;&#x4E00;&#x4E2A;&#x8BE5;&#x7C7B;&#x7684;&#x5B57;&#x7B26;&#x3002; &#x53EA;&#x8981;&#x6709;&#x53EF;&#x80FD;&#xFF0C;&#x5B83;&#x4F1A;&#x5339;&#x914D;&#x4E00;&#x4E2A;&#xFF1B;
%n&#xFF0C; &#x8FD9;&#x91CC;&#x7684; n &#x53EF;&#x4EE5;&#x4ECE; 1 &#x5230; 9&#xFF1B; &#x8FD9;&#x4E2A;&#x6761;&#x76EE;&#x5339;&#x914D;&#x4E00;&#x4E2A;&#x7B49;&#x4E8E; n &#x53F7;&#x6355;&#x83B7;&#x7269;&#xFF08;&#x540E;&#x9762;&#x6709;&#x63CF;&#x8FF0;&#xFF09;&#x7684;&#x5B50;&#x4E32;&#x3002;
%bxy&#xFF0C; &#x8FD9;&#x91CC;&#x7684; x &#x548C; y &#x662F;&#x4E24;&#x4E2A;&#x660E;&#x786E;&#x7684;&#x5B57;&#x7B26;&#xFF1B; &#x8FD9;&#x4E2A;&#x6761;&#x76EE;&#x5339;&#x914D;&#x4EE5; x &#x5F00;&#x59CB; y &#x7ED3;&#x675F;&#xFF0C; &#x4E14;&#x5176;&#x4E2D; x &#x548C; y &#x4FDD;&#x6301; &#x5E73;&#x8861; &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x610F;&#x601D;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x4ECE;&#x5DE6;&#x5230;&#x53F3;&#x8BFB;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5BF9;&#x6BCF;&#x6B21;&#x8BFB;&#x5230;&#x4E00;&#x4E2A; x &#x5C31; +1 &#xFF0C;&#x8BFB;&#x5230;&#x4E00;&#x4E2A; y &#x5C31; -1&#xFF0C; &#x6700;&#x7EC8;&#x7ED3;&#x675F;&#x5904;&#x7684;&#x90A3;&#x4E2A; y &#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x8BB0;&#x6570;&#x5230; 0 &#x7684; y&#x3002; &#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x6761;&#x76EE; %b() &#x53EF;&#x4EE5;&#x5339;&#x914D;&#x5230;&#x62EC;&#x53F7;&#x5E73;&#x8861;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x3002;
%f[set]&#xFF0C; &#x6307; &#x8FB9;&#x5883;&#x6A21;&#x5F0F;&#xFF1B; &#x8FD9;&#x4E2A;&#x6761;&#x76EE;&#x4F1A;&#x5339;&#x914D;&#x5230;&#x4E00;&#x4E2A;&#x4F4D;&#x4E8E; set &#x5185;&#x67D0;&#x4E2A;&#x5B57;&#x7B26;&#x4E4B;&#x524D;&#x7684;&#x4E00;&#x4E2A;&#x7A7A;&#x4E32;&#xFF0C; &#x4E14;&#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x7684;&#x524D;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E0D;&#x5C5E;&#x4E8E; set &#x3002; &#x96C6;&#x5408; set &#x7684;&#x542B;&#x4E49;&#x5982;&#x524D;&#x9762;&#x6240;&#x8FF0;&#x3002; &#x5339;&#x914D;&#x51FA;&#x7684;&#x90A3;&#x4E2A;&#x7A7A;&#x4E32;&#x4E4B;&#x5F00;&#x59CB;&#x548C;&#x7ED3;&#x675F;&#x70B9;&#x7684;&#x8BA1;&#x7B97;&#x5C31;&#x770B;&#x6210;&#x8BE5;&#x5904;&#x6709;&#x4E2A;&#x5B57;&#x7B26; &apos;\0&apos; &#x4E00;&#x6837;&#x3002;
&#x6A21;&#x5F0F;&#xFF1A;</p>
<p>&#x6A21;&#x5F0F; &#x6307;&#x4E00;&#x4E2A;&#x6A21;&#x5F0F;&#x6761;&#x76EE;&#x7684;&#x5E8F;&#x5217;&#x3002; &#x5728;&#x6A21;&#x5F0F;&#x6700;&#x524D;&#x9762;&#x52A0;&#x4E0A;&#x7B26;&#x53F7; &apos;^&apos; &#x5C06;&#x951A;&#x5B9A;&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5F00;&#x59CB;&#x5904;&#x505A;&#x5339;&#x914D;&#x3002; &#x5728;&#x6A21;&#x5F0F;&#x6700;&#x540E;&#x9762;&#x52A0;&#x4E0A;&#x7B26;&#x53F7; &apos;$&apos; &#x5C06;&#x4F7F;&#x5339;&#x914D;&#x8FC7;&#x7A0B;&#x951A;&#x5B9A;&#x5230;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x7ED3;&#x5C3E;&#x3002; &#x5982;&#x679C; &apos;^&apos; &#x548C; &apos;$&apos; &#x51FA;&#x73B0;&#x5728;&#x5176;&#x5B83;&#x4F4D;&#x7F6E;&#xFF0C;&#x5B83;&#x4EEC;&#x5747;&#x6CA1;&#x6709;&#x7279;&#x6B8A;&#x542B;&#x4E49;&#xFF0C;&#x53EA;&#x8868;&#x793A;&#x81EA;&#x8EAB;&#x3002;</p>
<p>&#x6355;&#x83B7;&#xFF1A;</p>
<p>&#x6A21;&#x5F0F;&#x53EF;&#x4EE5;&#x5728;&#x5185;&#x90E8;&#x7528;&#x5C0F;&#x62EC;&#x53F7;&#x62EC;&#x8D77;&#x4E00;&#x4E2A;&#x5B50;&#x6A21;&#x5F0F;&#xFF1B; &#x8FD9;&#x4E9B;&#x5B50;&#x6A21;&#x5F0F;&#x88AB;&#x79F0;&#x4E3A; &#x6355;&#x83B7;&#x7269;&#x3002; &#x5F53;&#x5339;&#x914D;&#x6210;&#x529F;&#x65F6;&#xFF0C;&#x7531; &#x6355;&#x83B7;&#x7269; &#x5339;&#x914D;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x7684;&#x5B50;&#x4E32;&#x88AB;&#x4FDD;&#x5B58;&#x8D77;&#x6765;&#x7528;&#x4E8E;&#x672A;&#x6765;&#x7684;&#x7528;&#x9014;&#x3002; &#x6355;&#x83B7;&#x7269;&#x4EE5;&#x5B83;&#x4EEC;&#x5DE6;&#x62EC;&#x53F7;&#x7684;&#x6B21;&#x5E8F;&#x6765;&#x7F16;&#x53F7;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x6A21;&#x5F0F; &quot;(a<em>(.)%w(%s</em>))&quot; &#xFF0C; &#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x5339;&#x914D;&#x5230; &quot;a<em>(.)%w(%s</em>)&quot; &#x7684;&#x90E8;&#x5206;&#x4FDD;&#x5B58;&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x6355;&#x83B7;&#x7269;&#x4E2D; &#xFF08;&#x56E0;&#x6B64;&#x662F;&#x7F16;&#x53F7; 1 &#xFF09;&#xFF1B; &#x7531; &quot;.&quot; &#x5339;&#x914D;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x662F; 2 &#x53F7;&#x6355;&#x83B7;&#x7269;&#xFF0C; &#x5339;&#x914D;&#x5230; &quot;%s*&quot; &#x7684;&#x90A3;&#x90E8;&#x5206;&#x662F; 3 &#x53F7;&#x3002;</p>
<p>&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x7279;&#x4F8B;&#xFF0C;&#x7A7A;&#x7684;&#x6355;&#x83B7; () &#x5C06;&#x6355;&#x83B7;&#x5230;&#x5F53;&#x524D;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x4F4D;&#x7F6E;&#xFF08;&#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF09;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x6A21;&#x5F0F; &quot;()aa()&quot; &#x4F5C;&#x7528;&#x5230;&#x5B57;&#x7B26;&#x4E32; &quot;flaaap&quot; &#x4E0A;&#xFF0C;&#x5C06;&#x4EA7;&#x751F;&#x4E24;&#x4E2A;&#x6355;&#x83B7;&#x7269;&#xFF1A; 3 &#x548C; 5 &#x3002;</p>
<h3 id="&#x6253;&#x5305;&#x548C;&#x89E3;&#x5305;&#x7528;&#x5230;&#x7684;&#x683C;&#x5F0F;&#x4E32;">&#x6253;&#x5305;&#x548C;&#x89E3;&#x5305;&#x7528;&#x5230;&#x7684;&#x683C;&#x5F0F;&#x4E32; <a href="#&#x6253;&#x5305;&#x548C;&#x89E3;&#x5305;&#x7528;&#x5230;&#x7684;&#x683C;&#x5F0F;&#x4E32;"> # </a></h3>
<p>&#x7528;&#x4E8E; string.pack&#xFF0C; string.packsize&#xFF0C; string.unpack &#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x3002; &#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x63CF;&#x8FF0;&#x4E86;&#x9700;&#x8981;&#x521B;&#x5EFA;&#x6216;&#x8BFB;&#x53D6;&#x7684;&#x7ED3;&#x6784;&#x4E4B;&#x5E03;&#x5C40;&#x3002;</p>
<p>&#x683C;&#x5F0F;&#x4E32;&#x662F;&#x7531;&#x8F6C;&#x6362;&#x9009;&#x9879;&#x6784;&#x6210;&#x7684;&#x5E8F;&#x5217;&#x3002; &#x8FD9;&#x4E9B;&#x8F6C;&#x6362;&#x9009;&#x9879;&#x5217;&#x5728;&#x540E;&#x9762;&#xFF1A;</p>
<p>&lt;: &#x8BBE;&#x4E3A;&#x5C0F;&#x7AEF;&#x7F16;&#x7801;</p>
<blockquote>
<p>: &#x8BBE;&#x4E3A;&#x5927;&#x7AEF;&#x7F16;&#x7801;
=: &#x5927;&#x5C0F;&#x7AEF;&#x9075;&#x5FAA;&#x672C;&#x5730;&#x8BBE;&#x7F6E;
![n]: &#x5C06;&#x6700;&#x5927;&#x5BF9;&#x9F50;&#x6570;&#x8BBE;&#x4E3A; n &#xFF08;&#x9ED8;&#x8BA4;&#x9075;&#x5FAA;&#x672C;&#x5730;&#x5BF9;&#x9F50;&#x8BBE;&#x7F6E;&#xFF09;
b: &#x4E00;&#x4E2A;&#x6709;&#x7B26;&#x53F7;&#x5B57;&#x8282; (char)
B: &#x4E00;&#x4E2A;&#x65E0;&#x7B26;&#x53F7;&#x5B57;&#x8282; (char)
h: &#x4E00;&#x4E2A;&#x6709;&#x7B26;&#x53F7; short &#xFF08;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;
H: &#x4E00;&#x4E2A;&#x65E0;&#x7B26;&#x53F7; short &#xFF08;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;
l: &#x4E00;&#x4E2A;&#x6709;&#x7B26;&#x53F7; long &#xFF08;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;
L: &#x4E00;&#x4E2A;&#x65E0;&#x7B26;&#x53F7; long &#xFF08;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;
j: &#x4E00;&#x4E2A; lua_Integer
J: &#x4E00;&#x4E2A; lua_Unsigned
T: &#x4E00;&#x4E2A; size_t &#xFF08;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;
i[n]: &#x4E00;&#x4E2A; n &#x5B57;&#x8282;&#x957F;&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;&#x7684;&#x6709;&#x7B26;&#x53F7; int
I[n]: &#x4E00;&#x4E2A; n &#x5B57;&#x8282;&#x957F;&#xFF08;&#x9ED8;&#x8BA4;&#x4E3A;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;&#x7684;&#x65E0;&#x7B26;&#x53F7; int
f: &#x4E00;&#x4E2A; float &#xFF08;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;
d: &#x4E00;&#x4E2A; double &#xFF08;&#x672C;&#x5730;&#x5927;&#x5C0F;&#xFF09;
n: &#x4E00;&#x4E2A; lua_Number
cn: n&#x5B57;&#x8282;&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#x7684;&#x5B57;&#x7B26;&#x4E32;
z: &#x96F6;&#x7ED3;&#x5C3E;&#x7684;&#x5B57;&#x7B26;&#x4E32;
s[n]: &#x957F;&#x5EA6;&#x52A0;&#x5185;&#x5BB9;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5176;&#x957F;&#x5EA6;&#x7F16;&#x7801;&#x4E3A;&#x4E00;&#x4E2A; n &#x5B57;&#x8282;&#xFF08;&#x9ED8;&#x8BA4;&#x662F;&#x4E2A; size_t&#xFF09; &#x957F;&#x7684;&#x65E0;&#x7B26;&#x53F7;&#x6574;&#x6570;&#x3002;
x: &#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x586B;&#x5145;
Xop: &#x6309;&#x9009;&#x9879; op &#x7684;&#x65B9;&#x5F0F;&#x5BF9;&#x9F50;&#xFF08;&#x5FFD;&#x7565;&#x5B83;&#x7684;&#x5176;&#x5B83;&#x65B9;&#x9762;&#xFF09;&#x7684;&#x4E00;&#x4E2A;&#x7A7A;&#x6761;&#x76EE;
&apos; &apos;: &#xFF08;&#x7A7A;&#x683C;&#xFF09;&#x5FFD;&#x7565;
&#xFF08; &quot;[n]&quot; &#x8868;&#x793A;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x7684;&#x6574;&#x6570;&#x3002;&#xFF09; &#x9664;&#x586B;&#x5145;&#x3001;&#x7A7A;&#x683C;&#x3001;&#x914D;&#x7F6E;&#x9879;&#xFF08;&#x9009;&#x9879; &quot;xX &lt;=&gt;!&quot;&#xFF09;&#x5916;&#xFF0C; &#x6BCF;&#x4E2A;&#x9009;&#x9879;&#x90FD;&#x5173;&#x8054;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#xFF08;&#x5BF9;&#x4E8E; string.pack&#xFF09; &#x6216;&#x7ED3;&#x679C;&#xFF08;&#x5BF9;&#x4E8E; string.unpack&#xFF09;&#x3002;</p>
</blockquote>
<p>&#x5BF9;&#x4E8E;&#x9009;&#x9879; &quot;!n&quot;, &quot;sn&quot;, &quot;in&quot;, &quot;In&quot;, n &#x53EF;&#x4EE5;&#x662F; 1 &#x5230; 16 &#x95F4;&#x7684;&#x6574;&#x6570;&#x3002; &#x6240;&#x6709;&#x7684;&#x6574;&#x6570;&#x9009;&#x9879;&#x90FD;&#x5C06;&#x505A;&#x6EA2;&#x51FA;&#x68C0;&#x67E5;&#xFF1B; string.pack &#x68C0;&#x67E5;&#x63D0;&#x4F9B;&#x7684;&#x503C;&#x662F;&#x5426;&#x80FD;&#x7528;&#x6307;&#x5B9A;&#x7684;&#x5B57;&#x957F;&#x8868;&#x793A;&#xFF1B; string.unpack &#x68C0;&#x67E5;&#x8BFB;&#x51FA;&#x7684;&#x503C;&#x80FD;&#x5426;&#x7F6E;&#x5165; Lua &#x6574;&#x6570;&#x4E2D;&#x3002;</p>
<p>&#x4EFB;&#x4F55;&#x683C;&#x5F0F;&#x4E32;&#x90FD;&#x5047;&#x8BBE;&#x6709;&#x4E00;&#x4E2A; &quot;!1=&quot; &#x524D;&#x7F00;&#xFF0C; &#x5373;&#x6700;&#x5927;&#x5BF9;&#x9F50;&#x4E3A; 1 &#xFF08;&#x65E0;&#x5BF9;&#x9F50;&#xFF09;&#x4E14;&#x91C7;&#x7528;&#x672C;&#x5730;&#x5927;&#x5C0F;&#x7AEF;&#x8BBE;&#x7F6E;&#x3002;</p>
<p>&#x5BF9;&#x9F50;&#x884C;&#x4E3A;&#x6309;&#x5982;&#x4E0B;&#x89C4;&#x5219;&#x5DE5;&#x4F5C;&#xFF1A; &#x5BF9;&#x6BCF;&#x4E2A;&#x9009;&#x9879;&#xFF0C;&#x683C;&#x5F0F;&#x5316;&#x65F6;&#x90FD;&#x4F1A;&#x586B;&#x5145;&#x4E00;&#x4E9B;&#x5B57;&#x8282;&#x76F4;&#x5230;&#x6570;&#x636E;&#x4ECE;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x504F;&#x79FB;&#x5904;&#x5F00;&#x59CB;&#xFF0C; &#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x662F;&#x8BE5;&#x9009;&#x9879;&#x7684;&#x5927;&#x5C0F;&#x548C;&#x6700;&#x5927;&#x5BF9;&#x9F50;&#x6570;&#x4E2D;&#x8F83;&#x5C0F;&#x7684;&#x90A3;&#x4E2A;&#x6570;&#x7684;&#x500D;&#x6570;&#xFF1B; &#x8FD9;&#x4E2A;&#x8F83;&#x5C0F;&#x503C;&#x5FC5;&#x987B;&#x662F; 2 &#x4E2A;&#x6574;&#x6570;&#x6B21;&#x65B9;&#x3002; &#x9009;&#x9879; &quot;c&quot; &#x53CA; &quot;z&quot; &#x4E0D;&#x505A;&#x5BF9;&#x9F50;&#x5904;&#x7406;&#xFF1B; &#x9009;&#x9879; &quot;s&quot; &#x5BF9;&#x5BF9;&#x9F50;&#x9075;&#x5FAA;&#x5176;&#x5F00;&#x5934;&#x7684;&#x6574;&#x6570;&#x3002;</p>
<p>string.pack &#x7528;&#x96F6;&#x53BB;&#x586B;&#x5145; &#xFF08;string.unpack &#x5219;&#x5FFD;&#x7565;&#x5B83;&#xFF09;&#x3002;</p>
<h2 id="UTF-8 &#x652F;&#x6301;">UTF-8 &#x652F;&#x6301; <a href="#UTF-8 &#x652F;&#x6301;"> # </a></h2>
<p>&#x8FD9;&#x4E2A;&#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9; UTF-8 &#x7F16;&#x7801;&#x7684;&#x57FA;&#x7840;&#x652F;&#x6301;&#x3002; &#x6240;&#x6709;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x653E;&#x5728;&#x8868; utf8 &#x4E2D;&#x3002; &#x6B64;&#x5E93;&#x4E0D;&#x63D0;&#x4F9B;&#x9664;&#x7F16;&#x7801;&#x5904;&#x7406;&#x4E4B;&#x5916;&#x7684;&#x4EFB;&#x4F55; Unicode &#x652F;&#x6301;&#x3002; &#x6240;&#x6709;&#x9700;&#x8981;&#x4E86;&#x89E3;&#x5B57;&#x7B26;&#x542B;&#x4E49;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x6BD4;&#x5982;&#x5B57;&#x7B26;&#x5206;&#x7C7B;&#xFF0C;&#x90FD;&#x4E0D;&#x5728;&#x6B64;&#x8303;&#x7574;&#x3002;</p>
<p>&#x9664;&#x975E;&#x53E6;&#x6709;&#x8BF4;&#x660E;&#xFF0C; &#x5F53;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x4F4D;&#x7F6E;&#x7684;&#x53C2;&#x6570;&#x65F6;&#xFF0C; &#x90FD;&#x5047;&#x5B9A;&#x8FD9;&#x4E2A;&#x4F4D;&#x7F6E;&#x8981;&#x4E48;&#x4ECE;&#x5B57;&#x8282;&#x5E8F;&#x5217;&#x7684;&#x5F00;&#x59CB;&#x8BA1;&#x7B97;&#xFF0C; &#x8981;&#x4E48;&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x52A0;&#x4E00;&#x7684;&#x4F4D;&#x7F6E;&#x7B97;&#x3002; &#x548C;&#x5B57;&#x7B26;&#x4E32;&#x5E93;&#x4E00;&#x6837;&#xFF0C;&#x8D1F;&#x7684;&#x7D22;&#x5F15;&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x672B;&#x5C3E;&#x8BA1;&#x8D77;&#x3002;</p>
<p>utf8.char (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x63A5;&#x6536;&#x96F6;&#x6216;&#x591A;&#x4E2A;&#x6574;&#x6570;&#xFF0C; &#x5C06;&#x6BCF;&#x4E2A;&#x6574;&#x6570;&#x8F6C;&#x6362;&#x6210;&#x5BF9;&#x5E94;&#x7684; UTF-8 &#x5B57;&#x8282;&#x5E8F;&#x5217;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x8FD9;&#x4E9B;&#x5E8F;&#x5217;&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x8D77;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;
utf8.charpattern</p>
<p>&#x7528;&#x4E8E;&#x7CBE;&#x786E;&#x5339;&#x914D;&#x5230;&#x4E00;&#x4E2A; UTF-8 &#x5B57;&#x8282;&#x5E8F;&#x5217;&#x7684;&#x6A21;&#x5F0F;&#xFF08;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x975E;&#x51FD;&#x6570;&#xFF09;&quot;[\0-\x7F\xC2-\xF4][\x80-\xBF]*&quot; &#xFF08;&#x53C2;&#x89C1; &#xA7;6.4.1&#xFF09;&#x3002; &#x5B83;&#x5047;&#x5B9A;&#x5904;&#x7406;&#x7684;&#x5BF9;&#x8C61;&#x662F;&#x4E00;&#x4E2A;&#x5408;&#x6CD5;&#x7684; UTF-8 &#x5B57;&#x7B26;&#x4E32;&#x3002;
utf8.codes (s)</p>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x503C;&#xFF0C;&#x53EF;&#x4EE5;&#x8BA9;</p>
<pre><code> for p, c in utf8.codes(s) do body end
</code></pre><p>&#x8FED;&#x4EE3;&#x51FA;&#x5B57;&#x7B26;&#x4E32; s &#x4E2D;&#x6240;&#x6709;&#x7684;&#x5B57;&#x7B26;&#x3002; &#x8FD9;&#x91CC;&#x7684; p &#x662F;&#x4F4D;&#x7F6E;&#xFF08;&#x6309;&#x5B57;&#x8282;&#x6570;&#xFF09;&#x800C; c &#x662F;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x7F16;&#x53F7;&#x3002; &#x5982;&#x679C;&#x5904;&#x7406;&#x5230;&#x4E00;&#x4E2A;&#x4E0D;&#x5408;&#x6CD5;&#x7684;&#x5B57;&#x8282;&#x5E8F;&#x5217;&#xFF0C;&#x5C06;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002;</p>
<p>utf8.codepoint (s [, i [, j]])</p>
<p>&#x4E00;&#x6574;&#x6570;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE; s &#x4E2D; &#x4ECE;&#x4F4D;&#x7F6E; i &#x5230; j &#x95F4;&#xFF08;&#x5305;&#x62EC;&#x4E24;&#x7AEF;&#xFF09; &#x6240;&#x6709;&#x5B57;&#x7B26;&#x7684;&#x7F16;&#x53F7;&#x3002; &#x9ED8;&#x8BA4;&#x7684; i &#x4E3A; 1 &#xFF0C;&#x9ED8;&#x8BA4;&#x7684; j &#x4E3A; i&#x3002; &#x5982;&#x679C;&#x78B0;&#x4E0A;&#x4E0D;&#x5408;&#x6CD5;&#x7684;&#x5B57;&#x8282;&#x5E8F;&#x5217;&#xFF0C;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002;
utf8.len (s [, i [, j]])</p>
<p>&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x4E32; s &#x4E2D; &#x4ECE;&#x4F4D;&#x7F6E; i &#x5230; j &#x95F4; &#xFF08;&#x5305;&#x62EC;&#x4E24;&#x7AEF;&#xFF09; UTF-8 &#x5B57;&#x7B26;&#x7684;&#x4E2A;&#x6570;&#x3002; &#x9ED8;&#x8BA4;&#x7684; i &#x4E3A; 1 &#xFF0C;&#x9ED8;&#x8BA4;&#x7684; j &#x4E3A; -1 &#x3002; &#x5982;&#x679C;&#x5B83;&#x627E;&#x5230;&#x4EFB;&#x4F55;&#x4E0D;&#x5408;&#x6CD5;&#x7684;&#x5B57;&#x8282;&#x5E8F;&#x5217;&#xFF0C; &#x8FD4;&#x56DE;&#x5047;&#x503C;&#x52A0;&#x4E0A;&#x7B2C;&#x4E00;&#x4E2A;&#x4E0D;&#x5408;&#x6CD5;&#x5B57;&#x8282;&#x7684;&#x4F4D;&#x7F6E;&#x3002;
utf8.offset (s, n [, i])</p>
<p>&#x8FD4;&#x56DE;&#x7F16;&#x7801;&#x5728; s &#x4E2D;&#x7684;&#x7B2C; n &#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;&#xFF08;&#x6309;&#x5B57;&#x8282;&#x6570;&#xFF09; &#xFF08;&#x4ECE;&#x4F4D;&#x7F6E; i &#x5904;&#x5F00;&#x59CB;&#x7EDF;&#x8BA1;&#xFF09;&#x3002; &#x8D1F; n &#x5219;&#x53D6;&#x5728;&#x4F4D;&#x7F6E; i &#x524D;&#x7684;&#x5B57;&#x7B26;&#x3002; &#x5F53; n &#x662F;&#x975E;&#x8D1F;&#x6570;&#x65F6;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684; i &#x662F; 1&#xFF0C; &#x5426;&#x5219;&#x9ED8;&#x8BA4;&#x4E3A; #s + 1&#x3002; &#x56E0;&#x6B64;&#xFF0C;utf8.offset(s, -n) &#x53D6;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5012;&#x6570;&#x7B2C; n &#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x4F4D;&#x7F6E;&#x3002; &#x5982;&#x679C;&#x6307;&#x5B9A;&#x7684;&#x5B57;&#x7B26;&#x4E0D;&#x5728;&#x5176;&#x4E2D;&#x6216;&#x5728;&#x7ED3;&#x675F;&#x70B9;&#x4E4B;&#x540E;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE; nil&#x3002;
&#x4F5C;&#x4E3A;&#x7279;&#x4F8B;&#xFF0C;&#x5F53; n &#x7B49;&#x4E8E; 0 &#x65F6;&#xFF0C; &#x6B64;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x542B;&#x6709; s &#x7B2C; i &#x5B57;&#x8282;&#x7684;&#x90A3;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x5F00;&#x59CB;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5047;&#x5B9A; s &#x662F;&#x4E00;&#x4E2A;&#x5408;&#x6CD5;&#x7684; UTF-8 &#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<h2 id="&#x8868;&#x5904;&#x7406;">&#x8868;&#x5904;&#x7406; <a href="#&#x8868;&#x5904;&#x7406;"> # </a></h2>
<p>&#x8FD9;&#x4E2A;&#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x8868;&#x5904;&#x7406;&#x7684;&#x901A;&#x7528;&#x51FD;&#x6570;&#x3002; &#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x653E;&#x5728;&#x8868; table &#x4E2D;&#x3002;</p>
<p>&#x8BB0;&#x4F4F;&#xFF0C;&#x65E0;&#x8BBA;&#x4F55;&#x65F6;&#xFF0C;&#x82E5;&#x4E00;&#x4E2A;&#x64CD;&#x4F5C;&#x9700;&#x8981;&#x53D6;&#x8868;&#x7684;&#x957F;&#x5EA6;&#xFF0C; &#x8FD9;&#x5F20;&#x8868;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x771F;&#x5E8F;&#x5217;&#xFF0C;&#x6216;&#x662F;&#x62E5;&#x6709; __len &#x5143;&#x65B9;&#x6CD5; &#xFF08;&#x53C2;&#x89C1; &#xA7;3.4.7 &#xFF09;&#x3002; &#x6240;&#x6709;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x5FFD;&#x7565;&#x4F20;&#x5165;&#x53C2;&#x6570;&#x7684;&#x90A3;&#x5F20;&#x8868;&#x4E2D;&#x7684;&#x975E;&#x6570;&#x5B57;&#x952E;&#x3002;</p>
<p>table.concat (list [, sep [, i [, j]]])</p>
<p>&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5217;&#x8868;&#xFF0C;&#x5176;&#x6240;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x6570;&#x5B57;&#xFF0C;&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x4E32; list[i]..sep..list[i+1] &#xB7;&#xB7;&#xB7; sep..list[j]&#x3002; sep &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x662F;&#x7A7A;&#x4E32;&#xFF0C; i &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x662F; 1 &#xFF0C; j &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x662F; #list &#x3002; &#x5982;&#x679C; i &#x6BD4; j &#x5927;&#xFF0C;&#x8FD4;&#x56DE;&#x7A7A;&#x4E32;&#x3002;</p>
<p>table.insert (list, [pos,] value)</p>
<p>&#x5728; list &#x7684;&#x4F4D;&#x7F6E; pos &#x5904;&#x63D2;&#x5165;&#x5143;&#x7D20; value &#xFF0C; &#x5E76;&#x540E;&#x79FB;&#x5143;&#x7D20; list[pos], list[pos+1], &#xB7;&#xB7;&#xB7;, list[#list] &#x3002; pos &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A; #list+1 &#xFF0C; &#x56E0;&#x6B64;&#x8C03;&#x7528; table.insert(t,x) &#x4F1A;&#x5C06; x &#x63D2;&#x5728;&#x5217;&#x8868; t &#x7684;&#x672B;&#x5C3E;&#x3002;</p>
<p>table.move (a1, f, e, t [,a2])</p>
<p>&#x5C06;&#x5143;&#x7D20;&#x4ECE;&#x8868; a1 &#x79FB;&#x5230;&#x8868; a2&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x505A;&#x4E86;&#x6B21;&#x7B49;&#x4EF7;&#x4E8E;&#x540E;&#x9762;&#x8FD9;&#x4E2A;&#x591A;&#x91CD;&#x8D4B;&#x503C;&#x7684;&#x7B49;&#x4EF7;&#x64CD;&#x4F5C;&#xFF1A; a2[t],&#xB7;&#xB7;&#xB7; = a1[f],&#xB7;&#xB7;&#xB7;,a1[e]&#x3002; a2 &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A; a1&#x3002; &#x76EE;&#x6807;&#x533A;&#x95F4;&#x53EF;&#x4EE5;&#x548C;&#x6E90;&#x533A;&#x95F4;&#x91CD;&#x53E0;&#x3002; &#x7D22;&#x5F15; f &#x5FC5;&#x987B;&#x662F;&#x6B63;&#x6570;&#x3002;</p>
<p>table.pack (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x8FD4;&#x56DE;&#x7528;&#x6240;&#x6709;&#x53C2;&#x6570;&#x4EE5;&#x952E; 1,2, &#x7B49;&#x586B;&#x5145;&#x7684;&#x65B0;&#x8868;&#xFF0C; &#x5E76;&#x5C06; &quot;n&quot; &#x8FD9;&#x4E2A;&#x57DF;&#x8BBE;&#x4E3A;&#x53C2;&#x6570;&#x7684;&#x603B;&#x6570;&#x3002; &#x6CE8;&#x610F;&#x8FD9;&#x5F20;&#x8FD4;&#x56DE;&#x7684;&#x8868;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#x3002;</p>
<p>table.remove (list [, pos])</p>
<p>&#x79FB;&#x9664; list &#x4E2D; pos &#x4F4D;&#x7F6E;&#x4E0A;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x8FD9;&#x4E2A;&#x88AB;&#x79FB;&#x9664;&#x7684;&#x503C;&#x3002; &#x5F53; pos &#x662F;&#x5728; 1 &#x5230; #list &#x4E4B;&#x95F4;&#x7684;&#x6574;&#x6570;&#x65F6;&#xFF0C; &#x5B83;&#x5411;&#x524D;&#x79FB;&#x52A8;&#x5143;&#x7D20;&#x3000;list[pos+1], list[pos+2], &#xB7;&#xB7;&#xB7;, list[#list] &#x5E76;&#x5220;&#x9664;&#x5143;&#x7D20; list[#list]&#xFF1B; &#x7D22;&#x5F15; pos &#x53EF;&#x4EE5;&#x662F; #list + 1 &#xFF0C;&#x6216;&#x5728; #list &#x4E3A; 0 &#x65F6;&#x53EF;&#x4EE5;&#x662F; 0 &#xFF1B; &#x5728;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;&#x5220;&#x9664;&#x5143;&#x7D20; list[pos]&#x3002;</p>
<p>pos &#x9ED8;&#x8BA4;&#x4E3A; #list&#xFF0C; &#x56E0;&#x6B64;&#x8C03;&#x7528; table.remove(l) &#x5C06;&#x79FB;&#x9664;&#x8868; l &#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x3002;</p>
<p>table.sort (list [, comp])</p>
<p>&#x5728;&#x8868;&#x5185;&#x4ECE; list[1] &#x5230; list[#list] &#x539F;&#x5730; &#x5BF9;&#x5176;&#x95F4;&#x5143;&#x7D20;&#x6309;&#x6307;&#x5B9A;&#x6B21;&#x5E8F;&#x6392;&#x5E8F;&#x3002; &#x5982;&#x679C;&#x63D0;&#x4F9B;&#x4E86; comp &#xFF0C; &#x5B83;&#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x63A5;&#x6536;&#x4E24;&#x4E2A;&#x5217;&#x8868;&#x5185;&#x5143;&#x7D20;&#x4E3A;&#x53C2;&#x6570;&#x7684;&#x51FD;&#x6570;&#x3002; &#x5F53;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x9700;&#x8981;&#x6392;&#x5728;&#x7B2C;&#x4E8C;&#x4E2A;&#x5143;&#x7D20;&#x4E4B;&#x524D;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE;&#x771F; &#xFF08;&#x56E0;&#x6B64; not comp(list[i+1],list[i]) &#x5728;&#x6392;&#x5E8F;&#x7ED3;&#x675F;&#x540E;&#x5C06;&#x4E3A;&#x771F;&#xFF09;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x63D0;&#x4F9B; comp&#xFF0C; &#x5C06;&#x4F7F;&#x7528;&#x6807;&#x51C6; Lua &#x64CD;&#x4F5C; &lt; &#x4F5C;&#x4E3A;&#x66FF;&#x4EE3;&#x54C1;&#x3002;</p>
<p>&#x6392;&#x5E8F;&#x7B97;&#x6CD5;&#x5E76;&#x4E0D;&#x7A33;&#x5B9A;&#xFF1B; &#x5373;&#x5F53;&#x4E24;&#x4E2A;&#x5143;&#x7D20;&#x6B21;&#x5E8F;&#x76F8;&#x7B49;&#x65F6;&#xFF0C;&#x5B83;&#x4EEC;&#x5728;&#x6392;&#x5E8F;&#x540E;&#x7684;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;&#x53EF;&#x80FD;&#x4F1A;&#x6539;&#x53D8;&#x3002;</p>
<p>table.unpack (list [, i [, j]])</p>
<p>&#x8FD4;&#x56DE;&#x5217;&#x8868;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7B49;&#x4EF7;&#x4E8E;</p>
<pre><code> return list[i], list[i+1], &#xB7;&#xB7;&#xB7;, list[j]
</code></pre><p>i &#x9ED8;&#x8BA4;&#x4E3A; 1 &#xFF0C;j &#x9ED8;&#x8BA4;&#x4E3A; #list&#x3002;</p>
<h2 id="&#x6570;&#x5B66;&#x51FD;&#x6570;">&#x6570;&#x5B66;&#x51FD;&#x6570; <a href="#&#x6570;&#x5B66;&#x51FD;&#x6570;"> # </a></h2>
<p>&#x8FD9;&#x4E2A;&#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x57FA;&#x672C;&#x7684;&#x6570;&#x5B66;&#x51FD;&#x6570;&#x3002; &#x6240;&#x4EE5;&#x51FD;&#x6570;&#x90FD;&#x653E;&#x5728;&#x8868; math &#x4E2D;&#x3002; &#x6CE8;&#x89E3;&#x6709; &quot;integer/float&quot; &#x7684;&#x51FD;&#x6570;&#x4F1A;&#x5BF9;&#x6574;&#x6570;&#x53C2;&#x6570;&#x8FD4;&#x56DE;&#x6574;&#x6570;&#x7ED3;&#x679C;&#xFF0C; &#x5BF9;&#x6D6E;&#x70B9;&#xFF08;&#x6216;&#x6DF7;&#x5408;&#xFF09;&#x53C2;&#x6570;&#x8FD4;&#x56DE;&#x6D6E;&#x70B9;&#x7ED3;&#x679C;&#x3002; &#x5706;&#x6574;&#x51FD;&#x6570;&#xFF08;math.ceil, math.floor, math.modf&#xFF09; &#x5728;&#x7ED3;&#x679C;&#x5728;&#x6574;&#x6570;&#x8303;&#x56F4;&#x5185;&#x65F6;&#x8FD4;&#x56DE;&#x6574;&#x6570;&#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE;&#x6D6E;&#x70B9;&#x6570;&#x3002;</p>
<p>math.abs (x)</p>
<p>&#x8FD4;&#x56DE; x &#x7684;&#x7EDD;&#x5BF9;&#x503C;&#x3002;(integer/float)</p>
<p>math.acos (x)</p>
<p>&#x8FD4;&#x56DE; x &#x7684;&#x53CD;&#x4F59;&#x5F26;&#x503C;&#xFF08;&#x7528;&#x5F27;&#x5EA6;&#x8868;&#x793A;&#xFF09;&#x3002;</p>
<p>math.asin (x)</p>
<p>&#x8FD4;&#x56DE; x &#x7684;&#x53CD;&#x6B63;&#x5F26;&#x503C;&#xFF08;&#x7528;&#x5F27;&#x5EA6;&#x8868;&#x793A;&#xFF09;&#x3002;</p>
<p>math.atan (y [, x])</p>
<p>&#x8FD4;&#x56DE; y/x &#x7684;&#x53CD;&#x6B63;&#x5207;&#x503C;&#xFF08;&#x7528;&#x5F27;&#x5EA6;&#x8868;&#x793A;&#xFF09;&#x3002; &#x5B83;&#x4F1A;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x7B26;&#x53F7;&#x6765;&#x627E;&#x5230;&#x7ED3;&#x679C;&#x843D;&#x5728;&#x54EA;&#x4E2A;&#x8C61;&#x9650;&#x4E2D;&#x3002; &#xFF08;&#x5373;&#x4F7F; x &#x4E3A;&#x96F6;&#x65F6;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x6B63;&#x786E;&#x7684;&#x5904;&#x7406;&#x3002;&#xFF09;</p>
<p>&#x9ED8;&#x8BA4;&#x7684; x &#x662F; 1 &#xFF0C; &#x56E0;&#x6B64;&#x8C03;&#x7528; math.atan(y) &#x5C06;&#x8FD4;&#x56DE; y &#x7684;&#x53CD;&#x6B63;&#x5207;&#x503C;&#x3002;</p>
<p>math.ceil (x)</p>
<p>&#x8FD4;&#x56DE;&#x4E0D;&#x5C0F;&#x4E8E; x &#x7684;&#x6700;&#x5C0F;&#x6574;&#x6570;&#x503C;&#x3002;</p>
<p>math.cos (x)</p>
<p>&#x8FD4;&#x56DE; x &#x7684;&#x4F59;&#x5F26;&#xFF08;&#x5047;&#x5B9A;&#x53C2;&#x6570;&#x662F;&#x5F27;&#x5EA6;&#xFF09;&#x3002;</p>
<p>math.deg (x)</p>
<p>&#x5C06;&#x89D2; x &#x4ECE;&#x5F27;&#x5EA6;&#x8F6C;&#x6362;&#x4E3A;&#x89D2;&#x5EA6;&#x3002;</p>
<p>math.exp (x)</p>
<p>&#x8FD4;&#x56DE; ex &#x7684;&#x503C; &#xFF08;e &#x4E3A;&#x81EA;&#x7136;&#x5BF9;&#x6570;&#x7684;&#x5E95;&#xFF09;&#x3002;</p>
<p>math.floor (x)</p>
<p>&#x8FD4;&#x56DE;&#x4E0D;&#x5927;&#x4E8E; x &#x7684;&#x6700;&#x5927;&#x6574;&#x6570;&#x503C;&#x3002;</p>
<p>math.fmod (x, y)</p>
<p>&#x8FD4;&#x56DE; x &#x9664;&#x4EE5; y&#xFF0C;&#x5C06;&#x5546;&#x5411;&#x96F6;&#x5706;&#x6574;&#x540E;&#x7684;&#x4F59;&#x6570;&#x3002; (integer/float)</p>
<p>math.huge</p>
<p>&#x6D6E;&#x70B9;&#x6570; HUGE_VAL&#xFF0C; &#x8FD9;&#x4E2A;&#x6570;&#x6BD4;&#x4EFB;&#x4F55;&#x6570;&#x5B57;&#x503C;&#x90FD;&#x5927;&#x3002;</p>
<p>math.log (x [, base])</p>
<p>&#x8FD4;&#x56DE;&#x4EE5;&#x6307;&#x5B9A;&#x5E95;&#x7684; x &#x7684;&#x5BF9;&#x6570;&#x3002; &#x9ED8;&#x8BA4;&#x7684; base &#x662F; e &#xFF08;&#x56E0;&#x6B64;&#x6B64;&#x51FD;&#x6570;&#x8FD4;&#x56DE; x &#x7684;&#x81EA;&#x7136;&#x5BF9;&#x6570;&#xFF09;&#x3002;</p>
<p>math.max (x, &#xB7;&#xB7;&#xB7;)</p>
<p>&#x8FD4;&#x56DE;&#x53C2;&#x6570;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x503C;&#xFF0C; &#x5927;&#x5C0F;&#x7531; Lua &#x64CD;&#x4F5C; &lt; &#x51B3;&#x5B9A;&#x3002; (integer/float)</p>
<p>math.maxinteger</p>
<p>&#x6700;&#x5927;&#x503C;&#x7684;&#x6574;&#x6570;&#x3002;
math.min (x, &#xB7;&#xB7;&#xB7;)</p>
<p>&#x8FD4;&#x56DE;&#x53C2;&#x6570;&#x4E2D;&#x6700;&#x5C0F;&#x7684;&#x503C;&#xFF0C; &#x5927;&#x5C0F;&#x7531; Lua &#x64CD;&#x4F5C; &lt; &#x51B3;&#x5B9A;&#x3002; (integer/float)</p>
<p>math.mininteger</p>
<p>&#x6700;&#x5C0F;&#x503C;&#x7684;&#x6574;&#x6570;&#x3002;
math.modf (x)</p>
<p>&#x8FD4;&#x56DE; x &#x7684;&#x6574;&#x6570;&#x90E8;&#x5206;&#x548C;&#x5C0F;&#x6570;&#x90E8;&#x5206;&#x3002; &#x7B2C;&#x4E8C;&#x4E2A;&#x7ED3;&#x679C;&#x4E00;&#x5B9A;&#x662F;&#x6D6E;&#x70B9;&#x6570;&#x3002;</p>
<p>math.pi</p>
<p>&#x3C0; &#x7684;&#x503C;&#x3002;</p>
<p>math.rad (x)</p>
<p>&#x5C06;&#x89D2; x &#x4ECE;&#x89D2;&#x5EA6;&#x8F6C;&#x6362;&#x4E3A;&#x5F27;&#x5EA6;&#x3002;</p>
<p>math.random ([m [, n]])</p>
<p>&#x5F53;&#x4E0D;&#x5E26;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x65F6;&#xFF0C; &#x8FD4;&#x56DE;&#x4E00;&#x4E2A; [0,1) &#x533A;&#x95F4;&#x5185;&#x4E00;&#x81F4;&#x5206;&#x5E03;&#x7684;&#x6D6E;&#x70B9;&#x4F2A;&#x968F;&#x673A;&#x6570;&#x3002; &#x5F53;&#x4EE5;&#x4E24;&#x4E2A;&#x6574;&#x6570; m &#x4E0E; n &#x8C03;&#x7528;&#x65F6;&#xFF0C; math.random &#x8FD4;&#x56DE;&#x4E00;&#x4E2A; [m, n] &#x533A;&#x95F4; &#x5185;&#x4E00;&#x81F4;&#x5206;&#x5E03;&#x7684;&#x6574;&#x6570;&#x4F2A;&#x968F;&#x673A;&#x6570;&#x3002; &#xFF08;&#x503C; m-n &#x4E0D;&#x80FD;&#x662F;&#x8D1F;&#x6570;&#xFF0C;&#x4E14;&#x5FC5;&#x987B;&#x5728; Lua &#x6574;&#x6570;&#x7684;&#x8868;&#x793A;&#x8303;&#x56F4;&#x5185;&#x3002;&#xFF09; &#x8C03;&#x7528; math.random(n) &#x7B49;&#x4EF7;&#x4E8E; math.random(1,n)&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x662F;&#x5BF9; C &#x63D0;&#x4F9B;&#x7684;&#x4F4D;&#x968F;&#x673A;&#x6570;&#x51FD;&#x6570;&#x7684;&#x5C01;&#x88C5;&#x3002; &#x5BF9;&#x5176;&#x7EDF;&#x8BA1;&#x5C5E;&#x6027;&#x4E0D;&#x4F5C;&#x62C5;&#x4FDD;&#x3002;</p>
<p>math.randomseed (x)</p>
<p>&#x628A; x &#x8BBE;&#x4E3A;&#x4F2A;&#x968F;&#x673A;&#x6570;&#x53D1;&#x751F;&#x5668;&#x7684;&#x201C;&#x79CD;&#x5B50;&#x201D;&#xFF1A; &#x76F8;&#x540C;&#x7684;&#x79CD;&#x5B50;&#x4EA7;&#x751F;&#x76F8;&#x540C;&#x7684;&#x968F;&#x673A;&#x6570;&#x5217;&#x3002;</p>
<p>math.sin (x)</p>
<p>&#x8FD4;&#x56DE; x &#x7684;&#x6B63;&#x5F26;&#x503C;&#xFF08;&#x5047;&#x5B9A;&#x53C2;&#x6570;&#x662F;&#x5F27;&#x5EA6;&#xFF09;&#x3002;</p>
<p>math.sqrt (x)</p>
<p>&#x8FD4;&#x56DE; x &#x7684;&#x5E73;&#x65B9;&#x6839;&#x3002; &#xFF08;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E58;&#x65B9; x^0.5 &#x6765;&#x8BA1;&#x7B97;&#x8FD9;&#x4E2A;&#x503C;&#x3002;&#xFF09;</p>
<p>math.tan (x)</p>
<p>&#x8FD4;&#x56DE; x &#x7684;&#x6B63;&#x5207;&#x503C;&#xFF08;&#x5047;&#x5B9A;&#x53C2;&#x6570;&#x662F;&#x5F27;&#x5EA6;&#xFF09;&#x3002;</p>
<p>math.tointeger (x)</p>
<p>&#x5982;&#x679C; x &#x53EF;&#x4EE5;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C; &#x8FD4;&#x56DE;&#x8BE5;&#x6574;&#x6570;&#x3002; &#x5426;&#x5219;&#x8FD4;&#x56DE; nil&#x3002;</p>
<p>math.type (x)</p>
<p>&#x5982;&#x679C; x &#x662F;&#x6574;&#x6570;&#xFF0C;&#x8FD4;&#x56DE; &quot;integer&quot;&#xFF0C; &#x5982;&#x679C;&#x5B83;&#x662F;&#x6D6E;&#x70B9;&#x6570;&#xFF0C;&#x8FD4;&#x56DE; &quot;float&quot;&#xFF0C; &#x5982;&#x679C; x &#x4E0D;&#x662F;&#x6570;&#x5B57;&#xFF0C;&#x8FD4;&#x56DE; nil&#x3002;</p>
<p>math.ult (m, n)</p>
<p>&#x5982;&#x679C;&#x6574;&#x6570; m &#x548C; n &#x4EE5;&#x65E0;&#x7B26;&#x53F7;&#x6574;&#x6570;&#x5F62;&#x5F0F;&#x6BD4;&#x8F83;&#xFF0C; m &#x5728; n &#x4E4B;&#x4E0B;&#xFF0C;&#x8FD4;&#x56DE;&#x5E03;&#x5C14;&#x771F;&#x5426;&#x5219;&#x8FD4;&#x56DE;&#x5047;&#x3002;</p>
<h2 id="&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x5E93;">&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x5E93; <a href="#&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x5E93;"> # </a></h2>
<p>I/O &#x5E93;&#x63D0;&#x4F9B;&#x4E86;&#x4E24;&#x5957;&#x4E0D;&#x540C;&#x98CE;&#x683C;&#x7684;&#x6587;&#x4EF6;&#x5904;&#x7406;&#x63A5;&#x53E3;&#x3002; &#x7B2C;&#x4E00;&#x79CD;&#x98CE;&#x683C;&#x4F7F;&#x7528;&#x9690;&#x5F0F;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF1B; &#x5B83;&#x63D0;&#x4F9B;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x53CA;&#x9ED8;&#x8BA4;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x7684;&#x64CD;&#x4F5C;&#xFF0C; &#x6240;&#x6709;&#x7684;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#x90FD;&#x9488;&#x5BF9;&#x8FD9;&#x4E9B;&#x9ED8;&#x8BA4;&#x6587;&#x4EF6;&#x3002; &#x7B2C;&#x4E8C;&#x79CD;&#x98CE;&#x683C;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x3002;</p>
<p>&#x5F53;&#x4F7F;&#x7528;&#x9690;&#x5F0F;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x65F6;&#xFF0C; &#x6240;&#x6709;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x7531;&#x8868; io &#x63D0;&#x4F9B;&#x3002; &#x82E5;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF0C; io.open &#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF0C;&#x4E14;&#x6240;&#x6709;&#x7684;&#x64CD;&#x4F5C;&#x90FD;&#x7531;&#x8BE5;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x63D0;&#x4F9B;&#x3002;</p>
<p>&#x8868; io &#x4E2D;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x4E09;&#x4E2A; &#x548C; C &#x4E2D;&#x542B;&#x4E49;&#x76F8;&#x540C;&#x7684;&#x9884;&#x5B9A;&#x4E49;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF1A; io.stdin&#xFF0C; io.stdout&#xFF0C; &#x4EE5;&#x53CA; io.stderr&#x3002; I/O &#x5E93;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x5173;&#x95ED;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x9664;&#x975E;&#x53E6;&#x6709;&#x8BF4;&#x660E;&#xFF0C; I/O &#x51FD;&#x6570;&#x5728;&#x51FA;&#x9519;&#x65F6;&#x90FD;&#x8FD4;&#x56DE; nil &#xFF08;&#x7B2C;&#x4E8C;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x4E3A;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#xFF0C;&#x7B2C;&#x4E09;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x4E3A;&#x7CFB;&#x7EDF;&#x76F8;&#x5173;&#x7684;&#x9519;&#x8BEF;&#x7801;&#xFF09;&#x3002; &#x6210;&#x529F;&#x65F6;&#x8FD4;&#x56DE;&#x4E0E; nil &#x4E0D;&#x540C;&#x7684;&#x503C;&#x3002; &#x5728;&#x975E; POSIX &#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C; &#x6839;&#x636E;&#x9519;&#x8BEF;&#x7801;&#x53D6;&#x51FA;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x7684;&#x8FC7;&#x7A0B;&#x53EF;&#x80FD;&#x5E76;&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C; &#x56E0;&#x4E3A;&#x8FD9;&#x4F7F;&#x7528;&#x4E86; C &#x7684;&#x5168;&#x5C40;&#x53D8;&#x91CF; errno &#x3002;</p>
<p>io.close ([file])</p>
<p>&#x7B49;&#x4EF7;&#x4E8E; file:close()&#x3002; &#x4E0D;&#x7ED9;&#x51FA; file &#x65F6;&#x5C06;&#x5173;&#x95ED;&#x9ED8;&#x8BA4;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x3002;</p>
<p>io.flush ()</p>
<p>&#x7B49;&#x4EF7;&#x4E8E; io.output():flush()&#x3002;</p>
<p>io.input ([file])</p>
<p>&#x7528;&#x6587;&#x4EF6;&#x540D;&#x8C03;&#x7528;&#x5B83;&#x65F6;&#xFF0C;&#xFF08;&#x4EE5;&#x6587;&#x672C;&#x6A21;&#x5F0F;&#xFF09;&#x6765;&#x6253;&#x5F00;&#x8BE5;&#x540D;&#x5B57;&#x7684;&#x6587;&#x4EF6;&#xFF0C; &#x5E76;&#x5C06;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x8BBE;&#x4E3A;&#x9ED8;&#x8BA4;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x3002; &#x5982;&#x679C;&#x7528;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x53BB;&#x8C03;&#x7528;&#x5B83;&#xFF0C; &#x5C31;&#x7B80;&#x5355;&#x7684;&#x5C06;&#x8BE5;&#x53E5;&#x67C4;&#x8BBE;&#x4E3A;&#x9ED8;&#x8BA4;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x3002; &#x5982;&#x679C;&#x8C03;&#x7528;&#x65F6;&#x4E0D;&#x4F20;&#x53C2;&#x6570;&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x7684;&#x9ED8;&#x8BA4;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x5728;&#x51FA;&#x9519;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x800C;&#x4E0D;&#x662F;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x7801;&#x3002;</p>
<p>io.lines ([filename &#xB7;&#xB7;&#xB7;])</p>
<p>&#x4EE5;&#x8BFB;&#x6A21;&#x5F0F;&#x6253;&#x5F00;&#x6307;&#x5B9A;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x5E76;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x8FED;&#x4EE3;&#x51FD;&#x6570;&#x3002; &#x6B64;&#x8FED;&#x4EE3;&#x51FD;&#x6570;&#x7684;&#x5DE5;&#x4F5C;&#x65B9;&#x5F0F;&#x548C;&#x7528;&#x4E00;&#x4E2A;&#x5DF2;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x53BB;&#x8C03;&#x7528; file:lines(&#xB7;&#xB7;&#xB7;) &#x5F97;&#x5230;&#x7684;&#x8FED;&#x4EE3;&#x5668;&#x76F8;&#x540C;&#x3002; &#x5F53;&#x8FED;&#x4EE3;&#x51FD;&#x6570;&#x68C0;&#x6D4B;&#x5230;&#x6587;&#x4EF6;&#x7ED3;&#x675F;&#xFF0C; &#x5B83;&#x4E0D;&#x8FD4;&#x56DE;&#x503C;&#xFF08;&#x8BA9;&#x5FAA;&#x73AF;&#x7ED3;&#x675F;&#xFF09;&#x5E76;&#x81EA;&#x52A8;&#x5173;&#x95ED;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x8C03;&#x7528; io.lines() &#xFF08;&#x4E0D;&#x4F20;&#x6587;&#x4EF6;&#x540D;&#xFF09; &#x7B49;&#x4EF7;&#x4E8E; io.input():lines(&quot;*l&quot;)&#xFF1B; &#x5373;&#xFF0C;&#x5B83;&#x5C06;&#x6309;&#x884C;&#x8FED;&#x4EE3;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x6587;&#x4EF6;&#x3002; &#x5728;&#x6B64;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5FAA;&#x73AF;&#x7ED3;&#x675F;&#x540E;&#x5B83;&#x4E0D;&#x4F1A;&#x5173;&#x95ED;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x5728;&#x51FA;&#x9519;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x800C;&#x4E0D;&#x662F;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x7801;&#x3002;</p>
<p>io.open (filename [, mode])</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x5B57;&#x7B26;&#x4E32; mode &#x6307;&#x5B9A;&#x7684;&#x6A21;&#x5F0F;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x3002; &#x8FD4;&#x56DE;&#x65B0;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x3002; &#x5F53;&#x51FA;&#x9519;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; nil &#x52A0;&#x9519;&#x8BEF;&#x6D88;&#x606F;&#x3002;</p>
<p>mode &#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x662F;&#x4E0B;&#x5217;&#x4EFB;&#x610F;&#x503C;&#xFF1A;</p>
<p>&quot;r&quot;: &#x8BFB;&#x6A21;&#x5F0F;&#xFF08;&#x9ED8;&#x8BA4;&#xFF09;&#xFF1B;
&quot;w&quot;: &#x5199;&#x6A21;&#x5F0F;&#xFF1B;
&quot;a&quot;: &#x8FFD;&#x52A0;&#x6A21;&#x5F0F;&#xFF1B;
&quot;r+&quot;: &#x66F4;&#x65B0;&#x6A21;&#x5F0F;&#xFF0C;&#x6240;&#x6709;&#x4E4B;&#x524D;&#x7684;&#x6570;&#x636E;&#x90FD;&#x4FDD;&#x7559;&#xFF1B;
&quot;w+&quot;: &#x66F4;&#x65B0;&#x6A21;&#x5F0F;&#xFF0C;&#x6240;&#x6709;&#x4E4B;&#x524D;&#x7684;&#x6570;&#x636E;&#x90FD;&#x5220;&#x9664;&#xFF1B;
&quot;a+&quot;: &#x8FFD;&#x52A0;&#x66F4;&#x65B0;&#x6A21;&#x5F0F;&#xFF0C;&#x6240;&#x6709;&#x4E4B;&#x524D;&#x7684;&#x6570;&#x636E;&#x90FD;&#x4FDD;&#x7559;&#xFF0C;&#x53EA;&#x5141;&#x8BB8;&#x5728;&#x6587;&#x4EF6;&#x5C3E;&#x90E8;&#x505A;&#x5199;&#x5165;&#x3002;
mode &#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x4EE5;&#x5728;&#x6700;&#x540E;&#x52A0;&#x4E00;&#x4E2A; &apos;b&apos; &#xFF0C; &#x8FD9;&#x4F1A;&#x5728;&#x67D0;&#x4E9B;&#x7CFB;&#x7EDF;&#x4E0A;&#x4EE5;&#x4E8C;&#x8FDB;&#x5236;&#x65B9;&#x5F0F;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x3002;</p>
<p>io.output ([file])</p>
<p>&#x7C7B;&#x4F3C;&#x4E8E; io.input&#x3002; &#x4E0D;&#x8FC7;&#x90FD;&#x9488;&#x5BF9;&#x9ED8;&#x8BA4;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x3002;</p>
<p>io.popen (prog [, mode])</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x548C;&#x7CFB;&#x7EDF;&#x6709;&#x5173;&#xFF0C;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#x5E73;&#x53F0;&#x90FD;&#x63D0;&#x4F9B;&#x3002;</p>
<p>&#x7528;&#x4E00;&#x4E2A;&#x5206;&#x79BB;&#x8FDB;&#x7A0B;&#x5F00;&#x542F;&#x7A0B;&#x5E8F; prog&#xFF0C; &#x8FD4;&#x56DE;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x53EF;&#x7528;&#x4E8E;&#x4ECE;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E; &#xFF08;&#x5982;&#x679C; mode &#x4E3A; &quot;r&quot;&#xFF0C;&#x8FD9;&#x662F;&#x9ED8;&#x8BA4;&#x503C;&#xFF09; &#x6216;&#x662F;&#x5411;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x5199;&#x5165;&#x8F93;&#x5165;&#xFF08;&#x5F53; mode &#x4E3A; &quot;w&quot; &#x65F6;&#xFF09;&#x3002;</p>
<p>io.read (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x7B49;&#x4EF7;&#x4E8E; io.input():read(&#xB7;&#xB7;&#xB7;)&#x3002;</p>
<p>io.tmpfile ()</p>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#x7684;&#x53E5;&#x67C4;&#x3002; &#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x4EE5;&#x66F4;&#x65B0;&#x6A21;&#x5F0F;&#x6253;&#x5F00;&#xFF0C;&#x5728;&#x7A0B;&#x5E8F;&#x7ED3;&#x675F;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x3002;</p>
<p>io.type (obj)</p>
<p>&#x68C0;&#x67E5; obj &#x662F;&#x5426;&#x662F;&#x5408;&#x6CD5;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x3002; &#x5982;&#x679C; obj &#x5B83;&#x662F;&#x4E00;&#x4E2A;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF0C;&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x4E32; &quot;file&quot;&#x3002; &#x5982;&#x679C; obj &#x662F;&#x4E00;&#x4E2A;&#x5173;&#x95ED;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF0C;&#x8FD4;&#x56DE;&#x5B57;&#x7B26;&#x4E32; &quot;closed file&quot;&#x3002; &#x5982;&#x679C; obj &#x4E0D;&#x662F;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#xFF0C;&#x8FD4;&#x56DE; nil &#x3002;</p>
<p>io.write (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x7B49;&#x4EF7;&#x4E8E; io.output():write(&#xB7;&#xB7;&#xB7;)&#x3002;</p>
<p>file:close ()</p>
<p>&#x5173;&#x95ED; file&#x3002; &#x6CE8;&#x610F;&#xFF0C;&#x6587;&#x4EF6;&#x5728;&#x53E5;&#x67C4;&#x88AB;&#x5783;&#x573E;&#x56DE;&#x6536;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x5173;&#x95ED;&#xFF0C; &#x4F46;&#x662F;&#x591A;&#x4E45;&#x4EE5;&#x540E;&#x53D1;&#x751F;&#xFF0C;&#x65F6;&#x95F4;&#x4E0D;&#x53EF;&#x9884;&#x671F;&#x7684;&#x3002;</p>
<p>&#x5F53;&#x5173;&#x95ED;&#x7528; io.popen &#x521B;&#x5EFA;&#x51FA;&#x6765;&#x7684;&#x6587;&#x4EF6;&#x53E5;&#x67C4;&#x65F6;&#xFF0C; file:close &#x8FD4;&#x56DE; os.execute &#x4F1A;&#x8FD4;&#x56DE;&#x7684;&#x4E00;&#x6837;&#x7684;&#x503C;&#x3002;</p>
<p>file:flush ()</p>
<p>&#x5C06;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x4FDD;&#x5B58;&#x5230; file &#x4E2D;&#x3002;</p>
<p>file:lines (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x8FED;&#x4EE3;&#x5668;&#x51FD;&#x6570;&#xFF0C; &#x6BCF;&#x6B21;&#x8C03;&#x7528;&#x8FED;&#x4EE3;&#x5668;&#x65F6;&#xFF0C;&#x90FD;&#x4ECE;&#x6587;&#x4EF6;&#x4E2D;&#x6309;&#x6307;&#x5B9A;&#x683C;&#x5F0F;&#x8BFB;&#x6570;&#x636E;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x683C;&#x5F0F;&#xFF0C;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x503C; &quot;l&quot; &#x3002; &#x770B;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;</p>
<pre><code> for c in file:lines(1) do body end
</code></pre><p>&#x4F1A;&#x4ECE;&#x6587;&#x4EF6;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x5F00;&#x59CB;&#xFF0C;&#x4E2D;&#x4E0D;&#x65AD;&#x8BFB;&#x51FA;&#x5B57;&#x7B26;&#x3002; &#x548C; io.lines &#x4E0D;&#x540C;&#xFF0C; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5728;&#x5FAA;&#x73AF;&#x7ED3;&#x675F;&#x540E;&#x4E0D;&#x4F1A;&#x5173;&#x95ED;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x5728;&#x51FA;&#x9519;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x51FD;&#x6570;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x800C;&#x4E0D;&#x662F;&#x8FD4;&#x56DE;&#x9519;&#x8BEF;&#x7801;&#x3002;</p>
<p>file:read (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x8BFB;&#x6587;&#x4EF6; file&#xFF0C; &#x6307;&#x5B9A;&#x7684;&#x683C;&#x5F0F;&#x51B3;&#x5B9A;&#x4E86;&#x8981;&#x8BFB;&#x4EC0;&#x4E48;&#x3002; &#x5BF9;&#x4E8E;&#x6BCF;&#x79CD;&#x683C;&#x5F0F;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x8BFB;&#x51FA;&#x7684;&#x5B57;&#x7B26;&#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x6570;&#x5B57;&#x3002; &#x82E5;&#x4E0D;&#x80FD;&#x4EE5;&#x8BE5;&#x683C;&#x5F0F;&#x5BF9;&#x5E94;&#x8BFB;&#x51FA;&#x6570;&#x636E;&#x5219;&#x8FD4;&#x56DE; nil&#x3002; &#xFF08;&#x5BF9;&#x4E8E;&#x6700;&#x540E;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#xFF0C; &#x51FD;&#x6570;&#x4E0D;&#x4F1A;&#x8BFB;&#x51FA;&#x540E;&#x7EED;&#x7684;&#x683C;&#x5F0F;&#x3002;&#xFF09; &#x5F53;&#x8C03;&#x7528;&#x65F6;&#x4E0D;&#x4F20;&#x683C;&#x5F0F;&#xFF0C;&#x5B83;&#x4F1A;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x8BFB;&#x4E0B;&#x4E00;&#x884C;&#xFF08;&#x89C1;&#x4E0B;&#x9762;&#x63CF;&#x8FF0;&#xFF09;&#x3002;</p>
<p>&#x63D0;&#x4F9B;&#x7684;&#x683C;&#x5F0F;&#x6709;</p>
<p>&quot;n&quot;: &#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C;&#x6839;&#x636E; Lua &#x7684;&#x8F6C;&#x6362;&#x6587;&#x6CD5;&#xFF0C;&#x53EF;&#x80FD;&#x8FD4;&#x56DE;&#x6D6E;&#x70B9;&#x6570;&#x6216;&#x6574;&#x6570;&#x3002; &#xFF08;&#x6570;&#x5B57;&#x53EF;&#x4EE5;&#x6709;&#x524D;&#x7F6E;&#x6216;&#x540E;&#x7F6E;&#x7684;&#x7A7A;&#x683C;&#xFF0C;&#x4EE5;&#x53CA;&#x7B26;&#x53F7;&#x3002;&#xFF09; &#x53EA;&#x8981;&#x80FD;&#x6784;&#x6210;&#x5408;&#x6CD5;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x8FD9;&#x4E2A;&#x683C;&#x5F0F;&#x603B;&#x662F;&#x53BB;&#x8BFB;&#x5C3D;&#x91CF;&#x957F;&#x7684;&#x4E32;&#xFF1B; &#x5982;&#x679C;&#x8BFB;&#x51FA;&#x6765;&#x7684;&#x524D;&#x7F00;&#x65E0;&#x6CD5;&#x6784;&#x6210;&#x5408;&#x6CD5;&#x7684;&#x6570;&#x5B57; &#xFF08;&#x6BD4;&#x5982;&#x7A7A;&#x4E32;&#xFF0C;&quot;0x&quot; &#x6216; &quot;3.4e-&quot;&#xFF09;&#xFF0C; &#x5C31;&#x4E2D;&#x6B62;&#x51FD;&#x6570;&#x8FD0;&#x884C;&#xFF0C;&#x8FD4;&#x56DE; nil&#x3002;
&quot;i&quot;: &#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8FD4;&#x56DE;&#x6574;&#x6570;&#x503C;&#x3002;
&quot;a&quot;: &#x4ECE;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x5F00;&#x59CB;&#x8BFB;&#x53D6;&#x6574;&#x4E2A;&#x6587;&#x4EF6;&#x3002; &#x5982;&#x679C;&#x5DF2;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#xFF0C;&#x8FD4;&#x56DE;&#x7A7A;&#x4E32;&#x3002;
&quot;l&quot;: &#x8BFB;&#x53D6;&#x4E00;&#x884C;&#x5E76;&#x5FFD;&#x7565;&#x884C;&#x7ED3;&#x675F;&#x6807;&#x8BB0;&#x3002; &#x5F53;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; nil &#x8FD9;&#x662F;&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x3002;
&quot;L&quot;: &#x8BFB;&#x53D6;&#x4E00;&#x884C;&#x5E76;&#x4FDD;&#x7559;&#x884C;&#x7ED3;&#x675F;&#x6807;&#x8BB0;&#xFF08;&#x5982;&#x679C;&#x6709;&#x7684;&#x8BDD;&#xFF09;&#xFF0C; &#x5F53;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; nil&#x3002;
number: &#x8BFB;&#x53D6;&#x4E00;&#x4E2A;&#x4E0D;&#x8D85;&#x8FC7;&#x8FD9;&#x4E2A;&#x6570;&#x91CF;&#x5B57;&#x8282;&#x6570;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x5F53;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; nil&#x3002; &#x5982;&#x679C; number &#x4E3A;&#x96F6;&#xFF0C; &#x5B83;&#x4EC0;&#x4E48;&#x4E5F;&#x4E0D;&#x8BFB;&#xFF0C;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7A7A;&#x4E32;&#x3002; &#x5F53;&#x5728;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; nil&#x3002;
&#x683C;&#x5F0F; &quot;l&quot; &#x548C; &quot;L&quot; &#x53EA;&#x80FD;&#x7528;&#x4E8E;&#x6587;&#x672C;&#x6587;&#x4EF6;&#x3002;</p>
<p>file:seek ([whence [, offset]])</p>
<p>&#x8BBE;&#x7F6E;&#x53CA;&#x83B7;&#x53D6;&#x57FA;&#x4E8E;&#x6587;&#x4EF6;&#x5F00;&#x5934;&#x5904;&#x8BA1;&#x7B97;&#x51FA;&#x7684;&#x4F4D;&#x7F6E;&#x3002; &#x8BBE;&#x7F6E;&#x7684;&#x4F4D;&#x7F6E;&#x7531; offset &#x548C; whence &#x5B57;&#x7B26;&#x4E32; whence &#x6307;&#x5B9A;&#x7684;&#x57FA;&#x70B9;&#x51B3;&#x5B9A;&#x3002;&#x57FA;&#x70B9;&#x53EF;&#x4EE5;&#x662F;&#xFF1A;</p>
<p>&quot;set&quot;: &#x57FA;&#x70B9;&#x4E3A; 0 &#xFF08;&#x6587;&#x4EF6;&#x5F00;&#x5934;&#xFF09;&#xFF1B;
&quot;cur&quot;: &#x57FA;&#x70B9;&#x4E3A;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#x4E86;&#xFF1B;
&quot;end&quot;: &#x57FA;&#x70B9;&#x4E3A;&#x6587;&#x4EF6;&#x5C3E;&#xFF1B;
&#x5F53; seek &#x6210;&#x529F;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE;&#x6700;&#x7EC8;&#x4ECE;&#x6587;&#x4EF6;&#x5F00;&#x5934;&#x8BA1;&#x7B97;&#x8D77;&#x7684;&#x6587;&#x4EF6;&#x7684;&#x4F4D;&#x7F6E;&#x3002; &#x5F53; seek &#x5931;&#x8D25;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE; nil &#x52A0;&#x4E0A;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x63CF;&#x8FF0;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>whence &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x662F; &quot;cur&quot;&#xFF0C; offset &#x9ED8;&#x8BA4;&#x4E3A; 0 &#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x8C03;&#x7528; file:seek() &#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x5F53;&#x524D;&#x4F4D;&#x7F6E;&#xFF0C;&#x5E76;&#x4E0D;&#x6539;&#x53D8;&#x5B83;&#xFF1B; &#x8C03;&#x7528; file:seek(&quot;set&quot;) &#x5C06;&#x4F4D;&#x7F6E;&#x8BBE;&#x4E3A;&#x6587;&#x4EF6;&#x5F00;&#x5934;&#xFF08;&#x5E76;&#x8FD4;&#x56DE; 0&#xFF09;&#xFF1B; &#x8C03;&#x7528; file:seek(&quot;end&quot;) &#x5C06;&#x4F4D;&#x7F6E;&#x8BBE;&#x5230;&#x6587;&#x4EF6;&#x672B;&#x5C3E;&#xFF0C;&#x5E76;&#x8FD4;&#x56DE;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x3002;</p>
<p>file:setvbuf (mode [, size])</p>
<p>&#x8BBE;&#x7F6E;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x7684;&#x7F13;&#x51B2;&#x6A21;&#x5F0F;&#x3002; &#x6709;&#x4E09;&#x79CD;&#x6A21;&#x5F0F;&#xFF1A;</p>
<p>&quot;no&quot;: &#x4E0D;&#x7F13;&#x51B2;&#xFF1B;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#x7ACB;&#x523B;&#x751F;&#x6548;&#x3002;
&quot;full&quot;: &#x5B8C;&#x5168;&#x7F13;&#x51B2;&#xFF1B;&#x53EA;&#x6709;&#x5728;&#x7F13;&#x5B58;&#x6EE1;&#x6216;&#x5F53;&#x4F60;&#x663E;&#x5F0F;&#x7684;&#x5BF9;&#x6587;&#x4EF6;&#x8C03;&#x7528; flush&#xFF08;&#x53C2;&#x89C1; io.flush&#xFF09; &#x65F6;&#x624D;&#x771F;&#x6B63;&#x505A;&#x8F93;&#x51FA;&#x64CD;&#x4F5C;&#x3002;
&quot;line&quot;: &#x884C;&#x7F13;&#x51B2;&#xFF1B; &#x8F93;&#x51FA;&#x5C06;&#x5230;&#x6BCF;&#x6B21;&#x6362;&#x884C;&#x524D;&#xFF0C; &#x5BF9;&#x4E8E;&#x67D0;&#x4E9B;&#x7279;&#x6B8A;&#x6587;&#x4EF6;&#xFF08;&#x4F8B;&#x5982;&#x7EC8;&#x7AEF;&#x8BBE;&#x5907;&#xFF09;&#x7F13;&#x51B2;&#x5230;&#x4EFB;&#x4F55;&#x8F93;&#x5165;&#x524D;&#x3002;
&#x5BF9;&#x4E8E;&#x540E;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#xFF0C;size &#x4EE5;&#x5B57;&#x8282;&#x6570;&#x4E3A;&#x5355;&#x4F4D; &#x6307;&#x5B9A;&#x7F13;&#x51B2;&#x533A;&#x5927;&#x5C0F;&#x3002; &#x9ED8;&#x8BA4;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;&#x6070;&#x5F53;&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<p>file:write (&#xB7;&#xB7;&#xB7;)</p>
<p>&#x5C06;&#x53C2;&#x6570;&#x7684;&#x503C;&#x9010;&#x4E2A;&#x5199;&#x5165; file&#x3002; &#x53C2;&#x6570;&#x5FC5;&#x987B;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x6570;&#x5B57;&#x3002;</p>
<p>&#x6210;&#x529F;&#x65F6;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE; file&#x3002; &#x5426;&#x5219;&#x8FD4;&#x56DE; nil &#x52A0;&#x9519;&#x8BEF;&#x63CF;&#x8FF0;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<h2 id="&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5E93;">&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5E93; <a href="#&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x5E93;"> # </a></h2>
<p>&#x8FD9;&#x4E2A;&#x5E93;&#x90FD;&#x901A;&#x8FC7;&#x8868; os &#x5B9E;&#x73B0;&#x3002;</p>
<p>os.clock ()</p>
<p>&#x8FD4;&#x56DE;&#x7A0B;&#x5E8F;&#x4F7F;&#x7528;&#x7684;&#x6309;&#x79D2;&#x8BA1; CPU &#x65F6;&#x95F4;&#x7684;&#x8FD1;&#x4F3C;&#x503C;&#x3002;</p>
<p>os.date ([format [, time]])</p>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5305;&#x542B;&#x65E5;&#x671F;&#x53CA;&#x65F6;&#x523B;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x8868;&#x3002; &#x683C;&#x5F0F;&#x5316;&#x65B9;&#x6CD5;&#x53D6;&#x51B3;&#x4E8E;&#x6240;&#x7ED9;&#x5B57;&#x7B26;&#x4E32; format&#x3002;</p>
<p>&#x5982;&#x679C;&#x63D0;&#x4F9B;&#x4E86; time &#x53C2;&#x6570;&#xFF0C; &#x683C;&#x5F0F;&#x5316;&#x8FD9;&#x4E2A;&#x65F6;&#x95F4; &#xFF08;&#x8FD9;&#x4E2A;&#x503C;&#x7684;&#x542B;&#x4E49;&#x53C2;&#x89C1; os.time &#x51FD;&#x6570;&#xFF09;&#x3002; &#x5426;&#x5219;&#xFF0C;date &#x683C;&#x5F0F;&#x5316;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x3002;</p>
<p>&#x5982;&#x679C; format &#x4EE5; &apos;!&apos; &#x6253;&#x5934;&#xFF0C; &#x65E5;&#x671F;&#x4EE5;&#x534F;&#x8C03;&#x4E16;&#x754C;&#x65F6;&#x683C;&#x5F0F;&#x5316;&#x3002; &#x5728;&#x8FD9;&#x4E2A;&#x53EF;&#x9009;&#x5B57;&#x7B26;&#x9879;&#x4E4B;&#x540E;&#xFF0C; &#x5982;&#x679C; format &#x4E3A;&#x5B57;&#x7B26;&#x4E32; &quot;*t&quot;&#xFF0C; date &#x8FD4;&#x56DE;&#x6709;&#x540E;&#x7EED;&#x57DF;&#x7684;&#x8868;&#xFF1A; year &#xFF08;&#x56DB;&#x4F4D;&#x6570;&#x5B57;&#xFF09;&#xFF0C;month &#xFF08;1&#x2013;12&#xFF09;&#xFF0C;day &#xFF08;1&#x2013;31&#xFF09;&#xFF0C; hour &#xFF08;0&#x2013;23&#xFF09;&#xFF0C;min &#xFF08;0&#x2013;59&#xFF09;&#xFF0C;sec &#xFF08;0&#x2013;61&#xFF09;&#xFF0C; wday &#xFF08;&#x661F;&#x671F;&#x51E0;&#xFF0C;&#x661F;&#x671F;&#x5929;&#x4E3A; 1 &#xFF09;&#xFF0C; yday &#xFF08;&#x5F53;&#x5E74;&#x7684;&#x7B2C;&#x51E0;&#x5929;&#xFF09;&#xFF0C; &#x4EE5;&#x53CA; isdst &#xFF08;&#x590F;&#x4EE4;&#x65F6;&#x6807;&#x8BB0;&#xFF0C;&#x4E00;&#x4E2A;&#x5E03;&#x5C14;&#x91CF;&#xFF09;&#x3002; &#x5BF9;&#x4E8E;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x57DF;&#xFF0C;&#x5982;&#x679C;&#x8BE5;&#x4FE1;&#x606F;&#x4E0D;&#x63D0;&#x4F9B;&#x7684;&#x8BDD;&#x5C31;&#x4E0D;&#x5B58;&#x5728;&#x3002;</p>
<p>&#x5982;&#x679C; format &#x5E76;&#x975E; &quot;*t&quot;&#xFF0C; date &#x4EE5;&#x5B57;&#x7B26;&#x4E32;&#x5F62;&#x5F0F;&#x8FD4;&#x56DE;&#xFF0C; &#x683C;&#x5F0F;&#x5316;&#x65B9;&#x6CD5;&#x9075;&#x5FAA; ISO C &#x51FD;&#x6570; strftime &#x7684;&#x89C4;&#x5219;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E0D;&#x4F20;&#x53C2;&#x6570;&#x8C03;&#x7528;&#xFF0C; date &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5408;&#x7406;&#x7684;&#x65E5;&#x671F;&#x65F6;&#x95F4;&#x4E32;&#xFF0C; &#x683C;&#x5F0F;&#x53D6;&#x51B3;&#x4E8E;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x4EE5;&#x53CA;&#x5F53;&#x524D;&#x7684;&#x533A;&#x57DF;&#x8BBE;&#x7F6E; &#xFF08;&#x5373;&#xFF0C;os.date() &#x7B49;&#x4EF7;&#x4E8E; os.date(&quot;%c&quot;)&#xFF09;&#x3002;</p>
<p>&#x5728;&#x975E; POSIX &#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C; &#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F9D;&#x8D56; C &#x51FD;&#x6570; gmtime &#x548C; localtime&#xFF0C; &#x5B83;&#x53EF;&#x80FD;&#x5E76;&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<p>os.difftime (t2, t1)</p>
<p>&#x8FD4;&#x56DE;&#x4EE5;&#x79D2;&#x8BA1;&#x7B97;&#x7684;&#x65F6;&#x523B; t1 &#x5230; t2 &#x7684;&#x5DEE;&#x503C;&#x3002; &#xFF08;&#x8FD9;&#x91CC;&#x7684;&#x65F6;&#x523B;&#x662F;&#x7531; os.time &#x8FD4;&#x56DE;&#x7684;&#x503C;&#xFF09;&#x3002; &#x5728; POSIX&#xFF0C;Windows&#xFF0C;&#x548C;&#x5176;&#x5B83;&#x4E00;&#x4E9B;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E2A;&#x503C;&#x5C31;&#x7B49;&#x4E8E; t2-t1&#x3002;</p>
<p>os.execute ([command])</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7B49;&#x4EF7;&#x4E8E; ISO C &#x51FD;&#x6570; system&#x3002; &#x5B83;&#x8C03;&#x7528;&#x7CFB;&#x7EDF;&#x89E3;&#x91CA;&#x5668;&#x6267;&#x884C; command&#x3002; &#x5982;&#x679C;&#x547D;&#x4EE4;&#x6210;&#x529F;&#x8FD0;&#x884C;&#x5B8C;&#x6BD5;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x5C31;&#x662F; true&#xFF0C; &#x5426;&#x5219;&#x662F; nil otherwise&#x3002; &#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x8FD4;&#x56DE;&#x503C;&#x4E4B;&#x540E;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x3002;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>&quot;exit&quot;: &#x547D;&#x4EE4;&#x6B63;&#x5E38;&#x7ED3;&#x675F;&#xFF1B; &#x63A5;&#x4E0B;&#x6765;&#x7684;&#x6570;&#x5B57;&#x662F;&#x547D;&#x4EE4;&#x7684;&#x9000;&#x51FA;&#x72B6;&#x6001;&#x7801;&#x3002;
&quot;signal&quot;: &#x547D;&#x4EE4;&#x88AB;&#x4FE1;&#x53F7;&#x6253;&#x65AD;&#xFF1B; &#x63A5;&#x4E0B;&#x6765;&#x7684;&#x6570;&#x5B57;&#x662F;&#x6253;&#x65AD;&#x8BE5;&#x547D;&#x4EE4;&#x7684;&#x4FE1;&#x53F7;&#x3002;
&#x5982;&#x679C;&#x4E0D;&#x5E26;&#x53C2;&#x6570;&#x8C03;&#x7528;&#xFF0C; os.execute &#x5728;&#x7CFB;&#x7EDF;&#x89E3;&#x91CA;&#x5668;&#x5B58;&#x5728;&#x7684;&#x65F6;&#x5019;&#x8FD4;&#x56DE;&#x771F;&#x3002;</p>
<p>os.exit ([code [, close]])</p>
<p>&#x8C03;&#x7528; ISO C &#x51FD;&#x6570; exit &#x7EC8;&#x6B62;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x3002; &#x5982;&#x679C; code &#x4E3A; true&#xFF0C; &#x8FD4;&#x56DE;&#x7684;&#x72B6;&#x6001;&#x7801;&#x662F; EXIT_SUCCESS&#xFF1B; &#x5982;&#x679C; code &#x4E3A; false&#xFF0C; &#x8FD4;&#x56DE;&#x7684;&#x72B6;&#x6001;&#x7801;&#x662F; EXIT_FAILURE&#xFF1B; &#x5982;&#x679C; code &#x662F;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#xFF0C; &#x8FD4;&#x56DE;&#x7684;&#x72B6;&#x6001;&#x7801;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x3002; code &#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A; true&#x3002;</p>
<p>&#x5982;&#x679C;&#x7B2C;&#x4E8C;&#x4E2A;&#x53EF;&#x9009;&#x53C2;&#x6570; close &#x4E3A;&#x771F;&#xFF0C; &#x5728;&#x9000;&#x51FA;&#x524D;&#x5173;&#x95ED; Lua &#x72B6;&#x6001;&#x673A;&#x3002;</p>
<p>os.getenv (varname)</p>
<p>&#x8FD4;&#x56DE;&#x8FDB;&#x7A0B;&#x73AF;&#x5883;&#x53D8;&#x91CF; varname &#x7684;&#x503C;&#xFF0C; &#x5982;&#x679C;&#x8BE5;&#x53D8;&#x91CF;&#x672A;&#x5B9A;&#x4E49;&#xFF0C;&#x8FD4;&#x56DE; nil &#x3002;</p>
<p>os.remove (filename)</p>
<p>&#x5220;&#x9664;&#x6307;&#x5B9A;&#x540D;&#x5B57;&#x7684;&#x6587;&#x4EF6;&#xFF08;&#x5728; POSIX &#x7CFB;&#x7EDF;&#x4E0A;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x7A7A;&#x76EE;&#x5F55;&#xFF09; &#x5982;&#x679C;&#x51FD;&#x6570;&#x5931;&#x8D25;&#xFF0C;&#x8FD4;&#x56DE; nil &#x52A0;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x63CF;&#x8FF0;&#x4E32;&#x53CA;&#x51FA;&#x9519;&#x7801;&#x3002;</p>
<p>os.rename (oldname, newname)</p>
<p>&#x5C06;&#x540D;&#x5B57;&#x4E3A; oldname &#x7684;&#x6587;&#x4EF6;&#x6216;&#x76EE;&#x5F55;&#x66F4;&#x540D;&#x4E3A; newname&#x3002; &#x5982;&#x679C;&#x51FD;&#x6570;&#x5931;&#x8D25;&#xFF0C;&#x8FD4;&#x56DE; nil &#x52A0;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x63CF;&#x8FF0;&#x4E32;&#x53CA;&#x51FA;&#x9519;&#x7801;&#x3002;</p>
<p>os.setlocale (locale [, category])</p>
<p>&#x8BBE;&#x7F6E;&#x7A0B;&#x5E8F;&#x7684;&#x5F53;&#x524D;&#x533A;&#x57DF;&#x3002; locale &#x662F;&#x4E00;&#x4E2A;&#x533A;&#x57DF;&#x8BBE;&#x7F6E;&#x7684;&#x7CFB;&#x7EDF;&#x76F8;&#x5173;&#x5B57;&#x7B26;&#x4E32;&#xFF1B; category &#x662F;&#x4E00;&#x4E2A;&#x63CF;&#x8FF0;&#x6709;&#x6539;&#x53D8;&#x54EA;&#x4E2A;&#x5206;&#x7C7B;&#x7684;&#x53EF;&#x9009;&#x5B57;&#x7B26;&#x4E32;&#xFF1A; &quot;all&quot;&#xFF0C;&quot;collate&quot;&#xFF0C; &quot;ctype&quot;&#xFF0C; &quot;monetary&quot;&#xFF0C; &quot;numeric&quot;&#xFF0C; &#x6216; &quot;time&quot;&#xFF1B; &#x9ED8;&#x8BA4;&#x7684;&#x5206;&#x7C7B;&#x4E3A; &quot;all&quot;&#x3002; &#x6B64;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x65B0;&#x533A;&#x57DF;&#x7684;&#x540D;&#x5B57;&#x3002; &#x5982;&#x679C;&#x8BF7;&#x6C42;&#x672A;&#x88AB;&#x83B7;&#x51C6;&#xFF0C;&#x8FD4;&#x56DE; nil &#x3002;</p>
<p>&#x5F53; locale &#x662F;&#x4E00;&#x4E2A;&#x7A7A;&#x4E32;&#xFF0C; &#x5F53;&#x524D;&#x533A;&#x57DF;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A;&#x4E00;&#x4E2A;&#x5728;&#x5B9E;&#x73B0;&#x4E2D;&#x5B9A;&#x4E49;&#x597D;&#x7684;&#x672C;&#x5730;&#x533A;&#x57DF;&#x3002; &#x5F53; locale &#x4E3A;&#x5B57;&#x7B26;&#x4E32; &quot;C&quot;&#xFF0C; &#x5F53;&#x524D;&#x533A;&#x57DF;&#x88AB;&#x8BBE;&#x7F6E;&#x4E3A;&#x6807;&#x51C6; C &#x533A;&#x57DF;&#x3002;</p>
<p>&#x5F53;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4E3A; nil &#x65F6;&#xFF0C; &#x6B64;&#x51FD;&#x6570;&#x4EC5;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x533A;&#x57DF;&#x6307;&#x5B9A;&#x5206;&#x7C7B;&#x7684;&#x540D;&#x5B57;&#x3002;</p>
<p>&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F9D;&#x8D56; C &#x51FD;&#x6570; setlocale&#xFF0C; &#x5B83;&#x53EF;&#x80FD;&#x5E76;&#x975E;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#x3002;</p>
<p>os.time ([table])</p>
<p>&#x5F53;&#x4E0D;&#x4F20;&#x53C2;&#x6570;&#x65F6;&#xFF0C;&#x8FD4;&#x56DE;&#x5F53;&#x524D;&#x65F6;&#x523B;&#x3002; &#x5982;&#x679C;&#x4F20;&#x5165;&#x4E00;&#x5F20;&#x8868;&#xFF0C;&#x5C31;&#x8FD4;&#x56DE;&#x7531;&#x8FD9;&#x5F20;&#x8868;&#x8868;&#x793A;&#x7684;&#x65F6;&#x523B;&#x3002; &#x8FD9;&#x5F20;&#x8868;&#x5FC5;&#x987B;&#x5305;&#x542B;&#x57DF; year&#xFF0C;month&#xFF0C;&#x53CA; day&#xFF1B; &#x53EF;&#x4EE5;&#x5305;&#x542B;&#x6709;&#x3000;hour &#xFF08;&#x9ED8;&#x8BA4;&#x4E3A; 12 &#xFF09;&#xFF0C; min &#xFF08;&#x9ED8;&#x8BA4;&#x4E3A; 0&#xFF09;&#xFF0C; sec &#xFF08;&#x9ED8;&#x8BA4;&#x4E3A; 0&#xFF09;&#xFF0C;&#x4EE5;&#x53CA; isdst &#xFF08;&#x9ED8;&#x8BA4;&#x4E3A; nil&#xFF09;&#x3002; &#x5173;&#x4E8E;&#x8FD9;&#x4E9B;&#x57DF;&#x7684;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;&#xFF0C;&#x53C2;&#x89C1; os.date &#x51FD;&#x6570;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x503C;&#x662F;&#x4E00;&#x4E2A;&#x542B;&#x4E49;&#x7531;&#x4F60;&#x7684;&#x7CFB;&#x7EDF;&#x51B3;&#x5B9A;&#x7684;&#x6570;&#x5B57;&#x3002; &#x5728; POSIX&#xFF0C;Windows&#xFF0C;&#x548C;&#x5176;&#x5B83;&#x4E00;&#x4E9B;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C; &#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x7EDF;&#x8BA1;&#x4E86;&#x4ECE;&#x6307;&#x5B9A;&#x65F6;&#x95F4;&#xFF08;&quot;epoch&quot;&#xFF09;&#x5F00;&#x59CB;&#x7ECF;&#x5386;&#x7684;&#x79D2;&#x6570;&#x3002; &#x5BF9;&#x4E8E;&#x53E6;&#x5916;&#x7684;&#x7CFB;&#x7EDF;&#xFF0C;&#x5176;&#x542B;&#x4E49;&#x672A;&#x5B9A;&#x4E49;&#xFF0C; &#x4F60;&#x53EA;&#x80FD;&#x628A; time &#x7684;&#x8FD4;&#x56DE;&#x6570;&#x5B57;&#x7528;&#x4E8E; os.date &#x548C; os.difftime &#x7684;&#x53C2;&#x6570;&#x3002;</p>
<p>os.tmpname ()</p>
<p>&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x53EF;&#x7528;&#x4E8E;&#x4E34;&#x65F6;&#x6587;&#x4EF6;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5728;&#x4F7F;&#x7528;&#x524D;&#x5FC5;&#x987B;&#x663E;&#x5F0F;&#x6253;&#x5F00;&#xFF0C;&#x4E0D;&#x518D;&#x4F7F;&#x7528;&#x65F6;&#x9700;&#x8981;&#x663E;&#x5F0F;&#x5220;&#x9664;&#x3002;</p>
<p>&#x5728; POSIX &#x7CFB;&#x7EDF;&#x4E0A;&#xFF0C; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4F1A;&#x4EE5;&#x6B64;&#x6587;&#x4EF6;&#x540D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4EE5;&#x56DE;&#x907F;&#x5B89;&#x5168;&#x98CE;&#x9669;&#x3002; &#xFF08;&#x522B;&#x4EBA;&#x53EF;&#x80FD;&#x672A;&#x7ECF;&#x5141;&#x8BB8;&#x5728;&#x83B7;&#x53D6;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x540D;&#x5230;&#x521B;&#x5EFA;&#x8BE5;&#x6587;&#x4EF6;&#x4E4B;&#x95F4;&#x7684;&#x65F6;&#x523B;&#x521B;&#x5EFA;&#x6B64;&#x6587;&#x4EF6;&#x3002;&#xFF09; &#x4F60;&#x4F9D;&#x65E7;&#x9700;&#x8981;&#x5728;&#x4F7F;&#x7528;&#x5B83;&#x7684;&#x65F6;&#x5019;&#x5148;&#x6253;&#x5F00;&#xFF0C;&#x5E76;&#x6700;&#x540E;&#x5220;&#x9664;&#xFF08;&#x5373;&#x4F7F;&#x4F60;&#x6CA1;&#x4F7F;&#x7528;&#x5230;&#xFF09;&#x3002;</p>
<p>&#x53EA;&#x6709;&#x6709;&#x53EF;&#x80FD;&#xFF0C;&#x4F60;&#x66F4;&#x5E94;&#x8BE5;&#x4F7F;&#x7528; io.tmpfile&#xFF0C; &#x56E0;&#x4E3A;&#x8BE5;&#x6587;&#x4EF6;&#x53EF;&#x4EE5;&#x5728;&#x7A0B;&#x5E8F;&#x7ED3;&#x675F;&#x65F6;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x3002;</p>
<h2 id="&#x8C03;&#x8BD5;&#x5E93;">&#x8C03;&#x8BD5;&#x5E93; <a href="#&#x8C03;&#x8BD5;&#x5E93;"> # </a></h2>
<p>&#x8FD9;&#x4E2A;&#x5E93;&#x63D0;&#x4F9B;&#x4E86; Lua &#x7A0B;&#x5E8F;&#x8C03;&#x8BD5;&#x63A5;&#x53E3;&#xFF08;&#xA7;4.9&#xFF09;&#x7684;&#x529F;&#x80FD;&#x3002; &#x5176;&#x4E2D;&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x8FDD;&#x53CD;&#x4E86; Lua &#x4EE3;&#x7801;&#x7684;&#x57FA;&#x672C;&#x5047;&#x5B9A; &#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x4E0D;&#x4F1A;&#x4ECE;&#x51FD;&#x6570;&#x4E4B;&#x5916;&#x8BBF;&#x95EE;&#x51FD;&#x6570;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF1B; &#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x5143;&#x8868;&#x4E0D;&#x4F1A;&#x88AB; Lua &#x4EE3;&#x7801;&#x4FEE;&#x6539;&#xFF1B; Lua &#x7A0B;&#x5E8F;&#x4E0D;&#x4F1A;&#x5D29;&#x6E83;&#xFF09;&#xFF0C; &#x56E0;&#x6B64;&#x5B83;&#x4EEC;&#x6709;&#x53EF;&#x80FD;&#x5371;&#x5BB3;&#x5230;&#x5176;&#x5B83;&#x4EE3;&#x7801;&#x7684;&#x5B89;&#x5168;&#x6027;&#x3002; &#x6B64;&#x5916;&#xFF0C;&#x5E93;&#x91CC;&#x7684;&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x53EF;&#x80FD;&#x8FD0;&#x884C;&#x7684;&#x5F88;&#x6162;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x5E93;&#x91CC;&#x7684;&#x6240;&#x6709;&#x51FD;&#x6570;&#x90FD;&#x63D0;&#x4F9B;&#x5728;&#x8868; debug &#x5185;&#x3002; &#x6240;&#x6709;&#x64CD;&#x4F5C;&#x7EBF;&#x7A0B;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x53EF;&#x9009;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x90FD;&#x662F;&#x9488;&#x5BF9;&#x7684;&#x7EBF;&#x7A0B;&#x3002; &#x9ED8;&#x8BA4;&#x503C;&#x6C38;&#x8FDC;&#x662F;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x3002;</p>
<p>debug.debug ()</p>
<p>&#x8FDB;&#x5165;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x4EA4;&#x4E92;&#x6A21;&#x5F0F;&#xFF0C;&#x8FD0;&#x884C;&#x7528;&#x6237;&#x8F93;&#x5165;&#x7684;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002; &#x4F7F;&#x7528;&#x7B80;&#x5355;&#x7684;&#x547D;&#x4EE4;&#x4EE5;&#x53CA;&#x5176;&#x5B83;&#x8C03;&#x8BD5;&#x8BBE;&#x7F6E;&#xFF0C;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x68C0;&#x9605;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x548C;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF0C; &#x6539;&#x53D8;&#x53D8;&#x91CF;&#x7684;&#x503C;&#xFF0C;&#x8BA1;&#x7B97;&#x4E00;&#x4E9B;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x7B49;&#x7B49;&#x3002; &#x8F93;&#x5165;&#x4E00;&#x884C;&#x4EC5;&#x5305;&#x542B; cont &#x7684;&#x5B57;&#x7B26;&#x4E32;&#x5C06;&#x7ED3;&#x675F;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#xFF0C; &#x8FD9;&#x6837;&#x8C03;&#x7528;&#x8005;&#x5C31;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x5411;&#x4E0B;&#x8FD0;&#x884C;&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF0C;debug.debug &#x8F93;&#x5165;&#x7684;&#x547D;&#x4EE4;&#x5728;&#x6587;&#x6CD5;&#x4E0A;&#x5E76;&#x6CA1;&#x6709;&#x5185;&#x5D4C;&#x5230;&#x4EFB;&#x4F55;&#x51FD;&#x6570;&#x4E2D;&#xFF0C; &#x56E0;&#x6B64;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x53BB;&#x8BBF;&#x95EE;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x3002;</p>
<p>debug.gethook ([thread])</p>
<p>&#x8FD4;&#x56DE;&#x4E09;&#x4E2A;&#x8868;&#x793A;&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;&#x8BBE;&#x7F6E;&#x7684;&#x503C;&#xFF1A; &#x5F53;&#x524D;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#xFF0C;&#x5F53;&#x524D;&#x94A9;&#x5B50;&#x63A9;&#x7801;&#xFF0C;&#x5F53;&#x524D;&#x94A9;&#x5B50;&#x8BA1;&#x6570; &#xFF08;debug.sethook &#x8BBE;&#x7F6E;&#x7684;&#x90A3;&#x4E9B;&#xFF09;&#x3002;</p>
<p>debug.getinfo ([thread,] f [, what])</p>
<p>&#x8FD4;&#x56DE;&#x5173;&#x4E8E;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4FE1;&#x606F;&#x7684;&#x8868;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x63D0;&#x4F9B;&#x8BE5;&#x51FD;&#x6570;&#xFF0C; &#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x4E00;&#x4E2A;&#x6570;&#x5B57; f &#x8868;&#x793A;&#x8BE5;&#x51FD;&#x6570;&#x3002; &#x6570;&#x5B57; f &#x8868;&#x793A;&#x8FD0;&#x884C;&#x5728;&#x6307;&#x5B9A;&#x7EBF;&#x7A0B;&#x7684;&#x8C03;&#x7528;&#x6808;&#x5BF9;&#x5E94;&#x5C42;&#x6B21;&#x4E0A;&#x7684;&#x51FD;&#x6570;&#xFF1A; 0 &#x5C42;&#x8868;&#x793A;&#x5F53;&#x524D;&#x51FD;&#x6570;&#xFF08;getinfo &#x81EA;&#x8EAB;&#xFF09;&#xFF1B; 1 &#x5C42;&#x8868;&#x793A;&#x8C03;&#x7528; getinfo &#x7684;&#x51FD;&#x6570; &#xFF08;&#x9664;&#x975E;&#x662F;&#x5C3E;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0D;&#x8BA1;&#x5165;&#x6808;&#xFF09;&#xFF1B;&#x7B49;&#x7B49;&#x3002; &#x5982;&#x679C; f &#x662F;&#x4E00;&#x4E2A;&#x6BD4;&#x6D3B;&#x52A8;&#x51FD;&#x6570;&#x6570;&#x91CF;&#x8FD8;&#x5927;&#x7684;&#x6570;&#x5B57;&#xFF0C; getinfo &#x8FD4;&#x56DE; nil&#x3002;</p>
<p>&#x53EA;&#x6709;&#x5B57;&#x7B26;&#x4E32; what &#x4E2D;&#x6709;&#x63CF;&#x8FF0;&#x8981;&#x586B;&#x5145;&#x54EA;&#x4E9B;&#x9879;&#xFF0C; &#x8FD4;&#x56DE;&#x7684;&#x8868;&#x53EF;&#x4EE5;&#x5305;&#x542B; lua_getinfo &#x80FD;&#x8FD4;&#x56DE;&#x7684;&#x6240;&#x6709;&#x9879;&#x3002; what &#x9ED8;&#x8BA4;&#x662F;&#x8FD4;&#x56DE;&#x63D0;&#x4F9B;&#x7684;&#x9664;&#x5408;&#x6CD5;&#x884C;&#x53F7;&#x8868;&#x5916;&#x7684;&#x6240;&#x6709;&#x4FE1;&#x606F;&#x3002; &#x5BF9;&#x4E8E;&#x9009;&#x9879; &apos;f&apos; &#xFF0C;&#x4F1A;&#x5728;&#x53EF;&#x80FD;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x589E;&#x52A0; func &#x57DF;&#x4FDD;&#x5B58;&#x51FD;&#x6570;&#x81EA;&#x8EAB;&#x3002; &#x5BF9;&#x4E8E;&#x9009;&#x9879; &apos;L&apos; &#xFF0C;&#x4F1A;&#x5728;&#x53EF;&#x80FD;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x589E;&#x52A0; activelines &#x57DF;&#x4FDD;&#x5B58;&#x5408;&#x6CD5;&#x884C;&#x53F7;&#x8868;&#x3002;</p>
<p>&#x4F8B;&#x5982;,&#x8868;&#x8FBE;&#x5F0F; debug.getinfo(1,&quot;n&quot;) &#x8FD4;&#x56DE;&#x5E26;&#x6709;&#x5F53;&#x524D;&#x51FD;&#x6570;&#x540D;&#x5B57;&#x4FE1;&#x606F;&#x7684;&#x8868;&#xFF08;&#x5982;&#x679C;&#x627E;&#x7684;&#x5230;&#x540D;&#x5B57;&#x7684;&#x8BDD;&#xFF09;&#xFF0C; &#x8868;&#x8FBE;&#x5F0F; debug.getinfo(print) &#x8FD4;&#x56DE;&#x5173;&#x4E8E; print &#x51FD;&#x6570;&#x7684; &#x5305;&#x542B;&#x6709;&#x6240;&#x6709;&#x80FD;&#x63D0;&#x4F9B;&#x4FE1;&#x606F;&#x7684;&#x8868;&#x3002;</p>
<p>debug.getlocal ([thread,] f, local)</p>
<p>&#x6B64;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x5728;&#x6808;&#x7684; f &#x5C42;&#x5904;&#x51FD;&#x6570;&#x7684;&#x7D22;&#x5F15;&#x4E3A; local &#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF; &#x7684;&#x540D;&#x5B57;&#x548C;&#x503C;&#x3002; &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x4E0D;&#x4EC5;&#x7528;&#x4E8E;&#x8BBF;&#x95EE;&#x663E;&#x5F0F;&#x5B9A;&#x4E49;&#x7684;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF0C;&#x4E5F;&#x5305;&#x62EC;&#x5F62;&#x53C2;&#x3001;&#x4E34;&#x65F6;&#x53D8;&#x91CF;&#x7B49;&#x3002;</p>
<p>&#x7B2C;&#x4E00;&#x4E2A;&#x5F62;&#x53C2;&#x6216;&#x662F;&#x5B9A;&#x4E49;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x7D22;&#x5F15;&#x4E3A; 1 &#xFF0C; &#x7136;&#x540E;&#x9075;&#x5FAA;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x5B9A;&#x4E49;&#x6B21;&#x5E8F;&#xFF0C;&#x4EE5;&#x6B21;&#x7C7B;&#x63A8;&#x3002; &#x5176;&#x4E2D;&#x53EA;&#x8BA1;&#x7B97;&#x51FD;&#x6570;&#x5F53;&#x524D;&#x4F5C;&#x7528;&#x57DF;&#x7684;&#x6D3B;&#x52A8;&#x53D8;&#x91CF;&#x3002; &#x8D1F;&#x7D22;&#x5F15;&#x6307;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#xFF1B; -1 &#x6307;&#x7B2C;&#x4E00;&#x4E2A;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x3002; &#x5982;&#x679C;&#x8BE5;&#x7D22;&#x5F15;&#x5904;&#x6CA1;&#x6709;&#x53D8;&#x91CF;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE; nil&#x3002; &#x82E5;&#x6307;&#x5B9A;&#x7684;&#x5C42;&#x6B21;&#x8D8A;&#x754C;&#xFF0C;&#x629B;&#x51FA;&#x9519;&#x8BEF;&#x3002; &#xFF08;&#x4F60;&#x53EF;&#x4EE5;&#x8C03;&#x7528; debug.getinfo &#x6765;&#x68C0;&#x67E5;&#x5C42;&#x6B21;&#x662F;&#x5426;&#x5408;&#x6CD5;&#x3002;&#xFF09;</p>
<p>&#x4EE5; &apos;(&apos; &#xFF08;&#x5F00;&#x62EC;&#x53F7;&#xFF09;&#x6253;&#x5934;&#x7684;&#x53D8;&#x91CF;&#x540D;&#x8868;&#x793A;&#x6CA1;&#x6709;&#x540D;&#x5B57;&#x7684;&#x53D8;&#x91CF; &#xFF08;&#x6BD4;&#x5982;&#x662F;&#x5FAA;&#x73AF;&#x63A7;&#x5236;&#x7528;&#x5230;&#x7684;&#x63A7;&#x5236;&#x53D8;&#x91CF;&#xFF0C; &#x6216;&#x662F;&#x53BB;&#x9664;&#x4E86;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x7684;&#x4EE3;&#x7801;&#x5757;&#xFF09;&#x3002;</p>
<p>&#x53C2;&#x6570; f &#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x3002; &#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;getlocal &#x4EC5;&#x8FD4;&#x56DE;&#x51FD;&#x6570;&#x5F62;&#x53C2;&#x7684;&#x540D;&#x5B57;&#x3002;</p>
<p>debug.getmetatable (value)</p>
<p>&#x8FD4;&#x56DE;&#x7ED9;&#x5B9A; value &#x7684;&#x5143;&#x8868;&#x3002; &#x82E5;&#x5176;&#x6CA1;&#x6709;&#x5143;&#x8868;&#x5219;&#x8FD4;&#x56DE; nil &#x3002;</p>
<p>debug.getregistry ()</p>
<p>&#x8FD4;&#x56DE;&#x6CE8;&#x518C;&#x8868;&#xFF08;&#x53C2;&#x89C1; &#xA7;4.5&#xFF09;&#x3002;</p>
<p>debug.getupvalue (f, up)</p>
<p>&#x6B64;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x51FD;&#x6570; f &#x7684;&#x7B2C; up &#x4E2A;&#x4E0A;&#x503C;&#x7684;&#x540D;&#x5B57;&#x548C;&#x503C;&#x3002; &#x5982;&#x679C;&#x8BE5;&#x51FD;&#x6570;&#x6CA1;&#x6709;&#x90A3;&#x4E2A;&#x4E0A;&#x503C;&#xFF0C;&#x8FD4;&#x56DE; nil &#x3002;</p>
<p>&#x4EE5; &apos;(&apos; &#xFF08;&#x5F00;&#x62EC;&#x53F7;&#xFF09;&#x6253;&#x5934;&#x7684;&#x53D8;&#x91CF;&#x540D;&#x8868;&#x793A;&#x6CA1;&#x6709;&#x540D;&#x5B57;&#x7684;&#x53D8;&#x91CF; &#xFF08;&#x53BB;&#x9664;&#x4E86;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x7684;&#x4EE3;&#x7801;&#x5757;&#xFF09;&#x3002;</p>
<p>debug.getuservalue (u)</p>
<p>&#x8FD4;&#x56DE;&#x5173;&#x8054;&#x5728; u &#x4E0A;&#x7684; Lua &#x503C;&#x3002; &#x5982;&#x679C; u &#x5E76;&#x975E;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C;&#x8FD4;&#x56DE; nil&#x3002;</p>
<p>debug.sethook ([thread,] hook, mask [, count])</p>
<p>&#x5C06;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x4F5C;&#x4E3A;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x8BBE;&#x5165;&#x3002; &#x5B57;&#x7B26;&#x4E32; mask &#x4EE5;&#x53CA;&#x6570;&#x5B57; count &#x51B3;&#x5B9A;&#x4E86;&#x94A9;&#x5B50;&#x5C06;&#x5728;&#x4F55;&#x65F6;&#x8C03;&#x7528;&#x3002; &#x63A9;&#x7801;&#x662F;&#x7531;&#x4E0B;&#x5217;&#x5B57;&#x7B26;&#x7EC4;&#x5408;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x6709;&#x5176;&#x542B;&#x4E49;&#xFF1A;</p>
<p>&apos;c&apos;: &#x6BCF;&#x5F53; Lua &#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x94A9;&#x5B50;&#xFF1B;
&apos;r&apos;: &#x6BCF;&#x5F53; Lua &#x4ECE;&#x4E00;&#x4E2A;&#x51FD;&#x6570;&#x5185;&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x94A9;&#x5B50;&#xFF1B;
&apos;l&apos;: &#x6BCF;&#x5F53; Lua &#x8FDB;&#x5165;&#x65B0;&#x7684;&#x4E00;&#x884C;&#x65F6;&#xFF0C;&#x8C03;&#x7528;&#x94A9;&#x5B50;&#x3002;
&#x6B64;&#x5916;&#xFF0C; &#x4F20;&#x5165;&#x4E00;&#x4E2A;&#x4E0D;&#x4E3A;&#x96F6;&#x7684; count &#xFF0C; &#x94A9;&#x5B50;&#x5C06;&#x5728;&#x6BCF;&#x8FD0;&#x884C; count &#x6761;&#x6307;&#x4EE4;&#x65F6;&#x8C03;&#x7528;&#x3002;</p>
<p>&#x5982;&#x679C;&#x4E0D;&#x4F20;&#x5165;&#x53C2;&#x6570;&#xFF0C; debug.sethook &#x5173;&#x95ED;&#x94A9;&#x5B50;&#x3002;</p>
<p>&#x5F53;&#x94A9;&#x5B50;&#x88AB;&#x8C03;&#x7528;&#x65F6;&#xFF0C; &#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x89E6;&#x53D1;&#x8FD9;&#x6B21;&#x8C03;&#x7528;&#x7684;&#x4E8B;&#x4EF6;&#xFF1A; &quot;call&quot; &#xFF08;&#x6216; &quot;tail call&quot;&#xFF09;&#xFF0C; &quot;return&quot;&#xFF0C; &quot;line&quot;&#xFF0C; &quot;count&quot;&#x3002; &#x5BF9;&#x4E8E;&#x884C;&#x4E8B;&#x4EF6;&#xFF0C; &#x94A9;&#x5B50;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x65B0;&#x7684;&#x884C;&#x53F7;&#x3002; &#x5728;&#x94A9;&#x5B50;&#x5185;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8C03;&#x7528; getinfo &#xFF0C;&#x6307;&#x5B9A;&#x7B2C; 2 &#x5C42;&#xFF0C; &#x6765;&#x83B7;&#x5F97;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x51FD;&#x6570;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F; &#xFF08;0 &#x5C42;&#x6307; getinfo &#x51FD;&#x6570;&#xFF0C; 1 &#x5C42;&#x6307;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#xFF09;&#x3002;</p>
<p>debug.setlocal ([thread,] level, local, value)</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06; value &#x8D4B;&#x7ED9; &#x6808;&#x4E0A;&#x7B2C; level &#x5C42;&#x51FD;&#x6570;&#x7684;&#x7B2C; local &#x4E2A;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x3002; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x90A3;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x51FD;&#x6570;&#x8FD4;&#x56DE; nil &#x3002; &#x5982;&#x679C; level &#x8D8A;&#x754C;&#xFF0C;&#x629B;&#x51FA;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;&#x3002; &#xFF08;&#x4F60;&#x53EF;&#x4EE5;&#x8C03;&#x7528; debug.getinfo &#x6765;&#x68C0;&#x67E5;&#x5C42;&#x6B21;&#x662F;&#x5426;&#x5408;&#x6CD5;&#x3002;&#xFF09; &#x5426;&#x5219;&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#x7684;&#x540D;&#x5B57;&#x3002;</p>
<p>&#x5173;&#x4E8E;&#x53D8;&#x91CF;&#x7D22;&#x5F15;&#x548C;&#x540D;&#x5B57;&#xFF0C;&#x53C2;&#x89C1; debug.getlocal&#x3002;</p>
<p>debug.setmetatable (value, table)</p>
<p>&#x5C06; value &#x7684;&#x5143;&#x8868;&#x8BBE;&#x4E3A; table &#xFF08;&#x53EF;&#x4EE5;&#x662F; nil&#xFF09;&#x3002; &#x8FD4;&#x56DE; value&#x3002;</p>
<p>debug.setupvalue (f, up, value)</p>
<p>&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06; value &#x8BBE;&#x4E3A;&#x51FD;&#x6570; f &#x7684;&#x7B2C; up &#x4E2A;&#x4E0A;&#x503C;&#x3002; &#x5982;&#x679C;&#x51FD;&#x6570;&#x6CA1;&#x6709;&#x90A3;&#x4E2A;&#x4E0A;&#x503C;&#xFF0C;&#x8FD4;&#x56DE; nil &#x5426;&#x5219;&#xFF0C;&#x8FD4;&#x56DE;&#x8BE5;&#x4E0A;&#x503C;&#x7684;&#x540D;&#x5B57;&#x3002;</p>
<p>debug.setuservalue (udata, value)</p>
<p>&#x5C06; value &#x8BBE;&#x4E3A; udata &#x7684;&#x5173;&#x8054;&#x503C;&#x3002; udata &#x5FC5;&#x987B;&#x662F;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x7528;&#x6237;&#x6570;&#x636E;&#x3002;</p>
<p>&#x8FD4;&#x56DE; udata&#x3002;</p>
<p>debug.traceback ([thread,] [message [, level]])</p>
<p>&#x5982;&#x679C; message &#x6709;&#xFF0C;&#x4E14;&#x4E0D;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x6216; nil&#xFF0C; &#x51FD;&#x6570;&#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x5904;&#x7406;&#x76F4;&#x63A5;&#x8FD4;&#x56DE; message&#x3002; &#x5426;&#x5219;&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x8C03;&#x7528;&#x6808;&#x7684;&#x6808;&#x56DE;&#x6EAF;&#x4FE1;&#x606F;&#x3002; &#x5B57;&#x7B26;&#x4E32;&#x53EF;&#x9009;&#x9879; message &#x88AB;&#x6DFB;&#x52A0;&#x5728;&#x6808;&#x56DE;&#x6EAF;&#x4FE1;&#x606F;&#x7684;&#x5F00;&#x5934;&#x3002; &#x6570;&#x5B57;&#x53EF;&#x9009;&#x9879; level &#x6307;&#x660E;&#x4ECE;&#x6808;&#x7684;&#x54EA;&#x4E00;&#x5C42;&#x5F00;&#x59CB;&#x56DE;&#x6EAF; &#xFF08;&#x9ED8;&#x8BA4;&#x4E3A; 1 &#xFF0C;&#x5373;&#x8C03;&#x7528; traceback &#x7684;&#x90A3;&#x91CC;&#xFF09;&#x3002;</p>
<p>debug.upvalueid (f, n)</p>
<p>&#x8FD4;&#x56DE;&#x6307;&#x5B9A;&#x51FD;&#x6570;&#x7B2C; n &#x4E2A;&#x4E0A;&#x503C;&#x7684;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7B26;&#xFF08;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF09;&#x3002;</p>
<p>&#x8FD9;&#x4E2A;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x7B26;&#x53EF;&#x4EE5;&#x8BA9;&#x7A0B;&#x5E8F;&#x68C0;&#x67E5;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x95ED;&#x5305;&#x662F;&#x5426;&#x5171;&#x4EAB;&#x4E86;&#x4E0A;&#x503C;&#x3002; &#x82E5; Lua &#x95ED;&#x5305;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x7684;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x4E0A;&#x503C; &#xFF08;&#x5373;&#x6307;&#x5411;&#x4E00;&#x4E2A;&#x5916;&#x90E8;&#x5C40;&#x90E8;&#x53D8;&#x91CF;&#xFF09;&#xFF0C;&#x4F1A;&#x8FD4;&#x56DE;&#x76F8;&#x540C;&#x7684;&#x6807;&#x8BC6;&#x7B26;&#x3002;</p>
<p>debug.upvaluejoin (f1, n1, f2, n2)</p>
<p>&#x8BA9; Lua &#x95ED;&#x5305; f1 &#x7684;&#x7B2C; n1 &#x4E2A;&#x4E0A;&#x503C; &#x5F15;&#x7528; Lua &#x95ED;&#x5305; f2 &#x7684;&#x7B2C; n2 &#x4E2A;&#x4E0A;&#x503C;&#x3002;</p>
<h1 id="&#x72EC;&#x7ACB;&#x7248; Lua">&#x72EC;&#x7ACB;&#x7248; Lua <a href="#&#x72EC;&#x7ACB;&#x7248; Lua"> # </a></h1>
<p>&#x867D;&#x7136; Lua &#x88AB;&#x8BBE;&#x8BA1;&#x6210;&#x4E00;&#x95E8;&#x6269;&#x5C55;&#x5F0F;&#x8BED;&#x8A00;&#xFF0C;&#x7528;&#x4E8E;&#x5D4C;&#x5165;&#x4E00;&#x4E2A;&#x5BBF;&#x4E3B;&#x7A0B;&#x5E8F;&#x3002; &#x4F46;&#x7ECF;&#x5E38;&#x4E5F;&#x4F1A;&#x88AB;&#x5F53;&#x6210;&#x72EC;&#x7ACB;&#x8BED;&#x8A00;&#x4F7F;&#x7528;&#x3002; &#x72EC;&#x7ACB;&#x7248;&#x7684; Lua &#x8BED;&#x8A00;&#x89E3;&#x91CA;&#x5668;&#x968F;&#x6807;&#x51C6;&#x5305;&#x53D1;&#x5E03;&#xFF0C;&#x5C31;&#x53EB; lua&#x3002; &#x72EC;&#x7ACB;&#x7248;&#x89E3;&#x91CA;&#x5668;&#x4FDD;&#x7559;&#x4E86;&#x6240;&#x6709;&#x7684;&#x6807;&#x51C6;&#x5E93;&#x53CA;&#x8C03;&#x8BD5;&#x5E93;&#x3002; &#x5176;&#x547D;&#x4EE4;&#x884C;&#x7528;&#x6CD5;&#x4E3A;&#xFF1A;</p>
<pre><code> lua [options] [script [args]]
</code></pre><p>&#x9009;&#x9879;&#x6709;&#xFF1A;</p>
<p>-e stat: &#x6267;&#x884C;&#x4E00;&#x6BB5;&#x5B57;&#x7B26;&#x4E32; stat &#xFF1B;
-l mod: &#x201C;&#x8BF7;&#x6C42;&#x6A21;&#x5757;&#x201D; mod &#xFF1B;
-i: &#x5728;&#x8FD0;&#x884C;&#x5B8C; &#x811A;&#x672C; &#x540E;&#x8FDB;&#x5165;&#x4EA4;&#x4E92;&#x6A21;&#x5F0F;&#xFF1B;
-v: &#x6253;&#x5370;&#x7248;&#x672C;&#x4FE1;&#x606F;&#xFF1B;
-E: &#x5FFD;&#x7565;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF1B;
--: &#x4E2D;&#x6B62;&#x5BF9;&#x540E;&#x9762;&#x9009;&#x9879;&#x7684;&#x5904;&#x7406;&#xFF1B;
-: &#x628A; stdin &#x5F53;&#x4F5C;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x8FD0;&#x884C;&#xFF0C;&#x5E76;&#x4E2D;&#x6B62;&#x5BF9;&#x540E;&#x9762;&#x9009;&#x9879;&#x7684;&#x5904;&#x7406;&#x3002;
&#x5728;&#x5904;&#x7406;&#x5B8C;&#x9009;&#x9879;&#x540E;&#xFF0C;lua &#x8FD0;&#x884C;&#x6307;&#x5B9A;&#x7684; &#x811A;&#x672C;&#x3002; &#x5982;&#x679C;&#x4E0D;&#x5E26;&#x53C2;&#x6570;&#x8C03;&#x7528;&#xFF0C; &#x5728;&#x6807;&#x51C6;&#x8F93;&#x5165;&#xFF08;stdin&#xFF09;&#x662F;&#x7EC8;&#x7AEF;&#x65F6;&#xFF0C;lua &#x7684;&#x884C;&#x4E3A;&#x548C; lua -v -i &#x76F8;&#x540C;&#x3002; &#x5426;&#x5219;&#x76F8;&#x5F53;&#x4E8E; lua - &#x3002;</p>
<p>&#x5982;&#x679C;&#x8C03;&#x7528;&#x65F6;&#x4E0D;&#x5E26;&#x9009;&#x9879; -E&#xFF0C; &#x89E3;&#x91CA;&#x5668;&#x4F1A;&#x5728;&#x8FD0;&#x884C;&#x4EFB;&#x4F55;&#x53C2;&#x6570;&#x524D;&#xFF0C;&#x68C0;&#x67E5;&#x73AF;&#x5883;&#x53D8;&#x91CF; LUA_INIT_5_3 &#xFF08;&#x6216;&#x5728;&#x7248;&#x672C;&#x540D;&#x672A;&#x5B9A;&#x4E49;&#x65F6;&#xFF0C;&#x68C0;&#x67E5; LUA_INIT &#xFF09;&#x3002; &#x5982;&#x679C;&#x8BE5;&#x53D8;&#x91CF;&#x5185;&#x5B58;&#x683C;&#x5F0F;&#x4E3A; @filename&#xFF0C; lua &#x6267;&#x884C;&#x8BE5;&#x6587;&#x4EF6;&#x3002; &#x5426;&#x5219;&#xFF0C;lua &#x6267;&#x884C;&#x8BE5;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8C03;&#x7528;&#x65F6;&#x6709;&#x9009;&#x9879; -E&#xFF0C; &#x9664;&#x4E86;&#x5FFD;&#x7565; LUA_INIT &#x5916;&#xFF0C; Lua &#x8FD8;&#x5FFD;&#x7565; LUA_PATH &#x4E0E; LUA_CPATH &#x7684;&#x503C;&#x3002; &#x5C06; package.path &#x548C; package.cpath &#x7684;&#x503C;&#x8BBE;&#x4E3A;&#x5B9A;&#x4E49;&#x5728; luaconf.h &#x4E2D;&#x7684;&#x9ED8;&#x8BA4;&#x8DEF;&#x5F84;&#x3002;</p>
<p>&#x9664; -i &#x4E0E; -E &#x5916;&#x6240;&#x6709;&#x7684;&#x9009;&#x9879;&#x90FD;&#x6309;&#x6B21;&#x5E8F;&#x5904;&#x7406;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x8FD9;&#x6837;&#x8C03;&#x7528;</p>
<pre><code> $ lua -e&apos;a=1&apos; -e &apos;print(a)&apos; script.lua
</code></pre><p>&#x5C06;&#x5148;&#x628A; a &#x8BBE;&#x4E3A; 1&#xFF0C;&#x7136;&#x540E;&#x6253;&#x5370; a &#x7684;&#x503C;&#xFF0C; &#x6700;&#x540E;&#x8FD0;&#x884C;&#x6587;&#x4EF6; script.lua &#x5E76;&#x4E0D;&#x5E26;&#x53C2;&#x6570;&#x3002; &#xFF08;&#x8FD9;&#x91CC;&#x7684; $ &#x662F;&#x547D;&#x4EE4;&#x884C;&#x63D0;&#x793A;&#x3002;&#x4F60;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x63D0;&#x793A;&#x53EF;&#x80FD;&#x4E0D;&#x4E00;&#x6837;&#x3002;&#xFF09;</p>
<p>&#x5728;&#x8FD0;&#x884C;&#x4EFB;&#x4F55;&#x4EE3;&#x7801;&#x524D;&#xFF0C; lua &#x4F1A;&#x5C06;&#x6240;&#x6709;&#x547D;&#x4EE4;&#x884C;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;&#x653E;&#x5230;&#x4E00;&#x5F20;&#x5168;&#x5C40;&#x8868; arg &#x4E2D;&#x3002; &#x811A;&#x672C;&#x7684;&#x540D;&#x5B57;&#x653E;&#x5728;&#x7D22;&#x5F15; 0 &#x7684;&#x5730;&#x65B9;&#xFF0C; &#x811A;&#x672C;&#x540D;&#x540E;&#x7D27;&#x8DDF;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x5728;&#x7D22;&#x5F15; 1 &#x5904;&#xFF0C;&#x4F9D;&#x6B21;&#x7C7B;&#x63A8;&#x3002; &#x5728;&#x811A;&#x672C;&#x540D;&#x524D;&#x9762;&#x7684;&#x4EFB;&#x4F55;&#x53C2;&#x6570; &#xFF08;&#x5373;&#x89E3;&#x91CA;&#x5668;&#x7684;&#x540D;&#x5B57;&#x4EE5;&#x53CA;&#x5404;&#x9009;&#x9879;&#xFF09; &#x653E;&#x5728;&#x8D1F;&#x7D22;&#x5F15;&#x5904;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x8C03;&#x7528;</p>
<pre><code> $ lua -la b.lua t1 t2
</code></pre><p>&#x8FD9;&#x5F20;&#x8868;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<pre><code class="lang-lua">arg = { [-<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;lua&quot;</span>, [-<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;-la&quot;</span>,
        [<span class="hljs-number">0</span>] = <span class="hljs-string">&quot;b.lua&quot;</span>,
        [<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;t1&quot;</span>, [<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;t2&quot;</span> }
</code></pre>
<p>&#x5982;&#x679C;&#x8C03;&#x7528;&#x4E2D;&#x6CA1;&#x63D0;&#x4F9B;&#x811A;&#x672C;&#x540D;&#xFF0C; &#x89E3;&#x91CA;&#x5668;&#x7684;&#x540D;&#x5B57;&#x5C31;&#x653E;&#x5728;&#x7D22;&#x5F15; 0 &#x5904;&#xFF0C;&#x540E;&#x9762;&#x63A5;&#x7740;&#x5176;&#x5B83;&#x53C2;&#x6570;&#x3002; &#x4F8B;&#x5982;&#xFF0C;&#x8C03;&#x7528;</p>
<pre><code> $ lua -e &quot;print(arg[1])&quot;
</code></pre><p>&#x5C06;&#x6253;&#x5370;&#x51FA; &quot;-e&quot; &#x3002; &#x5982;&#x679C;&#x63D0;&#x4F9B;&#x4E86;&#x811A;&#x672C;&#x540D;&#xFF0C; &#x5C31;&#x4EE5; arg[1], &#xB7;&#xB7;&#xB7;, arg[#arg] &#x4E3A;&#x53C2;&#x6570;&#x8C03;&#x7528;&#x811A;&#x672C;&#x3002; &#xFF08;&#x548C; Lua &#x6240;&#x6709;&#x7684;&#x4EE3;&#x7801;&#x5757;&#x4E00;&#x6837;&#xFF0C; &#x811A;&#x672C;&#x88AB;&#x7F16;&#x8BD1;&#x6210;&#x4E00;&#x4E2A;&#x53EF;&#x53D8;&#x53C2;&#x6570;&#x51FD;&#x6570;&#x3002;&#xFF09;</p>
<p>&#x5728;&#x4EA4;&#x4E92;&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C; Lua &#x4E0D;&#x65AD;&#x7684;&#x663E;&#x793A;&#x63D0;&#x793A;&#x7B26;&#xFF0C;&#x5E76;&#x7B49;&#x5F85;&#x4E0B;&#x4E00;&#x884C;&#x8F93;&#x5165;&#x3002; &#x4E00;&#x65E6;&#x8BFB;&#x5230;&#x4E00;&#x884C;&#xFF0C; &#x9996;&#x5148;&#x8BD5;&#x7740;&#x628A;&#x8FD9;&#x884C;&#x89E3;&#x91CA;&#x4E3A;&#x4E00;&#x4E2A;&#x8868;&#x8FBE;&#x5F0F;&#x3002; &#x5982;&#x679C;&#x6210;&#x529F;&#x89E3;&#x91CA;&#xFF0C;&#x5C31;&#x6253;&#x5370;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x503C;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x5C06;&#x8FD9;&#x884C;&#x89E3;&#x91CA;&#x4E3A;&#x8BED;&#x53E5;&#x3002; &#x5982;&#x679C;&#x4F60;&#x5199;&#x4E86;&#x4E00;&#x884C;&#x672A;&#x5B8C;&#x6210;&#x7684;&#x8BED;&#x53E5;&#xFF0C; &#x89E3;&#x91CA;&#x5668;&#x4F1A;&#x7528;&#x4E00;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x63D0;&#x793A;&#x7B26;&#x6765;&#x7B49;&#x5F85;&#x4F60;&#x5199;&#x5B8C;&#x3002;</p>
<p>&#x5F53;&#x811A;&#x672C;&#x4E2D;&#x51FA;&#x73B0;&#x4E86;&#x672A;&#x4FDD;&#x62A4;&#x7684;&#x9519;&#x8BEF;&#xFF0C; &#x89E3;&#x91CA;&#x5668;&#x5411;&#x6807;&#x51C6;&#x9519;&#x8BEF;&#x6D41;&#x62A5;&#x544A;&#x9519;&#x8BEF;&#x3002; &#x5982;&#x679C;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x5E76;&#x975E;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x4F46;&#x662F;&#x5374;&#x6709;&#x5143;&#x65B9;&#x6CD5; __tostring &#x7684;&#x8BDD;&#xFF0C; &#x89E3;&#x91CA;&#x5668;&#x4F1A;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x5143;&#x65B9;&#x6CD5;&#x751F;&#x6210;&#x6700;&#x7EC8;&#x7684;&#x6D88;&#x606F;&#x3002; &#x5426;&#x5219;&#xFF0C;&#x89E3;&#x91CA;&#x5668;&#x5C06;&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5E76;&#x628A;&#x6808;&#x56DE;&#x6EAF;&#x4FE1;&#x606F;&#x52A0;&#x5728;&#x524D;&#x9762;&#x3002;</p>
<p>&#x5982;&#x679C;&#x6B63;&#x5E38;&#x7ED3;&#x675F;&#x8FD0;&#x884C;&#xFF0C; &#x89E3;&#x91CA;&#x5668;&#x4F1A;&#x5173;&#x95ED;&#x4E3B; Lua &#x72B6;&#x6001;&#x673A; &#xFF08;&#x53C2;&#x89C1; lua_close&#xFF09;&#x3002; &#x811A;&#x672C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528; os.exit &#x6765;&#x7ED3;&#x675F;&#xFF0C;&#x4EE5;&#x56DE;&#x907F;&#x8FD9;&#x4E2A;&#x6B65;&#x9AA4;&#x3002;</p>
<p>&#x4E3A;&#x4E86;&#x8BA9; Lua &#x53EF;&#x4EE5;&#x7528;&#x4E8E; Unix &#x7CFB;&#x7EDF;&#x7684;&#x811A;&#x672C;&#x89E3;&#x91CA;&#x5668;&#x3002; &#x72EC;&#x7ACB;&#x7248;&#x89E3;&#x91CA;&#x5668;&#x4F1A;&#x5FFD;&#x7565;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x4EE5; # &#x6253;&#x5934;&#x7684;&#x7B2C;&#x4E00;&#x884C;&#x3002; &#x56E0;&#x6B64;&#xFF0C;Lua &#x811A;&#x672C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7; chmod +x &#x4EE5;&#x53CA; #! &#x5F62;&#x5F0F;&#x53D8;&#x6210;&#x4E00;&#x4E2A;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x3002; &#x7C7B;&#x4F3C;&#x8FD9;&#x6837;</p>
<pre><code> #!/usr/local/bin/lua
</code></pre><p>&#xFF08;&#x5F53;&#x7136;&#xFF0C; Lua &#x89E3;&#x91CA;&#x5668;&#x7684;&#x4F4D;&#x7F6E;&#x5BF9;&#x4E8E;&#x4F60;&#x7684;&#x673A;&#x5668;&#x6765;&#x8BF4;&#x53EF;&#x80FD;&#x4E0D;&#x4E00;&#x6837;&#x3002; &#x5982;&#x679C; lua &#x5728;&#x4F60;&#x7684; PATH &#x4E2D;&#xFF0C; &#x5199;&#x6210;</p>
<pre><code> #!/usr/bin/env lua
</code></pre><p>&#x66F4;&#x4E3A;&#x901A;&#x7528;&#x3002;&#xFF09;</p>
<h1 id="&#x4E0E;&#x4E4B;&#x524D;&#x7248;&#x672C;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x5730;&#x65B9;">&#x4E0E;&#x4E4B;&#x524D;&#x7248;&#x672C;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x5730;&#x65B9; <a href="#&#x4E0E;&#x4E4B;&#x524D;&#x7248;&#x672C;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x5730;&#x65B9;"> # </a></h1>
<p>&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x5217;&#x51FA;&#x4E86;&#x628A;&#x7A0B;&#x5E8F;&#x4ECE; Lua 5.2 &#x8FC1;&#x79FB;&#x5230; Lua 5.3 &#x4F1A;&#x78B0;&#x5230;&#x7684;&#x4E0D;&#x517C;&#x5BB9;&#x7684;&#x5730;&#x65B9;&#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x7F16;&#x8BD1; Lua &#x65F6;&#x5B9A;&#x4E49;&#x4E00;&#x4E9B;&#x6070;&#x5F53;&#x7684;&#x9009;&#x9879;&#xFF08;&#x53C2;&#x89C1;&#x6587;&#x4EF6; luaconf.h&#xFF09;&#xFF0C; &#x6765;&#x56DE;&#x907F;&#x4E00;&#x4E9B;&#x4E0D;&#x517C;&#x5BB9;&#x6027;&#x3002; &#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x4E9B;&#x517C;&#x5BB9;&#x9009;&#x9879;&#x4EE5;&#x540E;&#x4F1A;&#x79FB;&#x9664;&#x3002;</p>
<p>Lua &#x7684;&#x7248;&#x672C;&#x66F4;&#x66FF;&#x603B;&#x662F;&#x4F1A;&#x4FEE;&#x6539;&#x4E00;&#x4E9B; C API &#x5E76;&#x6D89;&#x53CA;&#x6E90;&#x4EE3;&#x7801;&#x7684;&#x6539;&#x53D8;&#x3002; &#x4F8B;&#x5982;&#x4E00;&#x4E9B;&#x5E38;&#x91CF;&#x7684;&#x6570;&#x5B57;&#x503C;&#xFF0C;&#x7528;&#x5B8F;&#x6765;&#x5B9E;&#x73B0;&#x4E00;&#x4E9B;&#x51FD;&#x6570;&#x3002; &#x56E0;&#x6B64;&#xFF0C;&#x4F60;&#x4E0D;&#x80FD;&#x5047;&#x8BBE;&#x5728;&#x4E0D;&#x540C;&#x7684; Lua &#x7248;&#x672C;&#x95F4;&#x53EF;&#x4EE5;&#x505A;&#x5230;&#x4E8C;&#x8FDB;&#x5236;&#x517C;&#x5BB9;&#x3002; &#x5F53;&#x4F60;&#x4F7F;&#x7528;&#x65B0;&#x7248;&#x65F6;&#xFF0C;&#x4E00;&#x5B9A;&#x8981;&#x5C06;&#x4F7F;&#x7528;&#x4E86; Lua API &#x7684;&#x5BA2;&#x6237;&#x7A0B;&#x5E8F;&#x91CD;&#x65B0;&#x7F16;&#x8BD1;&#x3002;</p>
<p>&#x540C;&#x6837;&#xFF0C;Lua &#x7248;&#x672C;&#x66F4;&#x66FF;&#x8FD8;&#x4F1A;&#x6539;&#x53D8;&#x9884;&#x7F16;&#x8BD1;&#x4EE3;&#x7801;&#x5757;&#x7684;&#x5185;&#x90E8;&#x5448;&#x73B0;&#x65B9;&#x5F0F;&#xFF1B; &#x5728;&#x4E0D;&#x540C;&#x7684; Lua &#x7248;&#x672C;&#x95F4;&#xFF0C;&#x9884;&#x7F16;&#x8BD1;&#x4EE3;&#x7801;&#x5757;&#x4E0D;&#x517C;&#x5BB9;&#x3002;</p>
<p>&#x5B98;&#x65B9;&#x53D1;&#x5E03;&#x7248;&#x7684;&#x6807;&#x51C6;&#x8DEF;&#x5F84;&#x4E5F;&#x53EF;&#x80FD;&#x968F;&#x7248;&#x672C;&#x53D8;&#x5316;&#x3002;</p>
<h2 id="&#x8BED;&#x8A00;&#x7684;&#x53D8;&#x66F4;">&#x8BED;&#x8A00;&#x7684;&#x53D8;&#x66F4; <a href="#&#x8BED;&#x8A00;&#x7684;&#x53D8;&#x66F4;"> # </a></h2>
<p>Lua 5.2 &#x5230; Lua 5.3 &#x6700;&#x5927;&#x7684;&#x53D8;&#x5316;&#x662F;&#x5F15;&#x5165;&#x4E86;&#x6570;&#x5B57;&#x7684;&#x6574;&#x6570;&#x5B50;&#x7C7B;&#x578B;&#x3002; &#x867D;&#x7136;&#x8FD9;&#x4E2A;&#x53D8;&#x5316;&#x4E0D;&#x4F1A;&#x5F71;&#x54CD;&#x201C;&#x4E00;&#x822C;&#x201D;&#x8BA1;&#x7B97;&#xFF0C; &#x4F46;&#x4E00;&#x4E9B;&#x8BA1;&#x7B97; &#xFF08;&#x4E3B;&#x8981;&#x662F;&#x6D89;&#x53CA;&#x6EA2;&#x51FA;&#x7684;&#xFF09; &#x4F1A;&#x5F97;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x7ED3;&#x679C;&#x3002;
&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x628A;&#x6570;&#x5B57;&#x90FD;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#x4E3A;&#x6D6E;&#x70B9;&#x6570;&#x6765;&#x6D88;&#x9664;&#x5DEE;&#x5F02; &#xFF08;&#x5728; Lua 5.2 &#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x6570;&#x5B57;&#x90FD;&#x662F;&#x6D6E;&#x70B9;&#x6570;&#xFF09;&#x3002; &#x6BD4;&#x5982;&#x4F60;&#x53EF;&#x4EE5;&#x5C06;&#x6240;&#x6709;&#x7684;&#x5E38;&#x91CF;&#x90FD;&#x4EE5; .0 &#x7ED3;&#x5C3E;&#xFF0C; &#x6216;&#x662F;&#x4F7F;&#x7528; x = x + 0.0 &#x6765;&#x8F6C;&#x6362;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x3002; &#xFF08;&#x8FD9;&#x6761;&#x5EFA;&#x8BAE;&#x4EC5;&#x7528;&#x4E8E;&#x5076;&#x5C14;&#x5FEB;&#x901F;&#x89E3;&#x51B3;&#x4E00;&#x4E9B;&#x4E0D;&#x517C;&#x5BB9;&#x95EE;&#x9898;&#xFF1B; &#x8FD9;&#x4E0D;&#x662F;&#x4E00;&#x6761;&#x597D;&#x7684;&#x7F16;&#x7A0B;&#x51C6;&#x5219;&#x3002; &#x597D;&#x597D;&#x5199;&#x7A0B;&#x5E8F;&#x7684;&#x8BDD;&#xFF0C;&#x4F60;&#x5E94;&#x8BE5;&#x5728;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x6D6E;&#x70B9;&#x6570;&#x7684;&#x5730;&#x65B9;&#x7528;&#x6D6E;&#x70B9;&#x6570;&#xFF0C; &#x9700;&#x8981;&#x6574;&#x6570;&#x7684;&#x5730;&#x65B9;&#x7528;&#x6574;&#x6570;&#x3002;&#xFF09;</p>
<p>&#x628A;&#x6D6E;&#x70B9;&#x6570;&#x8F6C;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5730;&#x65B9;&#xFF0C;&#x73B0;&#x5728;&#x90FD;&#x5BF9;&#x7B49;&#x4E8E;&#x6574;&#x6570;&#x7684;&#x6D6E;&#x70B9;&#x6570;&#x52A0;&#x4E86; .0 &#x540E;&#x7F00;&#x3002; &#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x6D6E;&#x70B9;&#x6570; 2.0 &#x4F1A;&#x88AB;&#x6253;&#x5370;&#x6210; 2.0&#xFF0C; &#x800C;&#x4E0D;&#x662F; 2&#x3002;&#xFF09; &#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x5B9A;&#x5236;&#x6570;&#x5B57;&#x7684;&#x683C;&#x5F0F;&#xFF0C;&#x5C31;&#x5FC5;&#x987B;&#x663E;&#x5F0F;&#x7684;&#x683C;&#x5F0F;&#x5316;&#x5B83;&#x4EEC;&#x3002;
&#xFF08;&#x51C6;&#x786E;&#x8BF4;&#x8FD9;&#x4E2A;&#x4E0D;&#x662F;&#x517C;&#x5BB9;&#x6027;&#x95EE;&#x9898;&#xFF0C; &#x56E0;&#x4E3A; Lua &#x5E76;&#x6CA1;&#x6709;&#x89C4;&#x5B9A;&#x6570;&#x5B57;&#x5982;&#x4F55;&#x683C;&#x5F0F;&#x5316;&#x6210;&#x5B57;&#x7B26;&#x4E32;&#xFF0C; &#x4F46;&#x4E00;&#x4E9B;&#x7A0B;&#x5E8F;&#x5047;&#x5B9A;&#x9075;&#x5FAA;&#x67D0;&#x79CD;&#x7279;&#x522B;&#x7684;&#x683C;&#x5F0F;&#x3002;&#xFF09;</p>
<p>&#x5206;&#x4EE3;&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x6CA1;&#x6709;&#x4E86;&#x3002; &#xFF08;&#x5B83;&#x662F; Lua 5.2 &#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x8BD5;&#x9A8C;&#x6027;&#x7279;&#x6027;&#x3002;&#xFF09;</p>
<h2 id="&#x5E93;&#x7684;&#x53D8;&#x66F4;">&#x5E93;&#x7684;&#x53D8;&#x66F4; <a href="#&#x5E93;&#x7684;&#x53D8;&#x66F4;"> # </a></h2>
<p>bit32 &#x5E93;&#x5E9F;&#x5F03;&#x4E86;&#x3002; &#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5916;&#x90E8;&#x517C;&#x5BB9;&#x5E93;&#x5F88;&#x5BB9;&#x6613;&#xFF0C; &#x4E0D;&#x8FC7;&#x6700;&#x597D;&#x76F4;&#x63A5;&#x7528;&#x5BF9;&#x5E94;&#x7684;&#x4F4D;&#x64CD;&#x4F5C;&#x7B26;&#x6765;&#x66FF;&#x6362;&#x5B83;&#x3002; &#xFF08;&#x6CE8;&#x610F; bit32 &#x53EA;&#x80FD;&#x9488;&#x5BF9; 32 &#x4F4D;&#x6574;&#x6570;&#x8FD0;&#x7B97;&#xFF0C; &#x800C;&#x6807;&#x51C6; Lua &#x4E2D;&#x7684;&#x4F4D;&#x64CD;&#x4F5C;&#x53EF;&#x4EE5;&#x7528;&#x4E8E; 64 &#x4F4D;&#x6574;&#x6570;&#x3002;&#xFF09;
&#x8868;&#x5904;&#x7406;&#x5E93;&#x73B0;&#x5728;&#x5728;&#x8BFB;&#x5199;&#x5176;&#x4E2D;&#x7684;&#x5143;&#x7D20;&#x65F6;&#x4F1A;&#x8003;&#x8651;&#x5143;&#x65B9;&#x6CD5;&#x3002;
ipairs &#x8FD9;&#x4E2A;&#x8FED;&#x4EE3;&#x5668;&#x4E5F;&#x4F1A;&#x8003;&#x8651;&#x5143;&#x65B9;&#x6CD5;&#xFF0C;&#x800C; __ipairs &#x5143;&#x65B9;&#x6CD5;&#x88AB;&#x5E9F;&#x5F03;&#x4E86;&#x3002;
io.read &#x7684;&#x9009;&#x9879;&#x540D;&#x4E0D;&#x518D;&#x7528; &apos;<em>&apos; &#x6253;&#x5934;&#x3002; &#x4F46;&#x51FA;&#x4E8E;&#x517C;&#x5BB9;&#x6027;&#x8003;&#x8651;&#xFF0C;Lua &#x4F1A;&#x7EE7;&#x7EED;&#x5FFD;&#x7565;&#x6389;&#x8FD9;&#x4E2A;&#x5B57;&#x7B26;&#x3002;
&#x6570;&#x5B66;&#x5E93;&#x4E2D;&#x7684;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x5E9F;&#x5F03;&#x4E86;&#xFF1A; atan2&#xFF0C; cosh&#xFF0C; sinh&#xFF0C; tanh&#xFF0C; pow&#xFF0C; frexp&#xFF0C; &#x4EE5;&#x53CA; ldexp &#x3002; &#x4F60;&#x53EF;&#x4EE5;&#x7528; x^y &#x66FF;&#x6362; math.pow(x,y)&#xFF1B; &#x4F60;&#x53EF;&#x4EE5;&#x7528; math.atan &#x66FF;&#x6362; math.atan2&#xFF0C;&#x524D;&#x8005;&#x73B0;&#x5728;&#x53EF;&#x4EE5;&#x63A5;&#x6536;&#x4E00;&#x6216;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF1B; &#x4F60;&#x53EF;&#x4EE5;&#x7528; x </em> 2.0^exp &#x66FF;&#x6362; math.ldexp(x,exp)&#x3002; &#x82E5;&#x7528;&#x5230;&#x5176;&#x5B83;&#x64CD;&#x4F5C;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5199;&#x4E00;&#x4E2A;&#x6269;&#x5C55;&#x5E93;&#xFF0C;&#x6216;&#x5728; Lua &#x4E2D;&#x5B9E;&#x73B0;&#x5B83;&#x4EEC;&#x3002;
require &#x5728;&#x641C;&#x7D22; C &#x52A0;&#x8F7D;&#x5668;&#x65F6;&#x5904;&#x7406;&#x7248;&#x672C;&#x53F7;&#x7684;&#x65B9;&#x5F0F;&#x6709;&#x6240;&#x53D8;&#x5316;&#x3002; &#x73B0;&#x5728;&#xFF0C;&#x7248;&#x672C;&#x53F7;&#x5E94;&#x8BE5;&#x8DDF;&#x5728;&#x6A21;&#x5757;&#x540D;&#x540E;&#xFF08;&#x5176;&#x5B83;&#x5927;&#x591A;&#x6570;&#x5DE5;&#x5177;&#x90FD;&#x662F;&#x8FD9;&#x6837;&#x5E72;&#x7684;&#xFF09;&#x3002; &#x51FA;&#x4E8E;&#x517C;&#x5BB9;&#x6027;&#x8003;&#x8651;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x65B0;&#x683C;&#x5F0F;&#x627E;&#x4E0D;&#x5230;&#x52A0;&#x8F7D;&#x5668;&#x7684;&#x8BDD;&#xFF0C;&#x641C;&#x7D22;&#x5668;&#x4F9D;&#x7136;&#x4F1A;&#x5C1D;&#x8BD5;&#x65E7;&#x683C;&#x5F0F;&#x3002; &#xFF08;Lua 5.2 &#x5DF2;&#x7ECF;&#x662F;&#x8FD9;&#x6837;&#x5904;&#x7406;&#x4E86;&#xFF0C;&#x4F46;&#x662F;&#x5E76;&#x6CA1;&#x6709;&#x5199;&#x5728;&#x6587;&#x6863;&#x91CC;&#x3002;&#xFF09;</p>
<h2 id="API &#x7684;&#x53D8;&#x66F4;">API &#x7684;&#x53D8;&#x66F4; <a href="#API &#x7684;&#x53D8;&#x66F4;"> # </a></h2>
<p>&#x5EF6;&#x7EED;&#x51FD;&#x6570;&#x73B0;&#x5728;&#x63A5;&#x6536;&#x539F;&#x6765;&#x7528; lua_getctx &#x83B7;&#x53D6;&#x7684;&#x53C2;&#x6570;&#xFF0C; &#x6240;&#x4EE5; lua_getctx &#x5C31;&#x53BB;&#x6389;&#x4E86;&#x3002; &#x6309;&#x9700;&#x8981;&#x6539;&#x5199;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x3002;
&#x51FD;&#x6570; lua_dump &#x6709;&#x4E86;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570; strip&#x3002; &#x5982;&#x679C;&#x60F3;&#x548C;&#x4E4B;&#x524D;&#x7684;&#x884C;&#x4E3A;&#x4E00;&#x81F4;&#xFF0C;&#x8FD9;&#x4E2A;&#x503C;&#x4F20; 0 &#x3002;
&#x7528;&#x4E8E;&#x4F20;&#x5165;&#x4F20;&#x51FA;&#x65E0;&#x7B26;&#x53F7;&#x6574;&#x6570;&#x7684;&#x51FD;&#x6570; &#xFF08;lua_pushunsigned&#xFF0C; lua_tounsigned&#xFF0C; lua_tounsignedx&#xFF0C; luaL_checkunsigned&#xFF0C; luaL_optunsigned&#xFF09; &#x90FD;&#x5E9F;&#x5F03;&#x4E86;&#x3002; &#x76F4;&#x63A5;&#x4ECE;&#x6709;&#x7B26;&#x53F7;&#x7248;&#x505A;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x3002;
&#x5904;&#x7406;&#x8F93;&#x5165;&#x975E;&#x9ED8;&#x8BA4;&#x6574;&#x6570;&#x7C7B;&#x578B;&#x7684;&#x5B8F; &#xFF08;luaL_checkint&#xFF0C; luaL_optint&#xFF0C; luaL_checklong&#xFF0C; luaL_optlong&#xFF09; &#x5E9F;&#x5F03;&#x6389;&#x4E86;&#x3002; &#x76F4;&#x63A5;&#x4F7F;&#x7528; lua_Integer &#x52A0;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x5C31;&#x53EF;&#x4EE5;&#x66FF;&#x4EE3; &#xFF08;&#x6216;&#x662F;&#x53EA;&#x8981;&#x6709;&#x53EF;&#x80FD;&#xFF0C;&#x5C31;&#x5728;&#x4F60;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x4F7F;&#x7528; lua_Integer&#xFF09;&#x3002;</p>
<h1 id="Lua &#x7684;&#x5B8C;&#x6574;&#x8BED;&#x6CD5;">Lua &#x7684;&#x5B8C;&#x6574;&#x8BED;&#x6CD5; <a href="#Lua &#x7684;&#x5B8C;&#x6574;&#x8BED;&#x6CD5;"> # </a></h1>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4EFD;&#x91C7;&#x7528;&#x6269;&#x5C55; BNF &#x63CF;&#x8FF0;&#x7684; Lua &#x5B8C;&#x6574;&#x8BED;&#x6CD5;&#x3002; &#x5728;&#x6269;&#x5C55; BNF &#x4E2D;&#xFF0C; {A} &#x8868;&#x793A; 0 &#x6216;&#x591A;&#x4E2A; A &#xFF0C; [A] &#x8868;&#x793A;&#x4E00;&#x4E2A;&#x53EF;&#x9009;&#x7684; A &#x3002; &#xFF08;&#x64CD;&#x4F5C;&#x7B26;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x53C2;&#x89C1; &#xA7;3.4.8&#xFF1B; &#x5BF9;&#x4E8E;&#x6700;&#x7EC8;&#x7B26;&#x53F7;&#xFF0C;&#x540D;&#x5B57;&#xFF0C;&#x6570;&#x5B57;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x5B57;&#x9762;&#x91CF;&#x7684;&#x89E3;&#x91CA;&#xFF0C;&#x53C2;&#x89C1; &#xA7;3.1&#x3002;&#xFF09;</p>
<pre><code class="lang-lua">chunk ::= block

block ::= {stat} [retstat]

stat ::=  &apos;;&apos; | 
     varlist &apos;=&apos; explist | 
     functioncall | 
     label | 
     break | 
     goto Name | 
     do block end | 
     while exp do block end | 
     repeat block until exp | 
     if exp then block {elseif exp then block} [else block] end | 
     for Name &apos;=&apos; exp &apos;,&apos; exp [&apos;,&apos; exp] do block end | 
     for namelist in explist do block end | 
     function funcname funcbody | 
     local function Name funcbody | 
     local namelist [&apos;=&apos; explist] 

retstat ::= return [explist] [&apos;;&apos;]

label ::= &apos;::&apos; Name &apos;::&apos;

funcname ::= Name {&apos;.&apos; Name} [&apos;:&apos; Name]

varlist ::= var {&apos;,&apos; var}

var ::=  Name | prefixexp &apos;[&apos; exp &apos;]&apos; | prefixexp &apos;.&apos; Name 

namelist ::= Name {&apos;,&apos; Name}

explist ::= exp {&apos;,&apos; exp}

exp ::=  nil | false | true | Numeral | LiteralString | &apos;...&apos; | functiondef | 
     prefixexp | tableconstructor | exp binop exp | unop exp 

prefixexp ::= var | functioncall | &apos;(&apos; exp &apos;)&apos;

functioncall ::=  prefixexp args | prefixexp &apos;:&apos; Name args 

args ::=  &apos;(&apos; [explist] &apos;)&apos; | tableconstructor | LiteralString 

functiondef ::= function funcbody

funcbody ::= &apos;(&apos; [parlist] &apos;)&apos; block end

parlist ::= namelist [&apos;,&apos; &apos;...&apos;] | &apos;...&apos;

tableconstructor ::= &apos;{&apos; [fieldlist] &apos;}&apos;

fieldlist ::= field {fieldsep field} [fieldsep]

field ::= &apos;[&apos; exp &apos;]&apos; &apos;=&apos; exp | Name &apos;=&apos; exp | exp

fieldsep ::= &apos;,&apos; | &apos;;&apos;

binop ::=  &apos;+&apos; | &apos;-&apos; | &apos;*&apos; | &apos;/&apos; | &apos;//&apos; | &apos;^&apos; | &apos;%&apos; | 
     &apos;&amp;&apos; | &apos;~&apos; | &apos;|&apos; | &apos;&gt;&gt;&apos; | &apos;&lt;&lt;&apos; | &apos;..&apos; | 
     &apos;&lt;&apos; | &apos;&lt;=&apos; | &apos;&gt;&apos; | &apos;&gt;=&apos; | &apos;==&apos; | &apos;~=&apos; | 
     and | or

unop ::= &apos;-&apos; | not | &apos;#&apos; | &apos;~&apos;
</code></pre>

        <div class="copyright">Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a>. Dependence <a href="https://nodejs.org">Node.js</a> run.</div>
    </div>
    
</div>


</body>
</html>
