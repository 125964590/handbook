<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>chai</title>
    <link rel="stylesheet" type="text/css" href="../../css/main.css">
</head>
<body>
<div class="nav">
<div class="logo">chai</div>
<ul><li><a href="../../index.html">Lua5.3</a></li><li><a href="../../html/chai.html">chai</a></li><li><a href="../../html/mocha.html">mocha</a></li><li><a href="#"><span></span>wcj</a><ul><li><a href="../../html/wcj/Lua5.32.html">Lua5.32</a></li><li><a href="../../html/wcj/chai1.html">chai1</a></li><li class="active"><a href="../../html/wcj/mocha3.html">mocha3</a></li></ul></li></ul></div>


<div class="warpper">

    <div class="page-toc">
        <ul><li><a href="#Mocha">Mocha</a></li><li><a href="#start">start</a></li><li><a href="#describe（moduleName, function）">describe（moduleName, function）</a></li><li><a href="#it(info, function)">it(info, function)</a></li><li><a href="#assert.equal（exp1,exp2）">assert.equal（exp1,exp2）</a><ul><li><a href="#异步代码测试">异步代码测试</a></li></ul></li><li><a href="#before(), after(),beforeEach(),afterEach()">before(), after(),beforeEach(),afterEach()</a></li><li><a href="#Pending">Pending</a></li><li><a href="#only 和skip">only 和skip</a></li></ul>
    </div>
    
    <div class="content markdown-body">
        <h2 id="Mocha">Mocha <a href="#Mocha"> # </a></h2>
<p><a href="http://www.ifeenan.com/javascript/2015-02-26-Mocha%E4%B8%AD%E6%96%87%E6%8C%87%E5%8D%97/">Mocha&#x4E2D;&#x6587;&#x6307;&#x5357;</a><br><a href="http://shouldjs.github.io/">should.js</a><br><a href="http://mochajs.org/">mocha&#x5B98;&#x65B9;&#x7F51;&#x7AD9;</a>  </p>
<p><code>mocha</code>&#x662F;&#x4E00;&#x6B3E;&#x6BD4;&#x8F83;&#x6D41;&#x884C;&#x7684;&#x6D4B;&#x8BD5;&#x6846;&#x67B6;,&#x51FA;&#x81EA;<code>TJ</code>&#x4E4B;&#x624B;,&#x8DDF;<code>jasmine</code>&#x76F8;&#x6BD4;,&#x5B83;&#x6709;&#x7075;&#x6D3B;&#x7684;&#x65AD;&#x8A00;&#x8BED;&#x6CD5;,&#x6D4B;&#x8BD5;&#x63D0;&#x793A;&#x4E5F;&#x6BD4;&#x8F83;&#x53CB;&#x597D;,&#x5176;&#x5B83;&#x65B9;&#x9762;&#x8DDF;<code>jasmine</code>&#x7C7B;&#x4F3C;.</p>
<h1 id="start">start <a href="#start"> # </a></h1>
<p>&#x8FD9;&#x662F;&#x5B98;&#x7F51;&#x4E0A;&#x7684;&#x4E00;&#x6BB5;&#x793A;&#x4F8B;&#x4EE3;&#x7801;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;assert&quot;</span>)
describe(<span class="hljs-string">&apos;Array&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    describe(<span class="hljs-string">&apos;#indexOf()&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        it(<span class="hljs-string">&apos;should return -1 when the value is not present&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            assert.equal(-<span class="hljs-number">1</span>, [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>].indexOf(<span class="hljs-number">5</span>));
            assert.equal(-<span class="hljs-number">1</span>, [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>].indexOf(<span class="hljs-number">0</span>));
        })
    })
})
</code></pre>
<p>&#x5982;&#x679C;&#x6211;&#x4EEC;&#x7684;&#x6D4B;&#x8BD5;&#x6587;&#x4EF6;&#x540D;&#x5B57;&#x4E3A;test.js&#xFF0C;&#x8FD0;&#x884C;mocha&#x5C31;</p>
<pre><code class="lang-shell">mocha test
</code></pre>
<p>&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x6709;&#x4E09;&#x4E2A;&#x964C;&#x751F;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E5F;&#x6B63;&#x662F;&#x8FD9;&#x4E09;&#x4E2A;&#x57FA;&#x672C;&#x65B9;&#x6CD5;&#x6784;&#x6210;mocha&#x6D4B;&#x8BD5;&#x6846;&#x67B6;&#x7684;&#x57FA;&#x672C;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x3002;</p>
<h1 id="describe&#xFF08;moduleName, function&#xFF09;">describe&#xFF08;moduleName, function&#xFF09; <a href="#describe&#xFF08;moduleName, function&#xFF09;"> # </a></h1>
<p>&#x987E;&#x540D;&#x601D;&#x4E49;&#xFF0C;&#x63CF;&#x8FF0;&#x4E00;&#x53E5;&#x6D4B;&#x8BD5;&#x7528;&#x4F8B;&#x662F;&#x5426;&#x6B63;&#x786E;&#x3002;&#x9996;&#x5148;describe&#x662F;&#x53EF;&#x4EE5;&#x5D4C;&#x5957;&#x7684;&#xFF0C;&#x591A;&#x4E2A;describe&#x5D4C;&#x5957;&#x7684;&#x4F7F;&#x7528;&#x7528;&#x4E8E;&#x63CF;&#x8FF0;&#x6A21;&#x5757;&#x4E0B;&#x7684;&#x5B50;&#x6A21;&#x5757;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#x6D4B;&#x8BD5;Array&#x8FD9;&#x4E2A;&#x7C7B;&#x4E0B;&#x9762;&#x7684;#indexOf()&#x65B9;&#x6CD5;, moduleName&#x662F;&#x53EF;&#x4EE5;&#x968F;&#x4FBF;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x5373;&#x662F;&#x662F;&#x4E2D;&#x6587;&#x4E5F;&#x53EF;&#x4EE5;&#x3002; &#x201C;#&#x201D;&#x7684;&#x4F7F;&#x7528;&#x4E5F;&#x662F;&#x4E00;&#x822C;&#x7EA6;&#x5B9A;&#xFF0C;&#x4E0D;&#x559C;&#x6B22;&#x4F60;&#x4E5F;&#x4F1A;&#x6362;&#x4E2A;&#x6216;&#x4E0D;&#x7528;&#x4E5F;&#x53EF;&#x4EE5;&#x3002;</p>
<h1 id="it(info, function)">it(info, function) <a href="#it(info, function)"> # </a></h1>
<p>&#x771F;&#x6B63;&#x7684;&#x6D4B;&#x8BD5;&#x8BED;&#x53E5;&#x662F;&#x5728;it&#x51FD;&#x6570;&#x7684;function&#x91CC;&#x9762;&#xFF0C;info&#x4E5F;&#x662F;&#x4E00;&#x53E5;&#x63CF;&#x8FF0;&#x6027;&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x770B;&#x5F97;&#x61C2;&#x5C31;&#x884C;&#x3002;function&#x91CC;&#x9762;&#x7684;&#x65AD;&#x8A00;&#x51B3;&#x5B9A;&#x8FD9;&#x6761;&#x6D4B;&#x8BD5;&#x662F;&#x5426;&#x6B63;&#x786E;&#x3002;&#x5982;&#x679C;fail&#x7684;&#x8BDD;&#x63A7;&#x5236;&#x53F0;&#x4F1A;&#x628A;log&#x6253;&#x5370;&#x51FA;&#x6765;&#x3002;&#x4E00;&#x4E2A;it&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x6D4B;&#x8BD5;&#x7528;&#x4F8B;&#xFF0C;&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x6761;&#x65AD;&#x8A00;&#x6216;&#x4E00;&#x6761;&#x65AD;&#x8A00;&#x3002;</p>
<h1 id="assert.equal&#xFF08;exp1,exp2&#xFF09;">assert.equal&#xFF08;exp1,exp2&#xFF09; <a href="#assert.equal&#xFF08;exp1,exp2&#xFF09;"> # </a></h1>
<p>mocha&#x7684;&#x65AD;&#x8A00;&#x8BED;&#x53E5;&#xFF0C;exp1&#x662F;&#x5426;&#x7B49;&#x4E8E;exp2. &#x5176;&#x4ED6;&#x66F4;&#x591A;&#x7528;&#x6CD5;&#x53EF;&#x4EE5;&#x67E5;&#x8003;mocha&#x7684;&#x6587;&#x6863;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x91CC;&#x4E00;&#x822C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;chai&#x6765;&#x4F5C;&#x4E3A;&#x65AD;&#x8A00;&#x5E93;&#x3002;&#x66F4;&#x52A0;&#x53CB;&#x597D;&#x7684;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x65AD;&#x8A00;&#x65B9;&#x5F0F;&#x3002;</p>
<h2 id="&#x5F02;&#x6B65;&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;">&#x5F02;&#x6B65;&#x4EE3;&#x7801;&#x6D4B;&#x8BD5; <a href="#&#x5F02;&#x6B65;&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;"> # </a></h2>
<p>&#x4E0A;&#x9762;&#x7684;&#x5B98;&#x65B9;&#x4F8B;&#x5B50;&#x662F;&#x540C;&#x6B65;&#x7684;&#x4EE3;&#x7801;&#x6D4B;&#x8BD5;&#xFF0C;&#x4E0B;&#x9762;&#x770B;&#x770B;&#x5F02;&#x6B65;&#x4EE3;&#x7801;&#x5982;&#x4F55;&#x6D4B;&#x8BD5;</p>
<pre><code class="lang-js">describe(<span class="hljs-string">&apos;User&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    describe(<span class="hljs-string">&apos;#save()&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        it(<span class="hljs-string">&apos;should save without error&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">done</span>)</span>{
            <span class="hljs-keyword">var</span> user = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&apos;Luna&apos;</span>);
            user.save(done);
        })
    })
})
</code></pre>
<p><code>user.save()</code> &#x662F;&#x8981;&#x94FE;&#x63A5;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x662F;&#x4E2A;&#x5F02;&#x6B65;&#x64CD;&#x4F5C;&#x3002;</p>
<p>&#x8DDF;&#x7B2C;&#x4E00;&#x6BB5;&#x4EE3;&#x7801;&#x4E0D;&#x540C;&#xFF0C;&#x4F7F;&#x7528;&#x4E86;done&#x3002;done&#x8868;&#x793A;&#x4F60;&#x56DE;&#x8C03;&#x7684;&#x6700;&#x6DF1;&#x5904;&#xFF0C;&#x4E5F;&#x662F;&#x5D4C;&#x5957;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#x7684;&#x672B;&#x7AEF;&#x3002;done()&#x51FD;&#x6570;&#x5982;&#x679C;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;error&#x7684;callback&#xFF0C;&#x8FD9;&#x53E5;&#x6D4B;&#x8BD5;&#x4E3A;fail&#x3002;</p>
<p>&#x6CE8;&#x610F;&#x4E00;&#x4E2A;it&#x91CC;&#x9762;&#x5E94;&#x8BE5;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;done&#xFF0C;&#x5982;&#x679C;&#x975E;&#x8981;&#x6709;&#x4E24;&#x4E2A;&#x5F02;&#x6B65;&#x5206;&#x53C9;&#xFF0C;&#x90A3;&#x5EFA;&#x8BAE;&#x7528;&#x4E24;&#x4E2A;it&#x3002;</p>
<h1 id="before(), after(),beforeEach(),afterEach()">before(), after(),beforeEach(),afterEach() <a href="#before(), after(),beforeEach(),afterEach()"> # </a></h1>
<p>&#x4ECB;&#x7ECD;&#x4E86;&#x5F02;&#x6B65;&#x7684;&#x5355;&#x5143;&#x6D4B;&#x8BD5;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x4E9B;&#x5217;&#x65B9;&#x4FBF;&#x7684;&#x8F85;&#x52A9;&#x65B9;&#x6CD5;&#xFF0C;&#x65B9;&#x6CD5;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x660E;&#x4E86;&#xFF0C;&#x6211;&#x8D34;&#x4E2A;&#x4EE3;&#x7801;&#x51FA;&#x6765;&#xFF0C;&#x5927;&#x5BB6;&#x770B;&#x770B;&#x5C31;&#x77E5;&#x9053;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#x4E86;&#x3002;</p>
<pre><code class="lang-js">describe(<span class="hljs-string">&apos;Connection&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> db = <span class="hljs-keyword">new</span> Connection
    ,tobi = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&apos;tobi&apos;</span>)
    ,loki = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&apos;loki&apos;</span>)
    ,jane = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&apos;jane&apos;</span>);
    beforeEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">done</span>)</span>{
        db.clear(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{
            <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> done(err);
            db.save([tobi, loki, jane], done);
        });
    })

describe(<span class="hljs-string">&apos;#find()&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    it(<span class="hljs-string">&apos;respond with matching records&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">done</span>)</span>{
        db.find({ type: <span class="hljs-string">&apos;User&apos;</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, res</span>)</span>{
            <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> done(err);
                res.should.have.length(<span class="hljs-number">3</span>);
                done();
            })
        })
    })
})
</code></pre>
<h1 id="Pending">Pending <a href="#Pending"> # </a></h1>
<pre><code class="lang-js">describe(<span class="hljs-string">&apos;Array&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    describe(<span class="hljs-string">&apos;#indexOf()&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        it(<span class="hljs-string">&apos;should return -1 when the value is not present&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        })
    })
});
</code></pre>
<p>&#x5C31;&#x662F;it&#x91CC;&#x9762;&#x7684;function&#x7559;&#x7A7A;&#x3002;mocha&#x9ED8;&#x8BA4;&#x4F1A;pass&#x8FD9;&#x6761;&#x6D4B;&#x8BD5;&#x3002;&#x8FD9;&#x6837;&#x7684;&#x7528;&#x6CD5;&#x5176;&#x5B9E;&#x76F8;&#x5F53;&#x4E8E;&#xFF0C;&#x67D0;&#x9879;&#x76EE;&#x8D1F;&#x8D23;&#x4EBA;&#x5B9A;&#x4E49;&#x597D;&#x4E86;&#x8981;&#x6D4B;&#x8BD5;&#x4EC0;&#x4E48;&#x5185;&#x5BB9;&#xFF0C;&#x4E4B;&#x540E;&#x7531;&#x76F8;&#x5E94;&#x7684;&#x5F00;&#x53D1;&#x53BB;&#x5B9E;&#x73B0;&#x5177;&#x4F53;&#x3002;</p>
<h1 id="only &#x548C;skip">only &#x548C;skip <a href="#only &#x548C;skip"> # </a></h1>
<pre><code class="lang-js">describe(<span class="hljs-string">&apos;Array&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    describe(<span class="hljs-string">&apos;#indexOf()&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        it.only(<span class="hljs-string">&apos;should return -1 unless present&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        })

        it(<span class="hljs-string">&apos;should return the index when present&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        })
    })
})
</code></pre>
<p>&#x4F7F;&#x7528;&#x4E86;only&#x4E4B;&#x540E;&#xFF0C;&#x8FD9;&#x6761;descibe&#x5C31;&#x53EA;&#x6267;&#x884C;only&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x5FFD;&#x7565;&#x3002;skip&#x4F5C;&#x7528;&#x76F8;&#x53CD;&#xFF0C;&#x5176;&#x4ED6;&#x4F1A;&#x6267;&#x884C;&#xFF0C;&#x81EA;&#x5DF1;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;&#x3002;&#x4E24;&#x8005;&#x4E00;&#x8D77;&#xFF0C;&#x81EA;&#x5DF1;&#x60F3;&#x60F3;&#x90FD;&#x77E5;&#x9053;&#x3002;  </p>
<p>mocha&#x8FD9;&#x4E2A;&#x6D4B;&#x8BD5;&#x6846;&#x67B6;&#x5927;&#x4F53;&#x90FD;&#x4ECB;&#x7ECD;&#x5F97;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x6700;&#x540E;&#x4F60;&#x4F1A;&#x60CA;&#x5947;&#x7684;&#x53D1;&#x73B0;&#xFF01;&#xFF01;&#xFF01;&#x63A7;&#x5236;&#x53F0;&#x8F93;&#x51FA;&#x7684;&#x5185;&#x5BB9;&#x597D;&#x4E11;&#x554A;&#xFF01;&#xFF01;&#x4E3A;&#x4EC0;&#x4E48;&#xFF1F;&#xFF1F;&#x4E3A;&#x4EC0;&#x4E48;&#xFF1F;&#x56E0;&#x4E3A;&#x4F60;&#x662F;&#x4E2A;&#x6CA1;&#x6709;Mac&#x7684;&#x6B7B;&#x7A77;&#x540A;&#xFF01;  </p>
<p>&#x5982;&#x679C;&#x60F3;&#x8F93;&#x51FA;&#x6D4B;&#x8BD5;&#x7ED3;&#x679C;&#x597D;&#x770B;&#x70B9;&#xFF0C;&#x53EF;&#x4EE5;-R &#x6307;&#x4EE4;&#x6765;&#x9009;&#x62E9;&#x4E00;&#x4E9B;&#x8F93;&#x51FA;&#x6837;&#x5F0F;&#x3002;&#x4E2A;&#x4EBA;&#x5EFA;&#x8BAE;&#x8FD9;&#x6837;&#x8FD0;&#x884C;&#x3010;mocha -R spec yourFile&#x3011;&#xFF08;&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x77E5;&#x9053;&#xFF1F;&#x4E0D;&#x8981;&#x8BF4;&#x4E86;&#xFF0C;&#x6CEA;&#x6C34;&#x554A;~~&#xFF09;  </p>

        <div class="copyright">Powered by <a href="https://github.com/jaywcjlove/idoc" target="_blank">idoc</a>. Dependence <a href="https://nodejs.org">Node.js</a> run.</div>
    </div>
    
</div>


</body>
</html>
