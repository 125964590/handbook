(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{524:function(n,s){n.exports="\x3c!--\ntitle: samba\nsort: 6\n--\x3e\n\n# samba简介\n\n[samba](https://www.samba.org/)，是一个基于[GPL](https://www.samba.org/samba/docs/GPL.html)协议的自由软件。它重新实现了[SMB/CIFS](https://en.wikipedia.org/wiki/Server_Message_Block)协议，可以在各个平台共享文件和打印机。\n\n1991年，还是大学生的[Andrew Tridgwell](https://en.wikipedia.org/wiki/Andrew_Tridgell)，有三台机器，分别是Microsoft的DOS系统、DEC的Digital Unix系统、以及Sun的Unix系统。当时的技术无法让三者共享文件。为此，他开发了samba并将其开源。\n\n本来改名为smbserver，但是一家商业公司注册了SMBServer商标。他被告知不能使用。于是执行了`grep -i '^s.*m.*b' /usr/share/dict/words`，从中选择了samba这个词。我觉得这个是一个好想法，以后我也得着么干😄。\n\n# 安装\n\n```bash\nyum -y install samba samba-client samba-common\n```\n\n# 修改 samba 的配置文件\n\nvim 在文件参数后面接 `+` 可以直接打开到文件末尾，相当于在命令行模式下按 `G`，然后直接按 `o` 可以在下一行插入下面内容。\n\n```bash\nsudo vim /etc/samba/smb.conf +\ntestparm # 测试smb.conf配置是否正确\ntestparm –v # 命令可以详细的列出smb.conf支持的配置参数\n```\n\n## 配置说明\n\n```bash\n[myshare] \ncomment = My share \npath = /home/public                     # 共享路径 \nbrowseable = Yes                        # 可以被浏览，就是在网络邻居中能看到共享名 \nread only = No                          # 可读写 \nguest ok = Yes                          # 允许匿名访问，这个也需要设置，否则匿名无法访问 \nvalid users = samba liuag guest         # 有效的用户和组 \ninvalid users = liuben                  # 无效用户和组    \nread list = samba                       # 只读用户和组(如果read only = No，只读用户需要在此设置) \nwrite list = liuag                      # 可读写用户和组(如果read only = Yes，可读写用户需要在此设置) \nallow hosts = 192.168.100.236    # 允许访问主机列表，支持通配符 \ndeny hosts = 192.168.100.0/24    # 禁止访问主机列表，支持通配符 \n\n\nsecurity = user #这里指定samba的安全等级。关于安全等级有四种：\n  # share：用户不需要账户及密码即可登录samba服务器\n  # user：由提供服务的samba服务器负责检查账户及密码（默认）\n  # server：检查账户及密码的工作由另一台windows或samba服务器负责\n  # domain：指定windows域控制服务器来验证用户的账户及密码。\n\n\n```\n\n# 重启服务\n\n```\nsystemctl restart smb\nsystemctl reload smb\nsystemctl status smb\n```\n\n# 查看安装状况\n\n```\nrpm -qa|grep samba\n```\n\n# 设置开机自启动\n\n```\nchkconfig --level 35 smb on             //在3、5级别上自动运行samba服务\n```\n\n# samba用户管理\n\n```\npdbedit –a username：新建Samba账户。\npdbedit –x username：删除Samba账户。\npdbedit –L：列出Samba用户列表，读取passdb.tdb数据库文件。\npdbedit –Lv：列出Samba用户列表的详细信息。\npdbedit –c “[D]” –u username：暂停该Samba用户的账号。\npdbedit –c “[]” –u username：恢复该Samba用户的账号。\n\n\nsmbpasswd -a 增加用户（要增加的用户必须以是系统用户）   \nsmbpasswd -d 冻结用户，就是这个用户不能在登录了   \nsmbpasswd -e 恢复用户，解冻用户，让冻结的用户可以在使用   \nsmbpasswd -n 把用户的密码设置成空.   \n             要在global中写入 null passwords -true   \nsmbpasswd -x  删除用户  \n```\n\n\n`netstat -anlp | grep samba` \n\n# 关闭防火墙\n\n```bash\nsystemctl stop firewalld        #关闭防火墙\nsystemctl disable firewalld        #开机禁用防火墙\n```\n\n\n如何让Finder不在远程连接时产生`.DS_Store`打开Mac的Terminal，输入\n\n```bash\ndefaults write com.apple.desktopservices DSDontWriteNetworkStores true\n```\n\n然后重启Mac，再试试远程连接。\n\n# 错误解决\n\n## 增加samba用户提示Failed to add entry for user\n\n```\n[root@ubuntu ~]# smbpasswd -a wcj\nNew SMB password:\nRetype new SMB password:\nFailed to add entry for user wcj.\n\n```\n\n**解决办法:**\n\n这是因为没有加相应的系统账号，所以会提示`Failed to add entry for user`的错误，只需增加相应的系统账号`wcj`就可以了:\n\n`sudo useradd wcj`\n`useradd -g test wcj`   注：新建wcj用户并增加到test工作组   \n\n而且samba的登录密码可以和本机登录密码不一样。  \n\n`sudo touch /etc/samba/smbpasswd`  \n`sudo smbpasswd -a wcj`  \n\n\n`smbclient -L \\\\192.168.0.104 -U username`  \n`smbclient  //192.168.60.231/username` #登录Samba服务器  \n\n## 我的配置\n\n```\n[global]\n    workgroup = MYGROUP\n    server string = Samba Server Version %v\n\n    # log files split per-machine:\n    log file = /var/log/samba/log.%m\n    # maximum size of 50KB per log file, then rotate:\n    max log size = 50\n\n    security = user\n    passdb backend = tdbsam\n\n    load printers = yes\n    cups options = raw\n\n    printcap name = /dev/null\n    ;printable = yes\n\n    directory mask =0777\n    force directorymode = 0777\n    directorysecurity mask = 0777\n    force directorysecurity mode = 0777\n    create mask =0777\n    force createmode = 0777\n    security mask =0777\n    force securitymode = 0777\n\n[homes]\n    comment = Home Directories\n    browseable = no\n    writable = yes\n;   valid users = %S\n;   valid users = MYDOMAIN\\%S\n[dev]\n    path = /home/wangchuajiang/shared\n    writeable = yes\n    browseable = yes\n    write list = wangchujiang\n```\n\n## session setup failed\n\n[samba报错：session setup failed: NT_STATUS_LOGON_FAILURE 解决](http://shineforever.blog.51cto.com/1429204/317305/)\n\n## 错误三\n\n[Failed to retrieve printer list: NT_STATUS_UNSUCCESSFUL解决](http://www.sotechdesign.com.au/samba-log-showing-error-failed-to-retrieve-printer-list/)\n\n```\nprinting = bsd\nprintcap name = /dev/null\n```\n\n## 错误四\n\nsecurity不再支持share  \nWARNING: Ignoring invalid value 'share' forparameter 'security'  \n\n## 错误五\n\n请检查服务器名称或 IP 地址，然后再试一次。如果问题持续发生，请联系系统管理员。\n\n解决办法：重启电脑\n\n## 错误六\n\n```bash\n# 解決方法：於smb.conf中加入以下設定 \nload printers = no \nprinting = bsd \nprintcap name = /dev/null \ndisable spoolss = yes \n```\n\n[about:Unable to connect to CUPS server localhost:631 - Connection refused](http://blog.csdn.net/wzhwho/article/details/6275063)\n\n## 错误六\n\nSTATUS=daemon 'smbd' finished starting up and ready to serve connections\n\n# 参考\n\n[samba官网](https://www.samba.org)  \n[Mac连接远程Linux管理文件（samba）](http://www.jianshu.com/p/fe7fd0286c4e)  \n[简单的配置 samba 共享](http://www.jianshu.com/p/a6d70f1fbfa1)  \n[Ubuntu下配置samba服务器](http://my.oschina.net/junn/blog/171388)  \n[linux6-samba服务器＆SSH工具](http://www.jianshu.com/p/a6d70f1fbfa1)  \n[CentOS7安装配置SAMBA服务器](http://www.cnblogs.com/kluan/p/4452684.html)  "}}]);